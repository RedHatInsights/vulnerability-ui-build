{"version":3,"sources":["webpack:///./src/Components/SmartComponents/CVEs/VulnerabilitiesTable.js","webpack:///./src/Components/SmartComponents/CVEs/VulnerabilitiesTableToolbar.js","webpack:///./src/Components/SmartComponents/CVEs/VulnerabilitiesCves.js","webpack:///./src/Components/SmartComponents/CVEs/CVEs.js","webpack:///./src/Components/SmartComponents/Modals/BusinessRiskModal.js","webpack:///./src/Components/SmartComponents/Modals/CveStatusModal.js"],"names":["VulnerabilitiesTableWithContext","noCves","props","entity","cves","context","heightAuto","cells","colSpan","title","filter","item","Object","prototype","hasOwnProperty","call","meta","length","FilterNotFoundForCVE","EmptyCVEListForSystem","data","EmptyCVEList","undefined","handleOnCollapse","event","rowKey","isOpen","rows","state","setState","handleOnSelect","isSelected","rowId","methods","cveName","id","selectCves","handleBusinessRiskToggle","isBusinessRiskOpen","this","header","isLoading","colSize","rowSize","Table","aria-label","onSelect","onCollapse","openCve","actions","cveTableRowActions","sortBy","createSortBy","key","sort","onSort","direction","handleSortColumn","apply","gridBreakPoint","PaginationWrapper","variant","Component","propTypes","any","array","object","VulnerabilitiesTable","CVETableContext","Consumer","VulnerabilitiesToolbarWithContext","handleCveDescription","openedCves","params","expandCveDescription","cve","map","showRemediationButton","selectedCves","selectedCvesCount","filterCategories","filtersShowAll","filtersCVSSScore","filtersSeverity","filtersBusinessRisk","filtersPublishDate","filtersStatus","kebabOptions","kebabItemEditBusinessRisk","showBusinessRiskModal","business_risk_id","isDisabled","kebabItemEditStatus","showStatusModal","status_id","kebabItemToggleCvesDescription","kebabItemDownloadJSON","downloadReport","kebabItemDownloadCSV","Fragment","className","ToolbarGroup","SelectAllCheckbox","selectedItems","selectorHandler","items","fetchResource","ops","show_all","multiRow","SearchFilter","placeholder","value","Filters","filterValues","Remediation","systemId","BaseKebab","dropdownItems","disabled","ToolbarItem","FilterChips","filterCveId","bool","defaultProps","totalNumber","VulnerabilitiesToolbar","React","createContext","transforms","sortable","classNames","columnTransforms","cellFormatters","expandable","VulnerabilitiesCves","processError","GenericError","config","cvssEntry","CVSSOptions","find","cvss_filter","values","split","parseFloat","from","to","cvss_from","cvss_to","publicEntry","PublicDateOptions","publish_date","public_from","format","public_to","changeParameters","then","sendRequest","cveNames","selectCve","toggleCveDescription","cveList","parameters","createUrlParams","allParams","show_irrelevant","allowedParams","keys","forEach","includes","queryString","qs","stringify","history","push","fetchData","showReportLink","showAllParam","response","payload","fetchCveListByAccount","page_size","Number","MAX_SAFE_INTEGER","data_format","page","JSON","downloadFile","Date","toISOString","BusinessRiskModal","updateRef","StatusModal","isStatuskOpen","queryObject","parse","location","search","errors","Provider","Stack","StackItem","showAllCheckbox","func","withRouter","connect","VulnerabilitiesStore","createCveListByAccount","dispatch","changeCveListParameters","expandCve","CVEs","useState","setShowReportLink","VulnerabilityHeader","showBreadcrumb","businessRiskId","setBusinessRiskId","label","setLabel","useEffect","toString","getDefaultLabel","handleOnRadioChange","_","currentTarget","justification","successNotification","onSave","setBusinessRisk","parseInt","business_risk_text","onSuccessNotification","gutter","fieldId","businessRiskOptions","isChecked","onChange","name","type","resizeOrientation","CveStatusModal","useStatusSelect","StatusSelect","statusId","useJustificationInput","JustificationInput","checkboxState","setCheckboxState","cveIds","setCveStatus","status_text","setSystemCveStatus","content","checked","style","marginRight","size","color","isFilled"],"mappings":"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","file":"js/VulnerabilitiesCVEs.js","sourcesContent":["import { Table, TableBody, TableHeader } from '@patternfly/react-table';\nimport { SkeletonTable, TableToolbar } from '@redhat-cloud-services/frontend-components';\nimport propTypes from 'prop-types';\nimport React, { Component, Fragment } from 'react';\nimport { EmptyCVEList, EmptyCVEListForSystem, FilterNotFoundForCVE } from '../../../Helpers/constants';\nimport { cveTableRowActions } from '../../../Helpers/CVEHelper';\nimport { createSortBy, handleSortColumn } from '../../../Helpers/MiscHelper';\nimport PaginationWrapper from '../../PresentationalComponents/PaginationWrapper/PaginationWrapper';\nimport { CVETableContext } from './VulnerabilitiesCves';\n\nclass VulnerabilitiesTableWithContext extends Component {\n    static propTypes = {\n        context: propTypes.any,\n        header: propTypes.array,\n        entity: propTypes.object\n    };\n\n    noCves = () => {\n        const { entity, context } = this.props;\n        const { cves } = context;\n        const filterFields = ['filter', 'cvss_from', 'cvss_to', 'public_from', 'public_to', 'impact', 'status_id'].filter(\n            item => Object.prototype.hasOwnProperty.call(cves.meta, item) && cves.meta[item]\n        );\n\n        let emptyComponent = (filterFields.length !== 0)\n            ? FilterNotFoundForCVE : entity ? EmptyCVEListForSystem : (cves.data.length === 0) ? EmptyCVEList : undefined;\n\n        return ([{\n            heightAuto: true,\n            cells: [\n                {\n                    props: { colSpan: 8 },\n                    title: (\n                        emptyComponent\n                    )\n                }\n            ]\n        }]);\n    };\n\n    handleOnCollapse = (event, rowKey, isOpen) => {\n        const { rows } = this.state;\n        /**\n         * Please do not use rowKey as row index for more complex tables.\n         * Rather use some kind of identifier like ID passed with each row.\n         */\n        rows[rowKey].isOpen = isOpen;\n        this.setState({\n            rows\n        });\n    };\n\n    handleOnSelect = (event, isSelected, rowId) => {\n        const { context } = this.props;\n        const { cves, methods } = context;\n        const cveName = cves.data[rowId] && cves.data[rowId].id;\n        methods.selectCves(isSelected, cveName);\n    };\n\n    handleBusinessRiskToggle = () => {\n        this.setState(({ isBusinessRiskOpen }) => ({\n            isBusinessRiskOpen: !isBusinessRiskOpen\n        }));\n    };\n\n    render() {\n        const { context, header } = this.props;\n        const { cves, methods } = context;\n        return (\n            <Fragment>\n                {!cves.isLoading ? (\n                    <Fragment>\n                        <Table\n                            aria-label={'Vulnerability CVE table'}\n                            cells={header}\n                            rows={(cves.data.length === 0) ? this.noCves() : cves.data}\n                            onSelect={!(cves.data.length === 0) ? this.handleOnSelect : undefined}\n                            onCollapse={!(cves.data.length === 0) ? (event, rowKey) => methods.openCve(rowKey) : undefined}\n                            actions={!(cves.data.length === 0) ? cveTableRowActions(methods) : undefined}\n                            sortBy={!(cves.data.length === 0) ?\n                                createSortBy([{ key: 'collapse' }, { key: 'checkbox' }, ...header], cves.meta.sort) : undefined}\n                            onSort={!(cves.data.length === 0) ?\n                                (event, key, direction) =>\n                                    handleSortColumn(\n                                        key,\n                                        direction,\n                                        [{ key: 'collapse' }, { key: 'checkbox' }, ...header],\n                                        cves.meta.sort,\n                                        methods.apply\n                                    ) : undefined\n                            }\n                            gridBreakPoint={'grid-lg'}\n                        >\n                            <Fragment>\n                                <TableHeader />\n                                <TableBody />\n                            </Fragment>\n                        </Table>\n                        <TableToolbar>\n                            <PaginationWrapper variant=\"bottom\" meta={cves.meta} apply={methods.apply} />\n                        </TableToolbar>\n                    </Fragment>\n                ) : (\n                    <SkeletonTable colSize={6} rowSize={20} />\n                )}\n            </Fragment>\n        );\n    }\n}\n\nconst VulnerabilitiesTable = props => (\n    <CVETableContext.Consumer>\n        {context => <VulnerabilitiesTableWithContext context={context} {...props} />}\n    </CVETableContext.Consumer>\n);\n\nexport default VulnerabilitiesTable;\n","/* eslint-disable camelcase */\nimport { ToolbarGroup, ToolbarItem } from '@patternfly/react-core';\nimport { TableToolbar } from '@redhat-cloud-services/frontend-components';\nimport propTypes from 'prop-types';\nimport React, { Component } from 'react';\nimport {\n    filtersBusinessRisk,\n    filtersCVSSScore,\n    filtersPublishDate,\n    filtersSeverity,\n    filtersShowAll,\n    filtersStatus,\n    filterCveId\n} from '../../../Helpers/constants';\nimport BaseKebab from '../../PresentationalComponents/DownloadReportKebab/BaseKebab';\nimport {\n    kebabItemDownloadCSV,\n    kebabItemDownloadJSON,\n    kebabItemEditBusinessRisk,\n    kebabItemEditStatus,\n    kebabItemToggleCvesDescription\n} from '../../PresentationalComponents/DownloadReportKebab/KebabItems';\nimport FilterChips from '../../PresentationalComponents/Filters/FilterChips';\nimport Filters from '../../PresentationalComponents/Filters/Filters';\nimport SearchFilter from '../../PresentationalComponents/Filters/SearchFilter';\nimport PaginationWrapper from '../../PresentationalComponents/PaginationWrapper/PaginationWrapper';\nimport Remediation from '../Remediation/Remediation';\nimport SelectAllCheckbox from '../../PresentationalComponents/SelectAllCheckbox';\nimport { CVETableContext } from './VulnerabilitiesCves';\n\nclass VulnerabilitiesToolbarWithContext extends Component {\n    static propTypes = {\n        showRemediationButton: propTypes.bool,\n        entity: propTypes.object,\n        context: propTypes.object\n    };\n\n    static defaultProps = {\n        showRemediationButton: false,\n        totalNumber: 0,\n        apply: () => undefined,\n        downloadReport: () => undefined\n    };\n\n    handleCveDescription = () => {\n        const { context } = this.props;\n        const { cves, methods, params } = context;\n        const { expandCveDescription } = params;\n        const openedCves = !expandCveDescription ? cves.data.filter(cve => cve.id).map(cve => cve.id) : [];\n        methods.openCve(openedCves);\n    }\n\n    render() {\n        const { showRemediationButton, entity, context } = this.props;\n        const { cves, params, methods } = context;\n        const { selectedCves, expandCveDescription, filter } = params;\n        const selectedCvesCount = selectedCves && selectedCves.length;\n        const filterCategories = [\n            filtersShowAll,\n            filtersCVSSScore,\n            filtersSeverity,\n            filtersBusinessRisk,\n            filtersPublishDate,\n            filtersStatus\n        ];\n        const kebabOptions = [\n            kebabItemEditBusinessRisk(\n                methods.showBusinessRiskModal,\n                selectedCves.map(item => ({ id: item, business_risk_id: '0' })),\n                { isDisabled: !selectedCvesCount }\n            ),\n            kebabItemEditStatus(methods.showStatusModal, selectedCves.map(item => ({ id: item, status_id: '0' })), [], {\n                isDisabled: !selectedCvesCount\n            }),\n            kebabItemToggleCvesDescription(this.handleCveDescription, expandCveDescription),\n            kebabItemDownloadJSON(methods.downloadReport),\n            kebabItemDownloadCSV(methods.downloadReport)\n        ];\n        return (\n            <React.Fragment>\n                <TableToolbar className=\"space-between-toolbar-items\">\n                    <ToolbarGroup className=\"vulnerability-toolbar-spacing\">\n                        <SelectAllCheckbox\n                            selectedItems={selectedCves}\n                            selectorHandler={methods.selectCves}\n                            items={cves}\n                            fetchResource={ops => methods.fetchResource({ ...params, ...ops, show_all: !params.show_all })}\n                            multiRow\n                        />\n                        <SearchFilter\n                            placeholder=\"Find a CVE...\"\n                            value={filter}\n                            apply={methods.apply}\n\n                        />\n                        <Filters\n                            filterValues={params}\n                            filterCategories={filterCategories}\n                            apply={methods.apply}\n                        />\n\n                        {showRemediationButton && <Remediation systemId={entity.id} selectedCves={selectedCves} />}\n                        <BaseKebab dropdownItems={kebabOptions} disabled={cves.data.length === 0} />\n                    </ToolbarGroup>\n\n                    <ToolbarGroup>\n                        <PaginationWrapper apply={methods.apply} meta={cves.meta} />\n                    </ToolbarGroup>\n                </TableToolbar>\n                <TableToolbar className=\"pf-u-pt-0\">\n                    <ToolbarGroup>\n                        <ToolbarItem>\n                            <FilterChips\n                                filterValues={params}\n                                filterCategories={[filterCveId, ...filterCategories]}\n                                apply={methods.apply}\n                            />\n                        </ToolbarItem>\n                    </ToolbarGroup>\n                </TableToolbar>\n            </React.Fragment>\n        );\n    }\n}\n\nconst VulnerabilitiesToolbar = props => (\n    <CVETableContext.Consumer>\n        {context => <VulnerabilitiesToolbarWithContext context={context} {...props} />}\n    </CVETableContext.Consumer>\n);\nexport default VulnerabilitiesToolbar;\n","/* eslint-disable camelcase */\nimport { Stack, StackItem } from '@patternfly/react-core';\nimport { classNames, expandable, sortable } from '@patternfly/react-table';\nimport { downloadFile } from '@redhat-cloud-services/frontend-components-utilities/files/helpers';\nimport propTypes from 'prop-types';\nimport qs from 'query-string';\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport { CVSSOptions, GenericError, PublicDateOptions } from '../../../Helpers/constants';\nimport { createCveListByAccount } from '../../../Helpers/VulnerabilitiesHelper';\nimport { changeCveListParameters, fetchCveListByAccount, selectCve, expandCve } from '../../../Store/Actions/Actions';\nimport BusinessRiskModal from '../Modals/BusinessRiskModal';\nimport StatusModal from '../Modals/CveStatusModal';\nimport './vulnerabilities.scss';\nimport SystemCveTable from './VulnerabilitiesTable';\nimport SystemCveTableToolbar from './VulnerabilitiesTableToolbar';\n\nexport const CVETableContext = React.createContext({});\n\nconst header = [\n    {\n        title: 'CVE ID',\n        key: 'synopsis',\n        transforms: [sortable, classNames('col-width-10')],\n        columnTransforms: [classNames('no-wrap')],\n        cellFormatters: [expandable]\n    },\n    {\n        title: 'Publish date',\n        key: 'public_date',\n        transforms: [sortable, classNames('col-width-10')],\n        columnTransforms: [classNames('hide-description')]\n    },\n    {\n        title: 'Impact',\n        key: 'impact',\n        transforms: [sortable, classNames('col-width-10')],\n        columnTransforms: [classNames('no-wrap')]\n    },\n    {\n        title: 'CVSS base score',\n        key: 'cvss_score',\n        transforms: [sortable, classNames('col-width-10')]\n    },\n\n    { title: 'Systems exposed', key: 'systems_affected', transforms: [sortable, classNames('col-width-10')] },\n    { title: 'Business risk', key: 'business_risk', transforms: [sortable, classNames('col-width-10')] },\n    { title: 'Status', key: 'status', transforms: [sortable, classNames('col-width-10')] }\n];\n\nclass VulnerabilitiesCves extends Component {\n    static propTypes = {\n        cveList: propTypes.any,\n        fetchData: propTypes.func,\n        history: propTypes.object,\n        location: propTypes.object,\n        parameters: propTypes.object,\n        changeParameters: propTypes.func,\n        selectCve: propTypes.func,\n        openCve: propTypes.func,\n        showReportLink: propTypes.func\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            isBusinessRiskOpen: false,\n            isStatuskOpen: false,\n            BusinessRiskModal: () => null,\n            StatusModal: () => null,\n            expandCveDescription: false\n        };\n    }\n\n    componentDidMount() {\n        const { parameters } = this.props;\n        const queryObject = qs.parse(this.props.location.search);\n        queryObject.show_irrelevant = queryObject.show_irrelevant === 'true';\n        if (queryObject.show_irrelevant) {\n            queryObject.show_all = undefined;\n        }\n\n        this.apply({ ...parameters, ...queryObject });\n    }\n\n    processError = () => {\n        return GenericError;\n    };\n\n    apply = (config = {}) => {\n        if (Object.prototype.hasOwnProperty.call(config, 'cvss_filter')) {\n            let cvssEntry = CVSSOptions.find(item => item.value === config.cvss_filter);\n\n            if (typeof cvssEntry === 'undefined' &&\n                typeof config.cvss_filter !== 'undefined'\n            ) {\n                let values = config.cvss_filter.split(/[^0-9]+/).filter(item => parseFloat(item));\n                cvssEntry = { from: values[0], to: values[1] };\n            }\n            else if (typeof cvssEntry === 'undefined' &&\n                typeof config.cvss_filter === 'undefined') {\n                cvssEntry = { from: undefined, to: undefined };\n            }\n\n            config.cvss_from = cvssEntry.from;\n            config.cvss_to = cvssEntry.to;\n        }\n\n        if (Object.prototype.hasOwnProperty.call(config, 'publish_date')) {\n            let publicEntry = PublicDateOptions.find(item => item.value === config.publish_date);\n\n            if (typeof publicEntry !== 'undefined') {\n                config.public_from = publicEntry.from && publicEntry.from.format('YYYY-MM-DD');\n                config.public_to = publicEntry.to && publicEntry.to.format('YYYY-MM-DD');\n            } else {\n                config.public_from = undefined;\n                config.public_to = undefined;\n                config.publish_date = undefined;\n            }\n        }\n\n        this.props.changeParameters(config).then(this.sendRequest);\n    };\n\n    selectCves = (isSelected, cveNames) => {\n        this.props.selectCve(cveNames || []);\n    };\n\n    toggleCveDescription = (cveList) => {\n        const { parameters } = this.props;\n        const { expandCveDescription } = parameters;\n        const openedCves = expandCveDescription\n            ? cveList.data.filter(cve => cve.id).map(cve => cve.id)\n            : parameters.openedCves.length ? parameters.openedCves : [];\n\n        this.props.openCve(openedCves);\n    }\n\n    createUrlParams = allParams => {\n        const params = { ...allParams };\n        params.show_irrelevant = !params.show_all;\n        const allowedParams = [\n            'show_irrelevant',\n            'cvss_filter',\n            'publish_date',\n            'filter',\n            'limit',\n            'offset',\n            'page',\n            'page_size',\n            'sort',\n            'impact',\n            'business_risk_id',\n            'status_id'\n        ];\n        Object.keys(allParams).forEach(\n            key =>\n                (params[key] === undefined || params[key] === '' || !allowedParams.includes(key) || params[key] === false) &&\n                delete params[key]\n        );\n        const queryString = qs.stringify(params);\n        this.props.history.push('?' + queryString);\n    };\n\n    sendRequest = () => {\n        const { fetchData, parameters, showReportLink } = this.props;\n        //TODO: need a better way of doing this\n        const showAllParam = Object.prototype.hasOwnProperty.call(parameters, 'show_all') && !parameters.show_all;\n        // eslint-disable-next-line camelcase\n        fetchData && fetchData({ ...parameters, show_all: showAllParam })\n        .then(response => {\n            const { value } = response;\n            if (parameters.expandCveDescription) {\n                this.toggleCveDescription(value);\n            }\n\n            showReportLink(true);\n        });\n\n        this.createUrlParams(parameters);\n    };\n\n    downloadReport = format => {\n        const { parameters } = this.props;\n        const params = { ...parameters, show_all: !parameters.show_all };\n        let { payload } = fetchCveListByAccount({ ...params, page_size: Number.MAX_SAFE_INTEGER, data_format: format, page: 1 });\n        payload &&\n            payload.then(({ data: response }) => {\n                const data = format === 'json' ? JSON.stringify(response) : response;\n                return downloadFile(data, `vulnerability_cves-${new Date().toISOString()}`, format);\n            });\n    };\n\n    showBusinessRiskModal = cves => {\n        this.setState({\n            BusinessRiskModal: () => <BusinessRiskModal cves={cves} updateRef={this.apply} />\n        });\n    };\n\n    showStatusModal = cves => {\n        this.setState({\n            StatusModal: () => <StatusModal cves={cves} updateRef={this.apply} />\n        });\n    };\n\n    render() {\n        const { cveList, parameters, openCve } = this.props;\n        const { apply, downloadReport, selectCves, showBusinessRiskModal, showStatusModal } = this;\n        const { BusinessRiskModal, StatusModal } = this.state;\n        const cves = cveList;\n        const { errors } = cves;\n        if (!errors) {\n            return (\n                <CVETableContext.Provider\n                    value={{\n                        cves,\n                        params: { ...this.state, ...parameters },\n                        methods: {\n                            apply,\n                            downloadReport,\n                            selectCves,\n                            showBusinessRiskModal,\n                            showStatusModal,\n                            fetchResource: fetchCveListByAccount,\n                            openCve\n                        }\n                    }}\n                >\n                    <BusinessRiskModal />\n                    <StatusModal />\n\n                    <Stack>\n                        <StackItem>\n                            <SystemCveTableToolbar showAllCheckbox />\n                        </StackItem>\n                        <StackItem>\n                            <SystemCveTable header={header} showAllCheckbox />\n                        </StackItem>\n                    </Stack>\n                </CVETableContext.Provider>\n            );\n        } else {\n            return this.processError(errors);\n        }\n    }\n}\n\nfunction mapStateToProps({ VulnerabilitiesStore }) {\n    return {\n        cveList: VulnerabilitiesStore && createCveListByAccount(VulnerabilitiesStore),\n        parameters: VulnerabilitiesStore && VulnerabilitiesStore.parameters\n    };\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        fetchData: params => dispatch(fetchCveListByAccount(params)),\n        selectCve: params => dispatch(selectCve(params)),\n        changeParameters: params => dispatch(changeCveListParameters(params)),\n        openCve: params => dispatch(expandCve(params))\n    };\n};\n\nexport default withRouter(\n    connect(\n        mapStateToProps,\n        mapDispatchToProps\n    )(VulnerabilitiesCves)\n);\n","import { Main } from '@redhat-cloud-services/frontend-components';\nimport React, { useState } from 'react';\nimport VulnerabilityHeader from '../VulnerabilityHeader/VulnerabilityHeader';\nimport VulnerabilitiesCves from './VulnerabilitiesCves';\n\nconst CVEs = () => {\n    const [showReportLink, setShowReportLink] = useState(false);\n\n    return (\n        <React.Fragment>\n            <VulnerabilityHeader showReportLink={showReportLink} showBreadcrumb={false} />\n            <Main>\n                <VulnerabilitiesCves showReportLink={setShowReportLink}/>\n            </Main>\n        </React.Fragment>\n    );\n};\n\nexport default CVEs;\n","import { Form, FormGroup, Radio, Stack, StackItem, TextArea } from '@patternfly/react-core';\nimport propTypes from 'prop-types';\nimport React, { useEffect, useState } from 'react';\nimport { setBusinessRisk } from '../../../Helpers/APIHelper';\nimport { businessRiskOptions } from '../../../Helpers/constants';\nimport BaseModal from './BaseModal';\n\nexport const BusinessRiskModal = ({ cves, updateRef }) => {\n    const [cveList] = useState(cves);\n    const [businessRiskId, setBusinessRiskId] = useState('0');\n    const [label, setLabel] = useState();\n\n    useEffect(() => {\n        getDefaultBusinessRisk(), getDefaultLabel();\n    }, [cves]);\n    useEffect(getDefaultLabel, [cves]);\n\n    const handleOnRadioChange = (_, event) => {\n        const { value } = event.currentTarget;\n        setBusinessRiskId(value);\n    };\n\n    const handleOnLabelChange = value => {\n        setLabel(value);\n    };\n\n    const handleSave = () => {\n        return setBusinessRisk({\n            business_risk_id: parseInt(businessRiskId),\n            cve: cveList.map(item => item.id),\n            business_risk_text: label\n        }).then(updateRef);\n    };\n\n    function getDefaultBusinessRisk() {\n        setBusinessRiskId((cveList && cveList.length === 1 && cveList[0].business_risk_id.toString()) || '0');\n    }\n\n    function getDefaultLabel() {\n        setLabel((cveList && cveList.length === 1 && cveList[0].justification) || '');\n    }\n\n    const successNotification = {\n        variant: 'success',\n        title: `Business risk updated for ${cveList.length} CVEs`\n    };\n\n    return (\n        <BaseModal items={cveList} onSave={handleSave} onSuccessNotification={successNotification} title=\"Edit business risk\">\n            <Stack gutter={'md'}>\n                <StackItem>\n                    Business risk can be used to identify, track, and address CVEs that have meaningful impact to your\n                    organization.\n                </StackItem>\n                <StackItem>\n                    <Form>\n                        <FormGroup label=\"Business risk\" fieldId={'businessRiskId'}>\n                            {businessRiskOptions.map(item => (\n                                <Radio\n                                    value={item.value}\n                                    isChecked={businessRiskId === item.value}\n                                    onChange={handleOnRadioChange}\n                                    label={item.label}\n                                    key={item.value}\n                                    id={item.value}\n                                    name={item.label}\n                                    aria-label={item.label}\n                                />\n                            ))}\n                        </FormGroup>\n                        <FormGroup label=\"Justification\" fieldId={'label'}>\n                            <TextArea\n                                type=\"text\"\n                                onChange={handleOnLabelChange}\n                                value={label}\n                                resizeOrientation='vertical'\n                                aria-label={'justification'}\n                            />\n                        </FormGroup>\n                    </Form>\n                </StackItem>\n            </Stack>\n        </BaseModal>\n    );\n};\n\nBusinessRiskModal.propTypes = {\n    cves: propTypes.array,\n    updateRef: propTypes.func\n};\n\nexport default BusinessRiskModal;\n","import { Checkbox, Form, FormGroup, Split, SplitItem, Stack, StackItem, Tooltip } from '@patternfly/react-core';\nimport { InfoCircleIcon, OutlinedQuestionCircleIcon } from '@patternfly/react-icons';\nimport propTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { setCveStatus, setSystemCveStatus } from '../../../Helpers/APIHelper';\nimport BaseModal, { useJustificationInput, useStatusSelect } from './BaseModal';\n\nexport const CveStatusModal = ({ cves, updateRef }) => {\n    const [cveList] = useState(cves);\n    const { StatusSelect, statusId } = useStatusSelect(getDefaultStatus());\n    const { JustificationInput, justification } = useJustificationInput(getDefaultLabel());\n    const [checkboxState, setCheckboxState] = useState(false);\n\n    const handleSave = () => {\n        const cveIds = cveList.map(item => item.id);\n        return setCveStatus({\n            status_id: parseInt(statusId),\n            cve: cveIds,\n            status_text: justification\n        })\n        .then(() => !checkboxState && setSystemCveStatus({ cve: cveIds }))\n        .then(updateRef);\n    };\n\n    function getDefaultStatus() {\n        return (cveList && cveList.length === 1 && cveList[0].status_id.toString()) || '0';\n    }\n\n    function getDefaultLabel() {\n        return (cveList && cveList.length === 1 && cveList[0].justification) || '';\n    }\n\n    const successNotification = {\n        variant: 'success',\n        title: `Status updated for ${cveList.length} CVEs`\n    };\n    const title = cveList.length > 1 ? 'Set status for these CVEs and all systems' : 'Set status for this CVE and all systems';\n    return (\n        <BaseModal items={cveList} onSave={handleSave} onSuccessNotification={successNotification} title={title}>\n            <Stack gutter={'md'}>\n                <StackItem>\n                    <Form key=\"key\">\n                        {StatusSelect}\n                        {JustificationInput}\n                        <FormGroup fieldId={'overwrite'}>\n                            <Checkbox\n                                label={\n                                    <React.Fragment>\n                                        Do not overwrite individual system status{' '}\n                                        <Tooltip\n                                            content=\"When checked, this setting does not change any pre-existing\n                                        statuses set on individual systems for this CVE.\"\n                                        >\n                                            <React.Fragment>\n                                                <OutlinedQuestionCircleIcon />\n                                            </React.Fragment>\n                                        </Tooltip>\n                                    </React.Fragment>\n                                }\n                                id=\"alt-form-checkbox-1\"\n                                name=\"alt-form-checkbox-1\"\n                                isChecked={checkboxState}\n                                onChange={checked => setCheckboxState(checked)}\n                            />\n                        </FormGroup>\n                        <FormGroup fieldId={'info'}>\n                            <Split>\n                                <SplitItem style={{ marginRight: 'var(--pf-global--spacer--xs)' }}>\n                                    <InfoCircleIcon size=\"md\" color=\"var(--pf-global--active-color--400)\" />\n                                </SplitItem>\n                                <SplitItem isFilled>\n                                    This status is applied to all existing matching systems. Any new matching systems will have\n                                    the status &quot;Not reviewed&quot;{' '}\n                                    <Tooltip\n                                        content='Example: If a new system is added and matches to this vulnerability,\n                                    it will be given a status \"Not reviewed\"'\n                                    >\n                                        <React.Fragment>\n                                            <OutlinedQuestionCircleIcon />\n                                        </React.Fragment>\n                                    </Tooltip>\n                                </SplitItem>\n                            </Split>\n                        </FormGroup>\n                    </Form>\n                </StackItem>\n            </Stack>\n        </BaseModal>\n    );\n};\n\nCveStatusModal.propTypes = {\n    cves: propTypes.array,\n    updateRef: propTypes.func\n};\n\nexport default CveStatusModal;\n"],"sourceRoot":""}