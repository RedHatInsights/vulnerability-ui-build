{"version":3,"sources":["webpack:///./src/Components/SmartComponents/Modals/BusinessRiskModal.js","webpack:///./src/Components/SmartComponents/Modals/CveStatusModal.js","webpack:///./src/Components/SmartComponents/CVEs/VulnerabilitiesTable.js","webpack:///./src/Components/SmartComponents/CVEs/VulnerabilitiesTableToolbar.js","webpack:///./src/Components/SmartComponents/CVEs/VulnerabilitiesCves.js","webpack:///./src/Components/SmartComponents/CVEs/CVEs.js"],"names":["BusinessRiskModal","cves","updateRef","intl","useState","cveList","businessRiskId","setBusinessRiskId","label","setLabel","getDefaultLabel","useCallback","length","justification","useEffect","business_risk_id","toString","handleOnRadioChange","_","event","value","currentTarget","successNotification","variant","title","formatMessage","messages","businessRiskUpdateSuccessful","count","items","onSave","setBusinessRisk","parseInt","cve","map","item","id","business_risk_text","then","onSuccessNotification","businessRiskModalTitle","gutter","businessRiskModalInfo","businessRiskLabel","fieldId","businessRiskOptions","isChecked","onChange","key","name","aria-label","justificationLabel","type","resizeOrientation","propTypes","array","func","any","injectIntl","CveStatusModal","useStatusSelect","status_id","StatusSelect","statusId","useJustificationInput","JustificationInput","checkboxState","setCheckboxState","cveStatusModalUpdateSuccessful","cveStatusModalTitle","cveIds","setCveStatus","status_text","setSystemCveStatus","cveStatusModalOverwriteCheckbox","checked","content","cveStatusModalOverwriteTooltip","className","style","verticalAlign","marginRight","font-size","color","isFilled","cveStatusModalInfo","cveStatusModalInfoTooltip","Fragment","VulnerabilitiesTableWithContext","noCves","props","entity","context","heightAuto","cells","colSpan","filter","Object","prototype","hasOwnProperty","call","meta","FilterNotFoundForCVE","EmptyCVEListForSystem","data","EmptyCVEList","undefined","handleOnCollapse","rowKey","isOpen","rows","state","setState","handleOnSelect","isSelected","rowId","methods","cveName","selectCves","handleBusinessRiskToggle","isBusinessRiskOpen","this","header","isLoading","colSize","rowSize","Table","onSelect","onCollapse","openCve","actions","cveTableRowActions","sortBy","createSortBy","sort","onSort","direction","handleSortColumn","apply","gridBreakPoint","PaginationWrapper","Component","object","VulnerabilitiesTable","CVETableContext","Consumer","VulnerabilitiesToolbarWithContext","handleCveDescription","openedCves","params","expandCveDescription","showRemediationButton","selectedCves","selectedCvesCount","filterCategories","filtersShowAll","filtersSecurityRules","filtersSeverity","filtersCVSSScore","filtersBusinessRisk","filtersStatus","filtersPublishDate","kebabOptions","kebabItemEditBusinessRisk","showBusinessRiskModal","isDisabled","kebabItemEditStatus","showStatusModal","kebabItemToggleCvesDescription","kebabItemDownloadJSON","downloadReport","kebabItemDownloadCSV","ToolbarGroup","SelectAllCheckbox","selectedItems","selectorHandler","fetchResource","ops","show_all","multiRow","ToolbarItem","minWidth","SearchFilter","placeholder","searchFilterLabel","Filters","filterValues","Remediation","systemId","BaseKebab","dropdownItems","disabled","FilterChips","filterCveSearchTerm","bool","defaultProps","totalNumber","React","createContext","VulnerabilitiesCves","processError","GenericError","config","cvssEntry","CVSSOptions","find","cvss_filter","values","split","parseFloat","from","to","cvss_from","cvss_to","publicEntry","PublicDateOptions","publish_date","public_from","format","public_to","changeParameters","sendRequest","cveNames","selectCve","toggleCveDescription","parameters","createUrlParams","allParams","show_irrelevant","allowedParams","keys","forEach","includes","queryString","qs","stringify","history","push","fetchData","showReportLink","showAllParam","response","payload","fetchCveListByAccount","page_size","Number","MAX_SAFE_INTEGER","data_format","page","JSON","downloadFile","Date","toISOString","StatusModal","isStatuskOpen","queryObject","parse","location","search","errors","cveId","transforms","sortable","classNames","columnTransforms","cellFormatters","expandable","publishDate","impact","cvssBaseScore","systemsExposed","businessRisk","status","Provider","Stack","StackItem","showAllCheckbox","withRouter","connect","VulnerabilitiesStore","createCveListByAccount","dispatch","changeCveListParameters","expandCve","CVEs","setShowReportLink","VulnerabilityHeader","showBreadcrumb"],"mappings":"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","file":"js/VulnerabilitiesCVEs.js","sourcesContent":["import { Form, FormGroup, Radio, Stack, StackItem, TextArea } from '@patternfly/react-core';\nimport propTypes from 'prop-types';\nimport React, { useEffect, useState, useCallback } from 'react';\nimport { setBusinessRisk } from '../../../Helpers/APIHelper';\nimport { businessRiskOptions } from '../../../Helpers/constants';\nimport BaseModal from './BaseModal';\nimport { injectIntl } from 'react-intl';\nimport messages from '../../../Messages';\n\nexport const BusinessRiskModal = ({ cves, updateRef, intl }) => {\n    const [cveList] = useState(cves);\n    const [businessRiskId, setBusinessRiskId] = useState('0');\n    const [label, setLabel] = useState();\n\n    const getDefaultLabel = useCallback(() => {\n        setLabel((cveList && cveList.length === 1 && cveList[0].justification) || '');\n    }, [cveList]);\n\n    useEffect(() => {\n        const getDefaultBusinessRisk = () => {\n            setBusinessRiskId((cveList && cveList.length === 1 && cveList[0].business_risk_id.toString()) || '0');\n        };\n\n        getDefaultBusinessRisk();\n        getDefaultLabel();\n    }, [cves, getDefaultLabel, cveList]);\n\n    useEffect(getDefaultLabel, [cves]);\n\n    const handleOnRadioChange = (_, event) => {\n        const { value } = event.currentTarget;\n        setBusinessRiskId(value);\n    };\n\n    const handleOnLabelChange = value => {\n        setLabel(value);\n    };\n\n    const handleSave = () => {\n        return setBusinessRisk({\n            business_risk_id: parseInt(businessRiskId),\n            cve: cveList.map(item => item.id),\n            business_risk_text: label\n        }).then(updateRef);\n    };\n\n    const successNotification = {\n        variant: 'success',\n        title: intl.formatMessage(messages.businessRiskUpdateSuccessful, { count: cveList.length || 0 })\n    };\n\n    return (\n        <BaseModal\n            items={cveList}\n            onSave={handleSave}\n            onSuccessNotification={successNotification}\n            title={intl.formatMessage(messages.businessRiskModalTitle)}\n        >\n            <Stack gutter={'md'}>\n                <StackItem>\n                    {intl.formatMessage(messages.businessRiskModalInfo)}\n                </StackItem>\n                <StackItem>\n                    <Form>\n                        <FormGroup label={intl.formatMessage(messages.businessRiskLabel)} fieldId={'businessRiskId'}>\n                            {businessRiskOptions.map(item => (\n                                <Radio\n                                    value={item.value}\n                                    isChecked={businessRiskId === item.value}\n                                    onChange={handleOnRadioChange}\n                                    label={item.label}\n                                    key={item.value}\n                                    id={item.value}\n                                    name={item.label}\n                                    aria-label={item.label}\n                                />\n                            ))}\n                        </FormGroup>\n                        <FormGroup label={intl.formatMessage(messages.justificationLabel)} fieldId={'label'}>\n                            <TextArea\n                                type=\"text\"\n                                onChange={handleOnLabelChange}\n                                value={label}\n                                resizeOrientation='vertical'\n                                aria-label={'justification'}\n                            />\n                        </FormGroup>\n                    </Form>\n                </StackItem>\n            </Stack>\n        </BaseModal>\n    );\n};\n\nBusinessRiskModal.propTypes = {\n    cves: propTypes.array,\n    updateRef: propTypes.func,\n    intl: propTypes.any\n};\n\nexport default injectIntl(BusinessRiskModal);\n","import { Checkbox, Form, FormGroup, Split, SplitItem, Stack, StackItem, Tooltip } from '@patternfly/react-core';\nimport { InfoCircleIcon, OutlinedQuestionCircleIcon } from '@patternfly/react-icons';\nimport propTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { setCveStatus, setSystemCveStatus } from '../../../Helpers/APIHelper';\nimport BaseModal, { useJustificationInput, useStatusSelect } from './BaseModal';\nimport { injectIntl } from 'react-intl';\nimport messages from '../../../Messages';\n\nexport const CveStatusModal = ({ cves, updateRef, intl }) => {\n    const [cveList] = useState(cves);\n    const { StatusSelect, statusId } = useStatusSelect(getDefaultStatus());\n    const { JustificationInput, justification } = useJustificationInput(getDefaultLabel());\n    const [checkboxState, setCheckboxState] = useState(false);\n\n    const handleSave = () => {\n        const cveIds = cveList.map(item => item.id);\n        return setCveStatus({\n            status_id: parseInt(statusId),\n            cve: cveIds,\n            status_text: justification\n        })\n        .then(() => !checkboxState && setSystemCveStatus({ cve: cveIds }))\n        .then(updateRef);\n    };\n\n    function getDefaultStatus() {\n        return (cveList && cveList.length === 1 && cveList[0].status_id.toString()) || '0';\n    }\n\n    function getDefaultLabel() {\n        return (cveList && cveList.length === 1 && cveList[0].justification) || '';\n    }\n\n    const successNotification = {\n        variant: 'success',\n        title: intl.formatMessage(messages.cveStatusModalUpdateSuccessful, { count: cveList.length || 0 })\n    };\n    const title = intl.formatMessage(messages.cveStatusModalTitle, { count: cveList.length || 0 });\n\n    return (\n        <BaseModal items={cveList} onSave={handleSave} onSuccessNotification={successNotification} title={title}>\n            <Stack gutter={'md'}>\n                <StackItem>\n                    <Form key=\"key\">\n                        {StatusSelect}\n                        {JustificationInput}\n                        <FormGroup fieldId={'overwrite'}>\n                            <Split>\n                                <SplitItem>\n                                    <Checkbox\n                                        label={intl.formatMessage(messages.cveStatusModalOverwriteCheckbox)}\n                                        id=\"alt-form-checkbox-1\"\n                                        name=\"alt-form-checkbox-1\"\n                                        isChecked={checkboxState}\n                                        onChange={checked => setCheckboxState(checked)}\n                                    />\n                                </SplitItem>\n                                <SplitItem>\n                                    <Tooltip\n                                        content={intl.formatMessage(messages.cveStatusModalOverwriteTooltip)}\n                                    >\n                                        <OutlinedQuestionCircleIcon\n                                            className=\"pf-u-ml-xs\"\n                                            style={{ verticalAlign: '0' }}\n                                        />\n                                    </Tooltip>\n                                </SplitItem>\n                            </Split>\n                        </FormGroup>\n                        <FormGroup fieldId={'info'}>\n                            <Split>\n                                <SplitItem style={{ marginRight: 'var(--pf-global--spacer--xs)' }}>\n                                    <InfoCircleIcon\n                                        font-size=\"var(--pf-global--FontSize--xl)\"\n                                        color=\"var(--pf-global--active-color--400)\"\n                                    />\n                                </SplitItem>\n                                <SplitItem isFilled>\n                                    {intl.formatMessage(messages.cveStatusModalInfo)}\n                                    <Tooltip\n                                        content={intl.formatMessage(messages.cveStatusModalInfoTooltip)}\n                                    >\n                                        <React.Fragment>\n                                            <OutlinedQuestionCircleIcon\n                                                className=\"pf-u-ml-xs\"\n                                                style={{ verticalAlign: '-0.125em' }}\n                                            />\n                                        </React.Fragment>\n                                    </Tooltip>\n                                </SplitItem>\n                            </Split>\n                        </FormGroup>\n                    </Form>\n                </StackItem>\n            </Stack>\n        </BaseModal>\n    );\n};\n\nCveStatusModal.propTypes = {\n    cves: propTypes.array,\n    updateRef: propTypes.func,\n    intl: propTypes.any\n};\n\nexport default injectIntl(CveStatusModal);\n","import { Table, TableBody, TableHeader } from '@patternfly/react-table';\nimport { SkeletonTable, TableToolbar } from '@redhat-cloud-services/frontend-components';\nimport propTypes from 'prop-types';\nimport React, { Component, Fragment } from 'react';\nimport { EmptyCVEList, EmptyCVEListForSystem, FilterNotFoundForCVE } from '../../../Helpers/constants';\nimport { cveTableRowActions } from '../../../Helpers/CVEHelper';\nimport { createSortBy, handleSortColumn } from '../../../Helpers/MiscHelper';\nimport PaginationWrapper from '../../PresentationalComponents/PaginationWrapper/PaginationWrapper';\nimport { CVETableContext } from './VulnerabilitiesCves';\n\nclass VulnerabilitiesTableWithContext extends Component {\n    static propTypes = {\n        context: propTypes.any,\n        header: propTypes.array,\n        entity: propTypes.object\n    };\n\n    noCves = () => {\n        const { entity, context } = this.props;\n        const { cves } = context;\n        const filterFields = ['filter', 'cvss_from', 'cvss_to', 'public_from', 'public_to', 'impact', 'status_id'].filter(\n            item => Object.prototype.hasOwnProperty.call(cves.meta, item) && cves.meta[item]\n        );\n\n        let emptyComponent = (filterFields.length !== 0)\n            ? FilterNotFoundForCVE : entity ? EmptyCVEListForSystem : (cves.data.length === 0) ? EmptyCVEList : undefined;\n\n        return ([{\n            heightAuto: true,\n            cells: [\n                {\n                    props: { colSpan: 8 },\n                    title: (\n                        emptyComponent\n                    )\n                }\n            ]\n        }]);\n    };\n\n    handleOnCollapse = (event, rowKey, isOpen) => {\n        const { rows } = this.state;\n        /**\n         * Please do not use rowKey as row index for more complex tables.\n         * Rather use some kind of identifier like ID passed with each row.\n         */\n        rows[rowKey].isOpen = isOpen;\n        this.setState({\n            rows\n        });\n    };\n\n    handleOnSelect = (event, isSelected, rowId) => {\n        const { context } = this.props;\n        const { cves, methods } = context;\n        const cveName = cves.data[rowId] && cves.data[rowId].id;\n        methods.selectCves(isSelected, cveName);\n    };\n\n    handleBusinessRiskToggle = () => {\n        this.setState(({ isBusinessRiskOpen }) => ({\n            isBusinessRiskOpen: !isBusinessRiskOpen\n        }));\n    };\n\n    render() {\n        const { context, header } = this.props;\n        const { cves, methods } = context;\n        return (\n            <Fragment>\n                {!cves.isLoading ? (\n                    <Fragment>\n                        <Table\n                            aria-label={'Vulnerability CVE table'}\n                            cells={header}\n                            rows={(cves.data.length === 0) ? this.noCves() : cves.data}\n                            onSelect={!(cves.data.length === 0) ? this.handleOnSelect : undefined}\n                            onCollapse={!(cves.data.length === 0) ? (event, rowKey) => methods.openCve(rowKey) : undefined}\n                            actions={!(cves.data.length === 0) ? cveTableRowActions(methods) : undefined}\n                            sortBy={!(cves.data.length === 0) ?\n                                createSortBy([{ key: 'collapse' }, { key: 'checkbox' }, ...header], cves.meta.sort) : undefined}\n                            onSort={!(cves.data.length === 0) ?\n                                (event, key, direction) =>\n                                    handleSortColumn(\n                                        key,\n                                        direction,\n                                        [{ key: 'collapse' }, { key: 'checkbox' }, ...header],\n                                        cves.meta.sort,\n                                        methods.apply\n                                    ) : undefined\n                            }\n                            gridBreakPoint={'grid-lg'}\n                        >\n                            <Fragment>\n                                <TableHeader />\n                                <TableBody />\n                            </Fragment>\n                        </Table>\n                        <TableToolbar>\n                            <PaginationWrapper variant=\"bottom\" meta={cves.meta} apply={methods.apply} />\n                        </TableToolbar>\n                    </Fragment>\n                ) : (\n                    <SkeletonTable colSize={6} rowSize={20} />\n                )}\n            </Fragment>\n        );\n    }\n}\n\nconst VulnerabilitiesTable = props => (\n    <CVETableContext.Consumer>\n        {context => <VulnerabilitiesTableWithContext context={context} {...props} />}\n    </CVETableContext.Consumer>\n);\n\nexport default VulnerabilitiesTable;\n","/* eslint-disable camelcase */\nimport { ToolbarGroup, ToolbarItem } from '@patternfly/react-core';\nimport { TableToolbar } from '@redhat-cloud-services/frontend-components';\nimport propTypes from 'prop-types';\nimport React, { Component } from 'react';\nimport {\n    filtersBusinessRisk,\n    filtersCVSSScore,\n    filtersPublishDate,\n    filtersSeverity,\n    filtersShowAll,\n    filtersStatus,\n    filterCveSearchTerm,\n    filtersSecurityRules\n} from '../../../Helpers/constants';\nimport BaseKebab from '../../PresentationalComponents/DownloadReportKebab/BaseKebab';\nimport {\n    kebabItemDownloadCSV,\n    kebabItemDownloadJSON,\n    kebabItemEditBusinessRisk,\n    kebabItemEditStatus,\n    kebabItemToggleCvesDescription\n} from '../../PresentationalComponents/DownloadReportKebab/KebabItems';\nimport FilterChips from '../../PresentationalComponents/Filters/FilterChips';\nimport Filters from '../../PresentationalComponents/Filters/Filters';\nimport SearchFilter from '../../PresentationalComponents/Filters/SearchFilter';\nimport PaginationWrapper from '../../PresentationalComponents/PaginationWrapper/PaginationWrapper';\nimport Remediation from '../Remediation/Remediation';\nimport SelectAllCheckbox from '../../PresentationalComponents/SelectAllCheckbox';\nimport { CVETableContext } from './VulnerabilitiesCves';\nimport { injectIntl } from 'react-intl';\nimport messages from '../../../Messages';\nclass VulnerabilitiesToolbarWithContext extends Component {\n    static propTypes = {\n        showRemediationButton: propTypes.bool,\n        entity: propTypes.object,\n        context: propTypes.object,\n        intl: propTypes.any\n    };\n\n    static defaultProps = {\n        showRemediationButton: false,\n        totalNumber: 0,\n        apply: () => undefined,\n        downloadReport: () => undefined\n    };\n\n    handleCveDescription = () => {\n        const { context } = this.props;\n        const { cves, methods, params } = context;\n        const { expandCveDescription } = params;\n        const openedCves = !expandCveDescription ? cves.data.filter(cve => cve.id).map(cve => cve.id) : [];\n        methods.openCve(openedCves);\n    }\n\n    render() {\n        const { showRemediationButton, entity, context } = this.props;\n        const { cves, params, methods } = context;\n        const { selectedCves, expandCveDescription, filter } = params;\n        const selectedCvesCount = selectedCves && selectedCves.length;\n        const filterCategories = [\n            filtersShowAll,\n            filtersSecurityRules,\n            filtersSeverity,\n            filtersCVSSScore,\n            filtersBusinessRisk,\n            filtersStatus,\n            filtersPublishDate\n        ];\n        const kebabOptions = [\n            kebabItemEditBusinessRisk(\n                methods.showBusinessRiskModal,\n                selectedCves.map(item => ({ id: item, business_risk_id: '0' })),\n                { isDisabled: !selectedCvesCount }\n            ),\n            kebabItemEditStatus(methods.showStatusModal, selectedCves.map(item => ({ id: item, status_id: '0' })), [], {\n                isDisabled: !selectedCvesCount\n            }),\n            kebabItemToggleCvesDescription(this.handleCveDescription, expandCveDescription),\n            kebabItemDownloadJSON(methods.downloadReport, { isDisabled: cves.data.length === 0 }),\n            kebabItemDownloadCSV(methods.downloadReport, { isDisabled: cves.data.length === 0 })\n        ];\n        return (\n            <React.Fragment>\n                <TableToolbar className=\"space-between-toolbar-items\">\n                    <ToolbarGroup className=\"vulnerability-toolbar-spacing\">\n                        <SelectAllCheckbox\n                            selectedItems={selectedCves}\n                            selectorHandler={methods.selectCves}\n                            items={cves}\n                            fetchResource={ops => methods.fetchResource({ ...params, ...ops, show_all: !params.show_all })}\n                            multiRow\n                        />\n                        <ToolbarItem style={{ minWidth: '5rem' }}>\n                            <SearchFilter\n                                placeholder={this.props.intl.formatMessage(messages.searchFilterLabel)}\n                                value={filter}\n                                apply={methods.apply}\n                            />\n                        </ToolbarItem>\n                        <Filters\n                            filterValues={params}\n                            filterCategories={filterCategories}\n                            apply={methods.apply}\n                        />\n                        {showRemediationButton && <Remediation systemId={entity.id} selectedCves={selectedCves} />}\n                        <BaseKebab\n                            dropdownItems={kebabOptions}\n                            disabled={cves.data.length === 0 && selectedCvesCount === 0}\n                        />\n                    </ToolbarGroup>\n\n                    <ToolbarGroup>\n                        <PaginationWrapper apply={methods.apply} meta={cves.meta} />\n                    </ToolbarGroup>\n                </TableToolbar>\n                <TableToolbar className=\"pf-u-pt-0\">\n                    <ToolbarGroup>\n                        <ToolbarItem>\n                            <FilterChips\n                                filterValues={params}\n                                filterCategories={[filterCveSearchTerm, ...filterCategories]}\n                                apply={methods.apply}\n                            />\n                        </ToolbarItem>\n                    </ToolbarGroup>\n                </TableToolbar>\n            </React.Fragment>\n        );\n    }\n}\n\nconst VulnerabilitiesToolbar = props => (\n    <CVETableContext.Consumer>\n        {context => <VulnerabilitiesToolbarWithContext context={context} {...props} />}\n    </CVETableContext.Consumer>\n);\nexport default injectIntl(VulnerabilitiesToolbar);\n","/* eslint-disable camelcase */\nimport { Stack, StackItem } from '@patternfly/react-core';\nimport { classNames, expandable, sortable } from '@patternfly/react-table';\nimport { downloadFile } from '@redhat-cloud-services/frontend-components-utilities/files/helpers';\nimport propTypes from 'prop-types';\nimport qs from 'query-string';\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport { CVSSOptions, GenericError, PublicDateOptions } from '../../../Helpers/constants';\nimport { createCveListByAccount } from '../../../Helpers/VulnerabilitiesHelper';\nimport { changeCveListParameters, fetchCveListByAccount, selectCve, expandCve } from '../../../Store/Actions/Actions';\nimport BusinessRiskModal from '../Modals/BusinessRiskModal';\nimport StatusModal from '../Modals/CveStatusModal';\nimport './vulnerabilities.scss';\nimport SystemCveTable from './VulnerabilitiesTable';\nimport SystemCveTableToolbar from './VulnerabilitiesTableToolbar';\nimport { injectIntl } from 'react-intl';\nimport messages from '../../../Messages';\n\nexport const CVETableContext = React.createContext({});\n\nclass VulnerabilitiesCves extends Component {\n    static propTypes = {\n        cveList: propTypes.any,\n        fetchData: propTypes.func,\n        history: propTypes.object,\n        location: propTypes.object,\n        parameters: propTypes.object,\n        changeParameters: propTypes.func,\n        selectCve: propTypes.func,\n        openCve: propTypes.func,\n        showReportLink: propTypes.func,\n        intl: propTypes.any\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            isBusinessRiskOpen: false,\n            isStatuskOpen: false,\n            BusinessRiskModal: () => null,\n            StatusModal: () => null,\n            expandCveDescription: false\n        };\n    }\n\n    componentDidMount() {\n        const { parameters } = this.props;\n        const queryObject = qs.parse(this.props.location.search);\n        queryObject.show_irrelevant = queryObject.show_irrelevant === 'true';\n        if (queryObject.show_irrelevant) {\n            queryObject.show_all = undefined;\n        }\n\n        this.apply({ ...parameters, ...queryObject });\n    }\n\n    processError = () => {\n        return GenericError;\n    };\n\n    apply = (config = {}) => {\n        if (Object.prototype.hasOwnProperty.call(config, 'cvss_filter')) {\n            let cvssEntry = CVSSOptions.find(item => item.value === config.cvss_filter);\n\n            if (typeof cvssEntry === 'undefined' &&\n                typeof config.cvss_filter !== 'undefined'\n            ) {\n                let values = config.cvss_filter.split(/[^0-9]+/).filter(item => parseFloat(item));\n                cvssEntry = { from: values[0], to: values[1] };\n            }\n            else if (typeof cvssEntry === 'undefined' &&\n                typeof config.cvss_filter === 'undefined') {\n                cvssEntry = { from: undefined, to: undefined };\n            }\n\n            config.cvss_from = cvssEntry.from;\n            config.cvss_to = cvssEntry.to;\n        }\n\n        if (Object.prototype.hasOwnProperty.call(config, 'publish_date')) {\n            let publicEntry = PublicDateOptions.find(item => item.value === config.publish_date);\n\n            if (typeof publicEntry !== 'undefined') {\n                config.public_from = publicEntry.from && publicEntry.from.format('YYYY-MM-DD');\n                config.public_to = publicEntry.to && publicEntry.to.format('YYYY-MM-DD');\n            } else {\n                config.public_from = undefined;\n                config.public_to = undefined;\n                config.publish_date = undefined;\n            }\n        }\n\n        this.props.changeParameters(config).then(this.sendRequest);\n    };\n\n    selectCves = (isSelected, cveNames) => {\n        this.props.selectCve(cveNames || []);\n    };\n\n    toggleCveDescription = (cveList) => {\n        const { parameters } = this.props;\n        const { expandCveDescription } = parameters;\n        const openedCves = expandCveDescription\n            ? cveList.data.filter(cve => cve.id).map(cve => cve.id)\n            : parameters.openedCves.length ? parameters.openedCves : [];\n\n        this.props.openCve(openedCves);\n    }\n\n    createUrlParams = allParams => {\n        const params = { ...allParams };\n        params.show_irrelevant = !params.show_all;\n        const allowedParams = [\n            'show_irrelevant',\n            'cvss_filter',\n            'publish_date',\n            'filter',\n            'limit',\n            'offset',\n            'page',\n            'page_size',\n            'sort',\n            'impact',\n            'business_risk_id',\n            'status_id',\n            'security_rule'\n        ];\n        Object.keys(allParams).forEach(\n            key =>\n                (params[key] === undefined || params[key] === '' || !allowedParams.includes(key) || params[key] === false) &&\n                delete params[key]\n        );\n        const queryString = qs.stringify(params);\n        this.props.history.push('?' + queryString);\n    };\n\n    sendRequest = () => {\n        const { fetchData, parameters, showReportLink } = this.props;\n        //TODO: need a better way of doing this\n        const showAllParam = Object.prototype.hasOwnProperty.call(parameters, 'show_all') && !parameters.show_all;\n        // eslint-disable-next-line camelcase\n        fetchData && fetchData({ ...parameters, show_all: showAllParam })\n        .then(response => {\n            const { value } = response;\n            if (parameters.expandCveDescription) {\n                this.toggleCveDescription(value);\n            }\n\n            showReportLink(true);\n        });\n\n        this.createUrlParams(parameters);\n    };\n\n    downloadReport = format => {\n        const { parameters } = this.props;\n        const params = { ...parameters, show_all: !parameters.show_all };\n        let { payload } = fetchCveListByAccount({ ...params, page_size: Number.MAX_SAFE_INTEGER, data_format: format, page: 1 });\n        payload &&\n            payload.then(({ data: response }) => {\n                const data = format === 'json' ? JSON.stringify(response) : response;\n                return downloadFile(data, `vulnerability_cves-${new Date().toISOString()}`, format);\n            });\n    };\n\n    showBusinessRiskModal = cves => {\n        this.setState({\n            BusinessRiskModal: () => <BusinessRiskModal cves={cves} updateRef={this.apply} />\n        });\n    };\n\n    showStatusModal = cves => {\n        this.setState({\n            StatusModal: () => <StatusModal cves={cves} updateRef={this.apply} />\n        });\n    };\n\n    render() {\n        const { cveList, parameters, openCve } = this.props;\n        const { apply, downloadReport, selectCves, showBusinessRiskModal, showStatusModal } = this;\n        const { BusinessRiskModal, StatusModal } = this.state;\n        const cves = cveList;\n        const { errors } = cves;\n        const header = [\n            {\n                title: this.props.intl.formatMessage(messages.cveId),\n                key: 'synopsis',\n                transforms: [sortable, classNames('col-width-10')],\n                columnTransforms: [classNames('no-wrap')],\n                cellFormatters: [expandable]\n            },\n            {\n                title: this.props.intl.formatMessage(messages.publishDate),\n                key: 'public_date',\n                transforms: [sortable, classNames('col-width-10')],\n                columnTransforms: [classNames('hide-description')]\n            },\n            {\n                title: this.props.intl.formatMessage(messages.impact),\n                key: 'impact',\n                transforms: [sortable, classNames('col-width-10')],\n                columnTransforms: [classNames('no-wrap')]\n            },\n            {\n                title: this.props.intl.formatMessage(messages.cvssBaseScore),\n                key: 'cvss_score',\n                transforms: [sortable, classNames('col-width-10')]\n            },\n            {\n                title: this.props.intl.formatMessage(messages.systemsExposed),\n                key: 'systems_affected',\n                transforms: [sortable, classNames('col-width-10')] },\n            {\n                title: this.props.intl.formatMessage(messages.businessRisk),\n                key: 'business_risk',\n                transforms: [sortable, classNames('col-width-10')]\n            },\n            {\n                title: this.props.intl.formatMessage(messages.status),\n                key: 'status',\n                transforms: [sortable, classNames('col-width-10')] }\n        ];\n\n        if (!errors) {\n            return (\n                <CVETableContext.Provider\n                    value={{\n                        cves,\n                        params: { ...this.state, ...parameters },\n                        methods: {\n                            apply,\n                            downloadReport,\n                            selectCves,\n                            showBusinessRiskModal,\n                            showStatusModal,\n                            fetchResource: fetchCveListByAccount,\n                            openCve\n                        }\n                    }}\n                >\n                    <BusinessRiskModal />\n                    <StatusModal />\n\n                    <Stack>\n                        <StackItem>\n                            <SystemCveTableToolbar showAllCheckbox />\n                        </StackItem>\n                        <StackItem>\n                            <SystemCveTable header={header} showAllCheckbox />\n                        </StackItem>\n                    </Stack>\n                </CVETableContext.Provider>\n            );\n        } else {\n            return this.processError(errors);\n        }\n    }\n}\n\nfunction mapStateToProps({ VulnerabilitiesStore }) {\n    return {\n        cveList: VulnerabilitiesStore && createCveListByAccount(VulnerabilitiesStore),\n        parameters: VulnerabilitiesStore && VulnerabilitiesStore.parameters\n    };\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        fetchData: params => dispatch(fetchCveListByAccount(params)),\n        selectCve: params => dispatch(selectCve(params)),\n        changeParameters: params => dispatch(changeCveListParameters(params)),\n        openCve: params => dispatch(expandCve(params))\n    };\n};\n\nexport default withRouter(\n    injectIntl(\n        connect(\n            mapStateToProps,\n            mapDispatchToProps\n        )(VulnerabilitiesCves)\n    )\n);\n","import { Main } from '@redhat-cloud-services/frontend-components';\nimport React, { useState } from 'react';\nimport VulnerabilityHeader from '../VulnerabilityHeader/VulnerabilityHeader';\nimport VulnerabilitiesCves from './VulnerabilitiesCves';\n\nconst CVEs = () => {\n    const [showReportLink, setShowReportLink] = useState(false);\n\n    return (\n        <React.Fragment>\n            <VulnerabilityHeader showReportLink={showReportLink} showBreadcrumb={false} />\n            <Main>\n                <VulnerabilitiesCves showReportLink={setShowReportLink}/>\n            </Main>\n        </React.Fragment>\n    );\n};\n\nexport default CVEs;\n"],"sourceRoot":""}