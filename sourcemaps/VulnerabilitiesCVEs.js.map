{"version":3,"sources":["webpack:///./src/Components/PresentationalComponents/EmptyStates/EmptyStates.js","webpack:///./src/Helpers/selectAllCheckboxHelper.js","webpack:///./src/Components/PresentationalComponents/Filters/PrimaryToolbarFilters/SearchFilter.js","webpack:///./src/Helpers/TableToolbarHelper.js","webpack:///./src/Components/PresentationalComponents/PaginationWrapper/PaginationWrapper.js","webpack:///./src/Components/SmartComponents/Modals/BusinessRiskModal.js","webpack:///./src/Components/SmartComponents/Modals/CveStatusModal.js","webpack:///./src/Components/SmartComponents/CVEs/vulnerabilities.scss?f1f2","webpack:///./src/Components/SmartComponents/CVEs/vulnerabilities.scss","webpack:///./src/Components/PresentationalComponents/Filters/PrimaryToolbarFilters/SecurityRuleFilter.js","webpack:///./src/Components/PresentationalComponents/Filters/PrimaryToolbarFilters/StatusFilter.js","webpack:///./src/Components/SmartComponents/CVEs/VulnerabilitiesTable.js","webpack:///./src/Components/PresentationalComponents/Filters/PrimaryToolbarFilters/PublishDateFilter.js","webpack:///./src/Components/PresentationalComponents/Filters/PrimaryToolbarFilters/CvssBaseScoreFilter.js","webpack:///./src/Components/PresentationalComponents/Filters/PrimaryToolbarFilters/ImpactFilter.js","webpack:///./src/Components/PresentationalComponents/Filters/PrimaryToolbarFilters/BusinessRiskFilter.js","webpack:///./src/Components/PresentationalComponents/Filters/PrimaryToolbarFilters/NotAffectingCVEsFilter.js","webpack:///./src/Components/SmartComponents/CVEs/VulnerabilitiesTableToolbar.js","webpack:///./src/Components/SmartComponents/CVEs/VulnerabilitiesCves.js","webpack:///./src/Components/SmartComponents/CVEs/CVEs.js"],"names":["FilterNotFoundForCVE","style","height","variant","EmptyStateVariant","large","headingLevel","size","messages","emptyStateNoMatchingCves","whiteSpace","emptyStateMaybeFollowing","emptyStateNoCveReported","component","TextVariants","p","emptyStateForMoreInfo","href","target","rel","emptyStateForMoreLink","FilterNotFoundForSystem","emptyStateNoSystemsMatching","emptyStateMaybeExcluded","emptyStateIfCveForSystem","EmptyCVEListForSystem","emptyStateNoReportedSystem","emptyStateNoCveAffects","EmptyExcludedSystem","buttonAction","icon","SecurityIcon","emptyStateSystemExcludedTitle","emptyStateSystemExcludedBody","onClick","emptyStateSystemResumeAnalysis","propTypes","func","EmptyCVEList","emptyStateIfCveForSystems","EmptyVulnerabilityData","CubesIcon","emptyStateNoData","emptyStateActivateInsights","emptyStateLearnInsights","GenericError","className","errorReload","selectAllCheckbox","selectedItems","selectorHandler","items","fetchResource","multiRow","selectedItemsArray","Array","from","selectedItemsCount","length","meta","data","selectPageNumber","isArray","handleUnselectAll","handleSelectAll","payload","page_size","total_items","page","then","map","item","id","handleOnCheckboxChange","title","intl","formatMessage","selectNone","selectPage","count","collectedItems","union","filter","selectAll","SearchFilter","placeholder","search","apply","React","useState","searchValue","setSearchValue","debounce","undefined","handleSearch","useEffect","type","conditionalFilterType","text","label","cve","filterValues","onChange","event","value","handleChangePage","_event","handleSetPageSize","perPage","exportConfig","methods","kebabExportAsJson","kebabExportAsCsv","onSelect","fileType","downloadReport","kebabAction","callback","isDisabled","color","isInline","key","buildActiveFilters","currentFilters","filterChips","Object","keys","FILTERS","reduce","array","includes","paramValues","split","filteredValues","values","push","object","name","category","chips","searchLabel","removeFilters","obj","some","chip","join","PaginationWrapper","pageNumber","props","nextProps","this","Fragment","itemCount","DEFAULT_PAGE_SIZE","onSetPage","onPerPageSelect","PaginationVariant","Component","string","defaultProps","BusinessRiskModal","cves","updateRef","cveList","businessRiskId","setBusinessRiskId","setLabel","getDefaultLabel","useCallback","justification","business_risk_id","toString","handleOnRadioChange","_","currentTarget","successNotification","businessRiskUpdateSuccessful","onSave","setBusinessRisk","parseInt","business_risk_text","onSuccessNotification","businessRiskModalTitle","gutter","businessRiskModalInfo","businessRiskLabel","fieldId","businessRiskOptions","isChecked","aria-label","justificationLabel","resizeOrientation","any","injectIntl","CveStatusModal","useStatusSelect","status_id","StatusSelect","statusId","useJustificationInput","JustificationInput","checkboxState","setCheckboxState","cveStatusModalUpdateSuccessful","cveStatusModalTitle","cveIds","setCveStatus","status_text","setSystemCveStatus","cveStatusModalSelected","cveId","b","chunks","fontSize","cveStatusModalInfo","content","cveStatusModalInfoTooltip","verticalAlign","cveStatusModalOverwriteCheckbox","checked","cveStatusModalOverwriteTooltip","module","i","options","transform","locals","exports","securityRuleFilter","currentFilter","dynamicFilters","currentValue","security_rule","filterBySecurityRule","securityRules","radio","urlParam","unionWith","securityRulesOptions","isEqual","statusFilter","filterByStatus","status","checkbox","STATUS_OPTIONS","VulnerabilitiesTableWithContext","noCves","entity","context","heightAuto","cells","colSpan","prototype","hasOwnProperty","call","handleOnCollapse","rowKey","isOpen","rows","state","setState","handleOnSelect","isSelected","rowId","cveName","selectCves","handleBusinessRiskToggle","isBusinessRiskOpen","header","isLoading","colSize","rowSize","Table","onCollapse","openCve","actions","cveTableRowActions","sortBy","createSortBy","sort","onSort","direction","handleSortColumn","gridBreakPoint","VulnerabilitiesTable","CVETableContext","Consumer","publishDateFilter","publish_date","filterByPublishDate","publishDate","PublicDateOptions","cvssBaseScoreFilter","cvss_filter","filterByCvssScore","cvssBaseScore","CVSSOptions","impactFilter","impact","filterByImpact","IMPACT_OPTIONS","hasIcon","iconColor","businessRiskFilter","filterByBusinessRisk","businessRisk","notAffectingCvesFilter","show_all","filterByNoAffect","filterAffectingCVEs","AFFECTING_SYSTEMS_OPTIONS","VulnerabilitiesToolbarWithContext","showRemediationButton","params","selectedCves","expandCveDescription","selectedCvesCount","selectOptions","ops","Remediation","systemId","editBusinessRisk","showBusinessRiskModal","editStatus","showStatusModal","kebabCollapseCves","kebabExpandCves","openedCves","pagination","actionsConfig","dropdownProps","bulkSelect","Boolean","filterConfig","searchFilter","activeFiltersConfig","filters","onDelete","e","bool","totalNumber","createContext","VulnerabilitiesCves","processError","config","cvssEntry","find","parseFloat","to","cvss_from","cvss_to","publicEntry","public_from","format","public_to","changeParameters","sendRequest","cveNames","selectCve","toggleCveDescription","parameters","createUrlParams","allParams","show_irrelevant","allowedParams","forEach","queryString","qs","stringify","history","fetchData","showReportLink","showAllParam","response","DownloadReport","exec","fetchCveListByAccount","StatusModal","isStatuskOpen","queryObject","parse","location","errors","transforms","sortable","classNames","columnTransforms","cellFormatters","expandable","systemsExposed","Provider","Stack","StackItem","showAllCheckbox","withRouter","connect","VulnerabilitiesStore","createCveListByAccount","dispatch","changeCveListParameters","expandCve","CVEs","setShowReportLink","VulnerabilityHeader","showBreadcrumb"],"mappings":"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","file":"js/VulnerabilitiesCVEs.js","sourcesContent":["import React from 'react';\nimport propTypes from 'prop-types';\nimport { FormattedMessage } from 'react-intl';\nimport {\n    Bullseye,\n    Button,\n    Card,\n    CardBody,\n    CardHeader,\n    EmptyStateVariant,\n    EmptyState,\n    EmptyStateBody,\n    EmptyStateIcon,\n    Text,\n    TextVariants,\n    TextContent,\n    Title\n} from '@patternfly/react-core';\n\nimport { CubesIcon, ExternalLinkAltIcon, FrownOpenIcon, SecurityIcon } from '@patternfly/react-icons';\nimport messages from '../../../Messages';\n\n// Reports that no CVEs were found after filtering results\nexport const FilterNotFoundForCVE = (\n    <Bullseye style={{ height: 'auto' }}>\n        <EmptyState variant={EmptyStateVariant.large}>\n            <Title headingLevel=\"h5\" size=\"lg\">\n                <FormattedMessage {...messages.emptyStateNoMatchingCves} />\n            </Title>\n            <TextContent>\n                <EmptyStateBody style={{ whiteSpace: 'normal' }}>\n                    <FormattedMessage {...messages.emptyStateMaybeFollowing} />\n                    <Text>\n                        <FormattedMessage {...messages.emptyStateNoCveReported} />\n                    </Text>\n                    <Text component={TextVariants.p}>\n                        <FormattedMessage {...messages.emptyStateForMoreInfo} />\n                        <a href=\"https://access.redhat.com/security/team/contact/\" target=\"__blank\" rel=\"noopener noreferrer\">\n                            <FormattedMessage {...messages.emptyStateForMoreLink} />  <ExternalLinkAltIcon />\n                        </a>\n                    </Text>\n                </EmptyStateBody>\n            </TextContent>\n        </EmptyState>\n    </Bullseye>\n);\n\nexport const FilterNotFoundForSystem = (\n    <Bullseye style={{ height: 'auto' }}>\n        <EmptyState variant={EmptyStateVariant.large}>\n            <Title headingLevel=\"h5\" size=\"lg\">\n                <FormattedMessage {...messages.emptyStateNoMatchingCves} />\n            </Title>\n            <TextContent>\n                <EmptyStateBody style={{ whiteSpace: 'normal' }}>\n                    <FormattedMessage {...messages.emptyStateMaybeFollowing} />\n                    {<br></br>}\n                    <Text component={TextVariants.p}>\n                        <FormattedMessage {...messages.emptyStateNoSystemsMatching} />\n                    </Text>\n                    <Text component={TextVariants.p}>\n                        <FormattedMessage {...messages.emptyStateMaybeExcluded} />\n                    </Text>\n                    {<br></br>}\n                    <Text component={TextVariants.p}>\n                        <FormattedMessage {...messages.emptyStateIfCveForSystem} />\n                        <a href=\"https://access.redhat.com/security/team/contact/\" target=\"__blank\" rel=\"noopener noreferrer\">\n                            <FormattedMessage {...messages.emptyStateForMoreLink} />  <ExternalLinkAltIcon />\n                        </a>\n                    </Text>\n                </EmptyStateBody>\n            </TextContent>\n        </EmptyState>\n    </Bullseye>\n);\n\nexport const EmptyCVEListForSystem = (\n    <Bullseye style={{ height: 'auto' }}>\n        <EmptyState variant={EmptyStateVariant.large}>\n            <Title headingLevel=\"h5\" size=\"lg\">\n                <FormattedMessage {...messages.emptyStateNoReportedSystem} />\n            </Title>\n            <TextContent>\n                <EmptyStateBody style={{ whiteSpace: 'normal' }}>\n                    <Text>\n                        <FormattedMessage {...messages.emptyStateNoCveAffects} />\n                    </Text>\n                    <Text component={TextVariants.p}>\n                        <FormattedMessage {...messages.emptyStateIfCveForSystem}/>\n                        <a href=\"https://access.redhat.com/security/team/contact/\" target=\"__blank\" rel=\"noopener noreferrer\">\n                            <FormattedMessage {...messages.emptyStateForMoreLink} />  <ExternalLinkAltIcon />\n                        </a>.\n                    </Text>\n\n                </EmptyStateBody>\n            </TextContent>\n        </EmptyState>\n    </Bullseye>\n);\n\nexport const EmptyExcludedSystem = ({ buttonAction }) => (\n    <Bullseye>\n        <EmptyState variant={EmptyStateVariant.large}>\n            <EmptyStateIcon icon={SecurityIcon} size={'sm'} />\n            <Title headingLevel=\"h5\" size=\"lg\">\n                <FormattedMessage {...messages.emptyStateSystemExcludedTitle} />\n            </Title>\n            <EmptyStateBody>\n                <FormattedMessage {...messages.emptyStateSystemExcludedBody} />\n            </EmptyStateBody>\n            <Button variant=\"primary\" component=\"a\" onClick={buttonAction}>\n                <FormattedMessage {...messages.emptyStateSystemResumeAnalysis} />\n            </Button>\n        </EmptyState>\n    </Bullseye>\n);\n\nEmptyExcludedSystem.propTypes = {\n    buttonAction: propTypes.func\n};\n\nexport const EmptyCVEList = (\n    <Bullseye style={{ height: 'auto' }}>\n        <EmptyState variant={EmptyStateVariant.large}>\n            <Title headingLevel=\"h5\" size=\"lg\">\n                <FormattedMessage {...messages.emptyStateNoReportedSystem} />\n            </Title>\n            <TextContent>\n                <EmptyStateBody style={{ whiteSpace: 'normal' }}>\n                    <Text>\n                        <FormattedMessage {...messages.emptyStateNoCveAffects} />\n                    </Text>\n                    <FormattedMessage {...messages.emptyStateIfCveForSystems}/>\n                    <a href=\"https://access.redhat.com/security/team/contact/\" target=\"__blank\" rel=\"noopener noreferrer\">\n                        <FormattedMessage {...messages.emptyStateForMoreLink} /> <ExternalLinkAltIcon />\n                    </a>\n                    .\n                </EmptyStateBody>\n            </TextContent>\n        </EmptyState>\n    </Bullseye>\n);\n\n// Indicates that Insights is not activated\nexport const EmptyVulnerabilityData = (\n    <Bullseye>\n        <EmptyState>\n            <EmptyStateIcon icon={CubesIcon} />\n            <Title headingLevel=\"h5\" size=\"lg\">\n                <FormattedMessage {...messages.emptyStateNoData} />\n            </Title>\n            <EmptyStateBody>\n                <FormattedMessage {...messages.emptyStateActivateInsights} />\n            </EmptyStateBody>\n            <Button\n                variant=\"primary\"\n                component=\"a\"\n                href=\"http://access.redhat.com/products/cloud_management_services_for_rhel#getstarted\"\n            >\n                <FormattedMessage {...messages.emptyStateLearnInsights} />\n            </Button>\n        </EmptyState>\n    </Bullseye>\n);\n\n// Generic error\nexport const GenericError = (\n    <Card className=\"ins-empty-rule-cards\">\n        <CardHeader>\n            <FrownOpenIcon size=\"lg\" />\n        </CardHeader>\n        <CardBody>\n            <FormattedMessage {...messages.errorReload} />\n        </CardBody>\n    </Card>\n);\n","import union from 'lodash/union';\nimport messages from '../Messages';\nimport { intl } from '../Utilities/IntlProvider';\n\nconst selectAllCheckbox = ({ selectedItems, selectorHandler, items, fetchResource, multiRow = false }) => {\n\n    const selectedItemsArray = Array.from(selectedItems); // we might get array or set and there's no common method for size\n    const selectedItemsCount = selectedItemsArray && selectedItemsArray.length;\n    const { meta, data } = items;\n    const selectPageNumber = ((Array.isArray(data) && data.length) && multiRow) ? data.length / 2 : data.length;\n\n    const handleSelectPage = () => {\n        const { data } = items;\n        const collectedItems = union(data.filter(item => item.id).map(item => item.id), selectedItemsArray);\n        selectorHandler(true, collectedItems);\n    };\n\n    const handleUnselectAll = () => {\n        selectorHandler(false, []);\n    };\n\n    const handleSelectAll = () => {\n        // eslint-disable-next-line camelcase\n        let { payload } = fetchResource && fetchResource({ page_size: meta.total_items, page: 1 });\n        payload &&\n            payload.then(({ data: response }) => {\n                const items = response.map(item => item.id);\n                selectorHandler(true, items);\n            });\n    };\n\n    const handleOnCheckboxChange = () => {\n        if (selectedItemsCount === 0) {\n            handleSelectAll();\n        } else {\n            handleUnselectAll();\n        }\n    };\n\n    return ({\n        handleOnCheckboxChange,\n        items: [\n            {\n                title: intl.formatMessage(messages.selectNone),\n                onClick: handleUnselectAll\n            },\n            {\n                title: `${intl.formatMessage(messages.selectPage, { count: selectPageNumber })}`,\n                onClick: handleSelectPage\n            },\n            {\n                title: `${intl.formatMessage(messages.selectAll, { count: meta.total_items ? meta.total_items : 0 })}`,\n                onClick: handleSelectAll\n            }\n        ]\n    }\n\n    );\n};\n\nexport default selectAllCheckbox;\n","import { conditionalFilterType } from '@redhat-cloud-services/frontend-components';\nimport { intl } from '../../../../Utilities/IntlProvider';\nimport messages from '../../../../Messages';\n\nimport debounce from 'lodash/debounce';\nimport React from 'react';\n\nconst SearchFilter = (placeholder, search, apply) => {\n    const [searchValue, setSearchValue] = React.useState();\n    const [handleSearch] = React.useState(() =>\n        debounce(filter =>  {if (filter !== undefined) { apply({ filter, page: 1 }); }}, 400)\n    );\n\n    React.useEffect(() => setSearchValue(search), [search]);\n\n    return {\n        type: conditionalFilterType.text,\n        label: intl.formatMessage(messages.cve),\n        filterValues: {\n            onChange: (event, value) => {\n                setSearchValue(value);\n                handleSearch(value);\n            },\n            placeholder,\n            value: searchValue\n        }\n    };\n};\n\nexport default SearchFilter;\n","/* eslint-disable camelcase */\nimport React from 'react';\nimport messages from '../Messages';\nimport { FILTERS } from './constants';\nimport { Button } from '@patternfly/react-core';\nimport { intl } from '../Utilities/IntlProvider';\n\nexport const handleChangePage = (_event, page, apply) => apply({ page });\n\nexport const handleSetPageSize = (_event, perPage, apply) => apply({ page_size: perPage, page: 1 });\n\nexport const exportConfig = (methods) => (\n    { label: intl.formatMessage(messages.kebabExportAsJson) },\n    { label: intl.formatMessage(messages.kebabExportAsCsv) },\n    { onSelect: (_event, fileType) =>   methods.downloadReport(fileType) }\n);\n\nexport const  kebabAction = (label, callback, isDisabled =  false) =>{\n    const color = { color: (isDisabled ? '' : 'black') };\n    return (\n        <Button variant=\"link\" isInline key= {label} isDisabled={isDisabled}  style={color} onClick={callback}>\n            {label}\n        </Button>\n    );\n};\n\nexport const buildActiveFilters = (currentFilters) =>{\n    const { filter } = currentFilters;\n    const filterChips = Object.keys(FILTERS).reduce((array, key) => {\n\n        if (key !== 'show_all' && Object.keys(currentFilters).includes(key) && !['', undefined].includes(currentFilters[key])) {\n            const paramValues = currentFilters[key].split(',');\n            const filteredValues = paramValues.reduce((values, filter) =>{\n                values.push(FILTERS[key].items.reduce((object, item) => {\n\n                    if (filter === item.value) {\n                        object.name = item.label;\n                        object.value = item.value ;\n                    }\n                    else if (key === 'security_rule')\n                    {\n                        object.name = filter;\n                        object.value = filter;\n                    }\n\n                    return object;\n                }, {}));\n                return values;\n            }, []);\n\n            array.push({ key, paramValues, category: FILTERS[key].title, chips: filteredValues });\n        }\n\n        return array;\n    }, []);\n\n    filter && filterChips.push({ key: 'filter', category: intl.formatMessage(messages.searchLabel), chips: [{ name: filter }] });\n\n    return filterChips;\n};\n\nexport const removeFilters = (chips, apply) =>{\n    const emptyFilter = chips.reduce((obj, item) =>{\n        if (item.key === 'filter' || (item.paramValues && item.paramValues.length === 1)) {\n            obj[item.key] = '';\n        }\n        else {\n            obj[item.key] = item.paramValues.filter(value => !item.chips.some(chip => chip.value === value)).join(',');\n        }\n\n        return obj;\n    }, {});\n\n    apply(emptyFilter);\n};\n","/* eslint-disable camelcase */\n\nimport { Pagination, PaginationVariant } from '@patternfly/react-core';\nimport propTypes from 'prop-types';\nimport React, { Component } from 'react';\nimport { DEFAULT_PAGE_SIZE } from '../../../Helpers/constants';\n\nclass PaginationWrapper extends Component {\n    static propTypes = {\n        apply: propTypes.func,\n        meta: propTypes.object,\n        variant: propTypes.string\n    };\n\n    static defaultProps = {\n        variant: 'top'\n    };\n    shouldComponentUpdate(nextProps) {\n        if (nextProps.meta === this.props.meta) {\n            return false;\n        }\n\n        return true;\n    }\n    handleChangePage = (_event, pageNumber) => this.props.apply({ page: pageNumber });\n\n    handleSetPageSize = (_event, perPage) => this.props.apply({ page_size: perPage, page: 1 });\n\n    render() {\n        const { meta, variant } = this.props;\n        const { page, total_items, page_size } = meta;\n        return (\n            <React.Fragment>\n                <Pagination\n                    page={page || 1}\n                    itemCount={total_items || 0}\n                    perPage={page_size || DEFAULT_PAGE_SIZE}\n                    onSetPage={this.handleChangePage}\n                    onPerPageSelect={this.handleSetPageSize}\n                    variant={PaginationVariant[variant]}\n                />\n            </React.Fragment>\n        );\n    }\n}\n\nexport default PaginationWrapper;\n","import { Form, FormGroup, Radio, Stack, StackItem, TextArea } from '@patternfly/react-core';\nimport propTypes from 'prop-types';\nimport React, { useEffect, useState, useCallback } from 'react';\nimport { setBusinessRisk } from '../../../Helpers/APIHelper';\nimport { businessRiskOptions } from '../../../Helpers/constants';\nimport BaseModal from './BaseModal';\nimport { injectIntl } from 'react-intl';\nimport messages from '../../../Messages';\n\nexport const BusinessRiskModal = ({ cves, updateRef, intl }) => {\n    const [cveList] = useState(cves);\n    const [businessRiskId, setBusinessRiskId] = useState('0');\n    const [label, setLabel] = useState();\n\n    const getDefaultLabel = useCallback(() => {\n        setLabel((cveList && cveList.length === 1 && cveList[0].justification) || '');\n    }, [cveList]);\n\n    useEffect(() => {\n        const getDefaultBusinessRisk = () => {\n            setBusinessRiskId((cveList && cveList.length === 1 && cveList[0].business_risk_id.toString()) || '0');\n        };\n\n        getDefaultBusinessRisk();\n        getDefaultLabel();\n    }, [cves, getDefaultLabel, cveList]);\n\n    useEffect(getDefaultLabel, [cves]);\n\n    const handleOnRadioChange = (_, event) => {\n        const { value } = event.currentTarget;\n        setBusinessRiskId(value);\n    };\n\n    const handleOnLabelChange = value => {\n        setLabel(value);\n    };\n\n    const handleSave = () => {\n        return setBusinessRisk({\n            business_risk_id: parseInt(businessRiskId),\n            cve: cveList.map(item => item.id),\n            business_risk_text: label\n        }).then(updateRef);\n    };\n\n    const successNotification = {\n        variant: 'success',\n        title: intl.formatMessage(messages.businessRiskUpdateSuccessful, { count: cveList.length || 0 })\n    };\n\n    return (\n        <BaseModal\n            items={cveList}\n            onSave={handleSave}\n            onSuccessNotification={successNotification}\n            title={intl.formatMessage(messages.businessRiskModalTitle)}\n        >\n            <Stack gutter={'md'}>\n                <StackItem>\n                    {intl.formatMessage(messages.businessRiskModalInfo)}\n                </StackItem>\n                <StackItem>\n                    <Form>\n                        <FormGroup label={intl.formatMessage(messages.businessRiskLabel)} fieldId={'businessRiskId'}>\n                            {businessRiskOptions.map(item => (\n                                <Radio\n                                    className={'business-risk-radio'}\n                                    value={item.value}\n                                    isChecked={businessRiskId === item.value}\n                                    onChange={handleOnRadioChange}\n                                    label={item.label}\n                                    key={item.value}\n                                    id={item.value}\n                                    name={item.label}\n                                    aria-label={item.label}\n                                />\n                            ))}\n                        </FormGroup>\n                        <FormGroup label={intl.formatMessage(messages.justificationLabel)} fieldId={'label'}>\n                            <TextArea\n                                type=\"text\"\n                                onChange={handleOnLabelChange}\n                                value={label}\n                                resizeOrientation='vertical'\n                                aria-label={'justification'}\n                            />\n                        </FormGroup>\n                    </Form>\n                </StackItem>\n            </Stack>\n        </BaseModal>\n    );\n};\n\nBusinessRiskModal.propTypes = {\n    cves: propTypes.array,\n    updateRef: propTypes.func,\n    intl: propTypes.any\n};\n\nexport default injectIntl(BusinessRiskModal);\n","import { Checkbox, Form, FormGroup, Split, SplitItem, Stack, StackItem, Tooltip } from '@patternfly/react-core';\nimport { InfoCircleIcon, OutlinedQuestionCircleIcon } from '@patternfly/react-icons';\nimport propTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { setCveStatus, setSystemCveStatus } from '../../../Helpers/APIHelper';\nimport BaseModal, { useJustificationInput, useStatusSelect } from './BaseModal';\nimport { injectIntl } from 'react-intl';\nimport messages from '../../../Messages';\n\nexport const CveStatusModal = ({ cves, updateRef, intl }) => {\n    const [cveList] = useState(cves);\n    const { StatusSelect, statusId } = useStatusSelect(getDefaultStatus());\n    const { JustificationInput, justification } = useJustificationInput(getDefaultLabel());\n    const [checkboxState, setCheckboxState] = useState(false);\n\n    const handleSave = () => {\n        const cveIds = cveList.map(item => item.id);\n        return setCveStatus({\n            status_id: parseInt(statusId),\n            cve: cveIds,\n            status_text: justification\n        })\n        .then(() => !checkboxState && setSystemCveStatus({ cve: cveIds }))\n        .then(updateRef);\n    };\n\n    function getDefaultStatus() {\n        return (cveList && cveList.length === 1 && cveList[0].status_id.toString()) || '0';\n    }\n\n    function getDefaultLabel() {\n        return (cveList && cveList.length === 1 && cveList[0].justification) || '';\n    }\n\n    const successNotification = {\n        variant: 'success',\n        title: intl.formatMessage(messages.cveStatusModalUpdateSuccessful, { count: cveList.length || 0 })\n    };\n    const title = intl.formatMessage(messages.cveStatusModalTitle, { count: cveList.length || 0 });\n\n    return (\n        <BaseModal items={cveList} onSave={handleSave} onSuccessNotification={successNotification} title={title}>\n            <Stack gutter={'md'}>\n                <StackItem>\n                    {intl.formatMessage(\n                        messages.cveStatusModalSelected,\n                        {\n                            count: cveList.length || 0,\n                            cveId: cveList[0].id, // only used when length is 1\n                            b: (...chunks) => <b>{chunks}</b> // explicitly specifying what is wrapped <b> should be bold\n                        }\n                    )}\n                </StackItem>\n                <StackItem>\n                    <InfoCircleIcon\n                        className=\"pf-u-mr-xs\"\n                        fontSize=\"var(--pf-global--FontSize--md)\"\n                        color=\"var(--pf-global--active-color--300)\"\n                    />\n                    {intl.formatMessage(messages.cveStatusModalInfo, { count: cveList.length || 0 })}\n                    <Tooltip\n                        content={intl.formatMessage(messages.cveStatusModalInfoTooltip)}\n                    >\n                        <React.Fragment>\n                            <OutlinedQuestionCircleIcon\n                                className=\"pf-u-ml-xs\"\n                                color=\"var(--pf-global--Color--200)\"\n                                style={{ verticalAlign: '-0.125em' }}\n                            />\n                        </React.Fragment>\n                    </Tooltip>\n                </StackItem>\n                <StackItem>\n                    <Form key=\"key\">\n                        {StatusSelect}\n                        {JustificationInput}\n                        <FormGroup fieldId={'overwrite'}>\n                            <Split>\n                                <SplitItem>\n                                    <Checkbox\n                                        label={intl.formatMessage(messages.cveStatusModalOverwriteCheckbox)}\n                                        id=\"alt-form-checkbox-1\"\n                                        name=\"alt-form-checkbox-1\"\n                                        isChecked={checkboxState}\n                                        onChange={checked => setCheckboxState(checked)}\n                                    />\n                                </SplitItem>\n                                <SplitItem>\n                                    <Tooltip\n                                        content={intl.formatMessage(messages.cveStatusModalOverwriteTooltip)}\n                                    >\n                                        <OutlinedQuestionCircleIcon\n                                            className=\"pf-u-ml-xs\"\n                                            color=\"var(--pf-global--Color--200)\"\n                                            style={{ verticalAlign: '0' }}\n                                        />\n                                    </Tooltip>\n                                </SplitItem>\n                            </Split>\n                        </FormGroup>\n                    </Form>\n                </StackItem>\n            </Stack>\n        </BaseModal>\n    );\n};\n\nCveStatusModal.propTypes = {\n    cves: propTypes.array,\n    updateRef: propTypes.func,\n    intl: propTypes.any\n};\n\nexport default injectIntl(CveStatusModal);\n","\nvar content = require(\"!!../../../../node_modules/css-loader/index.js!../../../../node_modules/sass-loader/lib/loader.js??ref--5-2!./vulnerabilities.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js!../../../../node_modules/sass-loader/lib/loader.js??ref--5-2!./vulnerabilities.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js!../../../../node_modules/sass-loader/lib/loader.js??ref--5-2!./vulnerabilities.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".ins-active-app-vulnerabilities .cvetable-toolbar,\\n.page__Vulnerabilities .cvetable-toolbar {\\n  justify-content: space-between; }\\n  .ins-active-app-vulnerabilities .cvetable-toolbar > div,\\n  .page__Vulnerabilities .cvetable-toolbar > div {\\n    align-self: flex-end; }\\n\\n.ins-active-app-vulnerabilities .space-between-toolbar-items,\\n.page__Vulnerabilities .space-between-toolbar-items {\\n  justify-content: space-between;\\n  flex-wrap: nowrap; }\\n  .ins-active-app-vulnerabilities .space-between-toolbar-items > div,\\n  .page__Vulnerabilities .space-between-toolbar-items > div {\\n    flex-wrap: nowrap; }\\n\\n.ins-active-app-vulnerabilities .vulnerability-toolbar-spacing,\\n.page__Vulnerabilities .vulnerability-toolbar-spacing {\\n  justify-content: flex-start; }\\n  .ins-active-app-vulnerabilities .vulnerability-toolbar-spacing > div:not(:last-child),\\n  .page__Vulnerabilities .vulnerability-toolbar-spacing > div:not(:last-child) {\\n    margin-right: var(--pf-global--spacer--sm); }\\n\\n@media screen and (max-width: 1100px) {\\n  .ins-active-app-vulnerabilities .pf-c-pagination:not(.pf-m-footer) .pf-c-options-menu,\\n  .ins-active-app-vulnerabilities .pf-c-pagination:not(.pf-m-footer) .pf-c-pagination__nav,\\n  .page__Vulnerabilities .pf-c-pagination:not(.pf-m-footer) .pf-c-options-menu,\\n  .page__Vulnerabilities .pf-c-pagination:not(.pf-m-footer) .pf-c-pagination__nav {\\n    display: none;\\n    visibility: hidden; }\\n  .ins-active-app-vulnerabilities .pf-c-pagination__total-items,\\n  .page__Vulnerabilities .pf-c-pagination__total-items {\\n    display: flex;\\n    visibility: visible; } }\\n\\n.ins-active-app-vulnerabilities .pf-c-pagination.pf-m-footer.ins-c-pagination-next,\\n.page__Vulnerabilities .pf-c-pagination.pf-m-footer.ins-c-pagination-next {\\n  margin-left: auto; }\\n\\n.ins-active-app-vulnerabilities #download-report,\\n.page__Vulnerabilities #download-report {\\n  cursor: pointer; }\\n\\n.ins-active-app-vulnerabilities .number-of-results,\\n.page__Vulnerabilities .number-of-results {\\n  display: inline-block;\\n  min-width: 55px;\\n  text-align: right;\\n  margin-right: 5px; }\\n\\n.ins-active-app-vulnerabilities .table-header-icon,\\n.page__Vulnerabilities .table-header-icon {\\n  margin-right: 5px;\\n  margin-right: 0.3125rem; }\\n\\n.ins-active-app-vulnerabilities .status-dropdown-column > svg,\\n.page__Vulnerabilities .status-dropdown-column > svg {\\n  color: var(--pf-global--primary-color--100); }\\n\\n.ins-active-app-vulnerabilities .status-dropdown-column:hover,\\n.page__Vulnerabilities .status-dropdown-column:hover {\\n  cursor: pointer; }\\n  .ins-active-app-vulnerabilities .status-dropdown-column:hover > svg,\\n  .page__Vulnerabilities .status-dropdown-column:hover > svg {\\n    visibility: visible; }\\n\\n.ins-active-app-vulnerabilities .status-dropdown-column > svg,\\n.page__Vulnerabilities .status-dropdown-column > svg {\\n  visibility: hidden; }\\n\\n.ins-active-app-vulnerabilities tbody > tr > td.pf-c-table__check,\\n.page__Vulnerabilities tbody > tr > td.pf-c-table__check {\\n  vertical-align: middle;\\n  padding-top: 0px !important;\\n  padding-bottom: 0px !important; }\\n\\n.ins-active-app-vulnerabilities thead > tr > td.pf-c-table__check,\\n.page__Vulnerabilities thead > tr > td.pf-c-table__check {\\n  visibility: hidden; }\\n\\n.ins-active-app-vulnerabilities p.pf-c-empty-state__body ul,\\n.page__Vulnerabilities p.pf-c-empty-state__body ul {\\n  margin-top: 0px;\\n  margin-bottom: var(--pf-global--spacer--sm); }\\n  .ins-active-app-vulnerabilities p.pf-c-empty-state__body ul li,\\n  .page__Vulnerabilities p.pf-c-empty-state__body ul li {\\n    margin-top: 0px; }\\n\\n@media (max-width: 1500px) and (min-width: 992px) {\\n  .ins-active-app-vulnerabilities .hide-description,\\n  .page__Vulnerabilities .hide-description {\\n    --pf-hidden-visible--Display: var(\\n                --pf-hidden-visible--hidden--Display\\n            );\\n    --pf-hidden-visible--Visibility: var(\\n                --pf-hidden-visible--hidden--Visibility\\n            ); } }\\n\\n@media (min-width: 1400px) {\\n  .ins-active-app-vulnerabilities .remediation-btn-sml,\\n  .page__Vulnerabilities .remediation-btn-sml {\\n    display: none;\\n    visibility: hidden; } }\\n\\n@media (max-width: 1400px) {\\n  .ins-active-app-vulnerabilities .remediation-btn-lg,\\n  .page__Vulnerabilities .remediation-btn-lg {\\n    display: none;\\n    visibility: none; } }\\n\\n.ins-active-app-vulnerabilities .col-width-10,\\n.page__Vulnerabilities .col-width-10 {\\n  width: 10%; }\\n\\n.ins-active-app-vulnerabilities .col-width-15,\\n.page__Vulnerabilities .col-width-15 {\\n  width: 15%; }\\n\\n.ins-active-app-vulnerabilities .col-width-description,\\n.page__Vulnerabilities .col-width-description {\\n  width: 35%; }\\n\\n.ins-active-app-vulnerabilities .no-wrap,\\n.page__Vulnerabilities .no-wrap {\\n  white-space: nowrap; }\\n\\n.ins-active-app-vulnerabilities .pf-c-table__expandable-row-content,\\n.page__Vulnerabilities .pf-c-table__expandable-row-content {\\n  white-space: normal; }\\n\\n.ins-active-app-vulnerabilities tr.pf-m-expanded .pf-c-table__action,\\n.page__Vulnerabilities tr.pf-m-expanded .pf-c-table__action {\\n  display: none; }\\n\\n.ins-active-app-vulnerabilities .pf-c-table__check,\\n.page__Vulnerabilities .pf-c-table__check {\\n  vertical-align: unset !important; }\\n\", \"\"]);\n\n// exports\n","\nimport { conditionalFilterType } from '@redhat-cloud-services/frontend-components';\nimport { securityRulesOptions } from '../../../../Helpers/constants';\nimport { intl } from '../../../../Utilities/IntlProvider';\nimport messages from '../../../../Messages';\nimport unionWith from 'lodash/unionWith';\nimport isEqual from 'lodash/isEqual';\n\nconst securityRuleFilter = (apply, currentFilter = {}, dynamicFilters = []) => {\n    let { security_rule: currentValue } = currentFilter;\n    if (currentValue === '' || !currentValue) {\n        currentValue = '';\n    }\n\n    const filterBySecurityRule = values => {\n        apply({ security_rule: values === '0' ? '' : values  });\n    };\n\n    return {\n        label: intl.formatMessage(messages.securityRules),\n        type: conditionalFilterType.radio,\n        urlParam: 'security_rule',\n        filterValues: {\n            onChange: (event, value) => {\n                filterBySecurityRule(value);\n            },\n            items:\n                unionWith(securityRulesOptions, dynamicFilters, isEqual).map(item => ({ label: item.label, value: item.value })),\n            value: currentValue\n        }\n    };\n};\n\nexport default securityRuleFilter;\n","\nimport { conditionalFilterType } from '@redhat-cloud-services/frontend-components';\nimport { STATUS_OPTIONS } from '../../../../Helpers/constants';\nimport { intl } from '../../../../Utilities/IntlProvider';\nimport messages from '../../../../Messages';\n\nconst statusFilter = (apply, currentFilter = {}) => {\n\n    let { status_id: currentValue } = currentFilter;\n\n    const filterByStatus = values => {\n        apply({ status_id: (values.length > '0' && values.filter(value => value !== ',').join(',')) || '' });\n    };\n\n    return {\n        label: intl.formatMessage(messages.status),\n        type: conditionalFilterType.checkbox,\n        filterValues: {\n            onChange: (event, value) => {\n                filterByStatus(value);\n            },\n            items: STATUS_OPTIONS.map(item => ({ label: item.label, value: item.value })),\n            value: (currentValue ? currentValue.split(',') : [])\n        }\n    };\n};\n\nexport default statusFilter;\n","import React, { Component, Fragment } from 'react';\nimport propTypes from 'prop-types';\nimport { Table, TableBody, TableHeader } from '@patternfly/react-table';\nimport { SkeletonTable, TableToolbar } from '@redhat-cloud-services/frontend-components';\n\nimport { cveTableRowActions } from '../../../Helpers/CVEHelper';\nimport { createSortBy, handleSortColumn } from '../../../Helpers/MiscHelper';\nimport PaginationWrapper from '../../PresentationalComponents/PaginationWrapper/PaginationWrapper';\nimport {\n    FilterNotFoundForCVE,\n    EmptyCVEListForSystem,\n    EmptyCVEList\n} from '../../PresentationalComponents/EmptyStates/EmptyStates';\n\nimport { CVETableContext } from './VulnerabilitiesCves';\n\nclass VulnerabilitiesTableWithContext extends Component {\n    static propTypes = {\n        context: propTypes.any,\n        header: propTypes.array,\n        entity: propTypes.object\n    };\n\n    noCves = () => {\n        const { entity, context } = this.props;\n        const { cves } = context;\n        const filterFields = ['filter', 'cvss_from', 'cvss_to', 'public_from', 'public_to', 'impact', 'status_id'].filter(\n            item => Object.prototype.hasOwnProperty.call(cves.meta, item) && cves.meta[item]\n        );\n\n        let emptyComponent = filterFields.length !== 0\n            ? FilterNotFoundForCVE\n            : entity\n                ? EmptyCVEListForSystem\n                : cves.data.length === 0\n                    ? EmptyCVEList\n                    : undefined;\n\n        return ([{\n            heightAuto: true,\n            cells: [\n                {\n                    props: { colSpan: 8 },\n                    title: (\n                        emptyComponent\n                    )\n                }\n            ]\n        }]);\n    };\n\n    handleOnCollapse = (event, rowKey, isOpen) => {\n        const { rows } = this.state;\n        /**\n         * Please do not use rowKey as row index for more complex tables.\n         * Rather use some kind of identifier like ID passed with each row.\n         */\n        rows[rowKey].isOpen = isOpen;\n        this.setState({\n            rows\n        });\n    };\n\n    handleOnSelect = (event, isSelected, rowId) => {\n        const { context } = this.props;\n        const { cves, methods } = context;\n        const cveName = cves.data[rowId] && cves.data[rowId].id;\n        methods.selectCves(isSelected, cveName);\n    };\n\n    handleBusinessRiskToggle = () => {\n        this.setState(({ isBusinessRiskOpen }) => ({\n            isBusinessRiskOpen: !isBusinessRiskOpen\n        }));\n    };\n\n    render() {\n        const { context, header } = this.props;\n        const { cves, methods } = context;\n        return (\n            <Fragment>\n                {!cves.isLoading ? (\n                    <Fragment>\n                        <Table\n                            aria-label={'Vulnerability CVE table'}\n                            cells={header}\n                            rows={(cves.data.length === 0) ? this.noCves() : cves.data}\n                            onSelect={!(cves.data.length === 0) ? this.handleOnSelect : undefined}\n                            onCollapse={!(cves.data.length === 0) ? (event, rowKey) => methods.openCve(rowKey) : undefined}\n                            actions={!(cves.data.length === 0) ? cveTableRowActions(methods) : undefined}\n                            sortBy={!(cves.data.length === 0) ?\n                                createSortBy([{ key: 'collapse' }, { key: 'checkbox' }, ...header], cves.meta.sort) : undefined}\n                            onSort={!(cves.data.length === 0) ?\n                                (event, key, direction) =>\n                                    handleSortColumn(\n                                        key,\n                                        direction,\n                                        [{ key: 'collapse' }, { key: 'checkbox' }, ...header],\n                                        cves.meta.sort,\n                                        methods.apply\n                                    ) : undefined\n                            }\n                            gridBreakPoint={'grid-lg'}\n                        >\n                            <Fragment>\n                                <TableHeader />\n                                <TableBody />\n                            </Fragment>\n                        </Table>\n                        <TableToolbar>\n                            <PaginationWrapper variant=\"bottom\" meta={cves.meta} apply={methods.apply} />\n                        </TableToolbar>\n                    </Fragment>\n                ) : (\n                    <SkeletonTable colSize={6} rowSize={20} />\n                )}\n            </Fragment>\n        );\n    }\n}\n\nconst VulnerabilitiesTable = props => (\n    <CVETableContext.Consumer>\n        {context => <VulnerabilitiesTableWithContext context={context} {...props} />}\n    </CVETableContext.Consumer>\n);\n\nexport default VulnerabilitiesTable;\n","\nimport { conditionalFilterType } from '@redhat-cloud-services/frontend-components';\nimport { PublicDateOptions } from '../../../../Helpers/constants';\nimport { intl } from '../../../../Utilities/IntlProvider';\nimport messages from '../../../../Messages';\n\nconst publishDateFilter = (apply, currentFilter = {}) => {\n    let { publish_date: currentValue } = currentFilter;\n\n    // Empty string value is not supported by PF Radio at the moment\n    if (currentValue === '' || !currentValue) {\n        currentValue = '0';\n    }\n\n    const filterByPublishDate = value => {\n        apply({ publish_date: (value !== '0' && value) || '' });\n    };\n\n    return {\n        label: intl.formatMessage(messages.publishDate),\n        type: conditionalFilterType.radio,\n        urlParam: 'publish_date',\n        filterValues: {\n            onChange: (event, value) => {\n                filterByPublishDate(value);\n            },\n            items: PublicDateOptions.map(item => ({ label: item.label, value: item.value })),\n            value: currentValue\n        }\n    };\n};\n\nexport default publishDateFilter;\n","\nimport { conditionalFilterType } from '@redhat-cloud-services/frontend-components';\nimport { CVSSOptions } from '../../../../Helpers/constants';\nimport { intl } from '../../../../Utilities/IntlProvider';\nimport messages from '../../../../Messages';\n\nconst cvssBaseScoreFilter = (apply, currentFilter = {}) => {\n    let { cvss_filter: currentValue } = currentFilter;\n\n    // Empty string value is not supported by PF Radio at the moment\n    if (currentValue === '' || !currentValue) {\n        currentValue = '0';\n    }\n\n    const filterByCvssScore = value => {\n        apply({ cvss_filter: (value !== '0' && value) || '' });\n    };\n\n    return {\n        label: intl.formatMessage(messages.cvssBaseScore),\n        type: conditionalFilterType.radio,\n        urlParam: 'cvss_filter',\n        filterValues: {\n            onChange: (event, value) => {\n                filterByCvssScore(value);\n            },\n            items: CVSSOptions.map(item => ({ label: item.label, value: item.value })),\n            value: currentValue\n        }\n    };\n};\n\nexport default cvssBaseScoreFilter;\n","\nimport React from 'react';\nimport { conditionalFilterType } from '@redhat-cloud-services/frontend-components';\nimport { IMPACT_OPTIONS } from '../../../../Helpers/constants';\nimport { intl } from '../../../../Utilities/IntlProvider';\nimport messages from '../../../../Messages';\nimport { SecurityIcon } from '@patternfly/react-icons';\n\nconst impactFilter = (apply, currentFilter = {}) => {\n    let { impact: currentValue } = currentFilter;\n\n    const filterByImpact = values => {\n        apply({ impact: (values.length > '0' && values.filter(value => value !== ',').join(',')) || '' });\n    };\n\n    return {\n        label: intl.formatMessage(messages.impact),\n        type: conditionalFilterType.checkbox,\n        urlParam: 'impact',\n        filterValues: {\n            onChange: (event, value) => {\n                filterByImpact(value);\n            },\n            items: IMPACT_OPTIONS.map(item => ({\n                label: (\n                    <React.Fragment>\n                        { item.hasIcon && <SecurityIcon className=\"pf-u-mr-xs\" color={item.iconColor}/> }\n                        {item.label}\n                    </React.Fragment>\n                ),\n                value: item.value\n            })),\n            value: (currentValue ? currentValue.split(',') : [])\n        }\n    };\n};\n\nexport default impactFilter;\n","\nimport { conditionalFilterType } from '@redhat-cloud-services/frontend-components';\nimport { businessRiskOptions } from '../../../../Helpers/constants';\nimport { intl } from '../../../../Utilities/IntlProvider';\nimport messages from '../../../../Messages';\n\nconst businessRiskFilter = (apply, currentFilter = {}) => {\n    let { business_risk_id: currentValue } = currentFilter;\n\n    const filterByBusinessRisk = values => {\n        apply({ business_risk_id: (values.length > '0' && values.filter(value => value !== ',').join(',')) || '' });\n    };\n\n    return {\n        label: intl.formatMessage(messages.businessRisk),\n        type: conditionalFilterType.checkbox,\n        urlParam: 'business_risk_id',\n        filterValues: {\n            onChange: (event, value) => {\n                filterByBusinessRisk(value);\n            },\n            items: businessRiskOptions.map(item => ({ label: item.label, value: item.value })),\n            value: (currentValue ? currentValue.split(',') : [])\n        }\n    };\n};\n\nexport default businessRiskFilter;\n","import { conditionalFilterType } from '@redhat-cloud-services/frontend-components';\nimport { AFFECTING_SYSTEMS_OPTIONS } from '../../../../Helpers/constants';\nimport { intl } from '../../../../Utilities/IntlProvider';\nimport messages from '../../../../Messages';\n\nconst notAffectingCvesFilter = (apply, currentFilter = {}) => {\n    const { show_all: currentValue } = currentFilter;\n    const filterByNoAffect = value => {\n        if (value === '1') {\n            value = '';\n\n        } else {\n            value = 'true';\n        }\n\n        apply({ show_all: value });\n    };\n\n    return {\n        label: intl.formatMessage(messages.filterAffectingCVEs),\n        type: conditionalFilterType.radio,\n        urlParam: 'show_all',\n        filterValues: {\n            onChange: (event, value) => {\n                filterByNoAffect(value);\n            },\n            items: AFFECTING_SYSTEMS_OPTIONS.map(item => ({ label: item.label, value: item.value })),\n            value: currentValue\n        }\n    };\n\n};\n\nexport default  notAffectingCvesFilter;\n","/* eslint-disable camelcase */\n\nimport React from 'react';\nimport propTypes from 'prop-types';\nimport { injectIntl } from 'react-intl';\nimport messages from '../../../Messages';\nimport Remediation from '../Remediation/Remediation';\nimport { CVETableContext } from './VulnerabilitiesCves';\nimport selectAllCheckbox from '../../../Helpers/selectAllCheckboxHelper';\nimport { PrimaryToolbar } from '@redhat-cloud-services/frontend-components';\nimport publishDateFilter from '../../PresentationalComponents/Filters/PrimaryToolbarFilters/PublishDateFilter';\nimport cvssBaseScoreFilter from '../../PresentationalComponents/Filters/PrimaryToolbarFilters/CvssBaseScoreFilter';\nimport impactFilter from '../../PresentationalComponents/Filters/PrimaryToolbarFilters/ImpactFilter';\nimport searchFilter from '../../PresentationalComponents/Filters/PrimaryToolbarFilters/SearchFilter';\nimport securityRuleFilter from '../../PresentationalComponents/Filters/PrimaryToolbarFilters/SecurityRuleFilter';\nimport businessRiskFilter from '../../PresentationalComponents/Filters/PrimaryToolbarFilters/BusinessRiskFilter';\nimport statusFilter from '../../PresentationalComponents/Filters/PrimaryToolbarFilters/StatusFilter';\nimport notAffectingCvesFilter from '../../PresentationalComponents/Filters/PrimaryToolbarFilters/NotAffectingCVEsFilter';\nimport { handleChangePage, handleSetPageSize, kebabAction,\n    exportConfig, buildActiveFilters, removeFilters } from '../../../Helpers/TableToolbarHelper';\n\nconst  VulnerabilitiesToolbarWithContext = (props) => {\n\n    const handleCveDescription = () => {\n        const { context } = props;\n        const { cves, methods, params } = context;\n        const { expandCveDescription } = params;\n        const openedCves = !expandCveDescription ? cves.data.filter(cve => cve.id).map(cve => cve.id) : [];\n        methods.openCve(openedCves);\n    };\n\n    const { showRemediationButton, entity, context } = props;\n    const { cves, params, methods } = context;\n    const { selectedCves, expandCveDescription, filter } = params;\n    const selectedCvesCount = selectedCves && selectedCves.length;\n\n    const selectOptions  = selectAllCheckbox({\n        selectedItems: selectedCves,\n        selectorHandler: methods.selectCves,\n        items: cves,\n        fetchResource: ops => methods.fetchResource({ ...params, ...ops, show_all: !params.show_all }),\n        multiRow: true\n    });\n\n    const actions = [\n        showRemediationButton && <Remediation systemId={entity.id} selectedCves={selectedCves} /> || '',\n        kebabAction(\n            props.intl.formatMessage(messages.editBusinessRisk),\n            () => methods.showBusinessRiskModal(selectedCves.map(item => ({ id: item, business_risk_id: '0' }))),\n            !selectedCvesCount\n        ),\n        kebabAction(\n            props.intl.formatMessage(messages.editStatus),\n            () => methods.showStatusModal(selectedCves.map(item => ({ id: item, status_id: '0' }), [])),\n            !selectedCvesCount\n        ),\n        kebabAction(\n            expandCveDescription ? props.intl.formatMessage(messages.kebabCollapseCves)\n                : props.intl.formatMessage(messages.kebabExpandCves),\n            handleCveDescription,\n            cves.meta.total_items === 0\n        )\n\n    ];\n\n    return (\n        <React.Fragment>\n            <PrimaryToolbar\n                pagination={{\n                    itemCount: cves.meta.total_items || 0,\n                    page: cves.meta.page || 1,\n                    perPage: cves.meta.page_size || 1,\n                    onSetPage: (_event, page) => handleChangePage(_event, page, methods.apply),\n                    onPerPageSelect: (_event, perPage) => handleSetPageSize(_event, perPage, methods.apply)\n                }}\n                actionsConfig={{\n                    actions,\n                    isDisabled: !selectedCvesCount && cves.meta.total_items === 0,\n                    dropdownProps: { className: 'custom-class' }\n                } }\n                bulkSelect={{\n                    count: selectedCvesCount,\n                    items: selectOptions.items,\n                    isDisabled: cves.meta.total_items === 0,\n                    checked: Boolean(selectedCvesCount),\n                    onSelect: ()=> selectOptions.handleOnCheckboxChange()\n                }}\n                filterConfig={{\n                    items: [\n                        searchFilter(props.intl.formatMessage(messages.searchLabel), filter, methods.apply),\n                        notAffectingCvesFilter(methods.apply, params),\n                        securityRuleFilter(methods.apply, params),\n                        impactFilter(methods.apply, params),\n                        cvssBaseScoreFilter(methods.apply, params),\n                        businessRiskFilter(methods.apply, params),\n                        statusFilter(methods.apply, params),\n                        publishDateFilter(methods.apply, params)\n                    ]\n                }}\n                activeFiltersConfig={{\n                    filters: buildActiveFilters(params),\n                    onDelete: (e, i) => removeFilters(i, methods.apply)\n                }}\n                exportConfig = {exportConfig(methods)}\n            />\n\n        </React.Fragment>\n    );\n};\n\nVulnerabilitiesToolbarWithContext.propTypes = {\n    showRemediationButton: propTypes.bool,\n    entity: propTypes.object,\n    context: propTypes.object,\n    intl: propTypes.object\n};\n\nVulnerabilitiesToolbarWithContext.defaultProps = {\n    showRemediationButton: false,\n    totalNumber: 0,\n    apply: () => undefined,\n    downloadReport: () => undefined\n};\n\nconst VulnerabilitiesToolbar = props => (\n    <CVETableContext.Consumer>\n        {context => <VulnerabilitiesToolbarWithContext context={context} {...props} />}\n    </CVETableContext.Consumer>\n);\nexport default injectIntl(VulnerabilitiesToolbar);\n","/* eslint-disable camelcase */\nimport { Stack, StackItem } from '@patternfly/react-core';\nimport { classNames, expandable, sortable } from '@patternfly/react-table';\nimport propTypes from 'prop-types';\nimport qs from 'query-string';\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport { CVSSOptions, PublicDateOptions } from '../../../Helpers/constants';\nimport { GenericError } from '../../PresentationalComponents/EmptyStates/EmptyStates';\nimport { createCveListByAccount } from '../../../Helpers/VulnerabilitiesHelper';\nimport { changeCveListParameters, fetchCveListByAccount, selectCve, expandCve } from '../../../Store/Actions/Actions';\nimport BusinessRiskModal from '../Modals/BusinessRiskModal';\nimport StatusModal from '../Modals/CveStatusModal';\nimport './vulnerabilities.scss';\nimport SystemCveTable from './VulnerabilitiesTable';\nimport SystemCveTableToolbar from './VulnerabilitiesTableToolbar';\nimport { injectIntl } from 'react-intl';\nimport messages from '../../../Messages';\nimport DownloadReport from '../../../Helpers/DownloadReport';\n\nexport const CVETableContext = React.createContext({});\n\nclass VulnerabilitiesCves extends Component {\n    static propTypes = {\n        cveList: propTypes.any,\n        fetchData: propTypes.func,\n        history: propTypes.object,\n        location: propTypes.object,\n        parameters: propTypes.object,\n        changeParameters: propTypes.func,\n        selectCve: propTypes.func,\n        openCve: propTypes.func,\n        showReportLink: propTypes.func,\n        intl: propTypes.any\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            isBusinessRiskOpen: false,\n            isStatuskOpen: false,\n            BusinessRiskModal: () => null,\n            StatusModal: () => null,\n            expandCveDescription: false\n        };\n    }\n\n    componentDidMount() {\n        const { parameters } = this.props;\n        const queryObject = qs.parse(this.props.location.search);\n        queryObject.show_irrelevant = queryObject.show_irrelevant === 'true';\n        if (queryObject.show_irrelevant) {\n            queryObject.show_all = undefined;\n        }\n\n        this.apply({ ...parameters, ...queryObject });\n    }\n\n    processError = () => {\n        return GenericError;\n    };\n\n    apply = (config = {}) => {\n        if (Object.prototype.hasOwnProperty.call(config, 'cvss_filter')) {\n            let cvssEntry = CVSSOptions.find(item => item.value === config.cvss_filter);\n\n            if (typeof cvssEntry === 'undefined' &&\n                typeof config.cvss_filter !== 'undefined'\n            ) {\n                let values = config.cvss_filter.split(/[^0-9]+/).filter(item => parseFloat(item));\n                cvssEntry = { from: values[0], to: values[1] };\n            }\n            else if (typeof cvssEntry === 'undefined' &&\n                typeof config.cvss_filter === 'undefined') {\n                cvssEntry = { from: undefined, to: undefined };\n            }\n\n            config.cvss_from = cvssEntry.from;\n            config.cvss_to = cvssEntry.to;\n        }\n\n        if (Object.prototype.hasOwnProperty.call(config, 'publish_date')) {\n            let publicEntry = PublicDateOptions.find(item => item.value === config.publish_date);\n\n            if (typeof publicEntry !== 'undefined') {\n                config.public_from = publicEntry.from && publicEntry.from.format('YYYY-MM-DD');\n                config.public_to = publicEntry.to && publicEntry.to.format('YYYY-MM-DD');\n            } else {\n                config.public_from = undefined;\n                config.public_to = undefined;\n                config.publish_date = undefined;\n            }\n        }\n\n        this.props.changeParameters(config).then(this.sendRequest);\n    };\n\n    selectCves = (isSelected, cveNames) => {\n        this.props.selectCve(cveNames || []);\n    };\n\n    toggleCveDescription = (cveList) => {\n        const { parameters } = this.props;\n        const { expandCveDescription } = parameters;\n        const openedCves = expandCveDescription\n            ? cveList.data.filter(cve => cve.id).map(cve => cve.id)\n            : parameters.openedCves.length ? parameters.openedCves : [];\n\n        this.props.openCve(openedCves);\n    }\n\n    createUrlParams = allParams => {\n        const params = { ...allParams };\n        params.show_irrelevant = !params.show_all;\n        const allowedParams = [\n            'show_irrelevant',\n            'cvss_filter',\n            'publish_date',\n            'filter',\n            'limit',\n            'offset',\n            'page',\n            'page_size',\n            'sort',\n            'impact',\n            'business_risk_id',\n            'status_id',\n            'security_rule'\n        ];\n        Object.keys(allParams).forEach(\n            key =>\n                (params[key] === undefined || params[key] === '' || !allowedParams.includes(key) || params[key] === false) &&\n                delete params[key]\n        );\n        const queryString = qs.stringify(params);\n        this.props.history.push('?' + queryString);\n    };\n\n    sendRequest = () => {\n        const { fetchData, parameters, showReportLink } = this.props;\n        //TODO: need a better way of doing this\n        const showAllParam = Object.prototype.hasOwnProperty.call(parameters, 'show_all') && !parameters.show_all;\n        // eslint-disable-next-line camelcase\n        fetchData && fetchData({ ...parameters, show_all: showAllParam })\n        .then(response => {\n            const { value } = response;\n            if (parameters.expandCveDescription) {\n                this.toggleCveDescription(value);\n            }\n\n            showReportLink(true);\n        });\n\n        this.createUrlParams(parameters);\n    };\n\n    downloadReport = format => {\n        const { parameters } = this.props;\n        const params = { ...parameters, show_all: !parameters.show_all };\n\n        DownloadReport.exec(fetchCveListByAccount, params, format, 'cves');\n    };\n\n    showBusinessRiskModal = cves => {\n        this.setState({\n            BusinessRiskModal: () => <BusinessRiskModal cves={cves} updateRef={this.apply} />\n        });\n    };\n\n    showStatusModal = cves => {\n        this.setState({\n            StatusModal: () => <StatusModal cves={cves} updateRef={this.apply} />\n        });\n    };\n\n    render() {\n        const { cveList, parameters, openCve } = this.props;\n        const { apply, downloadReport, selectCves, showBusinessRiskModal, showStatusModal } = this;\n        const { BusinessRiskModal, StatusModal } = this.state;\n        const cves = cveList;\n        const { errors } = cves;\n        const header = [\n            {\n                title: this.props.intl.formatMessage(messages.cveId),\n                key: 'synopsis',\n                transforms: [sortable, classNames('col-width-10')],\n                columnTransforms: [classNames('no-wrap')],\n                cellFormatters: [expandable]\n            },\n            {\n                title: this.props.intl.formatMessage(messages.publishDate),\n                key: 'public_date',\n                transforms: [sortable, classNames('col-width-10')],\n                columnTransforms: [classNames('hide-description')]\n            },\n            {\n                title: this.props.intl.formatMessage(messages.impact),\n                key: 'impact',\n                transforms: [sortable, classNames('col-width-10')],\n                columnTransforms: [classNames('no-wrap')]\n            },\n            {\n                title: this.props.intl.formatMessage(messages.cvssBaseScore),\n                key: 'cvss_score',\n                transforms: [sortable, classNames('col-width-10')]\n            },\n            {\n                title: this.props.intl.formatMessage(messages.systemsExposed),\n                key: 'systems_affected',\n                transforms: [sortable, classNames('col-width-10')] },\n            {\n                title: this.props.intl.formatMessage(messages.businessRisk),\n                key: 'business_risk',\n                transforms: [sortable, classNames('col-width-10')]\n            },\n            {\n                title: this.props.intl.formatMessage(messages.status),\n                key: 'status',\n                transforms: [sortable, classNames('col-width-10')] }\n        ];\n\n        if (!errors) {\n            return (\n                <CVETableContext.Provider\n                    value={{\n                        cves,\n                        params: { ...this.state, ...parameters },\n                        methods: {\n                            apply,\n                            downloadReport,\n                            selectCves,\n                            showBusinessRiskModal,\n                            showStatusModal,\n                            fetchResource: fetchCveListByAccount,\n                            openCve\n                        }\n                    }}\n                >\n                    <BusinessRiskModal />\n                    <StatusModal />\n\n                    <Stack>\n                        <StackItem>\n                            <SystemCveTableToolbar showAllCheckbox />\n                        </StackItem>\n                        <StackItem>\n                            <SystemCveTable header={header} showAllCheckbox />\n                        </StackItem>\n                    </Stack>\n                </CVETableContext.Provider>\n            );\n        } else {\n            return this.processError(errors);\n        }\n    }\n}\n\nfunction mapStateToProps({ VulnerabilitiesStore }) {\n    return {\n        cveList: VulnerabilitiesStore && createCveListByAccount(VulnerabilitiesStore),\n        parameters: VulnerabilitiesStore && VulnerabilitiesStore.parameters\n    };\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        fetchData: params => dispatch(fetchCveListByAccount(params)),\n        selectCve: params => dispatch(selectCve(params)),\n        changeParameters: params => dispatch(changeCveListParameters(params)),\n        openCve: params => dispatch(expandCve(params))\n    };\n};\n\nexport default withRouter(\n    injectIntl(\n        connect(\n            mapStateToProps,\n            mapDispatchToProps\n        )(VulnerabilitiesCves)\n    )\n);\n","import { Main } from '@redhat-cloud-services/frontend-components';\nimport React, { useState } from 'react';\nimport VulnerabilityHeader from '../VulnerabilityHeader/VulnerabilityHeader';\nimport VulnerabilitiesCves from './VulnerabilitiesCves';\n\nconst CVEs = () => {\n    const [showReportLink, setShowReportLink] = useState(false);\n\n    return (\n        <React.Fragment>\n            <VulnerabilityHeader showReportLink={showReportLink} showBreadcrumb={false} />\n            <Main>\n                <VulnerabilitiesCves showReportLink={setShowReportLink}/>\n            </Main>\n        </React.Fragment>\n    );\n};\n\nexport default CVEs;\n"],"sourceRoot":""}