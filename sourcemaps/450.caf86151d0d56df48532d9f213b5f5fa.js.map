{"version":3,"file":"js/450.5be932a2da6370ee16d1.js","mappings":"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","sources":["webpack:///./src/Helpers/Hooks.js"],"sourcesContent":["import { useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useIntl } from 'react-intl';\nimport {\n    addNotification as addNotificationFEC,\n    clearNotifications as clearNotificationsFEC\n} from '@redhat-cloud-services/frontend-components-notifications/redux';\nimport { optOutSystemsAction } from '../../src/Store/Actions/Actions';\nimport messages from '../Messages';\nimport { ReadOnlyNotification } from './constants';\n\nexport const useNotification = (config) => {\n    const dispatch = useDispatch();\n\n    const globalConfig = {\n        variant: 'info',\n        ...config\n    };\n\n    useEffect(() => {\n        return () => {\n            if (!config.preventClear) {\n                dispatch(clearNotificationsFEC());\n            }\n        };\n    }, [dispatch]);\n\n    const addNotification = ({ msg, ...config }) =>\n        dispatch(\n            addNotificationFEC({\n                title: msg,\n                ...globalConfig,\n                ...config\n            })\n        );\n\n    const clearNotifications = () =>\n        dispatch(clearNotificationsFEC());\n\n    return [addNotification, clearNotifications];\n};\n\nexport const useGetEntities = (fetchApi, { id, setUrlParams, createRows }) => {\n\n    const getEntities = async (\n        _items,\n        { orderBy, orderDirection, page, per_page: perPage, vulnerabilityParams }\n    ) => {\n        const sort = `${orderDirection === 'ASC' ? '' : '-'}${orderBy}`;\n\n        const params = {\n            ...vulnerabilityParams,\n            page,\n            page_size: perPage,\n            sort\n        };\n\n        setUrlParams?.({ ...params });\n\n        const items = await fetchApi(\n            {\n                ...id && { id },\n                ...params\n            }\n        );\n\n        return {\n            results: typeof createRows === 'function'\n                ? createRows({ items, cveId: id })\n                : items?.data?.map(row => ({ id: row.id, ...row.attributes })),\n            total: items?.meta?.total_items,\n            page: items?.meta?.page,\n            perPage: items?.meta.page_size,\n            meta: {\n                page: items?.meta?.page,\n                sort: items?.meta?.sort,\n                page_size: items?.meta?.page_size\n            }\n        };\n    };\n\n    return getEntities;\n};\n\nexport const useOptOutSystems = onRefreshInventory => {\n    const [addSuccessNotification] = useNotification({ variant: 'success' });\n    const [addFailureNotification] = useNotification({ variant: 'danger', autoDismiss: false });\n    const dispatch = useDispatch();\n    const intl = useIntl();\n\n    /**\n     * Excludes/included provided system(s), if toggling one system systemId and systemName have to be set.\n     * If toggling multiple systems, these two params are ignored and system info will be extracted from selectedRows.\n     * @param {object} affectedRows - object with keys representing ids of systems to opt out/in\n     * @param {?string} systemName - display name of a system if only a single system is toggled\n     * @param {bool} isIncluded - if true systems will be excluded, else included\n     */\n    return (affectedRows, systemName, isIncluded) => {\n        const count = Object.keys(affectedRows).length;\n\n        dispatch(optOutSystemsAction(Object.keys(affectedRows), isIncluded))\n            .then(() => {\n                addSuccessNotification(isIncluded\n                    ? {\n                        msg: intl.formatMessage(messages.notificationExcludeSuccess, { count, systemName })\n                    }\n                    : {\n                        msg: intl.formatMessage(messages.notificationIncludeSuccessTitle, { count, systemName }),\n                        description: intl.formatMessage(messages.notificationIncludeSuccessBody)\n                    }\n                );\n            }).catch(error => {\n                addFailureNotification(error.status === '503'\n                    ? ReadOnlyNotification\n                    : isIncluded\n                        ? {\n                            msg: intl.formatMessage(messages.notificationExcludeFailureTitle, { count, systemName }),\n                            description: intl.formatMessage(messages.notificationExcludeFailureBody, { count })\n                        }\n                        : {\n                            msg: intl.formatMessage(messages.notificationIncludeFailureTitle, { count, systemName }),\n                            description: intl.formatMessage(messages.notificationIncludeFailureBody, { count })\n                        }\n                );\n            }).finally(onRefreshInventory);\n    };\n};\n\n// Temp solution to suppoint\nconst mapSelectedRows = ({ id, inventory_id: inventoryId }) => ({ id: id ? id : inventoryId, selected: true });\n\nexport const useBulkSelect = ({ rawData, selectedRows, selectedRowsCount, handleSelect, fetchResource, multiRow = false }) => {\n    const intl = useIntl();\n    const { meta, data } = rawData;\n\n    const selectPageNumber = data && (((Array.isArray(data) && data.length) && multiRow) ? data.length / 2 : data.length);\n\n    const handleSelectPage = () => {\n        const { data } = rawData ?? {};\n        handleSelect(data?.map(mapSelectedRows));\n    };\n\n    const handleUnselect = () => {\n        let toSelect = [];\n        Object.keys(selectedRows).forEach((id) => {\n            toSelect.push(\n                {\n                    id,\n                    selected: false\n                }\n            );\n\n            return toSelect;\n        });\n\n        handleSelect(toSelect);\n    };\n\n    const handleSelectAll = async () => {\n\n        let { payload } = await fetchResource({ page_size: meta.totalItems, page: 1 });\n\n        payload.then(({ data }) => handleSelect(data.map(mapSelectedRows)));\n    };\n\n    return {\n        count: selectedRowsCount,\n        checked: !!selectedRowsCount,\n        isDisabled: meta.totalItems === 0 && selectedRowsCount === 0,\n        ouiaId: 'bulk-select',\n        items: [\n            {\n                title: intl.formatMessage(messages.selectNone),\n                onClick: handleUnselect\n            },\n            {\n                title: `${intl.formatMessage(messages.selectPage, { count: selectPageNumber })}`,\n                onClick: handleSelectPage\n            },\n            {\n                title: `${intl.formatMessage(messages.selectAll, { count: meta.totalItems })}`,\n                onClick: handleSelectAll\n            }\n        ],\n        onSelect: () => !selectedRowsCount ? handleSelectAll() : handleUnselect()\n    };\n\n};\n"],"names":["useNotification","config","dispatch","useDispatch","globalConfig","variant","useEffect","preventClear","clearNotificationsFEC","msg","addNotificationFEC","title","useGetEntities","fetchApi","id","setUrlParams","createRows","getEntities","_items","orderBy","orderDirection","page","perPage","per_page","vulnerabilityParams","sort","params","page_size","items","results","cveId","data","map","row","attributes","total","meta","total_items","useOptOutSystems","onRefreshInventory","addSuccessNotification","autoDismiss","addFailureNotification","intl","useIntl","affectedRows","systemName","isIncluded","count","Object","keys","length","optOutSystemsAction","then","formatMessage","messages","description","error","status","ReadOnlyNotification","mapSelectedRows","inventoryId","inventory_id","selected","useBulkSelect","rawData","selectedRows","selectedRowsCount","handleSelect","fetchResource","multiRow","selectPageNumber","Array","isArray","handleUnselect","toSelect","forEach","push","handleSelectAll","totalItems","payload","checked","isDisabled","ouiaId","onClick","onSelect"],"sourceRoot":""}