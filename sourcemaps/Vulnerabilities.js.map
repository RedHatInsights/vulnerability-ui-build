{"version":3,"sources":["webpack:///./src/Components/SmartComponents/Vulnerabilities/Vulnerabilities.js","webpack:///./node_modules/@babel/runtime/helpers/objectSpread.js","webpack:///./src/Helpers/APIHelper.js","webpack:///./node_modules/@babel/runtime/helpers/defineProperty.js"],"names":["VulnerabilitiesCVEs","asyncComponent","Promise","all","__webpack_require__","e","then","bind","CVEPage","Systems","InventoryDetail","Upgrade","Vulnerabilities","props","_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default","this","_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default","_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default","call","_this$props","location","history","pathname","paths","upgrade","getSystems","res","meta","total_items","replace","path","react__WEBPACK_IMPORTED_MODULE_7___default","a","createElement","Fragment","react_router_dom__WEBPACK_IMPORTED_MODULE_8__","react_router_dom__WEBPACK_IMPORTED_MODULE_9__","exact","vulnerabilitiesCves","component","systems","inventoryDetail","cvePage","react_router_dom__WEBPACK_IMPORTED_MODULE_10__","from","cvepagePath","to","render","some","p","React","Component","propTypes","object","isRequired","withRouter","defineProperty","module","exports","target","i","arguments","length","source","ownKeys","Object","keys","getOwnPropertySymbols","concat","filter","sym","getOwnPropertyDescriptor","enumerable","forEach","key","BASE_ROUTE","apiVersion","createApiCall","endpoint","method","parameters","undefined","data","params","JSON","parse","stringify","map","encodeURIComponent","join","window","insights","chrome","auth","getUser","fetch","body","ok","json","catch","error","_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_0___default","title","errors","getCveDetails","synopsis","getAffectedSystemsByCVE","options","getCveListByAccount","apiProps","getCveListBySystem","system","obj","value","configurable","writable"],"mappings":"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","file":"js/Vulnerabilities.js","sourcesContent":["import some from 'lodash/some';\nimport propTypes from 'prop-types';\nimport React from 'react';\nimport { Redirect, Route, Switch, withRouter } from 'react-router-dom';\nimport { getSystems } from '../../../Helpers/APIHelper';\nimport asyncComponent from '../../../Utilities/asyncComponent';\nimport { paths } from '../../../Utilities/Routes';\n\nconst VulnerabilitiesCVEs = asyncComponent(() =>\n    import(/* webpackChunkName: \"VulnerabilitiesCVEs\" */ '../VulnerabilitiesCVEs/VulnerabilitiesCVEs')\n);\nconst CVEPage = asyncComponent(() => import(/* webpackChunkName: \"CVEPage\" */ '../CVEPage/CVEPage'));\n\nconst Systems = asyncComponent(() => import(/* webpackChunkName: \"Systems\" */ '../Systems/Systems'));\nconst InventoryDetail = asyncComponent(() =>\n    import(/* webpackChunkName: \"InventoryDetail\" */ '../InventoryDetail/InventoryDetail')\n);\nconst Upgrade = asyncComponent(() => import(/* webpackChunkName: \"Upgrade\" */ '../EmptyPage/EmptyPage'));\n\nclass Vulnerabilities extends React.Component {\n    constructor(props) {\n        super(props);\n    }\n\n    componentDidMount() {\n        const { location, history } = this.props;\n        if (location.pathname !== paths.upgrade) {\n            getSystems().then(res => {\n                res.meta && res.meta.total_items <= 0 && history.replace(paths.upgrade);\n            });\n        }\n    }\n\n    render() {\n        const { props } = this;\n\n        let path = props.location.pathname;\n        return (\n            <React.Fragment>\n                <Switch>\n                    <Route exact path={paths.vulnerabilitiesCves} component={VulnerabilitiesCVEs} />\n                    <Route exact path={paths.systems} component={Systems} />\n                    <Route path={paths.inventoryDetail} component={InventoryDetail} />\n                    <Route exact path={paths.cvePage} component={CVEPage} />\n                    <Route exact path={paths.upgrade} component={Upgrade} />\n\n                    <Redirect from={paths.cvepagePath} to={paths.inventoryDetail} />\n                    <Route render={() => (some(paths, p => p === path) ? null : <Redirect to={paths.vulnerabilitiesCves} />)} />\n                </Switch>\n            </React.Fragment>\n        );\n    }\n}\n\nVulnerabilities.propTypes = {\n    location: propTypes.object.isRequired,\n    history: propTypes.object\n};\n\nexport default withRouter(Vulnerabilities);\n","var defineProperty = require(\"./defineProperty\");\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nmodule.exports = _objectSpread;","let BASE_ROUTE = '/api/vulnerability/';\nlet apiVersion = 'v1';\n\nexport function createApiCall(endpoint, method, parameters = undefined, data = undefined) {\n    if (parameters && method === 'get') {\n        let params = Object.keys(JSON.parse(JSON.stringify(parameters)))\n        .map(key => [\n            encodeURIComponent(key)\n            .concat('=')\n            .concat(encodeURIComponent(parameters[key]))\n        ])\n        .join('&');\n        endpoint = endpoint.concat('?').concat(params);\n    }\n\n    let result = window.insights.chrome.auth\n    .getUser()\n    .then(() =>\n        fetch(BASE_ROUTE + apiVersion + endpoint, {\n            method,\n            body: JSON.stringify(data)\n        })\n    )\n    .then(res => {\n        if (!res.ok) {\n            throw res;\n        }\n\n        return res.json();\n    })\n    .catch(error => {\n        return error.json().then(error => {\n            throw { title: 'Vulnerability Error', ...error.errors[0] };\n        });\n    });\n    return result;\n}\n\nexport function getCveDetails(synopsis) {\n    let endpoint = '/cves/' + synopsis + '/details/';\n    let result = createApiCall(endpoint, 'get');\n    return result;\n}\n\nexport function getAffectedSystemsByCVE(synopsis, options) {\n    let endpoint = '/cves/' + synopsis + '/affected_systems/';\n    let result = createApiCall(endpoint, 'get', options);\n    return result;\n}\n\nexport function getSystems(parameters) {\n    let endpoint = '/systems/';\n    let result = createApiCall(endpoint, 'get', parameters);\n    return result;\n}\n\nexport function getChanges() {\n    let endpoint = '/vulnerabilities/changes/';\n    let result = createApiCall(endpoint, 'get');\n    return result;\n}\n\nexport function getCurrentImpacts() {\n    let endpoint = '/vulnerabilities/impacts/';\n    let result = createApiCall(endpoint, 'get');\n    return result;\n}\n\nexport function getCveListByAccount(apiProps) {\n    let endpoint = '/vulnerabilities/cves/';\n    let result = createApiCall(endpoint, 'get', apiProps);\n    return result;\n}\n\nexport function getCveListBySystem(apiProps) {\n    let endpoint = '/systems/' + apiProps.system + '/cves/';\n    delete apiProps.system;\n    let result = createApiCall(endpoint, 'get', apiProps);\n    return result;\n}\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;"],"sourceRoot":""}