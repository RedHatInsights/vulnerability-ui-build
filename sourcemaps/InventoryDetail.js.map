{"version":3,"sources":["webpack:///./src/Components/SmartComponents/SystemCves/SystemCveTable.js","webpack:///./src/Components/SmartComponents/SystemCves/SystemCveTableToolbar.js","webpack:///./src/Components/SmartComponents/SystemCves/SystemCves.js","webpack:///./src/Components/SmartComponents/SystemDetail/SystemDetail.js","webpack:///./src/Store/Reducers/SystemDetailStore.js","webpack:///./src/Components/SmartComponents/InventoryDetail/InventoryDetail.js","webpack:///./src/Components/SmartComponents/Modals/CvePairStatusModal.js"],"names":["SystemCvesTableWithContext","noCves","props","entity","cves","context","heightAuto","cells","colSpan","title","filter","item","Object","prototype","hasOwnProperty","call","meta","length","FilterNotFoundForSystem","EmptyCVEListForSystem","data","EmptyCVEList","undefined","handleOnSelect","event","isSelected","rowId","methods","cveName","id","selectCves","rowKey","isOpen","this","expandCveDescription","params","openCves","header","selectedCves","openedCves","rows","map","cve","has","selected","isLoading","colSize","rowSize","Table","aria-label","onSelect","actions","systemCveTableRowActions","sortBy","createSortBy","key","sort","onCollapse","handleOnCollapse","onSort","direction","handleSortColumn","apply","gridBreakPoint","PaginationWrapper","variant","Component","propTypes","any","array","object","SystemCvesTable","CVETableContext","Consumer","SystemCveToolbarWithContext","handleCveDescription","showRemediationButton","selectedCvesCount","size","filterCategories","filtersCVSSScore","filtersSeverity","filtersBusinessRisk","filtersPublishDate","filtersStatus","kebabOptions","kebabItemEditStatus","showStatusModal","status_id","cve_status_id","isDisabled","kebabItemToggleCvesDescription","kebabItemDownloadJSON","downloadReport","kebabItemDownloadCSV","Fragment","className","ToolbarGroup","SelectAllCheckbox","selectedItems","selectorHandler","items","fetchResource","ops","multiRow","SearchFilter","placeholder","value","Filters","filterValues","Remediation","systemId","BaseKebab","dropdownItems","disabled","ToolbarItem","FilterChips","filterCveSearchTerm","bool","defaultProps","totalNumber","SystemCveToolbar","React","createContext","transforms","sortable","classNames","columnTransforms","cellFormatters","expandable","SystemCves","processError","error","status","parseInt","NoVulnerabilityData","GenericError","dataReload","cveList","page","reloadPage","pages","setState","state","page_size","config","cvssEntry","CVSSOptions","find","cvss_filter","values","split","parseFloat","from","to","cvss_from","cvss_to","publicEntry","PublicDateOptions","publish_date","public_from","format","public_to","sendRequest","cveNames","updateStateSet","Set","isExpanded","Array","isArray","visibleCves","visibleOpenedCves","createUrlParams","allParams","allowedParams","keys","forEach","includes","queryString","qs","stringify","history","push","fetchData","system","then","cveIds","payload","fetchCveListBySystem","Number","MAX_SAFE_INTEGER","data_format","response","JSON","downloadFile","Date","toISOString","hasDifferentStatus","some","element","StatusModal","CvePairStatusModal","updateRef","inventories","queryObject","parse","location","search","errors","Provider","Stack","StackItem","SystemCveTableToolbar","SystemCveTable","func","withRouter","connect","SystemCvesStore","entityDetails","createCveListBySystem","dispatch","cvePromise","SystemDetail","isOptOut","optOutSystemHandler","setHeader","breadcrumbs","paths","vulnerabilities","systems","display_name","isActive","buttonAction","opt_out","initialState","loaded","systemDetailStore","INVENTORY_ACTION_TYPES","action","type","FETCH_SYSTEM_DETAILS","LOAD_ENTITY_FULFILLED","activeApps","name","component","LOAD_ENTITY_REJECTED","InventoryDetail","checkItem","newList","systemList","toggleLinkHover","linkHovered","optOutSystem","inventoryId","fetchSystemDetails","addNotification","description","match","removeListener","fetchInventory","insights","loadInventory","react","reactRouterDom","reactCore","reactIcons","pfReactTable","inventoryConnector","mergeWithEntities","mergeWithDetail","ReducerRegistry","register","InventoryHeader","InventoryDetailHead","InventoryBody","AppInfo","systemDetails","Page","VulnerabilityHeader","showTabs","hideBack","onClick","optOutSystemAction","notification","useState","inventoryList","useJustificationInput","justification","getCveJustification","getDefaultLabel","JustificationInput","setJustification","setJustificationProps","setProps","inventory","getDefaultCheckboxState","checkboxState","setCheckboxState","useStatusSelect","toString","getCvestatus","getDefaultStatus","StatusSelect","statusId","setStatusId","setSelectProps","inventoryIds","useEffect","modalTitle","onSave","setStatusParams","inventory_id","status_text","setSystemCveStatus","onSuccessNotification","gutter","isInline","fieldId","label","isChecked","onChange","checked"],"mappings":"2mCAUMA,G,+LAOFC,OAAS,WAAM,MACiB,EAAKC,MAAzBC,EADG,EACHA,OACAC,EAFG,EACKC,QACRD,KAOR,MAAQ,CAAC,CACLE,YAAY,EACZC,MAAO,CACH,CACIL,MAAO,CAAEM,QAAS,GAClBC,MARkC,IAHzB,CAAC,SAAU,YAAa,UAAW,cAAe,YAAa,SAAU,aAAaC,OACvG,SAAAC,GAAI,OAAIC,OAAOC,UAAUC,eAAeC,KAAKX,EAAKY,KAAML,IAASP,EAAKY,KAAKL,KAE5CM,OAC7BC,IAA0Bf,EAASgB,IAA8C,IAArBf,EAAKgB,KAAKH,OAAgBI,SAAeC,O,EAwB/GC,eAAiB,SAACC,EAAOC,EAAYC,GAAU,IACnCrB,EAAY,EAAKH,MAAjBG,QACAD,EAAkBC,EAAlBD,KAAMuB,EAAYtB,EAAZsB,QACRC,EAAUxB,EAAKgB,KAAKM,IAAUtB,EAAKgB,KAAKM,GAAOG,GACrDF,EAAQG,WAAWL,EAAYG,I,kEAZlBJ,EAAOO,EAAQC,GAAQ,IAC5B3B,EAAY4B,KAAK/B,MAAjBG,QACAD,EAA0BC,EAA1BD,KAAMuB,EAAoBtB,EAApBsB,QACNO,EAD0B7B,EAAX8B,OACfD,qBACFN,EAAUxB,EAAKgB,KAAKW,IAAW3B,EAAKgB,KAAKW,GAAQF,GACvDF,EAAQS,SAASJ,EAAQJ,EAASM,K,+BAU7B,aACuBD,KAAK/B,MAAzBG,EADH,EACGA,QAASgC,EADZ,EACYA,OACTF,EAA0B9B,EAA1B8B,OAAQ/B,EAAkBC,EAAlBD,KAAMuB,EAAYtB,EAAZsB,QACdW,EAA6BH,EAA7BG,aAAcC,EAAeJ,EAAfI,WAChBC,EAAOpC,EAAKgB,KACjBqB,IAAI,SAAAC,GAAG,OAAKJ,EAAaK,IAAID,EAAIb,KAArB,MAAiCa,EAAjC,CAAsCE,UAAU,KAAWF,IACvED,IAAI,SAAAC,GAAG,OAAKH,EAAWI,IAAID,EAAIb,KAAnB,MAA+Ba,EAA/B,CAAoCV,QAAQ,KAAWU,IAEpE,OACI,kBAAC,WAAD,KACMtC,EAAKyC,UAkCH,kBAAC,gBAAD,CAAeC,QAAS,EAAGC,QAAS,KAjCpC,kBAAC,WAAD,KACI,kBAACC,EAAA,EAAD,CACIC,aAAY,0BACZ1C,MAAO8B,EACPG,KAA8B,IAArBpC,EAAKgB,KAAKH,OAAiBgB,KAAKhC,SAAWuC,EACpDU,SAAkC,IAArB9C,EAAKgB,KAAKH,OAAgBgB,KAAKV,oBAAiBD,EAC7D6B,QAAiC,IAArB/C,EAAKgB,KAAKH,OAAgBmC,YAAyBzB,QAAWL,EAC1E+B,OAAgC,IAArBjD,EAAKgB,KAAKH,OACjBqC,YAAa,CAAC,CAAEC,IAAK,YAAc,CAAEA,IAAK,aAA9B,WAA+ClB,IAASjC,EAAKY,KAAKwC,WAAQlC,EAC1FmC,WAAmC,IAArBrD,EAAKgB,KAAKH,OACpB,SAACO,EAAOO,EAAQC,GAAhB,OAA2B,EAAK0B,iBAAiBlC,EAAOO,EAAQC,SAAUV,EAC9EqC,OAA+B,IAArBvD,EAAKgB,KAAKH,OAChB,SAACO,EAAO+B,EAAKK,GAAb,OACIC,YACIN,EACAK,EAFY,CAGX,CAAEL,IAAK,YAAc,CAAEA,IAAK,aAHjB,WAGkClB,IAC9CjC,EAAKY,KAAKwC,KACV7B,EAAQmC,aACRxC,EAEZyC,eAAgB,WAEhB,kBAAC,WAAD,KACI,kBAAC,IAAD,MACA,kBAAC,IAAD,QAGR,kBAAC,eAAD,KACI,kBAACC,GAAA,EAAD,CAAmBC,QAAQ,SAASjD,KAAMZ,EAAKY,KAAM8C,MAAOnC,EAAQmC,e,GArFvDI,aAAnClE,GACKmE,UAAY,CACf9D,QAAS8D,IAAUC,IACnB/B,OAAQ8B,IAAUE,MAClBlE,OAAQgE,IAAUG,QA4F1B,IAGeC,GAHS,SAAArE,GAAK,OACzB,kBAACsE,GAAgBC,SAAjB,KAA2B,SAAApE,GAAO,OAAI,kBAAC,GAAD,KAA4BA,QAASA,GAAaH,O,6oBC/EtFwE,G,+LAcFC,qBAAuB,WAAM,IACjBtE,EAAY,EAAKH,MAAjBG,QACAD,EAA0BC,EAA1BD,KAAMuB,EAAoBtB,EAApBsB,QACNO,EAD0B7B,EAAX8B,OACfD,qBACFF,GAAUE,EACVK,EAAcL,EAA4E,GAArD9B,EAAKgB,KAAKV,OAAO,SAAAgC,GAAG,OAAIA,EAAIb,KAAIY,IAAI,SAAAC,GAAG,OAAIA,EAAIb,KAC1FF,EAAQS,SAASJ,EAAQO,GAAaL,I,0DAGjC,MAC8CD,KAAK/B,MAAhD0E,EADH,EACGA,sBAAuBzE,EAD1B,EAC0BA,OAAQE,EADlC,EACkCA,QAC/BD,EAA0BC,EAA1BD,KAAM+B,EAAoB9B,EAApB8B,OAAQR,EAAYtB,EAAZsB,QACdW,EAA+CH,EAA/CG,aAAcJ,EAAiCC,EAAjCD,qBAAsBxB,EAAWyB,EAAXzB,OACtCmE,GACmC,IAArC5C,KAAK/B,MAAM0E,sBAAkCtC,GAAgBA,EAAawC,MAAS,OAAIxD,EACrFyD,EAAmB,CAACC,IAAkBC,IAAiBC,IAAqBC,IAAoBC,KAEhGC,EAAe,CACjBC,aACI3D,EAAQ4D,gBACR,IAAIjD,GAAcG,IAAI,SAAA9B,GAAI,WACtBkB,GAAIlB,GACDP,EAAKgB,KAAKV,OAAO,SAAAgC,GAAG,OAAI/B,IAAS+B,EAAIb,KACvCY,IAAI,SAAA9B,GAAI,MAAK,CAAE6E,UAAW7E,EAAK6E,UAAWC,cAAe9E,EAAK8E,iBAAkB,MAErF,GACA,CAAEC,YAAab,IAEnBc,aAA+B1D,KAAK0C,qBAAsBzC,GAC1D0D,aAAsBjE,EAAQkE,gBAC9BC,aAAqBnE,EAAQkE,iBAEjC,OACI,kBAAC,IAAME,SAAP,KACI,kBAAC,eAAD,CAAcC,UAAU,+BACpB,kBAACC,GAAA,EAAD,CAAcD,UAAU,iCACnBpB,GACG,kBAACsB,GAAA,EAAD,CACIC,cAAe7D,EACf8D,gBAAiBzE,EAAQG,WACzBuE,MAAOjG,EACPkG,cAAe,SAAAC,GAAG,OAAI5E,EAAQ2E,cAAR,MAA2BnE,EAA3B,GAAsCoE,KAC5DC,UAAQ,IAGhB,kBAACC,GAAA,EAAD,CACIC,YAAY,gBACZC,MAAOjG,EACPoD,MAAOnC,EAAQmC,QAGnB,kBAAC8C,GAAA,EAAD,CACIC,aAAc1E,EACd4C,iBAAkBA,EAClBjB,MAAOnC,EAAQmC,QAElBc,GAAyB,kBAACkC,GAAA,EAAD,CAAaC,SAAU5G,EAAO0B,GAAIS,aAAcA,IAC1E,kBAAC0E,GAAA,EAAD,CAAWC,cAAe5B,EAAc6B,SAA+B,IAArB9G,EAAKgB,KAAKH,UAGhE,kBAACgF,GAAA,EAAD,KACI,kBAACjC,GAAA,EAAD,CAAmBF,MAAOnC,EAAQmC,MAAO9C,KAAMZ,EAAKY,SAG5D,kBAAC,eAAD,CAAcgF,UAAU,aACpB,kBAACC,GAAA,EAAD,KACI,kBAACkB,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,CACIP,aAAc1E,EACd4C,iBAAgB,CAAGsC,KAAH,OAA2BtC,GAC3CjB,MAAOnC,EAAQmC,gB,GApFLI,aAApCQ,GACKP,UAAY,CACfS,sBAAuBT,IAAUmD,KACjCnH,OAAQgE,IAAUG,OAClBjE,QAAS8D,IAAUG,QAJrBI,GAOK6C,aAAe,CAClB3C,uBAAuB,EACvB4C,YAAa,EACb1D,MAAO,aACP+B,eAAgB,cAmFxB,IAGe4B,GAHU,SAAAvH,GAAK,OAC1B,kBAACsE,GAAgBC,SAAjB,KAA2B,SAAApE,GAAO,OAAI,kBAAC,GAAD,KAA6BA,QAASA,GAAaH,O,+iBCzGtF,IAAMsE,GAAkBkD,IAAMC,cAAc,IAE7CtF,GAAS,CACX,CACI5B,MAAO,SACP8C,IAAK,WACLqE,WAAY,CAACC,IAAUC,YAAW,iBAClCC,iBAAkB,CAACD,YAAW,YAC9BE,eAAgB,CAACC,MAErB,CACIxH,MAAO,eACP8C,IAAK,cACLqE,WAAY,CAACC,IAAUC,YAAW,kBAEtC,CACIrH,MAAO,kBACP8C,IAAK,aACLqE,WAAY,CAACC,IAAUC,YAAW,kBAEtC,CACIrH,MAAO,SACP8C,IAAK,SACLqE,WAAY,CAACC,IAAUC,YAAW,iBAClCC,iBAAkB,CAACD,YAAW,aAGlC,CAAErH,MAAO,gBAAiB8C,IAAK,gBAAiBqE,WAAY,CAACC,IAAUC,YAAW,kBAClF,CAAErH,MAAO,SAAU8C,IAAK,SAAUqE,WAAY,CAACC,IAAUC,YAAW,mBAGlEI,G,YASF,WAAYhI,GAAO,0BACf,4BAAMA,KAeViI,aAAe,SAAAC,GAAS,IACZC,EAAWD,EAAXC,OAER,OAAmB,MADAC,SAASD,IACF,EAAKnI,MAAMC,OAC1BoI,IAEAC,KAtBI,EA0BnBC,WAAa,WAAM,MACQ,EAAKvI,MAAMwI,QAA1B1H,EADO,EACPA,KAAMI,EADC,EACDA,KACNuH,EAAgB3H,EAAhB2H,KACFC,EAAaD,IADK3H,EAAV6H,OACuBzH,EAAKH,OAAS,GAAM,EAAI,EAAI0H,EAEjE,EAAKG,SAAL,MAEW,EAAKC,MAFhB,CAGQJ,KAAMC,EACNI,UAAWhI,EAAKgI,YAEpB,EAAKlF,QArCM,EAyCnBA,MAAQ,WAAiB,IAAhBmF,EAAgB,uDAAP,GAEd,GAAIrI,OAAOC,UAAUC,eAAeC,KAAKkI,EAAQ,eAAgB,CAC7D,IAAIC,EAAYC,IAAYC,KAAK,SAAAzI,GAAI,OAAIA,EAAKgG,QAAUsC,EAAOI,cAE/D,QAAyB,IAAdH,QAA2D,IAAvBD,EAAOI,YAA6B,CAC/E,IAAIC,EAASL,EAAOI,YAAYE,MAAM,WAAW7I,OAAO,SAAAC,GAAI,OAAI6I,WAAW7I,KAC3EuI,EAAY,CAAEO,KAAMH,EAAO,GAAII,GAAIJ,EAAO,cACd,IAAdJ,QAA2D,IAAvBD,EAAOI,cACzDH,EAAY,CAAEO,UAAMnI,EAAWoI,QAAIpI,IAGvC2H,EAAOU,UAAYT,EAAUO,KAC7BR,EAAOW,QAAUV,EAAUQ,GAG/B,GAAI9I,OAAOC,UAAUC,eAAeC,KAAKkI,EAAQ,gBAAiB,CAC9D,IAAIY,EAAcC,IAAkBV,KAAK,SAAAzI,GAAI,OAAIA,EAAKgG,QAAUsC,EAAOc,oBAE5C,IAAhBF,GACPZ,EAAOe,YAAcH,EAAYJ,MAAQI,EAAYJ,KAAKQ,OAAO,cACjEhB,EAAOiB,UAAYL,EAAYH,IAAMG,EAAYH,GAAGO,OAAO,gBAE3DhB,EAAOe,iBAAc1I,EACrB2H,EAAOiB,eAAY5I,EACnB2H,EAAOc,kBAAezI,GAI9B,EAAKwH,SAAL,MAAmB,EAAKC,MAAxB,GAAkCE,GAAU,EAAKkB,cAtElC,EAyEnBrI,WAAa,SAACL,EAAY2I,GAAa,IAC7B9H,EAAiB,EAAKyG,MAAtBzG,aAEFA,EADA8H,EACeC,YAAe/H,EAAc8H,EAAU3I,GAEvC,IAAI6I,IAGvB,EAAKxB,SAAL,MAAmB,EAAKC,MAAxB,CAA+BzG,aAAc,IAAIgI,IAAIhI,OAjFtC,EAqFnBF,SAAW,SAACJ,EAAQoI,EAAUG,GAAe,MACE,EAAKxB,MAA1CxG,EADmC,EACnCA,WAaN,GAdyC,EACvBL,uBAGWkI,EAASnJ,SAClCsB,EAAa6H,GAIb7H,EADA6H,EACaC,YAAe9H,EAAY6H,EAAUpI,GAErC,IAAIsI,KAGhBE,MAAMC,QAAQL,GAAW,CAC1B,IAAMM,EAAc,EAAKxK,MAAMwI,QAAQtH,KACjCuJ,EAAoBD,EAAYhK,OAAO,SAAAgC,GAAG,OAAIH,EAAWI,IAAID,EAAIb,MAEvE0I,EAAcG,EAAYzJ,OAAS,IAAM0J,EAAkB1J,OAG/D,EAAK6H,SAAL,MAAmB,EAAKC,MAAxB,CAA+BxG,WAAY,IAAI+H,IAAI/H,GAAaL,qBAAsBqI,MA1GvE,EA6GnBK,gBAAkB,SAAAC,GACd,IAAM1I,EAAS,MAAK0I,GACdC,EAAgB,CAClB,cACA,eACA,SACA,QACA,SACA,OACA,YACA,OACA,SACA,mBACA,aAEJlK,OAAOmK,KAAKF,GAAWG,QACnB,SAAAzH,GAAG,YACkBjC,IAAhBa,EAAOoB,IAAsC,KAAhBpB,EAAOoB,KAAgBuH,EAAcG,SAAS1H,KAAwB,IAAhBpB,EAAOoB,YACpFpB,EAAOoB,KAEtB,IAAM2H,EAAcC,IAAGC,UAAUjJ,GACjC,EAAKjC,MAAMmL,QAAQC,KAAK,IAAMJ,IAlIf,EAqInBf,YAAc,WAAM,MACc,EAAKjK,MAA3BqL,EADQ,EACRA,UAAWpL,EADH,EACGA,OACX+B,EAAyB,EAAK6G,MAA9B7G,qBACRqJ,GAAaA,EAAU,MAAK,EAAKxC,MAAX,CAAkByC,OAAQrL,EAAO0B,MACtD4J,KAAK,YAAc,IAAXrK,EAAW,EAAXA,KACL,GAAIc,EAAsB,CACtB,IAAMwJ,EAAStK,GAAQA,EAAKqB,IAAI,SAAAC,GAAG,OAAIA,EAAIb,KAC3C,EAAKO,UAAS,EAAMsJ,EAAQxJ,MAGpC,EAAK0I,gBAAgB,EAAK7B,QA/IX,EAkJnBlD,eAAiB,SAAAoE,GACb,IAAM9H,EAAS,MAAK,EAAK4G,OACjB5I,EAAW,EAAKD,MAAhBC,OACFwL,EAAYC,YAAqB,MAChCzJ,EAD+B,CAElC6G,UAAW6C,OAAOC,iBAClBC,YAAa9B,EACbtB,KAAM,EACN6C,OAAQrL,EAAO0B,MALb8J,QAQNA,GACIA,EAAQF,KAAK,YAAwB,IAAfO,EAAe,EAArB5K,KACNA,EAAkB,SAAX6I,EAAoBgC,KAAKb,UAAUY,GAAYA,EAC5D,OAAOE,uBAAa9K,EAAD,8BAA6B,IAAI+K,MAAOC,eAAiBnC,MAhKrE,EAoKnB1E,gBAAkB,SAAAnF,GAEd,IAAIiM,EACJ,GAAIjM,EAAKa,OAAS,EAAG,CACjB,IAAMqB,EAAekI,MAAMf,KAAK,EAAKvJ,MAAMwI,QAAQtH,KAAKV,OAAO,SAAAgC,GAAG,OAAItC,EAAKkM,KAAK,SAAAC,GAAO,OAAIA,EAAQ1K,KAAOa,EAAIb,QAE9GwK,EAAqB/J,EAAagK,KAAK,SAAAC,GACnC,QAAOjK,EAAa5B,OAAO,SAAAgC,GAAG,OAAIA,EAAI8C,YAAc+G,EAAQ/G,YAAWvE,OAAS,KAIxF,EAAK6H,SAAS,CACV0D,YAAa,kBACT,kBAACC,EAAA,EAAD,CACIrM,KAAMA,EACNsM,UAAW,EAAKjE,WAChBkE,YAAa,CAAC,CAAE9K,GAAI,EAAK3B,MAAMC,QAAU,EAAKD,MAAMC,OAAO0B,KAC3DwK,mBAAoBA,QAnLhC,EAAKtD,MAAQ,CACTzG,aAAc,IAAIgI,IAClB/H,WAAY,IAAI+H,IAChBkC,YAAa,kBAAM,MACnBtK,sBAAsB,GANX,E,iEAWf,IACM0K,EAAczB,IAAG0B,MAAM5K,KAAK/B,MAAM4M,SAASC,QACjD9K,KAAK6B,MAAL,MAFsB,CAAEN,KAAM,gBAE9B,GAAkCoJ,M,+BA8K7B,MACuB3K,KAAK/B,MAAzBwI,EADH,EACGA,QAASvI,EADZ,EACYA,OACT2D,EAAiE7B,KAAjE6B,MAAO+B,EAA0D5D,KAA1D4D,eAAgB/D,EAA0CG,KAA1CH,WAAYM,EAA8BH,KAA9BG,SAAUmD,EAAoBtD,KAApBsD,gBAC7CiH,EAAgBvK,KAAK8G,MAArByD,YACFpM,EAAOsI,EACLsE,EAAW5M,EAAX4M,OAER,OAAKA,EA6BM/K,KAAKkG,aAAa6E,GA3BrB,kBAACxI,GAAgByI,SAAjB,CACItG,MAAO,CACHvG,OACA+B,OAAQF,KAAK8G,MACbpH,QAAS,CACLmC,QACA+B,iBACA/D,aACAM,WACAmD,kBACAe,cAAe,SAAAnE,GAAM,OAAIyJ,YAAqB,MAAKzJ,EAAN,CAAcqJ,OAAQrL,EAAO0B,UAIlF,kBAAC2K,EAAD,MAEA,kBAACU,EAAA,EAAD,KACI,kBAACC,EAAA,EAAD,KACI,kBAACC,GAAD,CAAuBxI,uBAAqB,EAACzE,OAAQA,KAEzD,kBAACgN,EAAA,EAAD,KACI,kBAACE,GAAD,CAAgBhL,OAAQA,GAAQlC,OAAQA,W,GAlO3C+D,aAAnBgE,GACK/D,UAAY,CACfhE,OAAQgE,IAAUG,OAClBoE,QAASvE,IAAUC,IACnBmH,UAAWpH,IAAUmJ,KACrBjC,QAASlH,IAAUG,OACnBwI,SAAU3I,IAAUG,QA8O5B,IAUeiJ,eACXC,kBAlBJ,YAAyE,IAA9CC,EAA8C,EAA9CA,gBAAkCtN,EAAY,EAA7BuN,cAAiBvN,OACzD,MAAO,CACHuI,QAAS+E,GAAmBE,YAAsBxN,EAAO0B,GAAI4L,EAAgB/E,SAC7EvI,WAImB,SAAAyN,GACvB,MAAO,CACHrC,UAAW,SAAApJ,GACP,IAAM0L,EAAajC,YAAqBzJ,GAExC,OADAyL,EAASC,GACFA,EAAWlC,WAM1B6B,CAGEtF,KCzSA4F,G,YAQF,WAAY5N,GAAO,6CACTA,I,sDAGD,MAC6C+B,KAAK/B,MAA/CC,EADH,EACGA,OAAQ4N,EADX,EACWA,SAAUC,EADrB,EACqBA,oBAS1B,OARA/L,KAAK/B,MAAM+N,UAAU,CACjBC,YAAa,CACT,CAAEzN,MAAO0N,IAAMC,gBAAgB3N,MAAOiJ,GAAIyE,IAAMC,gBAAgB1E,IAChE,CAAEjJ,MAAO0N,IAAME,QAAQ5N,MAAOiJ,GAAIyE,IAAME,QAAQ3E,IAChD,CAAEjJ,MAAQN,GAAUA,EAAOmO,cAAiB,iBAAkBC,UAAU,MAI3EpO,EAIA4N,EAQG,kBAAC,IAAMhI,SAAP,KACI,kBAAC,IAAD,CAA2ByI,aAAc,kBAAMR,GAAoB,OAPvE,kBAAC,IAAMjI,SAAP,KACI,kBAAC,GAAD,CAAiB5F,OAAQA,EAAO0B,MANjC,kBAAC,gBAAD,U,GAvBQ6F,IAAMxD,WAA3B4J,GACK3J,UAAY,CACf8J,UAAW9J,IAAUmJ,KACrBnN,OAAQgE,IAAUG,OAClByJ,SAAU5J,IAAUmD,KACpB0G,oBAAqB7J,IAAUmJ,MAkDxBC,mBACXC,kBARJ,YAA2E,QAAhDE,cACvB,MAAO,CACHvN,OAFmE,EAA/BA,OAGpC4N,SAHmE,EAAvBU,UANzB,SAAAb,GACvB,MAAO,CACHK,UAAW,SAAA5L,GAAM,OAAIuL,EAASK,YAAU5L,OAY5CmL,CAGEM,K,yjBCjEN,IAAIY,GAAe,CACfC,QAAQ,GAICC,GAAoB,SAACC,EAAwBb,GAAzB,OAAiD,WAAkC,IAAjCjF,EAAiC,uDAAzB2F,GAAcI,EAAW,uCAChH,OAAQA,EAAOC,MACX,KAAKC,KAAuB,aACxB,aACOjG,EADP,GAEO+F,EAAOnD,QAAQvK,MAE1B,KAAKyN,EAAuBI,sBACxB,aACOlG,EADP,CAEI4F,QAAQ,EACRO,WAAY,CACR,CACIzO,MAAO,kBACP0O,KAAM,kBACNC,UAAW,kBAAM,kBAAC,GAAD,CAAcpB,oBAAqBA,SAIpE,KAAKa,EAAuBQ,qBACxB,aACOtG,EADP,CAEI4F,QAAQ,EACRO,WAAY,CACR,CACIzO,MAAO,kBACP0O,KAAM,kBACNC,UAAW,kBAAM,kBAAC,GAAD,WAIjC,QACI,OAAOrG,K,skBCzBbuG,G,YASF,WAAYpP,GAAO,0BACf,4BAAMA,KAmCVqP,UAAY,SAAChM,EAAKoD,GACd,IAAI6I,EAAU,EAAKzG,MAAM0G,WACzBD,EAAQjM,GAAKX,SAAW+D,EACxB,EAAKmC,SAAS,CAAE2G,WAAYD,KAvCb,EA0CnBE,gBAAkB,SAAA/I,GACd,EAAKmC,SAAL,MAAmB,EAAKC,MAAxB,CAA+B4G,YAAahJ,MA3C7B,EA8CnBiJ,aAAe,SAAAjJ,GACX,EAAKzG,MAAM0P,aAAa,EAAK7G,MAAM8G,YAAalJ,GAAO8E,KAAK,WACxD,EAAKvL,MAAM4P,mBAAmB,EAAK/G,MAAM8G,cAC/B,IAAVlJ,EACM,EAAKzG,MAAM6P,gBAAgB,CACzB9L,QAAS,UACTxD,MAAO,6DAET,EAAKP,MAAM6P,gBAAgB,CACzB9L,QAAS,UACTxD,MAAO,qDACPuP,YAAa,sDAtDzB,EAAKjH,MAAQ,CACT8G,YAAa,EAAK3P,MAAM+P,MAAM9N,OAAO0N,YACrCK,eAAgB,aAChBP,aAAa,GANF,E,uEAWf1N,KAAK/B,MAAM4P,mBAAmB7N,KAAK8G,MAAM8G,aACzC5N,KAAKkO,mB,uJAI4FC,SAASC,cAAc,CACpHC,MAAO5I,IACP6I,iBACAC,YACAC,aACAC,iB,gBALIC,E,EAAAA,mBAAoBC,E,EAAAA,kBAAmBC,E,EAAAA,gBAAiBhC,E,EAAAA,uBAQhEiC,KAAgBC,SAAhB,MACOH,IADP,GAEOC,EAAgBjC,GAAkBC,EAAwB5M,KAAK2N,iBAGtE3N,KAAK6G,SAAS,CACVkI,gBAAiBL,IAAqBM,oBACtCC,cAAeP,IAAqBQ,UAExClP,KAAK8G,MAAMmH,iB,2HA6BN,aACsCjO,KAAK8G,MAAxCiI,EADH,EACGA,gBAAiBE,EADpB,EACoBA,cADpB,EAE0BjP,KAAK/B,MAA5BkR,qBAFH,MAEmB,GAFnB,IAGyCA,EAAtC3C,QAASV,OAHZ,SAG8B5N,EAAWiR,EAAXjR,OAEnC,OACI,kBAACkR,EAAA,EAAD,KACI,kBAACC,GAAA,EAAD,CAAqB7Q,MAAM,GAAG8Q,UAAU,GACnCP,GACG,kBAACA,EAAD,CACIQ,UAAQ,EACRrO,QACIhD,GAAU,CACN4N,EACM,CACEtN,MAAO,gCACPgR,QAAS,kBAAM,EAAK7B,cAAa,KAEnC,CACEnP,MAAO,sCACPgR,QAAS,kBAAM,EAAK7B,cAAa,SAQ5DsB,GACG,kBAAC,OAAD,KACI,kBAAC,IAAMnL,SAAP,KACI,kBAACmL,EAAD,CAAelD,oBAAqB/L,KAAK2N,sB,GAtGvClI,IAAMxD,WAA9BoL,GACKnL,UAAY,CACf2L,mBAAoB3L,IAAUmJ,KAC9B8D,cAAejN,IAAUG,OACzBsL,aAAczL,IAAUmJ,KACxB2C,MAAO9L,IAAUG,OACjByL,gBAAiB5L,IAAUmJ,MAuHpBC,sBACXC,kBAfJ,SAAyBzE,GACrB,MAAO,CACHqI,cAAerI,EAAM2E,gBAIF,SAAAE,GACvB,MAAO,CACHgC,aAAc,SAACpE,EAAQnD,GAAT,OAAoBuF,EAAS8D,YAAmBlG,EAAQnD,KACtEyH,mBAAoB,SAAAtE,GAAM,OAAIoC,EAASkC,YAAmBtE,KAC1DuE,gBAAiB,SAAA4B,GAAY,OAAI/D,EAASmC,0BAAgB4B,OAK9DnE,CAGE8B,M,+JC3IO7C,EAAqB,SAAC,GAAiE,IAA/DrM,EAA+D,EAA/DA,KAAMsM,EAAyD,EAAzDA,UAAWC,EAA8C,EAA9CA,YAA8C,IAAjCN,0BAAiC,WAC9EuF,mBAASxR,GAApBsI,EADyF,cAExEkJ,mBAASjF,GAA1BkF,EAFyF,cAQ5FC,YA6CJ,WACI,GAAID,GAA0C,IAAzBA,EAAc5Q,QAAgB4Q,EAAc,GAAGE,cAChE,OA2BIF,GAA0C,IAAzBA,EAAc5Q,QAAgB4Q,EAAc,GAAGE,eAAkB,GAxB1F,GAAIrJ,GAA8B,IAAnBA,EAAQzH,OACnB,OAAO+Q,IAnDWC,IAJtBC,EAJ4F,EAI5FA,mBACAH,EAL4F,EAK5FA,cACAI,EAN4F,EAM5FA,iBACUC,EAPkF,EAO5FC,SAP4F,EAStDT,mBAsD1C,WAEI,GAAIC,GAA0C,IAAzBA,EAAc5Q,QAAgB4Q,EAAc,GAAGrM,UAAW,KACtE8M,EADsE,IACzDT,EADyD,MAE3E,OAAOnJ,EAAQ4D,KAAK,SAAA5J,GAAG,OAAKA,EAAI8C,YAAc8M,EAAU9M,YAG5D,GAAIkD,GAA8B,IAAnBA,EAAQzH,OACnB,OAAO,EAGX,OAAO,EAjEwCsR,IAT6C,WASzFC,EATyF,KAS1EC,EAT0E,OAUtBC,YA+B1E,WAEI,GAAIb,GAAiBA,EAAc5Q,OAAS,GAAK4Q,EAAc,GAAGrM,UAC9D,OAkCIqM,GAAiBA,EAAc,GAAGrM,UAAUmN,YAAe,IA/BnE,GAAIjK,GAAWA,EAAQzH,OAAS,EAC5B,OAAO2R,IAtC2EC,IAAlFC,EAVwF,EAUxFA,aAAcC,EAV0E,EAU1EA,SAAUC,EAVgE,EAUhEA,YAAuBC,EAVyC,EAUnDZ,SACvCa,EAAerB,EAAcpP,IAAI,SAAA9B,GAAI,OAAIA,EAAKkB,KAEpDsR,oBAAU,WACFX,IACAS,EAAe,CAAEvN,YAAY,IAC7B0M,EAAsB,CAAElL,UAAU,MAEvC,IAEHiM,oBAAU,WACN,IAAIpK,EAASL,IACP8J,IAAkBnG,GAAuB3D,EAAQ,GAAGjD,eAC/CiD,EAAQ,GAAGlD,UAAUmN,aAAgB,IAChDK,EAAYjK,IAEb,CAACyJ,IA2DJ,SAASI,IACL,OAAQlK,IACH8J,GAAiB9J,EAAQ,GAAGjD,eAAiBiD,EAAQ,GAAGlD,UAAUmN,aAAgB,IAG3F,SAASX,IACL,OAAQtJ,GAA8B,IAAnBA,EAAQzH,QAAgByH,EAAQ,GAAGqJ,eAAkB,GAW5E,IAKIqB,EAAa,0CAKjB,OAJIF,EAAajS,OAAS,GAAKb,EAAKa,OAAS,KACzCmS,EAAa,6CAIb,kBAAC,IAAD,CAAW/M,MAAOqC,EAAS2K,OArFZ,WACf,IAAM3H,EAAShD,EAAQjG,IAAI,SAAA9B,GAAI,OAAIA,EAAKkB,KAClCyR,EAAmBd,EAOnB,CAAE9P,IAAKgJ,EAAQ6H,aAAcL,GAN7B,CACE1N,UAAW8C,SAASyK,GACpBrQ,IAAKgJ,EACL8H,YAAazB,EACbwB,aAAcL,GAGtB,OAAOO,YAAmBH,GAAiB7H,KAAKiB,IA2EDgH,sBAXvB,CACxBzP,QAAS,UACTxD,MAAO,sBASoFA,MAAO2S,GAC9F,kBAAC,IAAD,CAAOO,OAAQ,MACX,kBAAC,IAAD,KACKtH,EACG,kBAAC,IAAD,CACIpI,QAAQ,UACR2P,UAAQ,EACRnT,MAAM,4EACR,IAEV,kBAAC,IAAD,KACI,kBAAC,IAAD,CAAM8C,IAAI,OACN,kBAAC,IAAD,CAAWsQ,QAAS,WAChB,kBAAC,IAAD,CACIC,MAAM,yBACNjS,GAAG,sBACHsN,KAAK,sBACL4E,UAAWvB,EACXwB,SArC5B,SAA8BC,GAC1BxB,EAAiBwB,GACjBhB,EAAe,CAAEvN,WAAYuO,IAC7BjB,EAAYJ,KACZT,EAAiBH,KACjBI,EAAsB,CAAElL,SAAU+M,QAmCjBnB,EACAZ,OAQzBzF,EAAmBtI,UAAY,CAC3B/D,KAAM+D,IAAUE,MAChBqI,UAAWvI,IAAUmJ,KACrBX,YAAaxI,IAAUE,MACvBgI,mBAAoBlI,IAAUmD,MAGnBmF","file":"js/InventoryDetail.js","sourcesContent":["import { Table, TableBody, TableHeader } from '@patternfly/react-table';\nimport { SkeletonTable, TableToolbar } from '@redhat-cloud-services/frontend-components';\nimport propTypes from 'prop-types';\nimport React, { Component, Fragment } from 'react';\nimport { EmptyCVEList, EmptyCVEListForSystem, FilterNotFoundForSystem } from '../../../Helpers/constants';\nimport { systemCveTableRowActions } from '../../../Helpers/CVEHelper';\nimport { createSortBy, handleSortColumn } from '../../../Helpers/MiscHelper';\nimport PaginationWrapper from '../../PresentationalComponents/PaginationWrapper/PaginationWrapper';\nimport { CVETableContext } from './SystemCves';\n\nclass SystemCvesTableWithContext extends Component {\n    static propTypes = {\n        context: propTypes.any,\n        header: propTypes.array,\n        entity: propTypes.object\n    };\n\n    noCves = () => {\n        const { entity, context } = this.props;\n        const { cves } = context;\n        const filterFields = ['filter', 'cvss_from', 'cvss_to', 'public_from', 'public_to', 'impact', 'status_id'].filter(\n            item => Object.prototype.hasOwnProperty.call(cves.meta, item) && cves.meta[item]\n        );\n        let emptyComponent = (filterFields.length !== 0)\n            ? FilterNotFoundForSystem : entity ? EmptyCVEListForSystem : (cves.data.length === 0) ? EmptyCVEList : undefined;\n\n        return ([{\n            heightAuto: true,\n            cells: [\n                {\n                    props: { colSpan: 8 },\n                    title: (\n                        emptyComponent\n                    )\n                }\n            ]\n        }]);\n\n    };\n\n    handleOnCollapse(event, rowKey, isOpen) {\n        const { context } = this.props;\n        const { cves, methods, params } = context;\n        const { expandCveDescription } = params;\n        const cveName = cves.data[rowKey] && cves.data[rowKey].id;\n        methods.openCves(isOpen, cveName, expandCveDescription);\n    }\n\n    handleOnSelect = (event, isSelected, rowId) => {\n        const { context } = this.props;\n        const { cves, methods } = context;\n        const cveName = cves.data[rowId] && cves.data[rowId].id;\n        methods.selectCves(isSelected, cveName);\n    };\n\n    render() {\n        const { context, header } = this.props;\n        const { params, cves, methods } = context;\n        const { selectedCves, openedCves } = params;\n        const rows = cves.data\n        .map(cve => (selectedCves.has(cve.id) && { ...cve, selected: true }) || cve)\n        .map(cve => (openedCves.has(cve.id) && { ...cve, isOpen: true }) || cve);\n\n        return (\n            <Fragment>\n                {!cves.isLoading ? (\n                    <Fragment>\n                        <Table\n                            aria-label={'Vulnerability CVE table'}\n                            cells={header}\n                            rows  ={(cves.data.length === 0)  ? this.noCves() : rows}\n                            onSelect ={!(cves.data.length === 0) ? this.handleOnSelect : undefined}\n                            actions ={!(cves.data.length === 0) ? systemCveTableRowActions(methods) : undefined}\n                            sortBy ={!(cves.data.length === 0) ?\n                                createSortBy([{ key: 'collapse' }, { key: 'checkbox' }, ...header], cves.meta.sort) : undefined}\n                            onCollapse={!(cves.data.length === 0) ?\n                                (event, rowKey, isOpen) => this.handleOnCollapse(event, rowKey, isOpen) : undefined}\n                            onSort={!(cves.data.length === 0) ?\n                                (event, key, direction) =>\n                                    handleSortColumn(\n                                        key,\n                                        direction,\n                                        [{ key: 'collapse' }, { key: 'checkbox' }, ...header],\n                                        cves.meta.sort,\n                                        methods.apply\n                                    ) : undefined\n                            }\n                            gridBreakPoint={'grid-lg'}\n                        >\n                            <Fragment>\n                                <TableHeader />\n                                <TableBody />\n                            </Fragment>\n                        </Table>\n                        <TableToolbar>\n                            <PaginationWrapper variant=\"bottom\" meta={cves.meta} apply={methods.apply} />\n                        </TableToolbar>\n                    </Fragment>\n                ) : (\n                    <SkeletonTable colSize={2} rowSize={20} />\n                )}\n            </Fragment>\n        );\n    }\n}\n\nconst SystemCvesTable = props => (\n    <CVETableContext.Consumer>{context => <SystemCvesTableWithContext context={context} {...props} />}</CVETableContext.Consumer>\n);\nexport default SystemCvesTable;\n","/* eslint-disable camelcase */\nimport { ToolbarGroup, ToolbarItem } from '@patternfly/react-core';\nimport { TableToolbar } from '@redhat-cloud-services/frontend-components';\nimport propTypes from 'prop-types';\nimport React, { Component } from 'react';\nimport {\n    filtersBusinessRisk,\n    filtersCVSSScore,\n    filtersPublishDate,\n    filtersSeverity,\n    filtersStatus,\n    filterCveSearchTerm\n} from '../../../Helpers/constants';\nimport BaseKebab from '../../PresentationalComponents/DownloadReportKebab/BaseKebab';\nimport {\n    kebabItemDownloadCSV,\n    kebabItemDownloadJSON,\n    kebabItemEditStatus,\n    kebabItemToggleCvesDescription\n} from '../../PresentationalComponents/DownloadReportKebab/KebabItems';\nimport FilterChips from '../../PresentationalComponents/Filters/FilterChips';\nimport Filters from '../../PresentationalComponents/Filters/Filters';\nimport SearchFilter from '../../PresentationalComponents/Filters/SearchFilter';\nimport PaginationWrapper from '../../PresentationalComponents/PaginationWrapper/PaginationWrapper';\nimport Remediation from '../Remediation/Remediation';\nimport SelectAllCheckbox from '../../PresentationalComponents/SelectAllCheckbox';\nimport { CVETableContext } from './SystemCves';\n\nclass SystemCveToolbarWithContext extends Component {\n    static propTypes = {\n        showRemediationButton: propTypes.bool,\n        entity: propTypes.object,\n        context: propTypes.object\n    };\n\n    static defaultProps = {\n        showRemediationButton: false,\n        totalNumber: 0,\n        apply: () => undefined,\n        downloadReport: () => undefined\n    };\n\n    handleCveDescription = () => {\n        const { context } = this.props;\n        const { cves, methods, params } = context;\n        const { expandCveDescription } = params;\n        const isOpen = !expandCveDescription;\n        const openedCves = !expandCveDescription ? cves.data.filter(cve => cve.id).map(cve => cve.id) : [];\n        methods.openCves(isOpen, openedCves, !expandCveDescription);\n    }\n\n    render() {\n        const { showRemediationButton, entity, context } = this.props;\n        const { cves, params, methods } = context;\n        const { selectedCves, expandCveDescription, filter } = params;\n        const selectedCvesCount =\n            this.props.showRemediationButton === true ? (selectedCves && selectedCves.size) || 0 : undefined;\n        const filterCategories = [filtersCVSSScore, filtersSeverity, filtersBusinessRisk, filtersPublishDate, filtersStatus];\n\n        const kebabOptions = [\n            kebabItemEditStatus(\n                methods.showStatusModal,\n                [...selectedCves].map(item => ({\n                    id: item,\n                    ...cves.data.filter(cve => item === cve.id)\n                    .map(item => ({ status_id: item.status_id, cve_status_id: item.cve_status_id }))[0]\n                })),\n                [],\n                { isDisabled: !selectedCvesCount }\n            ),\n            kebabItemToggleCvesDescription(this.handleCveDescription, expandCveDescription),\n            kebabItemDownloadJSON(methods.downloadReport),\n            kebabItemDownloadCSV(methods.downloadReport)\n        ];\n        return (\n            <React.Fragment>\n                <TableToolbar className=\"space-between-toolbar-items\">\n                    <ToolbarGroup className=\"vulnerability-toolbar-spacing\">\n                        {showRemediationButton && (\n                            <SelectAllCheckbox\n                                selectedItems={selectedCves}\n                                selectorHandler={methods.selectCves}\n                                items={cves}\n                                fetchResource={ops => methods.fetchResource({ ...params, ...ops })}\n                                multiRow\n                            />\n                        )}\n                        <SearchFilter\n                            placeholder=\"Find a CVE...\"\n                            value={filter}\n                            apply={methods.apply}\n\n                        />\n                        <Filters\n                            filterValues={params}\n                            filterCategories={filterCategories}\n                            apply={methods.apply}\n                        />\n                        {showRemediationButton && <Remediation systemId={entity.id} selectedCves={selectedCves} />}\n                        <BaseKebab dropdownItems={kebabOptions} disabled={cves.data.length === 0} />\n                    </ToolbarGroup>\n\n                    <ToolbarGroup>\n                        <PaginationWrapper apply={methods.apply} meta={cves.meta} />\n                    </ToolbarGroup>\n                </TableToolbar>\n                <TableToolbar className=\"pf-u-pt-0\">\n                    <ToolbarGroup>\n                        <ToolbarItem>\n                            <FilterChips\n                                filterValues={params}\n                                filterCategories={[filterCveSearchTerm, ...filterCategories]}\n                                apply={methods.apply}\n                            />\n                        </ToolbarItem>\n                    </ToolbarGroup>\n                </TableToolbar>\n            </React.Fragment>\n        );\n    }\n}\n\nconst SystemCveToolbar = props => (\n    <CVETableContext.Consumer>{context => <SystemCveToolbarWithContext context={context} {...props} />}</CVETableContext.Consumer>\n);\nexport default SystemCveToolbar;\n","/* eslint-disable camelcase */\nimport { Stack, StackItem } from '@patternfly/react-core';\nimport { classNames, expandable, sortable } from '@patternfly/react-table';\nimport { downloadFile } from '@redhat-cloud-services/frontend-components-utilities/files/helpers';\nimport propTypes from 'prop-types';\nimport qs from 'query-string';\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport { CVSSOptions, GenericError, NoVulnerabilityData, PublicDateOptions } from '../../../Helpers/constants';\nimport { updateStateSet } from '../../../Helpers/MiscHelper';\nimport { createCveListBySystem } from '../../../Helpers/VulnerabilitiesHelper';\nimport { fetchCveListBySystem } from '../../../Store/Actions/Actions';\nimport '../CVEs/vulnerabilities.scss';\nimport CvePairStatusModal from '../Modals/CvePairStatusModal';\nimport SystemCveTable from './SystemCveTable';\nimport SystemCveTableToolbar from './SystemCveTableToolbar';\n\nexport const CVETableContext = React.createContext({});\n\nconst header = [\n    {\n        title: 'CVE ID',\n        key: 'synopsis',\n        transforms: [sortable, classNames('col-width-10')],\n        columnTransforms: [classNames('no-wrap')],\n        cellFormatters: [expandable]\n    },\n    {\n        title: 'Publish date',\n        key: 'public_date',\n        transforms: [sortable, classNames('col-width-10')]\n    },\n    {\n        title: 'CVSS base score',\n        key: 'cvss_score',\n        transforms: [sortable, classNames('col-width-10')]\n    },\n    {\n        title: 'Impact',\n        key: 'impact',\n        transforms: [sortable, classNames('col-width-10')],\n        columnTransforms: [classNames('no-wrap')]\n    },\n\n    { title: 'Business risk', key: 'business_risk', transforms: [sortable, classNames('col-width-10')] },\n    { title: 'Status', key: 'status', transforms: [sortable, classNames('col-width-10')] }\n];\n\nclass SystemCves extends Component {\n    static propTypes = {\n        entity: propTypes.object,\n        cveList: propTypes.any,\n        fetchData: propTypes.func,\n        history: propTypes.object,\n        location: propTypes.object\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            selectedCves: new Set(),\n            openedCves: new Set(),\n            StatusModal: () => null,\n            expandCveDescription: false\n        };\n    }\n\n    componentDidMount() {\n        const defaultParams = { sort: '-public_date' };\n        const queryObject = qs.parse(this.props.location.search);\n        this.apply({ ...defaultParams, ...queryObject });\n    }\n\n    processError = error => {\n        const { status } = error;\n        const statusCode = parseInt(status);\n        if (statusCode === 404 && this.props.entity) {\n            return NoVulnerabilityData;\n        } else {\n            return GenericError;\n        }\n    };\n\n    dataReload = () => {\n        const { meta, data } = this.props.cveList;\n        const { page, pages } = meta;\n        const reloadPage = page === pages && data.length / 2 === 1 ? 1 : page;\n\n        this.setState(\n            {\n                ...this.state,\n                page: reloadPage,\n                page_size: meta.page_size\n            },\n            this.apply\n        );\n    }\n\n    apply = (config = {}) => {\n\n        if (Object.prototype.hasOwnProperty.call(config, 'cvss_filter')) {\n            let cvssEntry = CVSSOptions.find(item => item.value === config.cvss_filter);\n\n            if (typeof cvssEntry === 'undefined' && typeof config.cvss_filter !== 'undefined') {\n                let values = config.cvss_filter.split(/[^0-9]+/).filter(item => parseFloat(item));\n                cvssEntry = { from: values[0], to: values[1] };\n            } else if (typeof cvssEntry === 'undefined' && typeof config.cvss_filter === 'undefined') {\n                cvssEntry = { from: undefined, to: undefined };\n            }\n\n            config.cvss_from = cvssEntry.from;\n            config.cvss_to = cvssEntry.to;\n        }\n\n        if (Object.prototype.hasOwnProperty.call(config, 'publish_date')) {\n            let publicEntry = PublicDateOptions.find(item => item.value === config.publish_date);\n\n            if (typeof publicEntry !== 'undefined') {\n                config.public_from = publicEntry.from && publicEntry.from.format('YYYY-MM-DD');\n                config.public_to = publicEntry.to && publicEntry.to.format('YYYY-MM-DD');\n            } else {\n                config.public_from = undefined;\n                config.public_to = undefined;\n                config.publish_date = undefined;\n            }\n        }\n\n        this.setState({ ...this.state, ...config }, this.sendRequest);\n    };\n\n    selectCves = (isSelected, cveNames) => {\n        let { selectedCves } = this.state;\n        if (cveNames) {\n            selectedCves = updateStateSet(selectedCves, cveNames, isSelected);\n        } else {\n            selectedCves = new Set();\n        }\n\n        this.setState({ ...this.state, selectedCves: new Set(selectedCves) });\n    };\n\n    // @TODO System has different mechanism to store opened, unify the mechanism with CVE\n    openCves = (isOpen, cveNames, isExpanded) => {\n        let { openedCves, expandCveDescription } = this.state;\n\n        // if expanded, collapse rows\n        if (expandCveDescription && !cveNames.length) {\n            openedCves = cveNames;\n        }\n\n        if (cveNames) {\n            openedCves = updateStateSet(openedCves, cveNames, isOpen);\n        } else {\n            openedCves = new Set();\n        }\n\n        if (!Array.isArray(cveNames)) {\n            const visibleCves = this.props.cveList.data;\n            const visibleOpenedCves = visibleCves.filter(cve => openedCves.has(cve.id));\n\n            isExpanded = (visibleCves.length / 2 === visibleOpenedCves.length);\n        }\n\n        this.setState({ ...this.state, openedCves: new Set(openedCves), expandCveDescription: isExpanded });\n    };\n\n    createUrlParams = allParams => {\n        const params = { ...allParams };\n        const allowedParams = [\n            'cvss_filter',\n            'publish_date',\n            'filter',\n            'limit',\n            'offset',\n            'page',\n            'page_size',\n            'sort',\n            'impact',\n            'business_risk_id',\n            'status_id'\n        ];\n        Object.keys(allParams).forEach(\n            key =>\n                (params[key] === undefined || params[key] === '' || !allowedParams.includes(key) || params[key] === false) &&\n                delete params[key]\n        );\n        const queryString = qs.stringify(params);\n        this.props.history.push('?' + queryString);\n    };\n\n    sendRequest = () => {\n        const { fetchData, entity } = this.props;\n        const { expandCveDescription } = this.state;\n        fetchData && fetchData({ ...this.state, system: entity.id })\n        .then(({ data }) => {\n            if (expandCveDescription) {\n                const cveIds = data && data.map(cve => cve.id);\n                this.openCves(true, cveIds, expandCveDescription);\n            }\n        });\n        this.createUrlParams(this.state);\n    };\n\n    downloadReport = format => {\n        const params = { ...this.state };\n        const { entity } = this.props;\n        let { payload } = fetchCveListBySystem({\n            ...params,\n            page_size: Number.MAX_SAFE_INTEGER,\n            data_format: format,\n            page: 1,\n            system: entity.id\n        });\n\n        payload &&\n            payload.then(({ data: response }) => {\n                const data = format === 'json' ? JSON.stringify(response) : response;\n                return downloadFile(data, `vulnerability_cves-${new Date().toISOString()}`, format);\n            });\n    };\n\n    showStatusModal = cves => {\n\n        let hasDifferentStatus;\n        if (cves.length > 1) {\n            const selectedCves = Array.from(this.props.cveList.data.filter(cve => cves.some(element => element.id === cve.id)));\n\n            hasDifferentStatus = selectedCves.some(element => {\n                return selectedCves.filter(cve => cve.status_id === element.status_id).length > 1 ? false : true;\n            });\n        }\n\n        this.setState({\n            StatusModal: () => (\n                <CvePairStatusModal\n                    cves={cves}\n                    updateRef={this.dataReload}\n                    inventories={[{ id: this.props.entity && this.props.entity.id }]}\n                    hasDifferentStatus={hasDifferentStatus}\n                />\n            )\n        });\n    };\n\n    render() {\n        const { cveList, entity } = this.props;\n        const { apply, downloadReport, selectCves, openCves, showStatusModal } = this;\n        const { StatusModal } = this.state;\n        const cves = cveList;\n        const { errors } = cves;\n\n        if (!errors) {\n            return (\n                <CVETableContext.Provider\n                    value={{\n                        cves,\n                        params: this.state,\n                        methods: {\n                            apply,\n                            downloadReport,\n                            selectCves,\n                            openCves,\n                            showStatusModal,\n                            fetchResource: params => fetchCveListBySystem({ ...params, system: entity.id })\n                        }\n                    }}\n                >\n                    <StatusModal />\n\n                    <Stack>\n                        <StackItem>\n                            <SystemCveTableToolbar showRemediationButton entity={entity} />\n                        </StackItem>\n                        <StackItem>\n                            <SystemCveTable header={header} entity={entity} />\n                        </StackItem>\n                    </Stack>\n                </CVETableContext.Provider>\n            );\n        } else {\n            return this.processError(errors);\n        }\n    }\n}\n\nfunction mapStateToProps({ SystemCvesStore, entityDetails: { entity } }) {\n    return {\n        cveList: SystemCvesStore && createCveListBySystem(entity.id, SystemCvesStore.cveList),\n        entity\n    };\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        fetchData: params => {\n            const cvePromise = fetchCveListBySystem(params);\n            dispatch(cvePromise);\n            return cvePromise.payload;\n        }\n    };\n};\n\nexport default withRouter(\n    connect(\n        mapStateToProps,\n        mapDispatchToProps\n    )(SystemCves)\n);\n","import { InvalidObject } from '@redhat-cloud-services/frontend-components';\nimport propTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport { SystemExludedFromAnalysis } from '../../../Helpers/constants';\nimport { setHeader } from '../../../Store/Actions/Actions';\nimport { paths } from '../../../Utilities/Routes';\nimport Vulnerabilities from '../SystemCves/SystemCves';\n\nclass SystemDetail extends React.Component {\n    static propTypes = {\n        setHeader: propTypes.func,\n        entity: propTypes.object,\n        isOptOut: propTypes.bool,\n        optOutSystemHandler: propTypes.func\n    };\n\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n        const { entity, isOptOut, optOutSystemHandler } = this.props;\n        this.props.setHeader({\n            breadcrumbs: [\n                { title: paths.vulnerabilities.title, to: paths.vulnerabilities.to },\n                { title: paths.systems.title, to: paths.systems.to },\n                { title: (entity && entity.display_name) || 'Invalid System', isActive: true }\n            ]\n        });\n\n        if (!entity) {\n            return <InvalidObject />;\n        }\n\n        if (!isOptOut) {\n            return (\n                <React.Fragment>\n                    <Vulnerabilities entity={entity.id} />\n                </React.Fragment>\n            );\n        } else {\n            return (\n                <React.Fragment>\n                    <SystemExludedFromAnalysis buttonAction={() => optOutSystemHandler(false)} />\n                </React.Fragment>\n            );\n        }\n    }\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        setHeader: header => dispatch(setHeader(header))\n    };\n};\n\nfunction mapStateToProps({ entityDetails: { entity, opt_out: isOptOut } }) {\n    return {\n        entity,\n        isOptOut\n    };\n}\n\nexport default withRouter(\n    connect(\n        mapStateToProps,\n        mapDispatchToProps\n    )(SystemDetail)\n);\n","import React from 'react';\nimport SystemDetail from '../../Components/SmartComponents/SystemDetail/SystemDetail';\nimport { FETCH_SYSTEM_DETAILS } from '../ActionTypes';\n\nlet initialState = {\n    loaded: false\n};\n\n// Reducer\nexport const systemDetailStore = (INVENTORY_ACTION_TYPES, optOutSystemHandler) => (state = initialState, action) => {\n    switch (action.type) {\n        case FETCH_SYSTEM_DETAILS + '_FULFILLED':\n            return {\n                ...state,\n                ...action.payload.data\n            };\n        case INVENTORY_ACTION_TYPES.LOAD_ENTITY_FULFILLED:\n            return {\n                ...state,\n                loaded: true,\n                activeApps: [\n                    {\n                        title: 'Vulnerabilities',\n                        name: 'vulnerabilities',\n                        component: () => <SystemDetail optOutSystemHandler={optOutSystemHandler} />\n                    }\n                ]\n            };\n        case INVENTORY_ACTION_TYPES.LOAD_ENTITY_REJECTED:\n            return {\n                ...state,\n                loaded: true,\n                activeApps: [\n                    {\n                        title: 'Vulnerabilities',\n                        name: 'vulnerabilities',\n                        component: () => <SystemDetail />\n                    }\n                ]\n            };\n        default:\n            return state;\n    }\n};\n","import * as reactCore from '@patternfly/react-core';\nimport { Page } from '@patternfly/react-core';\nimport * as reactIcons from '@patternfly/react-icons';\nimport { Main } from '@redhat-cloud-services/frontend-components';\nimport { addNotification } from '@redhat-cloud-services/frontend-components-notifications';\nimport * as pfReactTable from '@patternfly/react-table';\nimport propTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport * as reactRouterDom from 'react-router-dom';\nimport { withRouter } from 'react-router-dom';\nimport { fetchSystemDetails, optOutSystemAction } from '../../../Store/Actions/Actions';\nimport { systemDetailStore } from '../../../Store/Reducers/SystemDetailStore';\nimport ReducerRegistry from '../../../Utilities/ReducerRegistry';\nimport VulnerabilityHeader from '../VulnerabilityHeader/VulnerabilityHeader';\n\nclass InventoryDetail extends React.Component {\n    static propTypes = {\n        fetchSystemDetails: propTypes.func,\n        systemDetails: propTypes.object,\n        optOutSystem: propTypes.func,\n        match: propTypes.object,\n        addNotification: propTypes.func\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            inventoryId: this.props.match.params.inventoryId,\n            removeListener: () => {},\n            linkHovered: false\n        };\n    }\n\n    componentDidMount() {\n        this.props.fetchSystemDetails(this.state.inventoryId);\n        this.fetchInventory();\n    }\n\n    async fetchInventory() {\n        const { inventoryConnector, mergeWithEntities, mergeWithDetail, INVENTORY_ACTION_TYPES } = await insights.loadInventory({\n            react: React,\n            reactRouterDom,\n            reactCore,\n            reactIcons,\n            pfReactTable\n        });\n\n        ReducerRegistry.register({\n            ...mergeWithEntities(),\n            ...mergeWithDetail(systemDetailStore(INVENTORY_ACTION_TYPES, this.optOutSystem))\n        });\n\n        this.setState({\n            InventoryHeader: inventoryConnector().InventoryDetailHead,\n            InventoryBody: inventoryConnector().AppInfo\n        });\n        this.state.removeListener();\n    }\n\n    checkItem = (key, value) => {\n        let newList = this.state.systemList;\n        newList[key].selected = value;\n        this.setState({ systemList: newList });\n    };\n\n    toggleLinkHover = value => {\n        this.setState({ ...this.state, linkHovered: value });\n    };\n\n    optOutSystem = value => {\n        this.props.optOutSystem(this.state.inventoryId, value).then(() => {\n            this.props.fetchSystemDetails(this.state.inventoryId);\n            value === true\n                ? this.props.addNotification({\n                    variant: 'success',\n                    title: 'System successfully excluded from vulnerability analysis'\n                })\n                : this.props.addNotification({\n                    variant: 'success',\n                    title: 'System successfully resumed vulnerability analysis',\n                    description: 'There may be 24 hours before data is available'\n                });\n        });\n    };\n\n    render() {\n        const { InventoryHeader, InventoryBody } = this.state;\n        const { systemDetails = {} } = this.props;\n        const { opt_out: isOptOut = false, entity } = systemDetails;\n\n        return (\n            <Page>\n                <VulnerabilityHeader title=\"\" showTabs={false}>\n                    {InventoryHeader && (\n                        <InventoryHeader\n                            hideBack\n                            actions={\n                                entity && [\n                                    isOptOut\n                                        ? {\n                                            title: 'Resume vulnerability analysis',\n                                            onClick: () => this.optOutSystem(false)\n                                        }\n                                        : {\n                                            title: 'Exclude from vulnerability analysis',\n                                            onClick: () => this.optOutSystem(true)\n                                        }\n                                ]\n                            }\n                        />\n                    )}\n                </VulnerabilityHeader>\n\n                {InventoryBody && (\n                    <Main>\n                        <React.Fragment>\n                            <InventoryBody optOutSystemHandler={this.optOutSystem} />\n                        </React.Fragment>\n                    </Main>\n                )}\n            </Page>\n        );\n    }\n}\n\nfunction mapStateToProps(state) {\n    return {\n        systemDetails: state.entityDetails\n    };\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        optOutSystem: (system, status) => dispatch(optOutSystemAction(system, status)),\n        fetchSystemDetails: system => dispatch(fetchSystemDetails(system)),\n        addNotification: notification => dispatch(addNotification(notification))\n    };\n};\n\nexport default withRouter(\n    connect(\n        mapStateToProps,\n        mapDispatchToProps\n    )(InventoryDetail)\n);\n","import { Checkbox, Form, FormGroup, Stack, StackItem, Alert } from '@patternfly/react-core';\nimport propTypes from 'prop-types';\nimport React, { useState, useEffect } from 'react';\nimport { setSystemCveStatus } from '../../../Helpers/APIHelper';\nimport BaseModal, { useJustificationInput, useStatusSelect } from './BaseModal';\n\nexport const CvePairStatusModal = ({ cves, updateRef, inventories, hasDifferentStatus = false }) => {\n    const [cveList] = useState(cves);\n    const [inventoryList] = useState(inventories);\n    const {\n        JustificationInput,\n        justification,\n        setJustification,\n        setProps: setJustificationProps\n    } = useJustificationInput(getDefaultLabel());\n    const [checkboxState, setCheckboxState] = useState(getDefaultCheckboxState());\n    const { StatusSelect, statusId, setStatusId, setProps: setSelectProps } = useStatusSelect(getDefaultStatus());\n    const inventoryIds = inventoryList.map(item => item.id);\n\n    useEffect(() => {\n        if (checkboxState) {\n            setSelectProps({ isDisabled: true });\n            setJustificationProps({ disabled: true });\n        }\n    }, []);\n\n    useEffect(() => {\n        let state = (cveList &&\n            ((checkboxState && !hasDifferentStatus) && cveList[0].cve_status_id\n                || cveList[0].status_id.toString())) || '0';\n        setStatusId(state);\n\n    }, [checkboxState]);\n\n    const handleSave = () => {\n        const cveIds = cveList.map(item => item.id);\n        const setStatusParams = !checkboxState\n            ? {\n                status_id: parseInt(statusId),\n                cve: cveIds,\n                status_text: justification,\n                inventory_id: inventoryIds\n            }\n            : { cve: cveIds, inventory_id: inventoryIds };\n        return setSystemCveStatus(setStatusParams).then(updateRef);\n    };\n\n    function getDefaultStatus() {\n        // system has different status\n        if (inventoryList && inventoryList.length > 0 && inventoryList[0].status_id) {\n            return getSystemsStatus();\n        }\n\n        if (cveList && cveList.length > 0) {\n            return getCvestatus();\n        }\n\n    }\n\n    function getDefaultLabel() {\n        if (inventoryList && inventoryList.length === 1 && inventoryList[0].justification) {\n            return getSystemsJustification();\n        }\n\n        if (cveList && cveList.length === 1) {\n            return getCveJustification();\n        }\n    }\n\n    function getDefaultCheckboxState() {\n        // system has the same status as cve\n        if (inventoryList && inventoryList.length === 1 && inventoryList[0].status_id) {\n            let [inventory] = inventoryList;\n            return cveList.some(cve => (cve.status_id === inventory.status_id));\n        }\n\n        if (cveList && cveList.length === 1) {\n            return true;\n        }\n\n        return false;\n    }\n\n    function getSystemsStatus() {\n        return (inventoryList && inventoryList[0].status_id.toString()) || '0';\n    }\n\n    function getSystemsJustification() {\n        return (inventoryList && inventoryList.length === 1 && inventoryList[0].justification) || '';\n    }\n\n    function getCvestatus() {\n        return (cveList &&\n            (checkboxState && cveList[0].cve_status_id || cveList[0].status_id.toString())) || '0';\n    }\n\n    function getCveJustification() {\n        return (cveList && cveList.length === 1 && cveList[0].justification) || '';\n    }\n\n    function handleCheckboxChange(checked) {\n        setCheckboxState(checked);\n        setSelectProps({ isDisabled: checked });\n        setStatusId(getCvestatus());\n        setJustification(getCveJustification());\n        setJustificationProps({ disabled: checked });\n    }\n\n    const successNotification = {\n        variant: 'success',\n        title: 'CVE status updated'\n    };\n\n    let modalTitle = 'Set status for this CVE and system pair';\n    if (inventoryIds.length > 1 || cves.length > 1) {\n        modalTitle = 'Set status for these CVE and system pairs';\n    }\n\n    return (\n        <BaseModal items={cveList} onSave={handleSave} onSuccessNotification={successNotification} title={modalTitle}>\n            <Stack gutter={'md'}>\n                <StackItem>\n                    {hasDifferentStatus ?\n                        <Alert\n                            variant=\"warning\"\n                            isInline\n                            title=\"Selected pairs have different statuses. Changes will be applied to all \" />\n                        : ''}\n                </StackItem>\n                <StackItem>\n                    <Form key=\"key\">\n                        <FormGroup fieldId={'overall'}>\n                            <Checkbox\n                                label=\"Use overall CVE status\"\n                                id=\"alt-form-checkbox-1\"\n                                name=\"alt-form-checkbox-1\"\n                                isChecked={checkboxState}\n                                onChange={handleCheckboxChange}\n                            />\n                        </FormGroup>\n                        {StatusSelect}\n                        {JustificationInput}\n                    </Form>\n                </StackItem>\n            </Stack>\n        </BaseModal>\n    );\n};\n\nCvePairStatusModal.propTypes = {\n    cves: propTypes.array,\n    updateRef: propTypes.func,\n    inventories: propTypes.array,\n    hasDifferentStatus: propTypes.bool\n};\n\nexport default CvePairStatusModal;\n"],"sourceRoot":""}