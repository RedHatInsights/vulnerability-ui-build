{"version":3,"sources":["webpack:///./src/Helpers/DownloadReport.js","webpack:///./src/Components/SmartComponents/Reports/Common/tablePage.js","webpack:///./src/Components/SmartComponents/Reports/Common/firstPagePDF.js","webpack:///./src/Components/SmartComponents/Reports/DownloadCVEsReport.js","webpack:///./src/Components/SmartComponents/Reports/BuildExecReport.js","webpack:///./src/Components/SmartComponents/Reports/DownloadExecutive.js","webpack:///./src/Components/SmartComponents/Reports/CustomReportFilter.js","webpack:///./src/Components/SmartComponents/Modals/ReportConfigModal.js","webpack:///./src/Components/SmartComponents/Reports/ReportsPage.js"],"names":["filename","page","Date","toISOString","split","params","cve","defaultParams","date","checkTypes","fetchData","format","pages","includes","formats","exec","a","Array","isArray","data_format","payload","response","data","JSON","stringify","downloadFile","this","page_size","Number","MAX_SAFE_INTEGER","replace","tablePage","intl","header","type","POSSIBLE_HEADERS","name","value","formatMessage","messages","publishDate","cvssBaseScore","hit","impact","systemsExposed","businessRisk","status","columnBuilder","style","key","hitColumns","headerContent","push","cveId","forEach","item","concat","map","cveRows","attributes","cveCellStyle","rules","length","styles","cveCellAlign","bodyCell","cveCell","synopsis","link","src","CVES_PATH","public_date","processDate","systemRows","system","display_name","systemNameCell","opt_out","systemsTableExcluded","cve_count","systemCell","formatDate","updated","withHeader","rows","headerCell","customReportNoCves","propTypes","PropTypes","object","any","number","array","string","firstPagePDF","meta","filters","isReportDynamic","reportData","user","filtersBuilder","reduce","obj","filter","category","values","PUBLIC_DATE_OPTIONS","find","val","chips","timespan_label","join","filterStringSegments","msg","CVEsPDFreportFiltersSeverity","CVEsPDFreportFiltersBusinessRisk","CVEsPDFreportFiltersStatus","CVEsPDFreportFiltersSecurityRule","i","hasOwnProperty","isLast","formatWithBold","customReportIntroductionText","customReportSearchTermCvssAndPublishDate","hasSearchTerm","searchTerm","score","cvss_filter","DEFAULT_FILTER_DATA","min","toFixed","max","published","publish_date","customReportTimespanAnytime","toLowerCase","prefix","customReportAnd","systemsPDFreportFiltersSearchTerm","CVEsPDFreportSubHeader","total_items","toString","system_count","userNotes","userNotesTitle","bold","customReportUserNoteLabel","identity","italic","customReportUserNotesGenerated","first_name","last_name","defaultProps","undefined","bool","DownloadCVEsReport","buttonProps","label","props","useIntl","useState","loading","setLoading","securityRulesPresent","setSecurityRulesPresent","otherPagesPDF","resultArray","index","chunkIndex","Math","floor","PDF_REPORT_PER_PAGE","otherPages","cvesFetch","getCveListByAccount","DownloadReport","sort","affecting","insights","chrome","auth","getUser","cvss_score","parseFloat","cvss3_score","cvss2_score","some","firstPage","splice","firstPageWithNote","firstPageWithoutNote","cvePage","systemsFetch","getSystems","systemPage","asyncFunction","component","reportName","reportTitle","cvePDFReportName","systemPDFReportName","fileName","allPagesHaveTitle","size","orientation","footer","footerIcon","footerText","customReportFooter","kebabExportAsPDF","oneOfType","BuildExecReport","safeCharLength","cvesBySeverity","cves_by_severity","recentCves","recent_cves","topCves","top_cves","cvesTotal","cves_total","systemTotal","mapFields","fields","percentageInfo","arr","field","fieldData","count","percentage","executiveReportOfTotal","recentCvesData","recentCvesMapping","CVSSChart","CVSSMapping","severity","x","y","CVSSData","calculateTopCves","panelGroups","secondPage","totalRows","ceil","description","panel","title","executiveReportPanelTitle","systems_affected","executiveReportHeader","executiveReportSubHeader","systems","executiveReportHeaderSystems","cves","executiveReportHeaderCVEs","executiveReportCvesBySeverity","CVSSHeader","chartType","subTitle","executiveReportRecentlyPublishedCves","recentCvesHeader","executiveReportTop3","withColumn","exact","DownloadExecutive","renderPDF","setRenderPDF","dispatch","useDispatch","dataFetch","getExecutiveReport","report","buildExecReport","useEffect","clearNotifications","href","onClick","addNotification","dismissable","variant","downloadExecutiveNotification","executiveReportCardButton","showButton","isInline","vulnerabilitiesHeader","onSuccess","CustomReportFilter","filterName","filterData","setFilterData","isOpen","setOpen","handleCvssInputChange","inputName","validateCvssInput","valueThis","valueMin","valueMax","filterCheckboxes","options","Select","aria-label","onToggle","placeholderText","CVE_REPORT_FILTERS","items","id","direction","width","className","onSelect","event","optionName","optionId","indexOf","temp","slice","handleOnCheckboxChange","selections","isCheckboxSelectionBadgeHidden","SelectOption","filterRadios","optionValue","handleOnRadioChange","Radio","isChecked","filterCvssContent","Split","SplitItem","fontSize","customReportCvssMinLabel","TextInput","onChange","v","validated","customReportCvssMaxLabel","filterCvssWrapper","customContent","optionsAll","Text","color","STATUS_OPTIONS","BUSINESS_RISK_OPTIONS","IMPACT_OPTIONS","filterContent","func","ReportConfigModal","isModalOpen","handleModalClose","handleDownloadButton","columnsToInclude","setColumnsToInclude","setUserNotes","setReportTitle","activeFilters","Modal","configModalTitle","onClose","actions","Button","configModalExportReport","cancel","Form","FormGroup","customReportTitleLabel","fieldId","Checkbox","customOnlyCvesWithRulesLabel","security_rule","newValue","customReportDataToIncludeLabel","columnCount","isDisabled","Object","entries","parameter","handleCheckboxChange","customReportFilterDataByLabel","customReportUserNotesLabel","helperTextInvalid","customReportUserNoteTooLong","PDF_REPORT_USER_NOTE_MAX_LENGTH","TextArea","resizeOrientation","minHeight","ReportsPage","setModalOpen","downloadCVEReport","setDownloadCVEReport","customReportDefaultTitle","keys","Page","Header","reportsPageTitle","showBreadcrumb","Main","Grid","hasGutter","lg","md","sm","GridItem","Card","CardTitle","pieChartIcon","cardTitle","executiveReportCardTitle","CardBody","executiveReportCardDescription","CardFooter","customReportCardTitle","customReportCardDescription","customReportCardButton","customReportNotification","constructFilterParameters","buildFilters","marginRight"],"mappings":"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","file":"js/Reports.js","sourcesContent":["import { downloadFile } from '@redhat-cloud-services/frontend-components-utilities/files/cjs/helpers';\n\nclass DownloadReport  {\n    constructor() {\n        this.defaultParams = {\n            page: 1,\n            page_size: Number.MAX_SAFE_INTEGER,\n            date: new Date().toISOString().replace(/[T:]/g, '-').split('.')[0] + '-utc'\n        };\n\n        this.params = {\n            cve: ''\n        };\n\n        this.pages = ['systems-exposed', 'system-cves', 'cves', 'system-list'];\n        this.formats = ['csv', 'json'];\n    }\n\n    filename = (page) => {\n        switch (page) {\n            case 'reports':\n                return `vulnerability_cves-report--${new Date().toISOString().split('T')[0]}`;\n            case 'systems-exposed':\n                return `vulnerability_systems-exposed-${this.params.cve}--${this.defaultParams.date}`;\n            case 'system-list':\n                return `vulnerability_systems--${this.defaultParams.date}`;\n            default:\n                return `vulnerability_cves--${this.defaultParams.date}`;\n\n        }\n    }\n\n    checkTypes = (fetchData, page, format) => {\n        if (typeof fetchData !== 'function') {\n            throw `exec expects the 1st param to be funtion. Received ${typeof fetchData}`;\n        }\n\n        if (!this.pages.includes(page)) {\n            throw `Page ${page} does not exist`;\n        }\n\n        if (!this.formats.includes(format)) {\n            throw `Format ${format} is not supported`;\n        }\n    }\n\n    /**\n     * Execute and download the report\n     *\n     * @param {Function} fetchData - Function to be called in order to fetch data.\n     * @param {Object || Array} params - Object to be sent as request params. If you need to pass extra argument, pass an array.\n     * @param {String} format - Supported formats to download are CSV and JSON.\n     * @param {String} page - Name of the page based on which the filename will be determined.\n     * @returns {void}\n     */\n    exec = async (fetchData, params, format, page) => {\n        this.checkTypes(fetchData, page, format);\n        this.params.cve = Array.isArray(params) ? params[0] : '';\n\n        try {\n            let { payload } = Array.isArray(params)\n                ? await fetchData(this.params.cve, {\n                    ...params[1],\n                    ...this.defaultParams,\n                    data_format: format\n                }) :\n                await fetchData({\n                    ...params,\n                    ...this.defaultParams,\n                    data_format: format\n                });\n\n            let { data: response } = await payload;\n            let data = format === 'json' ? JSON.stringify(response) : response;\n\n            downloadFile(data, this.filename(page), format);\n        } catch (error) {\n            throw `${error}`;\n        }\n    }\n}\n\nexport default new DownloadReport();\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { View, Text, Link } from '@react-pdf/renderer';\nimport { Table, CSAwIcon } from '@redhat-cloud-services/frontend-components-pdf-generator';\nimport { processDate } from '@redhat-cloud-services/frontend-components-utilities/files/cjs/helpers';\nimport { CVES_PATH } from '../../../../Helpers/constants';\nimport messages from '../../../../Messages';\nimport styles from './styles';\nimport { formatDate } from '../../../../Helpers/MiscHelper';\n\nconst tablePage = ({ data, page, intl, header, type }) => {\n    const POSSIBLE_HEADERS = [\n        {\n            name: 'publish_date',\n            header: { value: intl.formatMessage(messages.publishDate) }\n        },\n        {\n            name: 'cvss_filter',\n            header: { value: intl.formatMessage(messages.cvssBaseScore) },\n            hit: 'cvss_score'\n        },\n        {\n            name: 'impact',\n            header: { value: intl.formatMessage(messages.impact) },\n            hit: 'impact'\n        },\n        {\n            name: 'affecting',\n            header: { value: intl.formatMessage(messages.systemsExposed) },\n            hit: 'systems_affected'\n        },\n        {\n            name: 'business_risk_id',\n            header: { value: intl.formatMessage(messages.businessRisk) },\n            hit: 'business_risk'\n        },\n        {\n            name: 'status_id',\n            header: { value: intl.formatMessage(messages.status) },\n            hit: 'status'\n        }\n    ];\n    // eslint-disable-next-line react/prop-types\n    const columnBuilder = ({ value, style }) => <Text key={value} style={style}>{value}</Text>;\n    let hitColumns = ['cvss_score', 'impact', 'systems_affected', 'business_risk', 'status'];\n\n    let headerContent = [];\n\n    // if the header is undefined we use default header (all params)\n    if (header) {\n        headerContent.push({ value: intl.formatMessage(messages.cveId) });\n        hitColumns = [];\n\n        POSSIBLE_HEADERS.forEach(item => {\n            if (header.includes(item.name)) {\n                headerContent.push(item.header);\n                item.hit && hitColumns.push(item.hit);\n            }\n        });\n    }\n    else if (type === 'cves') {\n        headerContent = [\n            { value: intl.formatMessage(messages.cveId) }\n        ].concat(POSSIBLE_HEADERS.map(item => item.header));\n    }\n    else {\n        hitColumns = ['display_name', 'cve_count', 'updated'];\n\n        headerContent = [\n            { value: 'Name' },\n            { value: 'Applicable CVEs' },\n            { value: 'Last seen' }\n        ];\n    }\n\n    const cveRows = [\n        ...data.map(({ attributes: cve }) => {\n            let cveCellStyle = (\n                cve.rules && cve.rules.length > 0\n                    ? [styles.cveCellAlign, styles.bodyCell, styles.cveCell]\n                    : [styles.bodyCell, styles.cveCell]\n            );\n\n            const synopsisCell = (\n                <View key={cve.synopsis}>\n                    { cve.rules && cve.rules.length > 0 && <CSAwIcon style={{ ...styles.bodyCell, ...styles.cveCell }}/> }\n                    <Text style={cveCellStyle}>\n                        <Link\n                            style={styles.link}\n                            src={`${CVES_PATH}/${cve.synopsis}`}\n                        >\n                            {cve.synopsis}\n                        </Link>\n                    </Text>\n                </View>\n            );\n\n            const publishDateCell = (\n                (!header || header.includes('publish_date')) &&\n                    <Text key={cve.public_date} style={[styles.bodyCell, styles.cveCell]}>\n                        { processDate(cve.public_date) }\n                    </Text>\n            );\n\n            return [\n                synopsisCell,\n                publishDateCell,\n                ...hitColumns.map(item => columnBuilder({ value: cve[item], style: [styles.bodyCell, styles.cveCell] }))\n            ];\n        })\n    ];\n\n    const systemRows = [\n        ...data.map(({ attributes: system }) => {\n            return [\n                columnBuilder({ value: system.display_name, style: [styles.bodyCell, styles.systemNameCell] }),\n                columnBuilder({ value: system.opt_out\n                    ? intl.formatMessage(messages.systemsTableExcluded)\n                    : system.cve_count, style: [styles.bodyCell, styles.systemCell]\n                }),\n                columnBuilder({ value: formatDate(system.updated, true), style: [styles.bodyCell, styles.systemCell] })\n            ];\n        })\n    ];\n\n    return <Fragment key={page}>\n        <Table\n            withHeader\n            rows={[\n                headerContent.map(item => columnBuilder({\n                    ...item,\n                    style: [styles.headerCell, type === 'cves'\n                        ? styles.cveCell\n                        : item.value === 'Name'\n                            ? styles.systemNameCell\n                            : styles.systemCell]\n                })),\n                ... (type === 'cves') ? cveRows : systemRows\n            ]}\n        />\n        { data.length === 0 && <Text>{intl.formatMessage(messages.customReportNoCves)}</Text> }\n    </Fragment>;\n};\n\ntablePage.propTypes = {\n    data: PropTypes.object,\n    intl: PropTypes.any,\n    page: PropTypes.number,\n    header: PropTypes.array,\n    type: PropTypes.string\n};\n\nexport default tablePage;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Paragraph } from '@redhat-cloud-services/frontend-components-pdf-generator';\nimport { Text, View } from '@react-pdf/renderer';\nimport messages from '../../../../Messages';\nimport tablePage from './tablePage';\nimport { PUBLIC_DATE_OPTIONS, DEFAULT_FILTER_DATA } from '../../../../Helpers/constants';\nimport { formatWithBold } from '../ReportsHelper';\nimport styles from './styles';\n\nconst firstPagePDF = ({ data, meta, filters, intl, isReportDynamic, reportData, user, type }) => {\n    // if data isn't converted to object convert it\n    const filtersBuilder = (isReportDynamic) ? filters : filters.reduce((obj, item) => {\n        obj[item.key] = {\n            filter: item.category,\n            values: item.key === 'publish_date'\n                ? PUBLIC_DATE_OPTIONS.find(val => val.value === item.chips[0].value).timespan_label\n                : item.chips.map(({ name }) => name).join(', ')\n        };\n        return obj;\n    }, {});\n\n    let filterStringSegments = [\n        { name: 'impact', msg: messages.CVEsPDFreportFiltersSeverity },\n        { name: 'business_risk_id', msg: messages.CVEsPDFreportFiltersBusinessRisk },\n        { name: 'status_id', msg: messages.CVEsPDFreportFiltersStatus },\n        { name: 'security_rule', msg: messages.CVEsPDFreportFiltersSecurityRule }\n    ];\n\n    // iterate from right to find last existing filter segment\n    for (let i = filterStringSegments.length - 1; i >= 0; i--) {\n        if (filtersBuilder.hasOwnProperty(filterStringSegments[i].name)) {\n            filterStringSegments[i].isLast = true;\n            break;\n        }\n    }\n\n    const generateCvesFiltersParagraph = () =>\n        <Paragraph>\n            {formatWithBold(messages.customReportSearchTermCvssAndPublishDate, {\n                hasSearchTerm: filtersBuilder.hasOwnProperty('filter') ? 'yes' : 'no',\n                searchTerm: filtersBuilder.filter && filtersBuilder.filter.values,\n                score: (filtersBuilder.cvss_filter && filtersBuilder.cvss_filter.values)\n                    || DEFAULT_FILTER_DATA.cvss_filter.min.toFixed(1) + ' - ' + DEFAULT_FILTER_DATA.cvss_filter.max.toFixed(1),\n                published: (filtersBuilder.publish_date && filtersBuilder.publish_date.values)\n                    || formatWithBold(messages.customReportTimespanAnytime)\n            })}\n            {filterStringSegments.map(filter =>\n                filtersBuilder.hasOwnProperty(filter.name) && formatWithBold(filter.msg, {\n                    values: filtersBuilder[filter.name].values.toLowerCase(),\n                    prefix: (filter.isLast ? intl.formatMessage(messages.customReportAnd) : ';')  })\n            )}\n            <Text>.</Text>\n            {'\\n\\n'}\n        </Paragraph>;\n\n    const generateSystemsFiltersParagraph = () =>\n        <Paragraph>\n            {filtersBuilder.filter ?\n                formatWithBold(messages.systemsPDFreportFiltersSearchTerm, { searchTerm: filtersBuilder.filter.values }) : ''}\n        </Paragraph>;\n\n    return (\n        <Fragment key=\"first-section\">\n            {\n                isReportDynamic && (\n                    <Paragraph>\n                        {formatWithBold(messages.customReportIntroductionText)}\n                    </Paragraph>\n                )\n            }\n\n            { type === 'cves' ? generateCvesFiltersParagraph() : generateSystemsFiltersParagraph() }\n\n            { type === 'cves' && (\n                <Paragraph>\n                    {formatWithBold(messages.CVEsPDFreportSubHeader, {\n                        cve_count: meta.total_items.toString(),\n                        system_count: meta.system_count.toString()\n                    })}\n                </Paragraph>\n            )}\n\n            {\n                reportData && reportData.userNotes ?\n                    (<View style={styles.userNotes}>\n                        <Paragraph style={styles.userNotesTitle}><Text style={styles.bold}>\n                            {intl.formatMessage(messages.customReportUserNoteLabel)}\n                        </Text></Paragraph>\n                        <Paragraph><Text>{reportData.userNotes}</Text></Paragraph>\n                        <Paragraph>\n                            { user && user.identity &&\n                                <Text style={styles.italic}>\n                                    {intl.formatMessage(messages.customReportUserNotesGenerated, {\n                                        name: `${user.identity.user.first_name} ${user.identity.user.last_name}`\n                                    })}\n                                </Text>\n                            }\n                        </Paragraph>\n                    </View>\n                    ) : null\n            }\n\n            {tablePage({ data, intl, header: reportData && reportData.header, type })}\n        </Fragment>\n    );\n};\n\nfirstPagePDF.defaultProps = {\n    user: undefined\n};\n\nfirstPagePDF.propTypes = {\n    intl: PropTypes.any,\n    filters: PropTypes.array,\n    data: PropTypes.object,\n    meta: PropTypes.object,\n    reportData: PropTypes.object,\n    isReportDynamic: PropTypes.bool,\n    user: PropTypes.object,\n    type: PropTypes.string\n};\n\nexport default firstPagePDF;\n","\nimport React, { useState } from 'react';\nimport propTypes from 'prop-types';\nimport { useIntl } from 'react-intl';\nimport { DownloadButton, CSAwIcon } from '@redhat-cloud-services/frontend-components-pdf-generator';\nimport { getCveListByAccount, getSystems } from '../../../Helpers/APIHelper';\nimport messages from '../../../Messages';\nimport firstPagePDF from './Common/firstPagePDF';\nimport tablePage from './Common/tablePage';\nimport DownloadReport from '../../../Helpers/DownloadReport';\nimport { PDF_REPORT_PER_PAGE } from '../../../Helpers/constants';\nimport { Text, View } from '@react-pdf/renderer';\nimport styles from './Common/styles';\n\nconst DownloadCVEsReport = ({\n    filters,\n    params,\n    reportData = {},\n    buttonProps,\n    isReportDynamic = false,\n    type,\n    label,\n    ...props\n}) => {\n    const intl = useIntl();\n    const [loading, setLoading] = useState(false);\n    const [securityRulesPresent, setSecurityRulesPresent] = useState(false);\n\n    const otherPagesPDF = data =>\n        data.reduce((resultArray, item, index) => {\n            const chunkIndex = Math.floor(index / PDF_REPORT_PER_PAGE.otherPages);\n            !resultArray[chunkIndex] && (resultArray[chunkIndex] = []);\n            resultArray[chunkIndex].push(item);\n\n            return resultArray;\n        }, []);\n\n    const cvesFetch = async () => {\n        setLoading(true);\n\n        let { data, meta } = await getCveListByAccount({\n            ...params,\n            ...DownloadReport.defaultParams,\n            sort: params.sort || '-cvss_score',\n            affecting: 'true,false'\n        });\n\n        let user;\n        if (reportData && reportData.userNotes) {\n            user = await insights.chrome.auth.getUser();\n        }\n\n        data = data.map(cve => ({\n            ...cve,\n            attributes: {\n                ...cve.attributes,\n                cvss_score: parseFloat(cve.attributes.cvss3_score || cve.attributes.cvss2_score).toFixed(1)\n            }\n        }));\n\n        setSecurityRulesPresent(data.some(cve => cve.attributes.rules.length > 0));\n\n        const firstPage = firstPagePDF({\n            data: data.splice(0, reportData.userNotes\n                ? PDF_REPORT_PER_PAGE.firstPageWithNote\n                : PDF_REPORT_PER_PAGE.firstPageWithoutNote),\n            meta, filters, intl, isReportDynamic, reportData, user, type\n        });\n\n        const otherPages = otherPagesPDF(data);\n\n        setLoading(false);\n\n        return [firstPage, ...otherPages.map((cvePage, index) =>\n            tablePage({ data: cvePage, page: index, intl, header: reportData && reportData.header, type }))];\n    };\n\n    const systemsFetch = async () => {\n        setLoading(true);\n\n        let { data, meta } = await getSystems({\n            ...params,\n            ...DownloadReport.defaultParams\n        });\n\n        const firstPage = firstPagePDF({ data: data.splice(0, PDF_REPORT_PER_PAGE.firstPageWithoutNote), meta, filters, intl });\n\n        const otherPages = otherPagesPDF(data);\n\n        setLoading(false);\n\n        return [firstPage, ...otherPages.map((systemPage, index) =>\n            tablePage({ data: systemPage, page: index, intl, header: reportData && reportData.header }))];\n    };\n\n    return (\n        <div>\n            <DownloadButton\n                {...props}\n                label={loading ? intl.formatMessage(messages.loading) : intl.formatMessage(label)}\n                asyncFunction={type === 'cves' ? cvesFetch : systemsFetch}\n                buttonProps={{ component: 'button', ...buttonProps }}\n                reportName={isReportDynamic ? reportData.reportTitle : (type === 'cves')\n                    ? intl.formatMessage(messages.cvePDFReportName)\n                    : intl.formatMessage(messages.systemPDFReportName)}\n                type={''}\n                fileName={`${DownloadReport.filename(type === 'cves' ? (isReportDynamic ? 'reports' : '') : 'system-list')}.pdf`}\n                allPagesHaveTitle={false}\n                size={'A4'}\n                orientation={'landscape'}\n                footer={\n                    securityRulesPresent && (\n                        <View style={styles.footer}>\n                            <Text>*</Text>\n                            <CSAwIcon style={styles.footerIcon}/>\n                            <Text style={styles.footerText}>\n                                {intl.formatMessage(messages.customReportFooter)}\n                            </Text>\n                        </View>)\n                }\n            />\n        </div>\n    );\n};\n\nDownloadCVEsReport.defaultProps = {\n    label: messages.kebabExportAsPDF\n};\n\nDownloadCVEsReport.propTypes = {\n    filters: propTypes.oneOfType([\n        propTypes.array,\n        propTypes.object\n    ]),\n    params: propTypes.object,\n    reportData: propTypes.object,\n    buttonProps: propTypes.object,\n    label: propTypes.oneOfType([\n        propTypes.array,\n        propTypes.object\n    ]),\n    isReportDynamic: propTypes.bool,\n    type: propTypes.string\n};\n\nexport default DownloadCVEsReport;\n","\nimport React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { CVSSHeader, CVSSMapping, recentCvesHeader, recentCvesMapping } from '../../../Helpers/constants';\nimport {\n    Paragraph,\n    Section,\n    Column,\n    Table,\n    Panel,\n    PanelItem,\n    Chart\n} from '@redhat-cloud-services/frontend-components-pdf-generator';\nimport { Text } from '@react-pdf/renderer';\nimport messages from '../../../Messages';\nimport styles from './Common/styles';\n\nconst BuildExecReport = ({ data, intl }) => {\n\n    const safeCharLength = { colChars: 70, rows: 15 };\n\n    const {\n        cves_by_severity: cvesBySeverity,\n        recent_cves: recentCves,\n        top_cves: topCves,\n        cves_total: cvesTotal,\n        system_count: systemTotal\n    } = data;\n\n    const mapFields = (fields, data, percentageInfo = false) => {\n        let arr = [];\n\n        for (const field in fields) {\n            let { [field]: label } = fields;\n            let { [field]: fieldData } = data;\n\n            let value = fieldData.count !== undefined ? fieldData.count : fieldData;\n            if (field === 'na' && value === 0) {\n                continue;  // if there's no CVE with N/A CVSS do not display N/A in graph/table\n            }\n\n            if (percentageInfo && fieldData.percentage) {\n                if (percentageInfo === 'number') { // only return number representing percentage\n                    value = fieldData.percentage;\n                }\n                else { // return formatted string including CVE count and percentage\n                    value = intl.formatMessage(messages.executiveReportOfTotal,\n                        { count: value, percentage: fieldData.percentage });\n                }\n            }\n\n            arr.push([label, value.toString()]);\n        }\n\n        return arr;\n    };\n\n    const recentCvesData = mapFields(\n        recentCvesMapping,\n        {\n            ...recentCves\n        }\n    );\n    const CVSSDataMap = mapFields(\n        CVSSMapping,\n        {\n            ...cvesBySeverity\n        },\n        'number'\n    );\n\n    const CVSSChart = CVSSDataMap.map((severity) => {\n        let [x, y] = severity;\n        return { x: `CVSS ${x}`, y: Number(y) };\n    });\n\n    const CVSSData = mapFields(\n        CVSSMapping,\n        {\n            ...cvesBySeverity\n        },\n        'string'\n    );\n\n    const calculateTopCves = () => {\n        let panelGroups = { firstPage: [], secondPage: [] };\n        let totalRows = 0;\n\n        topCves.forEach(cve => {\n            const rows = Math.ceil(cve.description.length / safeCharLength.colChars);\n            totalRows += rows;\n            const panel = (\n                <Panel key={cve.synopsis} title={cve.synopsis} description={cve.description}>\n                    <PanelItem title={intl.formatMessage(messages.executiveReportPanelTitle)}>\n                        {Number.parseFloat(cve.cvss3_score).toFixed(1)}\n                    </PanelItem>\n                    <PanelItem title={intl.formatMessage(messages.systemsExposed)}>\n                        {cve.systems_affected.toString()}\n                    </PanelItem>\n                </Panel>\n            );\n            totalRows <= 15 && panelGroups.firstPage.push(panel) || panelGroups.secondPage.push(panel);\n\n        });\n        return panelGroups;\n    };\n\n    return [(\n        <Fragment key=\"first-section\">\n            <Paragraph>\n                {intl.formatMessage(messages.executiveReportHeader)}\n            </Paragraph>\n            <Paragraph>\n                {intl.formatMessage(messages.executiveReportSubHeader, {\n                    systems: <Text style={styles.bold}>\n                        {intl.formatMessage(messages.executiveReportHeaderSystems, { systems: systemTotal })}\n                    </Text>,\n                    cves: <Text style={styles.bold}>\n                        {intl.formatMessage(messages.executiveReportHeaderCVEs, { cves: cvesTotal })}\n                    </Text>\n                })}\n            </Paragraph>\n            <Section title={intl.formatMessage(messages.executiveReportCvesBySeverity)}>\n\n                <Column>\n                    <Table\n                        withHeader\n                        rows={[CVSSHeader, ...CVSSData]}\n                    />\n                </Column>\n                <Column>\n                    <Chart\n                        chartType=\"pie\"\n                        subTitle=\"Cves\"\n                        title=\"100\"\n                        data={CVSSChart}\n                    />\n                </Column>\n            </Section>\n            <Section title={intl.formatMessage(messages.executiveReportRecentlyPublishedCves)}>\n                <Column>\n                    <Table\n                        withHeader\n                        rows={[recentCvesHeader, ...recentCvesData]}\n                    />\n                </Column>\n                <Column>\n                </Column>\n            </Section>\n            <Section title={intl.formatMessage(messages.executiveReportTop3)} withColumn={false}>\n                {\n                    calculateTopCves().firstPage\n\n                }\n            </Section>\n        </Fragment>\n    ),\n    calculateTopCves().secondPage\n    ];\n};\n\nBuildExecReport.propTypes = {\n    data: PropTypes.exact({\n        cves_by_severity: PropTypes.object,\n        recent_cves: PropTypes.object,\n        top_cves: PropTypes.array,\n        cves_total: PropTypes.number,\n        system_count: PropTypes.number\n    }),\n    intl: PropTypes.any\n};\n\nexport default BuildExecReport;\n","\nimport React, { useState, useEffect } from 'react';\nimport { useIntl } from 'react-intl';\nimport { DownloadButton } from '@redhat-cloud-services/frontend-components-pdf-generator';\nimport { getExecutiveReport } from '../../../Helpers/APIHelper';\nimport messages from '../../../Messages';\nimport buildExecReport from './BuildExecReport';\nimport { Fragment } from 'react';\nimport { useDispatch } from 'react-redux';\n\nimport { addNotification, clearNotifications } from '@redhat-cloud-services/frontend-components-notifications/cjs/actions';\n\nconst DownloadExecutive = () => {\n    const intl = useIntl();\n    const [loading, setLoading] = useState(false);\n    const [renderPDF, setRenderPDF] = useState(false);\n    const dispatch = useDispatch();\n\n    const dataFetch = async () => {\n        setLoading(true);\n\n        const data = await getExecutiveReport();\n        const report = buildExecReport({ data, intl });\n\n        setLoading(false);\n        return [...report];\n    };\n\n    const [date] = new Date().toISOString().split('T');\n\n    const handleDownloadButton = () => {\n        setRenderPDF(true);\n        dispatch(addNotification({\n            dismissable: true,\n            variant: 'info',\n            title: intl.formatMessage(messages.downloadExecutiveNotification)\n        }));\n    };\n\n    useEffect(() => {\n        return () => {\n            dispatch(clearNotifications());\n        };\n    }, [dispatch]);\n\n    return (<Fragment>\n        <a href onClick={() => handleDownloadButton()}>\n            {intl.formatMessage(messages.executiveReportCardButton)}\n        </a>\n        { renderPDF && <DownloadButton\n            showButton={false}\n            label={loading ? intl.formatMessage(messages.loading) : intl.formatMessage(messages.executiveReportCardButton)}\n            asyncFunction={dataFetch}\n            buttonProps={{ variant: 'link', isInline: true }}\n            type={intl.formatMessage(messages.vulnerabilitiesHeader)}\n            fileName={`vulnerability_executive-report--${date}.pdf`}\n            allPagesHaveTitle={false}\n            onSuccess={() => setRenderPDF(false)}\n        />\n        }\n    </Fragment>\n    );\n\n};\n\nexport default DownloadExecutive;\n","import React, { useState } from 'react';\nimport propTypes from 'prop-types';\nimport { Split, SplitItem, Radio, Text, TextInput, Select, SelectOption } from '@patternfly/react-core';\nimport {\n    CVE_REPORT_FILTERS,\n    BUSINESS_RISK_OPTIONS,\n    STATUS_OPTIONS,\n    PUBLIC_DATE_OPTIONS,\n    IMPACT_OPTIONS\n} from '../../../Helpers/constants';\nimport messages from '../../../Messages';\nimport { intl } from '../../../Utilities/IntlProvider';\nimport { ExclamationCircleIcon } from '@patternfly/react-icons';\n\nconst CustomReportFilter = ({ filterName, filterData, setFilterData }) => {\n    const [isOpen, setOpen] = useState(false);\n\n    const handleOnCheckboxChange = (filterName, optionName) => {\n        const optionId = CVE_REPORT_FILTERS[filterName].items.find(item => item.label === optionName).value;\n        if (!filterData[filterName].includes(optionId)) { // uncheck\n            setFilterData({ ...filterData, [filterName]: [...filterData[filterName], optionId] });\n        }\n        else { // check\n            let index = filterData[filterName].indexOf(optionId);\n            let temp = filterData[filterName].slice();\n            temp.splice(index, 1);\n            setFilterData({ ...filterData, [filterName]: temp });\n        }\n    };\n\n    const handleOnRadioChange = (filterName, optionName) => {\n        const optionValue = CVE_REPORT_FILTERS[filterName].items.find(item => item.label === optionName).value;\n        setFilterData({ ...filterData, [filterName]: optionValue });\n    };\n\n    const handleCvssInputChange = (value, inputName) => {\n        setFilterData({\n            ...filterData, cvss_filter: {\n                ...filterData.cvss_filter,\n                [inputName]: value\n            }\n        });\n    };\n\n    const validateCvssInput = (inputName) => {\n        const valueThis = +filterData.cvss_filter[inputName];\n        const valueMin = +filterData.cvss_filter.min;\n        const valueMax = +filterData.cvss_filter.max;\n\n        if (valueThis < 0 || valueThis > 10 || valueMin > valueMax) {\n            return 'error';\n        }\n\n        return 'default';\n    };\n\n    const filterCheckboxes = (options, filterName) => (\n        <Select\n            variant=\"checkbox\"\n            aria-label=\"Select Input\"\n            onToggle={() => setOpen(!isOpen)}\n            isOpen={isOpen}\n            placeholderText={`${CVE_REPORT_FILTERS[filterName].title}: ${filterData[filterName].length === 0\n                || filterData[filterName].length === CVE_REPORT_FILTERS[filterName].items.length ? `All` :\n                filterData[filterName].map(id =>\n                    CVE_REPORT_FILTERS[filterName].items.find(item => item.value === id).label).join(', ')}`}\n            direction=\"up\"\n            key={filterName}\n            width='auto'\n            className=\"pf-u-mr-sm pf-u-mb-sm custom-report-filter-select\"\n            onSelect={(event, optionName) => { handleOnCheckboxChange(filterName, optionName); }}\n            selections={filterData[filterName].map(\n                id => CVE_REPORT_FILTERS[filterName].items.find(item => item.value === id).label)}\n            isCheckboxSelectionBadgeHidden\n        >\n            {options.map(item =>\n                <SelectOption\n                    key={filterName + item.label}\n                    value={item.label}\n                />\n            )}\n        </Select>\n    );\n\n    const filterRadios = (options, filterName) => (\n        <Select\n            variant=\"single\"\n            aria-label=\"Select Input\"\n            onToggle={() => setOpen(!isOpen)}\n            isOpen={isOpen}\n            placeholderText={`${CVE_REPORT_FILTERS[filterName].title}:\n                ${CVE_REPORT_FILTERS[filterName].items.find(item => item.value === filterData[filterName]).label}`}\n            direction=\"up\"\n            key={filterName}\n            onSelect={(event, optionName) => { handleOnRadioChange(filterName, optionName); }}\n            className=\"pf-u-mr-sm pf-u-mb-sm\"\n            width=\"auto\"\n        >\n            {options.map(item =>\n                <SelectOption\n                    width=\"100%\"\n                    key={filterName + item.label}\n                    value={item.label}\n                >\n                    <Radio\n                        aria-label=\"Select Input\"\n                        label={item.label}\n                        value={item.label}\n                        isChecked={filterData[filterName] === item.value}\n                    />\n                </SelectOption>\n            )}\n        </Select>\n    );\n\n    const filterCvssContent = (<Split className='pf-u-m-md'>\n        <SplitItem>\n            <span style={{ fontSize: 14 }}>{intl.formatMessage(messages.customReportCvssMinLabel)}</span><br />\n            <TextInput\n                type=\"number\"\n                onChange={(v) => handleCvssInputChange(v, 'min')}\n                validated={validateCvssInput('min')}\n                id=\"cvss-min\"\n                value={filterData.cvss_filter.min}\n                style={{ width: '5em' }}\n            />\n        </SplitItem>\n        <SplitItem>\n            <br /><span className=\"pf-u-m-sm\">-</span>\n        </SplitItem>\n        <SplitItem>\n            <span style={{ fontSize: 14 }}>{intl.formatMessage(messages.customReportCvssMaxLabel)}</span><br />\n            <TextInput\n                type=\"number\"\n                onChange={(v) => handleCvssInputChange(v, 'max')}\n                validated={validateCvssInput('max')}\n                id=\"cvss-max\"\n                value={filterData.cvss_filter.max}\n                style={{ width: '5em' }}\n            />\n        </SplitItem>\n    </Split>);\n\n    const filterCvssGetLabel = () => {\n        const min = +filterData.cvss_filter.min;\n        const max = +filterData.cvss_filter.max;\n\n        if (min === 0 && max === 10) {\n            return `${CVE_REPORT_FILTERS.cvss_filter.title}: ${intl.formatMessage(messages.optionsAll)}`;\n        }\n        else {\n            return (\n                <Text>\n                    {`${CVE_REPORT_FILTERS.cvss_filter.title}: ${parseFloat(min).toFixed(1)} - ${parseFloat(max).toFixed(1)}`}\n                    {(min < 0 || max > 10 || min > max) &&\n                        <ExclamationCircleIcon color={'var(--pf-global--danger-color--100)'} className=\"pf-u-ml-xs\" />}\n                </Text>\n            );\n        }\n    };\n\n    const filterCvssWrapper = (\n        <Select\n            variant=\"panel\"\n            aria-label=\"Select Input\"\n            customContent={filterCvssContent}\n            onToggle={() => setOpen(!isOpen)}\n            isOpen={isOpen}\n            placeholderText={filterCvssGetLabel()}\n            className=\"pf-u-mr-sm pf-u-mb-sm\"\n            direction=\"up\"\n            width=\"auto\"\n        />\n    );\n\n    const filterContent = name => {\n        switch (name) {\n            case 'status_id':\n                return filterCheckboxes(STATUS_OPTIONS, 'status_id');\n            case 'business_risk_id':\n                return filterCheckboxes(BUSINESS_RISK_OPTIONS, 'business_risk_id');\n            case 'publish_date':\n                return filterRadios(PUBLIC_DATE_OPTIONS, 'publish_date');\n            case 'impact':\n                return filterCheckboxes(IMPACT_OPTIONS, 'impact');\n            case 'cvss_filter':\n                return filterCvssWrapper;\n            default:\n                return null;\n        }\n    };\n\n    return (filterContent(filterName));\n};\n\nCustomReportFilter.propTypes = {\n    filterName: propTypes.string,\n    filterData: propTypes.object,\n    setFilterData: propTypes.func\n};\n\nexport default CustomReportFilter;\n","import React from 'react';\nimport propTypes from 'prop-types';\nimport {\n    Modal,\n    Button,\n    Form,\n    FormGroup,\n    TextInput,\n    Checkbox,\n    TextArea\n} from '@patternfly/react-core';\nimport CustomReportFilter from '../Reports/CustomReportFilter';\nimport { CVE_REPORT_FILTERS, PDF_REPORT_USER_NOTE_MAX_LENGTH } from '../../../Helpers/constants';\nimport messages from '../../../Messages';\nimport { intl } from '../../../Utilities/IntlProvider';\n\nconst ReportConfigModal = ({\n    isOpen: isModalOpen,\n    handleModalClose,\n    filterData,\n    setFilterData,\n    handleDownloadButton,\n    columnsToInclude,\n    setColumnsToInclude,\n    userNotes,\n    setUserNotes,\n    reportTitle,\n    setReportTitle\n\n}) => {\n\n    const activeFilters = ['publish_date', 'impact',  'cvss_filter', 'status_id', 'business_risk_id'];\n\n    const handleCheckboxChange = (parameter, value) => {\n        if (value) {\n            setColumnsToInclude([...columnsToInclude, parameter]);\n        } else {\n            setColumnsToInclude(\n                columnsToInclude.filter((item) => item !== parameter)\n            );\n        }\n    };\n\n    return (\n        <Modal\n            title={intl.formatMessage(messages.configModalTitle)}\n            id=\"custom-report-modal\"\n            isOpen={isModalOpen}\n            onClose={handleModalClose}\n            actions={[\n                <Button\n                    key=\"export\"\n                    variant=\"primary\"\n                    onClick={handleDownloadButton}\n                >\n                    {intl.formatMessage(messages.configModalExportReport)}\n                </Button>,\n                <Button\n                    key=\"cancel\"\n                    variant=\"secondary\"\n                    onClick={handleModalClose}\n                >\n                    {intl.formatMessage(messages.cancel)}\n                </Button>\n            ]}\n        >\n            <Form>\n                <FormGroup label={intl.formatMessage(messages.customReportTitleLabel)} fieldId=\"horizontal-form-name\">\n                    <TextInput\n                        value={reportTitle}\n                        onChange={(value) => setReportTitle(value)}\n                        type=\"text\"\n                        id=\"horizontal-form-name\"\n                    />\n                    <Checkbox\n                        id=\"hasRule\"\n                        key=\"hasRule\"\n                        label={intl.formatMessage(messages.customOnlyCvesWithRulesLabel)}\n                        isChecked={filterData.security_rule === 'true'}\n                        onChange={(newValue) =>\n                            setFilterData({ ...filterData, security_rule: newValue ? 'true' : undefined })\n                        }\n                        className=\"pf-u-mt-md\"\n                    />\n                </FormGroup>\n                <FormGroup\n                    label={intl.formatMessage(messages.customReportDataToIncludeLabel)}\n                    fieldId=\"horizontal-form-name\"\n                >\n                    <div style={{ columnCount: 2 }}>\n                        <Checkbox\n                            id=\"cve_id\"\n                            label=\"CVE ID\"\n                            isChecked\n                            isDisabled\n                            className=\"pf-u-mb-md\"\n                        />\n                        {\n                            Object.entries(CVE_REPORT_FILTERS).map(([key, value]) =>\n                                <Checkbox\n                                    id={key}\n                                    key={key}\n                                    label={value.title}\n                                    isChecked={columnsToInclude.includes(key)}\n                                    onChange={(newValue) =>\n                                        handleCheckboxChange(key, newValue)\n                                    }\n                                    className='pf-u-mb-md'\n                                />\n                            )\n                        }\n                    </div>\n                </FormGroup>\n                <FormGroup\n                    label={intl.formatMessage(messages.customReportFilterDataByLabel)}\n                    fieldId=\"horizontal-form-name\"\n                >\n                    <div className=\"custom-report-filter-wrapper\"> {/* Width of modal minus padding from both sides */}\n                        {activeFilters &&\n                            activeFilters.map((item) => {\n                                return (\n                                    <CustomReportFilter\n                                        key={item}\n                                        filterName={item}\n                                        filterData={filterData}\n                                        setFilterData={setFilterData}\n                                    />\n                                );\n                            })}\n                    </div>\n                </FormGroup>\n                <FormGroup\n                    label={intl.formatMessage(messages.customReportUserNotesLabel)}\n                    fieldId=\"horizontal-form-name\"\n                    helperTextInvalid={intl.formatMessage(messages.customReportUserNoteTooLong)}\n                    validated={userNotes.length > PDF_REPORT_USER_NOTE_MAX_LENGTH && 'error'}\n                >\n                    <TextArea\n                        value={userNotes}\n                        onChange={(value) => setUserNotes(value)}\n                        type=\"text\"\n                        id=\"horizontal-form-name\"\n                        resizeOrientation='vertical'\n                        style={{ minHeight: '4em' }}\n                        validated={userNotes.length > PDF_REPORT_USER_NOTE_MAX_LENGTH && 'error'}\n                    />\n                </FormGroup>\n            </Form>\n        </Modal>\n    );\n};\n\nReportConfigModal.propTypes = {\n    isOpen: propTypes.bool,\n    filterData: propTypes.object,\n    setFilterData: propTypes.func,\n    handleModalClose: propTypes.func,\n    handleDownloadButton: propTypes.func,\n    columnsToInclude: propTypes.array,\n    setColumnsToInclude: propTypes.func,\n    userNotes: propTypes.string,\n    setUserNotes: propTypes.func,\n    reportTitle: propTypes.string,\n    setReportTitle: propTypes.func\n};\n\nexport default ReportConfigModal;\n","import React,  { useState, useEffect } from 'react';\nimport { Page, Grid, GridItem, Card, CardTitle, CardBody, CardFooter } from '@patternfly/react-core';\nimport { Main } from '@redhat-cloud-services/frontend-components';\nimport { useDispatch } from 'react-redux';\nimport { FileAltIcon } from '@patternfly/react-icons';\nimport DownloadExecutive from './DownloadExecutive';\nimport ReportConfigModal from '../Modals/ReportConfigModal';\nimport messages from '../../../Messages';\nimport { intl } from '../../../Utilities/IntlProvider';\nimport { ChartPieSolid } from '../../PresentationalComponents/CustomIcons/CustomIcons';\nimport Header from '../../PresentationalComponents/Header/Header';\nimport DownloadCVEsReport from '../Reports/DownloadCVEsReport';\nimport { constructFilterParameters, buildFilters } from '../Reports/ReportsHelper';\nimport { addNotification, clearNotifications } from '@redhat-cloud-services/frontend-components-notifications/cjs/actions';\nimport { CVE_REPORT_FILTERS, DEFAULT_FILTER_DATA, PDF_REPORT_USER_NOTE_MAX_LENGTH } from '../../../Helpers/constants';\nimport styles from './Common/styles';\n\nconst ReportsPage = () => {\n    const [isModalOpen, setModalOpen] = useState(false);\n    const [downloadCVEReport, setDownloadCVEReport] = useState(false);\n    const [reportTitle, setReportTitle] = useState(intl.formatMessage(messages.customReportDefaultTitle));\n    const [userNotes, setUserNotes] = useState('');\n    const [columnsToInclude, setColumnsToInclude] = useState(Object.keys(CVE_REPORT_FILTERS));\n    const [filterData, setFilterData] = useState(DEFAULT_FILTER_DATA);\n    const dispatch = useDispatch();\n\n    const handleModalClose = () => {\n        setReportTitle(intl.formatMessage(messages.customReportDefaultTitle));\n        setUserNotes('');\n        setColumnsToInclude(Object.keys(CVE_REPORT_FILTERS));\n        setFilterData(DEFAULT_FILTER_DATA);\n        setDownloadCVEReport(false);\n        setModalOpen(false);\n    };\n\n    const handleDownloadButton = () => {\n        setDownloadCVEReport(true);\n        dispatch(addNotification({\n            dismissable: true,\n            variant: 'info',\n            title: intl.formatMessage(messages.customReportNotification)\n        }));\n\n        setModalOpen(false);\n    };\n\n    useEffect(() => {\n        return () => {\n            dispatch(clearNotifications());\n        };\n    }, [dispatch]);\n\n    return (\n        <Page>\n            <Header title={intl.formatMessage(messages.reportsPageTitle)} showBreadcrumb={false}/>\n            <Main>\n                <Grid hasGutter lg={3} md={4} sm={12}>\n                    <GridItem>\n                        <Card className=\"report-card\">\n                            <CardTitle>\n                                <ChartPieSolid style={styles.pieChartIcon}/>\n                                <span className=\"pf-u-ml-sm\" style={styles.cardTitle}>\n                                    {intl.formatMessage(messages.executiveReportCardTitle)}\n                                </span>\n                            </CardTitle>\n                            <CardBody>\n                                {intl.formatMessage(messages.executiveReportCardDescription)}\n                            </CardBody>\n                            <CardFooter>\n                                <DownloadExecutive/>\n                            </CardFooter>\n                        </Card>\n                    </GridItem>\n                    <GridItem>\n                        <Card className=\"report-card\">\n                            <CardTitle>\n                                <FileAltIcon size=\"lg\" color=\"var(--pf-global--link--Color)\"/>\n                                <span className=\"pf-u-ml-sm\" style={styles.cardTitle}>\n                                    {intl.formatMessage(messages.customReportCardTitle)}\n                                </span>\n                            </CardTitle>\n                            <CardBody>\n                                {intl.formatMessage(messages.customReportCardDescription)}\n                            </CardBody>\n                            <CardFooter>\n                                <a className=\"create-report\"\n                                    onClick={() => setModalOpen(true)}>{intl.formatMessage(messages.customReportCardButton)}\n                                </a>\n                            </CardFooter>\n                        </Card>\n                    </GridItem>\n                </Grid>\n            </Main>\n            <ReportConfigModal\n                isOpen={isModalOpen}\n                columnsToInclude={columnsToInclude}\n                setColumnsToInclude={setColumnsToInclude}\n                filterData={filterData}\n                userNotes={userNotes}\n                reportTitle={reportTitle}\n                setReportTitle={setReportTitle}\n                setUserNotes={setUserNotes}\n                setFilterData={setFilterData}\n                handleModalClose={(handleModalClose)}\n                handleDownloadButton={handleDownloadButton}\n            />\n\n            { downloadCVEReport && <DownloadCVEsReport\n                type='cves'\n                key=\"download\"\n                reportData={{\n                    header: columnsToInclude,\n                    reportTitle,\n                    userNotes\n                }}\n                showButton={false}\n                onSuccess={handleModalClose}\n                params={constructFilterParameters(filterData)}\n                filters={buildFilters(filterData)}\n                isReportDynamic\n                buttonProps={{\n                    isDisabled:\n                            +filterData.cvss_filter.min < 0 ||\n                            +filterData.cvss_filter.max > 10 ||\n                            +filterData.cvss_filter.min > +filterData.cvss_filter.max ||\n                            userNotes.length > PDF_REPORT_USER_NOTE_MAX_LENGTH,\n                    style: { marginRight: '0.5em' }\n                }}\n                label={messages.configModalExportReport}\n            />}\n        </Page>\n    );\n};\n\nexport default ReportsPage;\n"],"sourceRoot":""}