(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{1650:function(e,t,r){"use strict";r.r(t);var n=r(158),a=r.n(n),o=r(130),s=r.n(o),c=r(159),i=r.n(c),l=r(402),u=r.n(l),p=r(97),f=r.n(p),d=r(98),y=r.n(d),h=r(99),m=r.n(h),b=r(100),v=r.n(b),g=r(101),O=r.n(g),w=r(229),j=r(79),S=r(205),E=r(204),_=r(231),P=r(431),D=r(411),I=r(89),T=r(459),C=r(587),N=r.n(C),k=r(1),R=r.n(k),L=r(594),M=r.n(L),z=r(2),x=r.n(z),A=r(88),F=r(152),U=r(386),K=r(447),B=r(461),H=r(691),V=r(599),q=r(103),J=r(533),W=r(530),G=r(531),X=(r(1651),r(598)),Y=r(403),Q=r(596),Z=r(597),$=r(398),ee=r(26);function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(r,!0).forEach(function(t){u()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var ne=function(e){function t(e){var r;return f()(this,t),(r=m()(this,v()(t).call(this,e))).downloadReport=function(e){var t=r.state,n=t.opt_out,a=t.filter,o=Object(B.h)({opt_out:n,filter:a,data_format:e,page:1,page_size:Number.MAX_SAFE_INTEGER}).payload;o&&o.then(function(t){var r=t.data,n="json"===e?JSON.stringify(r):r;return Object(T.downloadFile)(n,"systems-".concat((new Date).toISOString()),e)})},r.apply=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.setState(re({},r.state,{},e),r.sendRequest)},r.sendRequest=function(){(0,r.props.fetchData)(re({},r.state)),r.createUrlParams(r.state)},r.createUrlParams=function(e){var t=re({},e),n=["filter","page","page_size"];Object.keys(e).forEach(function(e){return(void 0===t[e]||""===t[e]||!n.includes(e)||!1===t[e])&&delete t[e]});var a=M.a.stringify(t);r.props.history.push("?"+a)},r.addFilter=function(e,t,n){var a;a="radio"===n||"show_all"===e?u()({},e,t):r.state[e]?u()({},e,"".concat(r.state[e],",").concat(t)):u()({},e,t),r.apply(re({},a,{page:1}))},r.doOptOut=function(){r.state.selected.size>0&&r.props.optOutSystems(r.state.selected,!r.state.opt_out).then(function(){r.props.fetchData(re({},r.params(),{page:1})),!1===r.state.opt_out?r.props.addNotification({variant:"success",title:r.state.selected.size+r.props.intl.formatMessage($.a.systemsExcludedNotification)}):r.props.addNotification({variant:"success",title:r.state.selected.size+r.props.intl.formatMessage($.a.systemsResumedNotificationTitle),description:r.props.intl.formatMessage($.a.systemsResumedNotificationBody)}),r.setState({selected:new Set})})},r.onSelect=function(e){var t;!e.data||Array.isArray(e.data)?t=new Set(e.data):(t=r.state.selected,e.data.selected?t.add(e.data.id):t.delete(e.data.id)),r.setState({selected:t},r.props.selectMultiple)},r.getSelected=function(){return r.state.selected},r.params=function(){var e=r.state;return{filter:e.filter,opt_out:e.opt_out,page:e.page,page_size:e.page_size}},r.handleFilterChange=N()(function(e){var t=r.props.systems.meta.page_size;r.apply({filter:e,page_size:t,page:1})},400),r.handleRefresh=function(e){var t=e.page,n=e.per_page,a=r.props.systems.meta,o=r.props.fetchData;if(a.page!==t||a.page_size!==n){var s={page:t,page_size:n||a.page_size,filter:r.state.filter,opt_out:r.state.opt_out};o(s),r.createUrlParams(s)}},r.handleOptOut=function(){r.setState({opt_out:!r.state.opt_out,selected:new Set,page:1},r.sendRequest)},r.handleKebabToggle=function(e){r.setState({isKebabOpen:e})},r.handleKebabSelect=function(){r.setState({isKebabOpen:!r.state.isKebabOpen})},r.state={InventoryCmp:function(){return x.a.createElement("div",null,"Loading...")},filter:void 0,removeListener:function(){},columns:[{key:"display_name",title:r.props.intl.formatMessage($.a.systemsColumnHeaderName),composed:["facts.os_release","display_name"]},{key:"cve_count",title:r.props.intl.formatMessage($.a.systemsColumnHeaderCveCount)}],opt_out:!1,isKebabOpen:!1,selectListener:q.b.addNew({on:"SELECT_ENTITY",callback:function(e){return r.onSelect(e)}}),selectAllListener:q.b.addNew({on:"SELECT_ENTITIES",callback:function(e){return r.onSelect(e)}}),selected:new Set},r}var r;return O()(t,e),y()(t,[{key:"componentDidMount",value:function(){var e=M.a.parse(this.props.location.search);e.show_irrelevant="true"===e.show_irrelevant,e.show_irrelevant&&(e.show_all=void 0),this.fetchInventory(),this.apply(re({},e))}},{key:"shouldComponentUpdate",value:function(e){return!e.systems.isLoading}},{key:"fetchInventory",value:(r=i()(s.a.mark(function e(){var t,r,n,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,insights.loadInventory({react:x.a,reactRouterDom:F,reactCore:w,reactIcons:_,pfReactTable:P});case 2:t=e.sent,r=t.inventoryConnector,n=t.mergeWithEntities,a=t.mergeWithDetail,q.a.register(re({},n(Object(H.a)(this.state.columns,this.getSelected)),{},a())),this.setState({InventoryCmp:r(q.a.getStore()).InventoryTable}),this.state.removeListener();case 9:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,r=t.InventoryCmp,n=t.filter,o=this.props.systems,s=o.data,c=o.meta,i=s.map(function(e){var t=e.attributes,r=t.cve_count,n=a()(t,["cve_count"]);return re({cve_count:c.opt_out?"Excluded":r,id:e.attributes.inventory_id},n)}),l=[Object(G.e)(this.doOptOut,this.state.opt_out,{isDisabled:!this.getSelected().size}),Object(G.g)(this.handleOptOut,this.state.opt_out),Object(G.b)(this.downloadReport),Object(G.a)(this.downloadReport)];return x.a.createElement(j.a,null,x.a.createElement(J.a,{showBreadcrumb:!1}),x.a.createElement(D.Main,null,x.a.createElement(r,{hasCheckbox:0!==s.length,page:c.page,total:c.total_items,perPage:c.page_size,onRefresh:this.handleRefresh,items:i},x.a.createElement(S.a,{className:"systems-toolbar"},x.a.createElement(E.a,null,x.a.createElement(X.a,{selectedItems:this.state.selected,selectorHandler:this.props.selectRows,items:this.props.systems,fetchResource:function(t){return Object(B.h)(re({},e.params(),{},t))}})),x.a.createElement(E.a,null,x.a.createElement(Z.a,{placeholder:this.props.intl.formatMessage($.a.searchFilterByName),value:n,apply:this.apply})),x.a.createElement(E.a,null,x.a.createElement(W.a,{dropdownItems:l,disabled:0===s.length}))),x.a.createElement(D.TableToolbar,{className:"pf-u-pl-0 system-filter-chips"},x.a.createElement(S.a,null,x.a.createElement(E.a,null,x.a.createElement(Q.a,{filterValues:this.params(),filterCategories:[Y.t],apply:this.apply})))))))}}]),t}(x.a.Component);ne.propTypes={fetchData:R.a.func,systems:K.c,optOutSystems:R.a.func,addNotification:R.a.func,selectRows:R.a.func,selectMultiple:R.a.func,history:R.a.object,location:R.a.object,intl:R.a.any};t.default=Object(ee.c)(Object(U.a)(Object(A.connect)(function(e){return{systems:Object(V.a)(e)}},function(e){return{setHeader:function(t){return e(Object(B.n)(t))},fetchData:function(t){return e(Object(B.h)(t))},optOutSystems:function(t,r){return e(Object(B.k)(t,r))},addNotification:function(t){return e(Object(I.addNotification)(t))},selectRows:function(t,r){return e(Object(B.m)(t,r))},selectMultiple:function(){return e({type:"SELECT_MULTIPLE_ENTITIES"})}}})(ne)))},1651:function(e,t,r){var n=r(1652);"string"==typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r(8)(n,a);n.locals&&(e.exports=n.locals)},1652:function(e,t,r){(e.exports=r(6)(!1)).push([e.i,".systems-toolbar > div {\n  margin-right: var(--pf-global--spacer--sm); }\n\n.space-between-toolbar-items {\n  justify-content: space-between;\n  flex-wrap: nowrap; }\n  .space-between-toolbar-items > div {\n    flex-wrap: nowrap; }\n\n.vulnerability-toolbar-spacing {\n  justify-content: flex-start; }\n  .vulnerability-toolbar-spacing > div:not(:last-child) {\n    margin-right: var(--pf-global--spacer--sm); }\n\n.system-filter-chips {\n  order: 6;\n  flex-basis: 100%; }\n",""])},599:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"c",function(){return l}),r.d(t,"a",function(){return u});var n=r(402),a=r.n(n),o=r(690),s=r(529);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var i=Object(o.createSelector)([function(e){return e.CVEStore.cveDetails}],s.a),l=Object(o.createSelector)([function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(r,!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e.CVEStore.affectedSystemsByCVE,{cve:t})}],s.b),u=Object(o.createSelector)([function(e){return e.SystemsStore}],s.b)},690:function(e,t,r){"use strict";function n(e,t){return e===t}function a(e,t,r){if(null===t||null===r||t.length!==r.length)return!1;for(var n=t.length,a=0;a<n;a++)if(!e(t[a],r[a]))return!1;return!0}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,r=null,o=null;return function(){return a(t,r,arguments)||(o=e.apply(null,arguments)),r=arguments,o}}function s(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(e){return"function"==typeof e})){var r=t.map(function(e){return typeof e}).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+r+"]")}return t}function c(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];var c=0,i=n.pop(),l=s(n),u=e.apply(void 0,[function(){return c++,i.apply(null,arguments)}].concat(r)),p=o(function(){for(var e=[],t=l.length,r=0;r<t;r++)e.push(l[r].apply(null,arguments));return u.apply(null,e)});return p.resultFunc=i,p.recomputations=function(){return c},p.resetRecomputations=function(){return c=0},p}}t.__esModule=!0,t.defaultMemoize=o,t.createSelectorCreator=c,t.createStructuredSelector=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;if("object"!=typeof e)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);var r=Object.keys(e);return t(r.map(function(t){return e[t]}),function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t,n){return e[r[n]]=t,e},{})})};var i=t.createSelector=c(o)},691:function(e,t,r){"use strict";r.d(t,"a",function(){return f});var n=r(435),a=r.n(n),o=r(402),s=r.n(o);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(r,!0).forEach(function(t){s()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var l={columns:[],rows:[],entities:[]};function u(e,t,r){if(t.loaded){var n=r(),o=t.columns.filter(function(e){return"updated"===e.key});return i({},t,{rows:t.rows.filter(function(e){return e.insights_id}).map(function(e){return i({},e,{selected:n.has(e.id)})}),columns:[].concat(a()(e||[]),a()(o||[]))})}return t}function p(e,t){var r=t(),n=e.rows.slice();return i({},e,{rows:n.map(function(e){return i({},e,{selected:r.has(e.id)})})})}var f=function(e,t){return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"LOAD_ENTITIES_FULFILLED":return u(e,r,t);case"SELECT_MULTIPLE_ENTITIES":return p(r,t);default:return r}}}}}]);
//# sourceMappingURL=../sourcemaps/Systems.js.map