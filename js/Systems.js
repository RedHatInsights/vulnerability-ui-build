(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{1617:function(e,t,r){"use strict";r.r(t);var n=r(150),a=r.n(n),o=r(121),s=r.n(o),c=r(151),i=r.n(c),l=r(386),u=r.n(l),p=r(91),f=r.n(p),d=r(92),y=r.n(d),h=r(93),b=r.n(h),m=r(94),v=r.n(m),g=r(95),O=r.n(g),w=r(216),j=r(76),E=r(196),S=r(195),_=r(217),P=r(416),D=r(396),I=r(85),T=r(445),k=r(571),C=r.n(k),L=r(1),N=r.n(L),R=r(578),z=r.n(R),x=r(2),A=r.n(x),M=r(84),F=r(143),U=r(372),K=r(433),V=r(447),q=r(672),J=r(583),B=r(97),H=r(520),W=r(516),G=r(517),X=(r(1618),r(582)),Y=r(388),Q=r(580),Z=r(581);function $(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(r,!0).forEach(function(t){u()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var te=function(e){function t(e){var r;return f()(this,t),(r=b()(this,v()(t).call(this,e))).downloadReport=function(e){var t=r.state,n=t.opt_out,a=t.filter,o=Object(V.h)({opt_out:n,filter:a,data_format:e,page:1,page_size:Number.MAX_SAFE_INTEGER}).payload;o&&o.then(function(t){var r=t.data,n="json"===e?JSON.stringify(r):r;return Object(T.downloadFile)(n,"systems-".concat((new Date).toISOString()),e)})},r.apply=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.setState(ee({},r.state,{},e),r.sendRequest)},r.sendRequest=function(){(0,r.props.fetchData)(ee({},r.state)),r.createUrlParams(r.state)},r.createUrlParams=function(e){var t=ee({},e),n=["filter","page","page_size"];Object.keys(e).forEach(function(e){return(void 0===t[e]||""===t[e]||!n.includes(e)||!1===t[e])&&delete t[e]});var a=z.a.stringify(t);r.props.history.push("?"+a)},r.addFilter=function(e,t,n){var a;a="radio"===n||"show_all"===e?u()({},e,t):r.state[e]?u()({},e,"".concat(r.state[e],",").concat(t)):u()({},e,t),r.apply(ee({},a,{page:1}))},r.doOptOut=function(){r.state.selected.size>0&&r.props.optOutSystems(r.state.selected,!r.state.opt_out).then(function(){r.props.fetchData(ee({},r.params(),{page:1})),!1===r.state.opt_out?r.props.addNotification({variant:"success",title:r.state.selected.size+" systems successfully excluded from vulnerability analysis"}):r.props.addNotification({variant:"success",title:r.state.selected.size+" systems successfully resumed vulnerability analysis",description:"There may be 24 hours before data is available"}),r.setState({selected:new Set})})},r.onSelect=function(e){var t;!e.data||Array.isArray(e.data)?t=new Set(e.data):(t=r.state.selected,e.data.selected?t.add(e.data.id):t.delete(e.data.id)),r.setState({selected:t},r.props.selectMultiple)},r.getSelected=function(){return r.state.selected},r.params=function(){var e=r.state;return{filter:e.filter,opt_out:e.opt_out,page:e.page,page_size:e.page_size}},r.handleFilterChange=C()(function(e){var t=r.props.systems.meta.page_size;r.apply({filter:e,page_size:t,page:1})},400),r.handleRefresh=function(e){var t=e.page,n=e.per_page,a=r.props.systems.meta,o=r.props.fetchData;if(a.page!==t||a.page_size!==n){var s={page:t,page_size:n||a.page_size,filter:r.state.filter,opt_out:r.state.opt_out};o(s),r.createUrlParams(s)}},r.handleOptOut=function(){r.setState({opt_out:!r.state.opt_out,selected:new Set,page:1},r.sendRequest)},r.handleKebabToggle=function(e){r.setState({isKebabOpen:e})},r.handleKebabSelect=function(){r.setState({isKebabOpen:!r.state.isKebabOpen})},r.state={InventoryCmp:function(){return A.a.createElement("div",null,"Loading...")},filter:void 0,removeListener:function(){},columns:[{key:"display_name",title:"Name",composed:["facts.os_release","display_name"]},{key:"cve_count",title:"Applicable CVEs"},{key:"updated",title:"Last seen",isTime:!0}],opt_out:!1,isKebabOpen:!1,selectListener:B.b.addNew({on:"SELECT_ENTITY",callback:function(e){return r.onSelect(e)}}),selectAllListener:B.b.addNew({on:"SELECT_ENTITIES",callback:function(e){return r.onSelect(e)}}),selected:new Set},r}var r;return O()(t,e),y()(t,[{key:"componentDidMount",value:function(){var e=z.a.parse(this.props.location.search);e.show_irrelevant="true"===e.show_irrelevant,e.show_irrelevant&&(e.show_all=void 0),this.fetchInventory(),this.apply(ee({},e))}},{key:"shouldComponentUpdate",value:function(e){return!e.systems.isLoading}},{key:"fetchInventory",value:(r=i()(s.a.mark(function e(){var t,r,n,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,insights.loadInventory({react:A.a,reactRouterDom:F,reactCore:w,reactIcons:_,pfReactTable:P});case 2:t=e.sent,r=t.inventoryConnector,n=t.mergeWithEntities,a=t.mergeWithDetail,B.a.register(ee({},n(Object(q.a)(this.state.columns,this.getSelected)),{},a())),this.setState({InventoryCmp:r().InventoryTable}),this.state.removeListener();case 9:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,r=t.InventoryCmp,n=t.filter,o=this.props.systems,s=o.data,c=o.meta,i=s.map(function(e){var t=e.attributes,r=t.cve_count,n=a()(t,["cve_count"]);return ee({cve_count:c.opt_out?"Excluded":r,id:e.attributes.inventory_id},n)}),l=[Object(G.e)(this.doOptOut,this.state.opt_out,{isDisabled:!this.getSelected().size}),Object(G.g)(this.handleOptOut,this.state.opt_out),Object(G.b)(this.downloadReport),Object(G.a)(this.downloadReport)];return A.a.createElement(j.a,null,A.a.createElement(H.a,{showBreadcrumb:!1}),A.a.createElement(D.Main,null,A.a.createElement(r,{hasCheckbox:0!==s.length,page:c.page,total:c.total_items,perPage:c.page_size,onRefresh:this.handleRefresh,items:i},A.a.createElement(E.a,{className:"systems-toolbar"},A.a.createElement(S.a,null,A.a.createElement(X.a,{selectedItems:this.state.selected,selectorHandler:this.props.selectRows,items:this.props.systems,fetchResource:function(t){return Object(V.h)(ee({},e.params(),{},t))}})),A.a.createElement(S.a,null,A.a.createElement(Z.a,{placeholder:"Filter by name",value:n,apply:this.apply})),A.a.createElement(S.a,null,A.a.createElement(W.a,{dropdownItems:l}))),A.a.createElement(D.TableToolbar,{className:"pf-u-pl-0 system-filter-chips"},A.a.createElement(E.a,null,A.a.createElement(S.a,null,A.a.createElement(Q.a,{filterValues:this.params(),filterCategories:[Y.r],apply:this.apply})))))))}}]),t}(A.a.Component);te.propTypes={fetchData:N.a.func,systems:K.c,optOutSystems:N.a.func,addNotification:N.a.func,selectRows:N.a.func,selectMultiple:N.a.func,history:N.a.object,location:N.a.object};t.default=Object(U.a)(Object(M.connect)(function(e){return{systems:Object(J.a)(e)}},function(e){return{setHeader:function(t){return e(Object(V.n)(t))},fetchData:function(t){return e(Object(V.h)(t))},optOutSystems:function(t,r){return e(Object(V.k)(t,r))},addNotification:function(t){return e(Object(I.addNotification)(t))},selectRows:function(t,r){return e(Object(V.m)(t,r))},selectMultiple:function(){return e({type:"SELECT_MULTIPLE_ENTITIES"})}}})(te))},1618:function(e,t,r){var n=r(1619);"string"==typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r(7)(n,a);n.locals&&(e.exports=n.locals)},1619:function(e,t,r){(e.exports=r(6)(!1)).push([e.i,".systems-toolbar > div {\n  margin-right: var(--pf-global--spacer--sm); }\n\n.space-between-toolbar-items {\n  justify-content: space-between;\n  flex-wrap: nowrap; }\n  .space-between-toolbar-items > div {\n    flex-wrap: nowrap; }\n\n.vulnerability-toolbar-spacing {\n  justify-content: flex-start; }\n  .vulnerability-toolbar-spacing > div:not(:last-child) {\n    margin-right: var(--pf-global--spacer--sm); }\n\n.system-filter-chips {\n  order: 6;\n  flex-basis: 100%; }\n",""])},583:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"c",function(){return l}),r.d(t,"a",function(){return u});var n=r(386),a=r.n(n),o=r(671),s=r(515);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var i=Object(o.createSelector)([function(e){return e.CVEStore.cveDetails}],s.a),l=Object(o.createSelector)([function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(r,!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e.CVEStore.affectedSystemsByCVE,{cve:t})}],s.b),u=Object(o.createSelector)([function(e){return e.SystemsStore}],s.b)},671:function(e,t,r){"use strict";function n(e,t){return e===t}function a(e,t,r){if(null===t||null===r||t.length!==r.length)return!1;for(var n=t.length,a=0;a<n;a++)if(!e(t[a],r[a]))return!1;return!0}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,r=null,o=null;return function(){return a(t,r,arguments)||(o=e.apply(null,arguments)),r=arguments,o}}function s(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(e){return"function"==typeof e})){var r=t.map(function(e){return typeof e}).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+r+"]")}return t}function c(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];var c=0,i=n.pop(),l=s(n),u=e.apply(void 0,[function(){return c++,i.apply(null,arguments)}].concat(r)),p=o(function(){for(var e=[],t=l.length,r=0;r<t;r++)e.push(l[r].apply(null,arguments));return u.apply(null,e)});return p.resultFunc=i,p.recomputations=function(){return c},p.resetRecomputations=function(){return c=0},p}}t.__esModule=!0,t.defaultMemoize=o,t.createSelectorCreator=c,t.createStructuredSelector=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;if("object"!=typeof e)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);var r=Object.keys(e);return t(r.map(function(t){return e[t]}),function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t,n){return e[r[n]]=t,e},{})})};var i=t.createSelector=c(o)},672:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var n=r(386),a=r.n(n);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(r,!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var c={columns:[],rows:[],entities:[]};function i(e,t,r){if(t.loaded){var n=r();return s({},t,{rows:t.rows.filter(function(e){return e.insights_id}).map(function(e){return s({},e,{selected:n.has(e.id)})}),columns:e})}return t}function l(e,t){var r=t(),n=e.rows.slice();return s({},e,{rows:n.map(function(e){return s({},e,{selected:r.has(e.id)})})})}var u=function(e,t){return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"LOAD_ENTITIES_FULFILLED":return i(e,r,t);case"SELECT_MULTIPLE_ENTITIES":return l(r,t);default:return r}}}}}]);
//# sourceMappingURL=../sourcemaps/Systems.js.map