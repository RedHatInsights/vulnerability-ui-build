(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{1568:function(e,t,n){"use strict";n.d(t,"o",(function(){return r})),n.d(t,"n",(function(){return a})),n.d(t,"s",(function(){return i})),n.d(t,"r",(function(){return s})),n.d(t,"l",(function(){return o})),n.d(t,"p",(function(){return c})),n.d(t,"x",(function(){return u})),n.d(t,"y",(function(){return l})),n.d(t,"q",(function(){return p})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return y})),n.d(t,"t",(function(){return m})),n.d(t,"w",(function(){return b})),n.d(t,"u",(function(){return v})),n.d(t,"v",(function(){return g})),n.d(t,"i",(function(){return E})),n.d(t,"j",(function(){return _})),n.d(t,"k",(function(){return O})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return S})),n.d(t,"g",(function(){return j})),n.d(t,"h",(function(){return w})),n.d(t,"f",(function(){return P})),n.d(t,"m",(function(){return L}));var r="FETCH_CVE_LIST",a="FETCH_CVE_DETAILS",i="HANDLE_CVE_DETAILS_ERROR",s="FETCH_SYSTEM_DETAILS",o="FETCH_AFFECTED_SYSTEMS_BY_CVE",c="FETCH_SYSTEMS",u="SET_HEADER",l="SYSTEM_OPT_OUT",p="FETCH_SYSTEM_CVE_LIST",d="CHANGE_SYSTEM_CVE_STATUS",f="CHANGE_EXPOSED_SYSTEMS_PARAMETERS",y="CHANGE_CVE_LIST_PARAMETERS",m="SELECT_CVE",b="SELECT_SYSTEM_CVE",v="SELECT_ENTITIES",g="SELECT_MULTIPLE_ENTITIES",E="EXPAND_CVE",_="EXPAND_ROW",O="EXPAND_SYSTEM_CVE",h="CHANGE_SYSTEMS_PARAMS",S="CHANGE_SYSTEM_CVE_LIST_PARAMETERS",j="CLEAR_SYSTEMS_STORE",w="CLEAR_SYSTEM_CVES_STORE",P="CLEAR_CVE_STORE",L="FETCH_AFFECTED_SYSTEM_IDS_BY_CVE"},1569:function(e,t,n){"use strict";n.d(t,"x",(function(){return T})),n.d(t,"k",(function(){return C})),n.d(t,"q",(function(){return D})),n.d(t,"m",(function(){return k})),n.d(t,"r",(function(){return x})),n.d(t,"p",(function(){return R})),n.d(t,"n",(function(){return A})),n.d(t,"s",(function(){return I})),n.d(t,"o",(function(){return M})),n.d(t,"t",(function(){return N})),n.d(t,"a",(function(){return F})),n.d(t,"b",(function(){return V})),n.d(t,"c",(function(){return H})),n.d(t,"u",(function(){return Y})),n.d(t,"h",(function(){return z})),n.d(t,"w",(function(){return B})),n.d(t,"j",(function(){return G})),n.d(t,"i",(function(){return U})),n.d(t,"v",(function(){return q})),n.d(t,"d",(function(){return X})),n.d(t,"g",(function(){return J})),n.d(t,"f",(function(){return W})),n.d(t,"e",(function(){return K})),n.d(t,"l",(function(){return Q}));var r=n(591),a=n(597),i=n(308),s=n(1568),o=n(1570),c=n.n(o),u=c()({title:"Vulnerability",breadcrumbs:[]}),l=n(126),p=n.n(l);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(n,!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y,m=c()({affectedSystemsByCVE:{isLoading:!0,openedRows:[],payload:{meta:{total_items:0,page:1,page_size:20}}},parameters:{page:1,page_size:20,selectedHosts:[],security_rule:void 0,status_id:void 0},cveDetails:{isLoading:!0,payload:{},error:!1}}),b=n(596);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(n,!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E={parameters:{page:1,page_size:20},cveList:{isLoading:!0,payload:[],meta:new Date,error:!1},openedCves:[],selectedCves:[],expandCveDescription:!1};var _=Object(b.a)((y={},p()(y,"".concat(s.q,"_PENDING"),(function(e,t){return g({},e,{timestamp:t.meta,cveList:g({},e.cveList,{isLoading:!0})})})),p()(y,"".concat(s.q,"_REJECTED"),(function(e,t){return g({},e,{timestamp:t.meta,cveList:{payload:{errors:t.payload},isLoading:!1}})})),p()(y,"".concat(s.q,"_FULFILLED"),(function(e,t){var n=t.payload,r=t.meta;return r>=e.timestamp?g({},e,{timestamp:r,cveList:{payload:n,isLoading:!1}}):e})),p()(y,"CHANGE_SYSTEM_CVE_LIST_PARAMETERS",(function(e,t){var n=e;return n.parameters=g({},e.parameters,{},t.payload),n})),p()(y,"SELECT_SYSTEM_CVE",(function(e,t){var n=e,r=n.selectedCves.slice();return Array.isArray(t.payload)?r=t.payload:r.includes(t.payload)&&r.splice(r.indexOf(t.payload),1)||r.push(t.payload),g({},n,{selectedCves:r})})),p()(y,"EXPAND_SYSTEM_CVE",(function(e,t){var n=e,r=t.payload,a=r.isOpen,i=r.cves,s=r.expandCveDescription,o=n.openedCves.slice();return i.length>0?i.map((function(e){var t=o.findIndex((function(t){return t.id===e}));t>-1?o[t]={id:e,isOpen:a}:o.push({id:e,isOpen:a})})):o=o.map((function(e){return{id:e.id,isOpen:!1}})),g({},n,{openedCves:o,expandCveDescription:s})})),p()(y,"CLEAR_SYSTEM_CVES_STORE",(function(e){var t=e;return t.selectedCves=[],t.openedCves=[],t.parameters={page:1,page_size:20},t})),y),E);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(n,!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S={isLoading:!0,payload:{},metadata:{page:1,limit:20,offet:0,total_items:0},params:{filter:void 0,opt_out:!1,page:1,page_size:20}};function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(n,!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P={cveList:{isLoading:!0,payload:[],timestamp:new Date},parameters:{show_all:"true",sort:"-public_date",selectedCves:[],openedCves:[],expandCveDescription:!1}};function L(e,t){return t>=e}i.a.register({CVEStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case s.s:return e.setIn(["cveDetails","error"],t.payload.error).setIn(["cveDetails","isLoading"],!1);case s.n+"_PENDING":return e.setIn(["cveDetails","isLoading"],!0);case s.n+"_FULFILLED":return e.setIn(["cveDetails","payload"],t.payload).setIn(["cveDetails","isLoading"],!1);case s.l+"_PENDING":return e.setIn(["affectedSystemsByCVE","isLoading"],!0);case s.l+"_FULFILLED":return e.setIn(["affectedSystemsByCVE","payload"],t.payload).setIn(["affectedSystemsByCVE","isLoading"],!1);case s.b:return e.setIn(["parameters"],f({},e.parameters,{},t.payload,{page_size:t.payload.page_size||e.parameters.page_size}));case s.f:return m;default:return e}}}),i.a.register({VulnerabilitiesStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0,n=w({},e);switch(t.type){case s.o+"_PENDING":return n.cveList.isLoading=!0,n.cveList.timestamp=t.meta,n;case s.o+"_REJECTED":return n.cveList.isLoading=!1,n.cveList.payload={errors:t.payload},n;case s.o+"_FULFILLED":return L(e.cveList.timestamp,t.meta)?(n.cveList.payload=t.payload,n.cveList.isLoading=!1,n.cveList.timestamp=t.meta,n):e;case s.a+"_FULFILLED":return n.parameters=w({},n.parameters,{},t.payload),n;case s.t:var r=n.parameters.selectedCves.slice();return Array.isArray(t.payload)?r=t.payload:r.includes(t.payload)&&r.splice(r.indexOf(t.payload),1)||r.push(t.payload),w({},n,{parameters:w({},n.parameters,{selectedCves:r})});case s.i:if(Array.isArray(t.payload)){var a=t.payload,i=0!==t.payload.length;return w({},n,{parameters:w({},n.parameters,{openedCves:a,expandCveDescription:i})})}var o=n.cveList.payload.data[t.payload/2].id,c=n.parameters.openedCves.slice();c.includes(o)&&c.splice(c.indexOf(o),1)||c.push(o);var u=c.length===n.cveList.payload.data.length;return w({},n,{parameters:w({},n.parameters,{openedCves:c,expandCveDescription:u})});default:return e}}}),i.a.register({SystemsStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0,n=h({},e);switch(t.type){case s.p+"_PENDING":return n.isLoading=!0,n;case s.p+"_FULFILLED":return n.payload=t.payload,n.metadata=t.payload.meta,n.isLoading=!1,n;case s.c:return n.params=h({},n.params,{},t.payload,{page_size:t.payload.page_size||n.params.page_size}),n;case s.g:return S;default:return e}}}),i.a.register({BreadcrumbStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case s.x+"_FULFILLED":return e.set("title",t.payload&&t.payload.title||u.title).set("breadcrumbs",t.payload&&t.payload.breadcrumbs||u.breadcrumbs);default:return e}}}),i.a.register({SystemCvesStore:_});var T=function(e){return{type:s.x,payload:new Promise((function(t){t(a.b(e))})).then((function(e){return e}))}},C=function(e,t){return{type:s.l,payload:new Promise((function(n){n(r.a(e,t))})).then((function(e){return e}))}},D=function(e){return{type:s.p,payload:new Promise((function(t){t(r.h(e))})).then((function(e){return e}))}},k=function(e){return{type:s.n,payload:new Promise((function(t){t(r.c(e))})).then((function(e){return e}))}},x=function(){return{type:s.s,payload:{error:!0}}},R=function(e){return{type:s.r,meta:{noError:!0},payload:new Promise((function(t){t(r.g(e))})).then((function(e){return e}))}},A=function(e){return{type:s.o,meta:new Date,payload:r.d(e)}},I=function(e,t){return{type:s.y,payload:new Promise((function(n){n(r.i(e,t))})).then((function(e){return e}))}},M=function(e){return{type:s.q,meta:new Date,payload:r.e(e)}},N=function(e,t){return{type:s.y,payload:new Promise((function(n){n(r.j(e,t))})).then((function(e){return e}))}},F=function(e){return{type:s.a,payload:new Promise((function(t){t(e)})).then((function(e){return e}))}},V=function(e){return{type:s.b,payload:e}},H=function(e){return{type:s.d,payload:e}},Y=function(e){return{type:s.t,payload:e}},z=function(e){return{type:s.i,payload:e}},B=function(e){return{type:s.w,payload:e}},G=function(e){return{type:s.k,payload:e}},U=function(e,t){return{type:s.j,payload:{id:e,isOpen:t}}},q=function(e){return{type:s.v,payload:e}},X=function(e){return{type:s.c,payload:e}},J=function(){return{type:s.g,payload:[]}},W=function(){return{type:s.h,payload:[]}},K=function(){return{type:s.f,payload:[]}},Q=function(e,t){return{type:s.m,payload:r.b(e,t)}}},1572:function(e,t,n){"use strict";n.d(t,"b",(function(){return C})),n.d(t,"c",(function(){return D})),n.d(t,"a",(function(){return k})),n.d(t,"d",(function(){return R})),n.d(t,"e",(function(){return A})),n.d(t,"f",(function(){return I})),n.d(t,"g",(function(){return M}));var r=n(126),a=n.n(r),i=n(64),s=n(404),o=n.n(s),c=n(309),u=n.n(c),l=n(250),p=n(2),d=n.n(p),f=n(29),y=n(274),m=n(307),b=n.n(m),v=n(162),g=n(164),E=n(0),_=n.n(E),O=n(1528),h=n(189),S=n(188),j=n(6),w=function(e){var t=e.rule,n=e.cve;return d.a.createElement(p.Fragment,null,t?d.a.createElement(p.Fragment,null,d.a.createElement(g.TextContent,{className:"icon-with-label"},d.a.createElement(v.Text,{component:v.TextVariants.h3,style:{paddingLeft:"var(--pf-global--spacer--lg)"}},d.a.createElement(S.a,null,d.a.createElement(i.Tooltip,{content:d.a.createElement(y.a,j.a.rulesIconTooltip)},d.a.createElement(h.a,null))),d.a.createElement("span",{className:"rule-name"},t.rule.description||t.rule.rule_id))),d.a.createElement(O.a,{report:t})):d.a.createElement(P,{cve:n}))};w.propTypes={rule:_.a.shape({rule:_.a.object,details:_.a.object,resulotion:_.a.object}).isRequired,cve:_.a.string};var P=function(e){var t=e.cve;return d.a.createElement(g.TextContent,{className:"icon-with-label"},d.a.createElement(v.Text,{component:v.TextVariants.p},d.a.createElement(y.a,b()({},j.a.exposedSystemNoRules,{values:{cve:t}}))),d.a.createElement(v.Text,{component:v.TextVariants.p},d.a.createElement(y.a,j.a.exposedSystemNoRulesInfo)," ",d.a.createElement(h.a,null),d.a.createElement("br",null),d.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://access.redhat.com/articles/2968471"},d.a.createElement(y.a,j.a.exposedSystemNoRulesInfoLink))))};function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(n,!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}P.propTypes={cve:_.a.string};var C=function(e){var t=e.isLoading,n=e.payload,r=e.openedRows,a=e.cve;if(t)return{data:n&&n.data||[],meta:{},isLoading:t};var i=n.data,s=n.meta;return{data:i.map((function(e){return T({},e.attributes,{id:e.id,isOpen:r.includes(e.id),status:e.attributes.status_name,children:e.attributes.rule?d.a.createElement(w,{cve:a,rule:e.attributes.rule}):d.a.createElement(P,{cve:a})})})),meta:s,isLoading:t}};function D(e){var t=e.isLoading;if(!t){var n=e.payload.asMutable(),r=n.data,a=n.meta;return{data:r.map((function(e){return T({},e,{attributes:T({},e.attributes,{status:d.a.createElement("span",null,e.attributes.cve_status_id!==e.attributes.status_id?d.a.createElement(i.Tooltip,{content:d.a.createElement(y.a,j.a.onlyThisSystemCvePair)},d.a.createElement(u.a,null)):""," ",void 0!==e.attributes.status_id&&f.r.find((function(t){return parseInt(t.value)===e.attributes.status_id})).label)})})})),meta:a,isLoading:t}}return{data:e.payload&&e.payload.data||[],meta:{},isLoading:t}}function k(e){var t,n=e.isLoading,r=e.error;if(!n&&!r){var a=e.payload.asMutable(),i=a.data,s=a.meta;return{data:i={impact:i.attributes.impact,public_date:Object(l.processDate)(i.attributes.public_date),description:i.attributes.description,synopsis:i.attributes.synopsis,rh_link:(t=i.attributes.synopsis,d.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://access.redhat.com/security/cve/"+t},d.a.createElement(y.a,j.a.RHDBLink),d.a.createElement(o.a,{className:"pf-u-ml-sm"}))),mitre_link:x(i.attributes.synopsis),cvss3_score:i.attributes.cvss3_score,cvss2_score:i.attributes.cvss2_score,cvss2_metrics:i.attributes.cvss2_metrics,cvss3_metrics:i.attributes.cvss3_metrics,business_risk:f.b.find((function(e){return e.value===i.attributes.business_risk_id.toString()})).label,business_risk_justification:i.attributes.business_risk_text,business_risk_id:i.attributes.business_risk_id,status:f.r.find((function(e){return e.value===i.attributes.status_id.toString()})).label,status_id:i.attributes.status_id,status_justification:i.attributes.status_text,systems_status_detail:i.attributes.systems_status_detail,systems_status_divergent:i.attributes.systems_status_divergent,rules:i.attributes.rules},meta:s,isLoading:n}}return{data:[],meta:{},isLoading:n,error:r}}function x(e){return d.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://cve.mitre.org/cgi-bin/cvename.cgi?name="+e},d.a.createElement(y.a,j.a.MITRELink),d.a.createElement(o.a,null))}var R=function(e){return[{title:d.a.createElement(y.a,j.a.editBusinessRisk),onClick:function(t,n,r){return e.showBusinessRiskModal([{id:r.id,business_risk_id:r.business_risk_id,justification:r.business_risk_justification}])}},{title:d.a.createElement(y.a,j.a.editStatus),onClick:function(t,n,r){return e.showStatusModal([{id:r.id,status_id:r.status_id,justification:r.status_justification}])}}]},A=function(e){return[{title:d.a.createElement(y.a,j.a.editStatus),onClick:function(t,n,r){return e.showStatusModal([{id:r.id,status_id:r.status_id,cve_status_id:r.cve_status_id,justification:r.status_justification,cve_justification:r.cve_status_justification}])}}]},I=function(e,t){return[{title:d.a.createElement(y.a,j.a.editStatus),onClick:function(n,r,a){e([{id:t.id,status_id:t.status_id,justification:t.justification}],[{id:a.id,status_id:a.status_id,justification:a.status_text}])}}]},M=function(e,t){return[{title:d.a.createElement(y.a,t?j.a.kebabResumeAnalysis:j.a.kebabExcludeAnalysis),onClick:function(t,n,r){e([r.id])}}]}},1573:function(e,t,n){"use strict";var r=n(1580),a=n.n(r),i=n(6),s=n(15);t.a=function(e){var t=e.selectedItems,n=e.selectorHandler,r=e.items,o=e.fetchResource,c=e.multiRow,u=void 0!==c&&c,l=Array.from(t),p=l&&l.length,d=r.meta,f=r.data,y=Array.isArray(f)&&f.length&&u?f.length/2:f.length,m=function(){n(!1,[])},b=function(){var e=(o&&o({page_size:d.total_items,page:1})).payload;e&&e.then((function(e){var t=e.data.map((function(e){return e.id&&e.id||e}));n(!0,t)}))};return{handleOnCheckboxChange:function(){0===p?b():m()},items:[{title:s.a.formatMessage(i.a.selectNone),onClick:m},{title:"".concat(s.a.formatMessage(i.a.selectPage,{count:y})),onClick:function(){var e=r.data,t=a()(e.filter((function(e){return e.id})).map((function(e){return e.id})),l);n(!0,t)}},{title:"".concat(s.a.formatMessage(i.a.selectAll,{count:d.total_items?d.total_items:0})),onClick:b}]}}},1574:function(e,t,n){"use strict";var r=n(104),a=n.n(r),i=n(126),s=n.n(i),o=n(165),c=n.n(o),u=n(829),l=n.n(u),p=n(143),d=n.n(p),f=n(250);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(n,!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=new function e(){var t=this;d()(this,e),this.filename=function(e){switch(e){case"systems-exposed":return"vulnerability_systems-exposed-".concat(t.params.cve,"--").concat(t.defaultParams.date);case"system-list":return"vulnerability_systems--".concat(t.defaultParams.date);default:return"vulnerability_cves--".concat(t.defaultParams.date)}},this.checkTypes=function(e,n,r){if("function"!=typeof e)throw"exec expects the 1st param to be funtion. Received ".concat(l()(e));if(!t.pages.includes(n))throw"Page ".concat(n," does not exist");if(!t.formats.includes(r))throw"Format ".concat(r," is not supported")},this.exec=function(){var e=c()(a.a.mark((function e(n,r,i,s){var o,c,u,l,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.checkTypes(n,s,i),t.params.cve=Array.isArray(r)?r[0]:"",e.prev=2,!Array.isArray(r)){e.next=9;break}return e.next=6,n(t.params.cve,m({},r[1],{},t.defaultParams,{data_format:i}));case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,n(m({},r,{},t.defaultParams,{data_format:i}));case 11:e.t0=e.sent;case 12:return o=e.t0,c=o.payload,e.next=16,c;case 16:u=e.sent,l=u.data,p="json"===i?JSON.stringify(l):l,Object(f.downloadFile)(p,t.filename(s),i),e.next=25;break;case 22:throw e.prev=22,e.t1=e.catch(2),"".concat(e.t1);case 25:case"end":return e.stop()}}),e,null,[[2,22]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),this.defaultParams={page:1,page_size:Number.MAX_SAFE_INTEGER,date:(new Date).toISOString().replace(/[T:]/g,"-").split(".")[0]+"-utc"},this.params={cve:""},this.pages=["systems-exposed","system-cves","cves","system-list"],this.formats=["csv","json"]}},1575:function(e,t,n){"use strict";var r=n(163),a=n.n(r),i=n(828),s=n(15),o=n(830),c=n.n(o),u=n(2),l=n.n(u);t.a=function(e,t,n,r){var o=l.a.useState(),u=a()(o,2),p=u[0],d=u[1],f=l.a.useState((function(){return c()((function(e){void 0!==e&&r({filter:e,page:1})}),400)})),y=a()(f,1)[0];return l.a.useEffect((function(){return d(n)}),[n]),{type:i.conditionalFilterType.text,label:s.a.formatMessage(e),filterValues:{"aria-label":"search-field",id:"search-".concat(e.id),onChange:function(e,t){d(t),y(t)},placeholder:s.a.formatMessage(t),value:p}}}},1576:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"e",(function(){return l}));var r=n(6),a=n(29),i=n(15),s=function(e,t,n){return n({page:t})},o=function(e,t,n){return n({page_size:t,page:1})},c=function(e){return i.a.formatMessage(r.a.kebabExportAsJson),i.a.formatMessage(r.a.kebabExportAsCsv),{onSelect:function(t,n){return e.downloadReport(n)}}},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.filter,s=Object.keys(a.i).reduce((function(n,r){if("show_all"!==r&&Object.keys(e).includes(r)&&!["",void 0].includes(e[r])){var i=e[r].split(","),s=i.reduce((function(e,n){return e.push(a.i[r].items.reduce((function(e,a){if(n===a.value)e.name=a.label,e.value=a.value;else if("security_rule"===r&&!["true","false"].includes(n)){var i=t.find((function(e){return e.value===n}));e.name=i&&i.label||n,e.value=n}return e}),{})),e}),[]);n.push({key:r,paramValues:i,category:a.i[r].title,chips:s})}return n}),[]);return n&&s.push({key:"filter",category:i.a.formatMessage(r.a.searchLabel),chips:[{name:n}]}),s},l=function(e,t){t(e.reduce((function(e,t){return"filter"===t.key||t.paramValues&&1===t.paramValues.length?e[t.key]="":e[t.key]=t.paramValues.filter((function(e){return!t.chips.some((function(t){return t.value===e}))})).join(","),e}),{}))}},1584:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(114),a=n.n(r),i=n(126),s=n.n(i);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(n,!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u={columns:[],rows:[],entities:[],selectedRows:[]};function l(e,t){if(t.selectedRows||(t.selectedRows=[]),t.loaded){var n=t.columns.filter((function(e){return"updated"===e.key}));return c({},t,{rows:t.rows.map((function(e){return c({},e,{selected:t.selectedRows.some((function(t){return t===e.id}))})})),columns:[].concat(a()(e||[]),a()(n||[]))})}return t}function p(e,t){var n=e.rows.slice();return e.selectedRows||(e.selectedRows=[]),c({},e,{rows:n.map((function(e){return c({},e,{selected:t.some((function(t){return t===e.id}))})})),selectedRows:a()(t)})}var d=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"LOAD_ENTITIES_FULFILLED":return l(e,t);case"SELECT_MULTIPLE_ENTITIES":return p(t,n.payload);case"EXPAND_ROW":return c({},t,{rows:t.rows.map((function(e){return c({},e,{isOpen:e.id===n.payload.id?n.payload.isOpen:e.isOpen})}))});default:return t}}}},1605:function(e,t,n){var r=n(1606);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(26)(r,a);r.locals&&(e.exports=r.locals)},1606:function(e,t,n){(e.exports=n(24)(!1)).push([e.i,".systems-toolbar > div {\n  margin-right: var(--pf-global--spacer--sm); }\n\n.space-between-toolbar-items {\n  justify-content: space-between;\n  flex-wrap: nowrap; }\n  .space-between-toolbar-items > div {\n    flex-wrap: nowrap; }\n\n.vulnerability-toolbar-spacing {\n  justify-content: flex-start; }\n  .vulnerability-toolbar-spacing > div:not(:last-child) {\n    margin-right: var(--pf-global--spacer--sm); }\n\n.system-filter-chips {\n  order: 6;\n  flex-basis: 100%; }\n",""])},1611:function(e,t,n){"use strict";n.r(t);var r=n(104),a=n.n(r),i=n(165),s=n.n(i),o=n(163),c=n.n(o),u=n(126),l=n.n(u),p=n(593),d=n.n(p),f=n(0),y=n.n(f),m=n(55),b=n(6),v=n(75),g=n(127),E=n(71),_=n(758),O=n(759),h=n(636),S=n(635),j=n(231),w=n(114),P=n.n(w),L=(n(1605),n(2)),T=n.n(L),C=n(121),D=n(251),k=n(1569),x=n(308),R=n(1573),A=n(1532),I=n(1575),M=n(1576),N=n(1574);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(n,!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var H=function(e){var t=e.selectedHosts,n=e.intl,r=e.parameters,a=e.systems,i=e.methods,s=i.apply,o=i.handleSelect,c=i.doOptOut,u=i.setSelectedHosts;x.b.addNew({on:"SELECT_ENTITY",callback:function(e){return function(e){var n=e.data.selected?[e.data.id].concat(P()(t)):t.filter((function(t){return t!==e.data.id}));o(!1,n)}(e)}});var l=["",{label:r.opt_out?n.formatMessage(b.a.kebabResumeAnalysis):n.formatMessage(b.a.kebabExcludeVulnerabilityAnalysis),onClick:function(){return c()},props:{isDisabled:!t.length}},{label:r.opt_out?n.formatMessage(b.a.kebabHideExcludedSystems):n.formatMessage(b.a.kebabShowExcludedSystems),onClick:function(){s({opt_out:!r.opt_out,page:1}),u([])}}],p=Object(R.a)({selectedItems:t,selectorHandler:o,items:a,fetchResource:function(e){return Object(k.q)(V({},r,{},e))}});return T.a.createElement(A.PrimaryToolbar,{bulkSelect:{count:t.length,items:p.items,isDisabled:0===a.meta.total_items&&0===t.length,checked:Boolean(t.length),onSelect:function(){return p.handleOnCheckboxChange()}},actionsConfig:{actions:l},filterConfig:{items:[Object(I.a)(b.a.systemsSearchName,b.a.searchFilterByName,r.filter,s)]},activeFiltersConfig:{filters:Object(M.a)(r),onDelete:function(e,t){return Object(M.e)(t,s)}},exportConfig:V({isDisabled:0===a.meta.total_items},Object(M.b)({downloadReport:function(e){var t=V({},r);N.a.exec(k.q,t,e,"system-list")}}))})};H.propTypes={systems:D.d,parameters:y.a.object,selectedHosts:y.a.array,methods:y.a.shape({doOptOut:y.a.func,apply:y.a.func,handleSelect:y.a.func,setSelectedHosts:y.a.func}),intl:y.a.any};var Y=Object(C.o)(Object(m.c)(H)),z=n(29),B=n(594),G=n(1572),U=n(595),q=n(592),X=n.n(q),J=n(1584);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(n,!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q=function(e){var t=e.intl,n=Object(L.useState)((function(){return function(){return T.a.createElement("div",null,"Loading...")}})),r=c()(n,2),i=r[0],o=r[1],u=Object(D.g)(z.s),l=c()(u,2),p=l[0],f=l[1],y=Object(L.useState)(!0),m=c()(y,2),w=m[0],P=m[1],C=Object(L.useState)(!1),R=c()(C,2),A=R[0],I=R[1],M=T.a.createRef(),N=Object(g.useDispatch)(),F=Object(g.useSelector)((function(e){return e.SystemsStore.payload})),V=Object(g.useSelector)((function(e){return e.SystemsStore.params})),H=Object(g.useSelector)((function(e){return e.SystemsStore.metadata})),q=Object(L.useState)(void 0),W=c()(q,2),Q=W[0],Z=W[1],$=Object(g.useSelector)((function(e){return e.SystemsStore.isLoading})),ee=Object(L.useMemo)((function(){return t=(e=F).data,n=e.meta,t&&t.map((function(e){var t=e.attributes,r=t.cve_count,a=d()(t,["cve_count"]);return K({cve_count:n.opt_out?"Excluded":r,id:e.attributes.inventory_id},a)}))||[];var e,t,n}),[F]),te=function(){var e=s()(a.a.mark((function e(){var t,n,r,i,s,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,insights.loadInventory({react:T.a,reactRouterDom:v,pfReactTable:{Table:E.b,TableBody:_.a,TableHeader:O.a,TableGridBreakpoint:E.d,cellWidth:h.a,TableVariant:E.e,sortable:S.a,expandable:j.b,SortByDirection:E.a}});case 2:t=e.sent,n=t.inventoryConnector,r=t.mergeWithEntities,i=t.mergeWithDetail,x.a.register(K({},r(Object(J.a)(z.v)),{},i())),s=n(x.a.getStore()),c=s.InventoryTable,o((function(){return c}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(L.useEffect)((function(){return te(),function(){N(Object(k.g)())}}),[]),Object(L.useEffect)((function(){Q&&N(Object(k.v)(Q))}),[Q,N]);var ne=function(e){N(Object(k.d)(e))};Object(L.useEffect)((function(){w?(ne(f),P(!1)):(N(Object(k.q)(V)),A&&p(K({},V))||I(!0))}),[V]);var re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(Q&&Q.length>0||e)&&N(Object(k.t)(e||Q,!V.opt_out)).then((function(){N(Object(k.q)(K({},V,{page:1}))),!1===V.opt_out?N(X()({variant:"success",title:t.formatMessage(b.a.systemsExcludedNotification,{count:e?1:Q.length||0})})):N(X()({variant:"success",title:t.formatMessage(b.a.systemsResumedNotificationTitle,{count:e?1:Q.length||0}),description:t.formatMessage(b.a.systemsResumedNotificationBody)})),Z([])}))};return T.a.createElement(L.Fragment,null,T.a.createElement(U.a,{showBreadcrumb:!1}),T.a.createElement(B.Main,null,i&&T.a.createElement(i,{ref:M,items:ee,page:H&&H.page||1,perPage:H&&H.page_size||20,total:H&&H.total_items||0,onRefresh:function(e){var t=e.page,n=e.per_page;H.page===t&&H.limit===n||ne({page:t,page_size:n}),H&&H.total_items<=n&&M.current&&M.current.onRefreshData({page:t,page_size:n})},isLoaded:!$,hasCheckbox:0!==F.length,actions:Object(G.g)(re,V.optOut)},F.data&&T.a.createElement(Y,{parameters:V,systems:F,selectedHosts:Q||[],methods:{doOptOut:re,apply:ne,handleSelect:function(e,t){t||(t=[]),Z(t)},setSelectedHosts:Z}}))))};Q.propTypes={intl:y.a.any};t.default=Object(m.c)(Q)}}]);
//# sourceMappingURL=../sourcemaps/Systems.js.map