(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1675:function(e,t,n){"use strict";var r=n(1663),a=n.n(r),o=n(8),s=n(11);t.a=function(e){var t=e.selectedItems,n=e.selectorHandler,r=e.items,c=e.fetchResource,i=e.multiRow,u=void 0!==i&&i,l=Array.from(t),f=l&&l.length,p=r.meta,d=r.data,b=Array.isArray(d)&&d.length&&u?d.length/2:d.length,m=function(){n(!1,[])},g=function(){var e=(c&&c({page_size:p.total_items,page:1})).payload;e&&e.then(function(e){var t=e.data.map(function(e){return e.id});n(!0,t)})};return{handleOnCheckboxChange:function(){0===f?g():m()},items:[{title:s.a.formatMessage(o.a.selectNone),onClick:m},{title:"".concat(s.a.formatMessage(o.a.selectPage,{count:b})),onClick:function(){var e=r.data,t=a()(e.filter(function(e){return e.id}).map(function(e){return e.id}),l);n(!0,t)}},{title:"".concat(s.a.formatMessage(o.a.selectAll,{count:p.total_items?p.total_items:0})),onClick:g}]}}},1676:function(e,t,n){"use strict";var r=n(306),a=n.n(r),o=n(304),s=n(11),c=n(8),i=n(909),u=n.n(i),l=n(2),f=n.n(l);t.a=function(e,t,n){var r=f.a.useState(),i=a()(r,2),l=i[0],p=i[1],d=f.a.useState(function(){return u()(function(e){void 0!==e&&n({filter:e,page:1})},400)}),b=a()(d,1)[0];return f.a.useEffect(function(){return p(t)},[t]),{type:o.conditionalFilterType.text,label:s.a.formatMessage(c.a.cve),filterValues:{onChange:function(e,t){p(t),b(t)},placeholder:e,value:l}}}},1677:function(e,t,n){"use strict";n.d(t,"c",function(){return u}),n.d(t,"d",function(){return l}),n.d(t,"b",function(){return f}),n.d(t,"e",function(){return p}),n.d(t,"a",function(){return d}),n.d(t,"f",function(){return b});var r=n(2),a=n.n(r),o=n(8),s=n(105),c=n(297),i=n(11),u=function(e,t,n){return n({page:t})},l=function(e,t,n){return n({page_size:t,page:1})},f=function(e){return i.a.formatMessage(o.a.kebabExportAsJson),i.a.formatMessage(o.a.kebabExportAsCsv),{onSelect:function(t,n){return e.downloadReport(n)}}},p=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={color:n?"":"black"};return a.a.createElement(c.a,{variant:"link",isInline:!0,key:e,isDisabled:n,style:r,onClick:t},e)},d=function(e){var t=e.filter,n=Object.keys(s.i).reduce(function(t,n){if("show_all"!==n&&Object.keys(e).includes(n)&&!["",void 0].includes(e[n])){var r=e[n].split(","),a=r.reduce(function(e,t){return e.push(s.i[n].items.reduce(function(e,n){return t===n.value&&(e.name=n.label,e.value=n.value),e},{})),e},[]);t.push({key:n,paramValues:r,category:s.i[n].title,chips:a})}return t},[]);return t&&n.push({key:"filter",category:i.a.formatMessage(o.a.searchLabel),chips:[{name:t}]}),n},b=function(e,t){t(e.reduce(function(e,t){return"filter"===t.key||t.paramValues&&1===t.paramValues.length?e[t.key]="":e[t.key]=t.paramValues.filter(function(e){return!t.chips.some(function(t){return t.value===e})}).join(","),e},{}))}},1678:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(167),a=n.n(r),o=n(305),s=n.n(o);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(n,!0).forEach(function(t){s()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var u={columns:[],rows:[],entities:[],selectedRows:[]};function l(e,t){if(t.selectedRows||(t.selectedRows=[]),t.loaded){var n=t.columns.filter(function(e){return"updated"===e.key});return i({},t,{rows:t.rows.map(function(e){return i({},e,{selected:t.selectedRows.some(function(t){return t===e.id})})}),columns:[].concat(a()(e||[]),a()(n||[]))})}return t}function f(e,t){var n=e.rows.slice();return e.selectedRows||(e.selectedRows=[]),i({},e,{rows:n.map(function(e){return i({},e,{selected:t.some(function(t){return t===e.id})})}),selectedRows:a()(t)})}var p=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"LOAD_ENTITIES_FULFILLED":return l(e,t);case"SELECT_MULTIPLE_ENTITIES":return f(t,n.payload);default:return t}}}},1762:function(e,t,n){var r=n(1763);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(22)(r,a);r.locals&&(e.exports=r.locals)},1763:function(e,t,n){(e.exports=n(20)(!1)).push([e.i,".systems-toolbar > div {\n  margin-right: var(--pf-global--spacer--sm); }\n\n.space-between-toolbar-items {\n  justify-content: space-between;\n  flex-wrap: nowrap; }\n  .space-between-toolbar-items > div {\n    flex-wrap: nowrap; }\n\n.vulnerability-toolbar-spacing {\n  justify-content: flex-start; }\n  .vulnerability-toolbar-spacing > div:not(:last-child) {\n    margin-right: var(--pf-global--spacer--sm); }\n\n.system-filter-chips {\n  order: 6;\n  flex-basis: 100%; }\n",""])},1768:function(e,t,n){"use strict";n.r(t);var r=n(139),a=n.n(r),o=n(222),s=n.n(o),c=n(306),i=n.n(c),u=n(305),l=n.n(u),f=n(561),p=n.n(f),d=n(1659),b=n.n(d),m=n(0),g=n.n(m),O=n(74),y=n(8),v=n(166),h=n(210),j=n(235),w=n(191),_=n(559),S=n(167),E=n.n(S),k=(n(1762),n(2)),P=n.n(k),R=n(157),C=n(343),D=n(1654),M=n(342),x=n(1675),T=n(304),H=n(1676),I=n(1655),N=n(1677);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var z=function(e){var t=Object(k.useState)(M.b.addNew({on:"SELECT_ENTITY",callback:function(t){return function(t){var n=t.data.selected?[t.data.id].concat(E()(e.selectedHosts)):e.selectedHosts.filter(function(e){return e!==t.data.id});e.handleSelect(!1,n)}(t)}})),n=(i()(t,1)[0],function(t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(n,!0).forEach(function(t){l()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t),r=["filter","page","page_size"];Object.keys(t).forEach(function(e){return(void 0===n[e]||""===n[e]||!r.includes(e)||!1===n[e])&&delete n[e]});var a=b.a.stringify(n);e.setFilter(t.filter),e.history.push("?"+a)}),r=function(t,r){var a=t.page,o=t.page_size,s=t.filter,c=t.opt_out,i=e.systems.meta;if(i.page!==a||i.page_size!==o){var u={page:a,page_size:o||i.page_size,filter:s,opt_out:c||e.params().opt_out};if(n(u),r)return r(u)}},a=["",Object(N.e)(e.params().opt_out?e.intl.formatMessage(y.a.kebabResumeAnalysis):e.intl.formatMessage(y.a.kebabExcludeVulnerabilityAnalysis),function(){return e.doOptOut()},!e.selectedHosts.length),Object(N.e)(e.params().opt_out?e.intl.formatMessage(y.a.kebabHideExcludedSystems):e.intl.formatMessage(y.a.kebabShowExcludedSystems),function(){return e.setOptOut(!e.params().opt_out),e.setSelectedHosts([]),void e.setPage(1)})],o=Object(x.a)({selectedItems:e.selectedHosts,selectorHandler:e.handleSelect,items:e.systems,fetchResource:function(e){return r(e,function(e){return Object(D.j)(e)})}});return P.a.createElement(T.PrimaryToolbar,{bulkSelect:{count:e.selectedHosts.length,items:o.items,checked:Boolean(e.selectedHosts.length),onSelect:function(){return o.handleOnCheckboxChange()}},actionsConfig:{actions:a,dropdownProps:{className:"custom-class"}},filterConfig:{items:[Object(H.a)(e.intl.formatMessage(y.a.searchLabel),e.params().filter,function(t){return r(t,e.onRefresh)})]},activeFiltersConfig:{filters:Object(N.a)(e.parameters),onDelete:function(t,n){return Object(N.f)(n,function(t){return r(t,e.onRefresh)})}},exportConfig:Object(N.b)({downloadReport:function(t){var n=(new Date).toISOString().replace(/[T:]/g,"-").split(".")[0]+"-utc",r=Object(D.j)({opt_out:e.params().opt_out,filter:e.params().filter,data_format:t,page:1,page_size:Number.MAX_SAFE_INTEGER}).payload;r&&r.then(function(e){var r=e.data,a="json"===t?JSON.stringify(r):r;return Object(I.downloadFile)(a,"vulnerability_systems--".concat(n),t)})}})})};z.propTypes={systems:C.c,params:g.a.func,setPage:g.a.func,setFilter:g.a.func,setOptOut:g.a.func,selectedHosts:g.a.array,setSelectedHosts:g.a.func,doOptOut:g.a.func,onRefresh:g.a.any,parameters:g.a.object,handleSelect:g.a.func,history:g.a.object,intl:g.a.any};var A=Object(R.o)(Object(O.c)(z)),F=n(1662),V=n(562),J=n(307),B=n(1678);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(n,!0).forEach(function(t){l()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var G=function(e){var t=Object(k.useState)(function(){return function(){return P.a.createElement("div",null,"Loading...")}}),n=i()(t,2),r=n[0],o=n[1],c=Object(k.useState)(b.a.parse(e.location.search).filter),u=i()(c,2),l=u[0],f=u[1],d=Object(k.useState)(void 0),m=i()(d,2),g=m[0],O=m[1],S=Object(k.useState)(!1),E=i()(S,2),R=E[0],C=E[1],x=Object(k.useState)(1),H=i()(x,2),I=H[0],N=H[1],L=Object(k.useState)(10),z=i()(L,1)[0],U=P.a.createRef(),G=Object(w.useDispatch)(),X=Object(w.useSelector)(function(e){return e.SystemsStore.payload}),Y=Object(w.useSelector)(function(e){return e.SystemsStore.params}),q=Object(w.useSelector)(function(e){return e.SystemsStore.metadata}),K=Object(w.useSelector)(function(e){return e.SystemsStore.isLoading}),Q=Object(k.useMemo)(function(){return t=(e=X).data,n=e.meta,t&&t.map(function(e){var t=e.attributes,r=t.cve_count,a=p()(t,["cve_count"]);return W({cve_count:n.opt_out?"Excluded":r,id:e.attributes.inventory_id},a)})||[];var e,t,n},[X]),Z=[{key:"display_name",title:e.intl.formatMessage(y.a.systemsColumnHeaderName),composed:["facts.os_release","display_name"]},{key:"cve_count",title:e.intl.formatMessage(y.a.systemsColumnHeaderCveCount)}],$=function(){return{filter:l,page_size:z,opt_out:R,page:I}};Object(k.useEffect)(function(){0!==Object.keys(Y).length&&Y.constructor===Object&&G(Object(D.j)(Y))},[Y,G]);var ee=function(){var e=s()(a.a.mark(function e(){var t,n,r,s,c,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,insights.loadInventory({react:P.a,reactRouterDom:v,reactCore:h,reactIcons:j,pfReactTable:_});case 2:t=e.sent,n=t.inventoryConnector,r=t.mergeWithEntities,s=t.mergeWithDetail,M.a.register(W({},r(Object(B.a)(Z)),{},s())),c=n(M.a.getStore()),i=c.InventoryTable,o(function(){return i});case 9:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();Object(k.useEffect)(function(){ee()},[]),Object(k.useEffect)(function(){g&&G(Object(D.p)(g))},[g,G]),Object(k.useEffect)(function(){K||G(Object(D.j)(W({},$())))},[R]);var te=function(e){var t=e.page,n=e.per_page,r=e.opt_out,a=e.filter;q.page===t&&q.page_size===n||G(Object(D.b)({page:t,per_page:n,opt_out:r||$().opt_out,filter:void 0===a?$().filter:a})),q.total_items<=n&&U.current&&U.current.onRefreshData({page:t,perPage:n,opt_out:r||$().opt_out,filter:a})},ne=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(g&&g.length>0||t)&&G(Object(D.m)(t||g,!R)).then(function(){G(Object(D.j)({filter:l,opt_out:R,page_size:z,page:1})),G(!1===R?Object(J.addNotification)({variant:"success",title:e.intl.formatMessage(y.a.systemsExcludedNotification,{count:g.length||t&&1||0})}):Object(J.addNotification)({variant:"success",title:e.intl.formatMessage(y.a.systemsResumedNotificationTitle,{count:g.length||t&&1||0}),description:e.intl.formatMessage(y.a.systemsResumedNotificationBody)})),O([])})};return P.a.createElement(k.Fragment,null,P.a.createElement(V.a,{showBreadcrumb:!1}),P.a.createElement(T.Main,null,r&&P.a.createElement(r,{ref:U,items:Q,page:q&&q.page||1,perPage:q&&q.page_size||20,total:q&&q.total_items||0,onRefresh:te,isLoaded:!K,hasCheckbox:0!==X.length,actions:Object(F.g)(ne,R)},X.data&&P.a.createElement(A,{params:$,systems:X,parameters:Y,selectedHosts:g||[],setSelectedHosts:O,setOptOut:C,setFilter:f,setPage:N,doOptOut:ne,onRefresh:te,handleSelect:function(e,t){t||(t=[]),O(t)}}))))};G.propTypes={location:g.a.object,intl:g.a.any};t.default=Object(O.c)(G)}}]);
//# sourceMappingURL=../sourcemaps/Systems.js.map