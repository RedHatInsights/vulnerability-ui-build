(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{1240:function(e,t,n){"use strict";n.d(t,"q",(function(){return r})),n.d(t,"p",(function(){return a})),n.d(t,"v",(function(){return o})),n.d(t,"n",(function(){return i})),n.d(t,"s",(function(){return c})),n.d(t,"B",(function(){return s})),n.d(t,"C",(function(){return u})),n.d(t,"u",(function(){return l})),n.d(t,"e",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return d})),n.d(t,"x",(function(){return m})),n.d(t,"A",(function(){return y})),n.d(t,"y",(function(){return b})),n.d(t,"z",(function(){return v})),n.d(t,"k",(function(){return E})),n.d(t,"l",(function(){return g})),n.d(t,"m",(function(){return _})),n.d(t,"c",(function(){return O})),n.d(t,"d",(function(){return h})),n.d(t,"i",(function(){return S})),n.d(t,"j",(function(){return j})),n.d(t,"g",(function(){return w})),n.d(t,"h",(function(){return C})),n.d(t,"f",(function(){return P})),n.d(t,"o",(function(){return T})),n.d(t,"t",(function(){return D})),n.d(t,"r",(function(){return L})),n.d(t,"w",(function(){return k}));var r="FETCH_CVE_LIST",a="FETCH_CVE_DETAILS",o="FETCH_SYSTEM_DETAILS",i="FETCH_AFFECTED_SYSTEMS_BY_CVE",c="FETCH_SYSTEMS",s="SET_HEADER",u="SYSTEM_OPT_OUT",l="FETCH_SYSTEM_CVE_LIST",p="CHANGE_SYSTEM_CVE_STATUS",f="CHANGE_EXPOSED_SYSTEMS_PARAMETERS",d="CHANGE_CVE_LIST_PARAMETERS",m="SELECT_CVE",y="SELECT_SYSTEM_CVE",b="SELECT_ENTITIES",v="SELECT_MULTIPLE_ENTITIES",E="EXPAND_CVE",g="EXPAND_ROW",_="EXPAND_SYSTEM_CVE",O="CHANGE_SYSTEMS_PARAMS",h="CHANGE_SYSTEM_CVE_LIST_PARAMETERS",S="CLEAR_SYSTEMS_STORE",j="CLEAR_SYSTEM_CVES_STORE",w="CLEAR_CVE_STORE",C="CLEAR_INVENTORY_STORE",P="CLEAR_CVEs_STORE",T="FETCH_AFFECTED_SYSTEM_IDS_BY_CVE",D="FETCH_SYSTEMS_IDS",L="FETCH_CVE_LIST_IDS",k="FETCH_SYTEM_DETAILS_IDS"},1254:function(e,t,n){"use strict";n.d(t,"d",(function(){return h})),n.d(t,"b",(function(){return S})),n.d(t,"e",(function(){return w})),n.d(t,"a",(function(){return C})),n.d(t,"f",(function(){return P})),n.d(t,"c",(function(){return T})),n.d(t,"g",(function(){return D})),n.d(t,"i",(function(){return L})),n.d(t,"h",(function(){return k}));var r=n(1238),a=n.n(r),o=n(264),i=n.n(o),c=n(655),s=n.n(c),u=n(1188),l=n.n(u),p=n(78),f=n(1354),d=n.n(f),m=n(3),y=n.n(m),b=n(0),v=n.n(b),E=n(42),g=n(1425),_=n.n(g);n(508);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var h=y.a.shape({data:y.a.oneOfType([y.a.object,y.a.array]),meta:y.a.object,isLoading:y.a.bool});function S(e,t){return e?(Object.keys(e).forEach((function(t){return(void 0===e[t]||""===e[t])&&delete e[t]})),t.map((function(t){return e[t]}))):[]}function j(e,t){if(e){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(n,!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);return Object.keys(e).forEach((function(e){return(void 0===n[e]||""===n[e]||!t.includes(e)||!1===n[e])&&delete n[e]})),n}}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=function(e){return"".concat(1==="".concat(e).length?"0":"").concat(e)},n=new Date(e);if(n instanceof Date&&!isNaN(n)){var r=n.getFullYear(),a=n.getMonth()+1,o=n.getDate();return"".concat(r,"-").concat(t(a),"-").concat(t(o))}return n}function C(e){if(Object.prototype.hasOwnProperty.call(e,"cvss_filter")){var t=E.f.find((function(t){return t.value===e.cvss_filter}));if(void 0===t&&void 0!==e.cvss_filter){var n=e.cvss_filter.split(/[^0-9]+/).filter((function(e){return parseFloat(e)})),r=a()(n,2);t={from:r[0],to:r[1]}}else void 0===t&&void 0===e.cvss_filter?t={from:void 0,to:void 0}:t&&"N/A"===t.label&&"from-1to-1"===e.cvss_filter&&(t={from:-1,to:-1});e.cvss_from=t.from,e.cvss_to=t.to}if(Object.prototype.hasOwnProperty.call(e,"publish_date")){var o=E.l.find((function(t){return t.value===e.publish_date}));void 0!==o?(e.public_from=o.from&&w(o.from),e.public_to=o.to&&w(o.to)):(e.public_from=void 0,e.public_to=void 0,e.publish_date=void 0)}return e}function P(e){return Object.keys(E.C).includes(e)?{title:E.C[e].title,color:E.C[e].color,text:E.C[e].text,titleContent:v.a.createElement(s.a,{size:"lg"})}:{title:"Unknown",color:E.B.unknown,text:"",titleContent:v.a.createElement(l.a,{size:"lg"})}}var T=function(e,t){if(t){var n=0===t.indexOf("-")?p.a.desc:p.a.asc;return t=t.replace(/^(-|\+)/,""),{index:d()(e,(function(e){return e.key===t})),direction:n}}return{}},D=function(e,t,n,r,a){var o=n[e].key,i=r&&r.substr(1)!==o;(t===p.a.desc||i)&&(o="-"+o),a({sort:o})},L=function(e){return[function(t){window.history.pushState({},"","".concat(window.location.pathname,"?").concat(_.a.stringify(j(t,e))))},_.a.parse(window.location.search)]},k=function(e,t){var n=parseInt(e.pages),r=parseInt(e.page),a=parseInt(e.cvesCount);t({page:n===r&&r>1&&1===a?n-1:r})}},1261:function(e,t,n){"use strict";n.d(t,"c",(function(){return g})),n.d(t,"i",(function(){return _})),n.d(t,"a",(function(){return O})),n.d(t,"j",(function(){return h})),n.d(t,"f",(function(){return S})),n.d(t,"l",(function(){return j})),n.d(t,"g",(function(){return w})),n.d(t,"p",(function(){return C})),n.d(t,"m",(function(){return P})),n.d(t,"n",(function(){return T})),n.d(t,"o",(function(){return D})),n.d(t,"h",(function(){return L})),n.d(t,"b",(function(){return k})),n.d(t,"k",(function(){return x})),n.d(t,"e",(function(){return I})),n.d(t,"d",(function(){return R}));var r=n(1426),a=n.n(r),o=n(1253),i=n.n(o),c=n(1189),s=n(264),u=n.n(s),l=n(1190),p=n(1185),f=n.n(p),d=n(42);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var y=f.a.create();y.interceptors.request.use(l.authInterceptor),y.interceptors.response.use(l.responseDataInterceptor),y.interceptors.response.use(null,l.interceptor401),y.interceptors.response.use(null,(function(e){if(e.response&&503===e.response.status)throw d.p;throw e})),y.interceptors.response.use(null,(function(e){if(!f.a.isCancel(e)){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(n,!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);if(t.response&&t.response.data&&t.response.data.errors)throw t.response.data.errors[0];throw e}}));var b=y,v=n(1254),E=new c.GitApi(void 0,"/api/vulnerability/",b);function g(e){return E.getCveDetails(e)}function _(e){return E.getSystemDetails(e)}function O(e,t){var n=Object(v.b)(t,["filter","limit","offset","page","page_size","sort","status_id","data_format","security_rule","rule_name"]);return E.getAffectedSystemsByCve.apply(E,[e].concat(i()(n)))}function h(e){var t=Object(v.b)(e,["filter","limit","offset","page","page_size","sort","data_format","stale","uuid","opt_out"]);return E.getSystemsList.apply(E,i()(t))}function S(e){var t=Object(v.b)(e,["filter","limit","offset","page","page_size","sort","cvss_from","cvss_to","public_from","public_to","impact","data_format","business_risk_id","status_id","security_rule","show_all"]);return E.getCveList.apply(E,i()(t))}function j(e,t){return E.setSystemOptOut(e,t)}function w(e){var t=e.system;if(e&&t){Object.keys(e).forEach((function(t){return(void 0===e[t]||""===e[t])&&delete e[t]}));var n=["filter","limit","offset","page","page_size","sort","cvss_from","cvss_to","public_from","public_to","impact","status_id","data_format","business_risk_id","security_rule"].map((function(t){return e[t]}));return E.getCveListBySystem.apply(E,[t].concat(i()(n))).catch((function(e){if(e&&"404"===e.status)return{errors:e};throw e}))}}function C(e){return E.setStatus(e)}function P(e,t){var n={opt_out:t,inventory_id:a()(Array,i()(e))};return E.setSystemsOptOut(n)}function T(e){return E.setCveBusinessRisk(e)}function D(e){return E.setCveStatus(e)}function L(){return E.getExecutiveReport()}function k(e,t){var n=Object(v.b)(t,["filter","limit","offset","page","page_size","sort","status_id","data_format","security_rule"]);return E.getAffectedSystemsIdsByCve.apply(E,[e].concat(i()(n)))}function x(e){var t=Object(v.b)(e,["filter","limit","offset","page","page_size","sort","data_format","stale","uuid","opt_out"]);return E.getSystemsIds.apply(E,i()(t))}function I(e){var t=Object(v.b)(e,["filter","limit","offset","page","page_size","sort","cvss_from","cvss_to","public_from","public_to","impact","data_format","business_risk_id","status_id","security_rule","show_all"]);return E.getCveIdsList.apply(E,i()(t))}function R(e){var t=e.system;if(e&&t){Object.keys(e).forEach((function(t){return(void 0===e[t]||""===e[t])&&delete e[t]}));var n=["filter","limit","offset","page","page_size","sort","cvss_from","cvss_to","public_from","public_to","impact","status_id","data_format","business_risk_id","security_rule"].map((function(t){return e[t]}));return E.getCveIdsBySystem.apply(E,[t].concat(i()(n)))}}},1284:function(e,t,n){"use strict";n.d(t,"B",(function(){return T})),n.d(t,"m",(function(){return D})),n.d(t,"u",(function(){return L})),n.d(t,"o",(function(){return k})),n.d(t,"s",(function(){return x})),n.d(t,"p",(function(){return I})),n.d(t,"w",(function(){return R})),n.d(t,"q",(function(){return A})),n.d(t,"x",(function(){return N})),n.d(t,"a",(function(){return M})),n.d(t,"b",(function(){return F})),n.d(t,"c",(function(){return V})),n.d(t,"y",(function(){return B})),n.d(t,"j",(function(){return z})),n.d(t,"A",(function(){return H})),n.d(t,"l",(function(){return Y})),n.d(t,"k",(function(){return G})),n.d(t,"z",(function(){return U})),n.d(t,"d",(function(){return q})),n.d(t,"i",(function(){return J})),n.d(t,"h",(function(){return X})),n.d(t,"f",(function(){return W})),n.d(t,"n",(function(){return K})),n.d(t,"v",(function(){return Q})),n.d(t,"r",(function(){return Z})),n.d(t,"t",(function(){return $})),n.d(t,"g",(function(){return ee})),n.d(t,"e",(function(){return te}));var r=n(1261),a=n(510),o=n(266),i=n(1240),c=n(1286),s=n.n(c),u=s()({title:"Vulnerability",breadcrumbs:[]}),l=n(264),p=n.n(l);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(n,!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m,y=s()({affectedSystemsByCVE:{isLoading:!0,openedRows:[],payload:{meta:{total_items:0,page:1,page_size:20}}},parameters:{page:1,page_size:20,selectedHosts:[],security_rule:void 0,status_id:void 0},cveDetails:{isLoading:!0,payload:{},error:!1}}),b=n(509);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(n,!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g={parameters:{page:1,page_size:20},cveList:{isLoading:!0,payload:[],meta:new Date,error:!1},openedCves:[],selectedCves:[],expandCveDescription:!1};var _=Object(b.a)((m={},p()(m,"".concat(i.u,"_PENDING"),(function(e,t){return E({},e,{timestamp:t.meta,cveList:E({},e.cveList,{isLoading:!0})})})),p()(m,"".concat(i.u,"_REJECTED"),(function(e,t){return E({},e,{timestamp:t.meta,cveList:{payload:{errors:t.payload},isLoading:!1}})})),p()(m,"".concat(i.u,"_FULFILLED"),(function(e,t){var n=t.payload,r=t.meta;return r>=e.timestamp?E({},e,{timestamp:r,cveList:{payload:n,isLoading:!1}}):e})),p()(m,"CHANGE_SYSTEM_CVE_LIST_PARAMETERS",(function(e,t){var n=e;return n.parameters=E({},e.parameters,{},t.payload),n})),p()(m,"SELECT_SYSTEM_CVE",(function(e,t){var n=e,r=n.selectedCves.slice();return Array.isArray(t.payload)?r=t.payload:r.includes(t.payload)&&r.splice(r.indexOf(t.payload),1)||r.push(t.payload),E({},n,{selectedCves:r})})),p()(m,"EXPAND_SYSTEM_CVE",(function(e,t){var n=e,r=t.payload,a=r.isOpen,o=r.cves,i=r.expandCveDescription,c=n.openedCves.slice();return o.length>0?o.map((function(e){var t=c.findIndex((function(t){return t.id===e}));t>-1?c[t]={id:e,isOpen:a}:c.push({id:e,isOpen:a})})):c=c.map((function(e){return{id:e.id,isOpen:!1}})),E({},n,{openedCves:c,expandCveDescription:i})})),p()(m,"CLEAR_SYSTEM_CVES_STORE",(function(e){var t=e;return t.selectedCves=[],t.openedCves=[],t.parameters={page:1,page_size:20},t})),m),g);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(n,!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S={isLoading:!0,payload:{},metadata:{page:1,limit:20,offet:0,total_items:0},params:{filter:void 0,opt_out:!1,page:1,page_size:20,sort:"-last_upload"}};function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(n,!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C={cveList:{isLoading:!0,payload:[],timestamp:new Date},parameters:{show_all:!1,sort:"-public_date"},selectedCves:[],openedCves:[],expandCveDescription:!1};function P(e,t){return t>=e}o.a.register({CVEDetailsPageStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i.p+"_REJECTED":return e.setIn(["cveDetails","error"],!0).setIn(["cveDetails","isLoading"],!1);case i.p+"_PENDING":return e.setIn(["cveDetails","isLoading"],!0);case i.p+"_FULFILLED":return e.setIn(["cveDetails","payload"],t.payload).setIn(["cveDetails","isLoading"],!1);case i.n+"_PENDING":return e.setIn(["affectedSystemsByCVE","isLoading"],!0);case i.n+"_FULFILLED":return e.setIn(["affectedSystemsByCVE","payload"],t.payload).setIn(["affectedSystemsByCVE","isLoading"],!1);case i.b:return e.setIn(["parameters"],d({},e.parameters,{},t.payload,{page_size:t.payload.page_size||e.parameters.page_size}));case i.g:return y;default:return e}}}),o.a.register({CVEsStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0,n=w({},e);switch(t.type){case i.q+"_PENDING":return n.cveList={timestamp:t.meta,isLoading:!0},n;case i.q+"_REJECTED":return n.error=!0,n.cveList={isLoading:!1,payload:{errors:t.payload}},n;case i.q+"_FULFILLED":return P(e.cveList.timestamp,t.meta)?(n.cveList={payload:t.payload,isLoading:!1},n):e;case i.a+"_FULFILLED":return n.parameters=w({},n.parameters,{},t.payload),n;case i.x:var r=n.selectedCves.slice();return Array.isArray(t.payload)?r=t.payload:r.includes(t.payload)&&r.splice(r.indexOf(t.payload),1)||r.push(t.payload),w({},n,{selectedCves:r});case i.k:if(Array.isArray(t.payload)){var a=t.payload,o=0!==t.payload.length;return w({},n,{openedCves:a,expandCveDescription:o})}var c=n.cveList.payload.data[t.payload/2].id,s=n.openedCves.slice();s.includes(c)&&s.splice(s.indexOf(c),1)||s.push(c);var u=s.length===n.cveList.payload.data.length;return w({},n,{openedCves:s,expandCveDescription:u});case i.f:return C;default:return e}}}),o.a.register({SystemsPageStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0,n=h({},e);switch(t.type){case i.s+"_PENDING":return n.isLoading=!0,n;case i.s+"_REJECTED":return n.error=!0,n;case i.s+"_FULFILLED":return n.payload=t.payload,n.metadata=t.payload.meta,n.isLoading=!1,n;case i.c:return n.params=h({},n.params,{},t.payload,{page_size:t.payload.page_size||n.params.page_size}),n;case i.i:return S;default:return e}}}),o.a.register({BreadcrumbStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i.B+"_FULFILLED":return e.set("title",t.payload&&t.payload.title||u.title).set("breadcrumbs",t.payload&&t.payload.breadcrumbs||u.breadcrumbs);default:return e}}}),o.a.register({SystemCvesStore:_});var T=function(e){return{type:i.B,payload:new Promise((function(t){t(a.b(e))})).then((function(e){return e}))}},D=function(e,t){return{type:i.n,payload:new Promise((function(n){n(r.a(e,t))})).then((function(e){return e}))}},L=function(e){return{type:i.s,payload:new Promise((function(t){t(r.j(e))})).then((function(e){return e}))}},k=function(e){return{type:i.p,payload:new Promise((function(t){t(r.c(e))})).then((function(e){return e}))}},x=function(e){return{type:i.v,meta:{noError:!0},payload:new Promise((function(t){t(r.i(e))})).then((function(e){return e}))}},I=function(e){return{type:i.q,meta:new Date,payload:r.f(e)}},R=function(e,t){return{type:i.C,payload:new Promise((function(n){n(r.l(e,t))})).then((function(e){return e}))}},A=function(e){return{type:i.u,meta:new Date,payload:r.g(e)}},N=function(e,t){return{type:i.C,payload:new Promise((function(n){n(r.m(e,t))})).then((function(e){return e}))}},M=function(e){return{type:i.a,payload:new Promise((function(t){t(e)})).then((function(e){return e}))}},F=function(e){return{type:i.b,payload:e}},V=function(e){return{type:i.d,payload:e}},B=function(e){return{type:i.x,payload:e}},z=function(e){return{type:i.k,payload:e}},H=function(e){return{type:i.A,payload:e}},Y=function(e){return{type:i.m,payload:e}},G=function(e,t){return{type:i.l,payload:{id:e,isOpen:t}}},U=function(e){return{type:i.z,payload:e}},q=function(e){return{type:i.c,payload:e}},J=function(){return{type:i.i,payload:[]}},X=function(){return{type:i.j,payload:[]}},W=function(){return{type:i.g,payload:[]}},K=function(e,t){return{type:i.o,payload:r.b(e,t)}},Q=function(e){return{type:i.t,payload:r.k(e)}},Z=function(e){return{type:i.r,payload:r.e(e)}},$=function(e){return{type:i.w,payload:r.d(e)}},ee=function(){return{type:i.h,payload:[]}},te=function(){return{type:i.f,payload:[]}}},1305:function(e,t,n){"use strict";var r=n(115),a=n.n(r),o=n(264),i=n.n(o),c=n(213),s=n.n(c),u=n(657),l=n.n(u),p=n(153),f=n.n(p),d=n(137);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(n,!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=new function e(){var t=this;f()(this,e),this.filename=function(e){switch(e){case"reports":return"vulnerability_cves-report--".concat((new Date).toISOString().split("T")[0]);case"systems-exposed":return"vulnerability_systems-exposed-".concat(t.params.cve,"--").concat(t.defaultParams.date);case"system-list":return"vulnerability_systems--".concat(t.defaultParams.date);default:return"vulnerability_cves--".concat(t.defaultParams.date)}},this.checkTypes=function(e,n,r){if("function"!=typeof e)throw"exec expects the 1st param to be funtion. Received ".concat(l()(e));if(!t.pages.includes(n))throw"Page ".concat(n," does not exist");if(!t.formats.includes(r))throw"Format ".concat(r," is not supported")},this.exec=function(){var e=s()(a.a.mark((function e(n,r,o,i){var c,s,u,l,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.checkTypes(n,i,o),t.params.cve=Array.isArray(r)?r[0]:"",e.prev=2,!Array.isArray(r)){e.next=9;break}return e.next=6,n(t.params.cve,y({},r[1],{},t.defaultParams,{data_format:o}));case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,n(y({},r,{},t.defaultParams,{data_format:o}));case 11:e.t0=e.sent;case 12:return c=e.t0,s=c.payload,e.next=16,s;case 16:u=e.sent,l=u.data,p="json"===o?JSON.stringify(l):l,Object(d.downloadFile)(p,t.filename(i),o),e.next=25;break;case 22:throw e.prev=22,e.t1=e.catch(2),"".concat(e.t1);case 25:case"end":return e.stop()}}),e,null,[[2,22]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),this.defaultParams={page:1,page_size:Number.MAX_SAFE_INTEGER,date:(new Date).toISOString().replace(/[T:]/g,"-").split(".")[0]+"-utc"},this.params={cve:""},this.pages=["systems-exposed","system-cves","cves","system-list"],this.formats=["csv","json"]}},1351:function(e,t,n){"use strict";n.d(t,"e",(function(){return P})),n.d(t,"f",(function(){return T})),n.d(t,"b",(function(){return D})),n.d(t,"c",(function(){return L})),n.d(t,"a",(function(){return k})),n.d(t,"d",(function(){return x})),n.d(t,"g",(function(){return I}));var r=n(500),a=n.n(r),o=n(0),i=n.n(o),c=n(3),s=n.n(c),u=n(200),l=n(507),p=n(65),f=n(503),d=n(513),m=n(512),y=n(135),b=n(136),v=n(216),E=n(1194),g=n.n(E),_=n(214),O=n.n(_),h=n(219),S=n.n(h),j=n(655),w=n.n(j),C=n(6),P=i.a.createElement(l.Bullseye,{style:{height:"auto"}},i.a.createElement(f.EmptyState,{variant:f.EmptyStateVariant.large},i.a.createElement(v.Title,{headingLevel:"h5",size:"lg"},i.a.createElement(u.a,C.a.emptyStateNoMatchingCves)),i.a.createElement(b.TextContent,null,i.a.createElement(d.EmptyStateBody,{style:{whiteSpace:"normal"}},i.a.createElement(u.a,C.a.emptyStateMaybeFollowing),i.a.createElement(y.Text,null,i.a.createElement(u.a,C.a.emptyStateNoCveReported)),i.a.createElement(y.Text,{component:y.TextVariants.p},i.a.createElement(u.a,C.a.emptyStateForMoreInfo),i.a.createElement("a",{href:"https://access.redhat.com/security/team/contact/",target:"__blank",rel:"noopener noreferrer"},i.a.createElement(u.a,C.a.emptyStateForMoreLink),"  ",i.a.createElement(O.a,null))))))),T=i.a.createElement(l.Bullseye,{style:{height:"auto"}},i.a.createElement(f.EmptyState,{variant:f.EmptyStateVariant.large},i.a.createElement(v.Title,{headingLevel:"h5",size:"lg"},i.a.createElement(u.a,C.a.emptyStateNoCvesReported)),i.a.createElement(b.TextContent,null,i.a.createElement(d.EmptyStateBody,{style:{whiteSpace:"normal"}},i.a.createElement(y.Text,null,i.a.createElement(u.a,C.a.emptyStateNoCveReported)),i.a.createElement(y.Text,{component:y.TextVariants.p},i.a.createElement(u.a,C.a.emptyStateIfCveForSystem),i.a.createElement("a",{href:"https://access.redhat.com/security/team/contact/",target:"__blank",rel:"noopener noreferrer"},i.a.createElement(u.a,C.a.emptyStateForMoreLink),"  ",i.a.createElement(O.a,null))))))),D=i.a.createElement(l.Bullseye,{style:{height:"auto"}},i.a.createElement(f.EmptyState,{variant:f.EmptyStateVariant.large},i.a.createElement(v.Title,{headingLevel:"h5",size:"lg"},i.a.createElement(u.a,C.a.emptyStateNoReportedSystem)),i.a.createElement(b.TextContent,null,i.a.createElement(d.EmptyStateBody,{style:{whiteSpace:"normal"}},i.a.createElement(y.Text,null,i.a.createElement(u.a,C.a.emptyStateNoCveAffects)),i.a.createElement(y.Text,{component:y.TextVariants.p},i.a.createElement(u.a,C.a.emptyStateIfCveForSystem),i.a.createElement("a",{href:"https://access.redhat.com/security/team/contact/",target:"__blank",rel:"noopener noreferrer"},i.a.createElement(u.a,C.a.emptyStateForMoreLink),"  ",i.a.createElement(O.a,null)),"."))))),L=function(e){var t=e.buttonAction;return i.a.createElement(l.Bullseye,null,i.a.createElement(f.EmptyState,{variant:f.EmptyStateVariant.large},i.a.createElement(m.EmptyStateIcon,{icon:w.a,size:"sm"}),i.a.createElement(v.Title,{headingLevel:"h5",size:"lg"},i.a.createElement(u.a,C.a.emptyStateSystemExcludedTitle)),i.a.createElement(d.EmptyStateBody,null,i.a.createElement(u.a,C.a.emptyStateSystemExcludedBody)),i.a.createElement(p.Button,{variant:"primary",component:"a",onClick:t},i.a.createElement(u.a,C.a.emptyStateSystemResumeAnalysis))))};L.propTypes={buttonAction:s.a.func};var k=i.a.createElement(l.Bullseye,{style:{height:"auto"}},i.a.createElement(f.EmptyState,{variant:f.EmptyStateVariant.large},i.a.createElement(v.Title,{headingLevel:"h5",size:"lg"},i.a.createElement(u.a,C.a.emptyStateNoReportedSystem)),i.a.createElement(b.TextContent,null,i.a.createElement(d.EmptyStateBody,{style:{whiteSpace:"normal"}},i.a.createElement(y.Text,null,i.a.createElement(u.a,C.a.emptyStateNoCveAffects)),i.a.createElement(u.a,C.a.emptyStateIfCveForSystems),i.a.createElement("a",{href:"https://access.redhat.com/security/team/contact/",target:"__blank",rel:"noopener noreferrer"},i.a.createElement(u.a,C.a.emptyStateForMoreLink)," ",i.a.createElement(O.a,null)),".")))),x=i.a.createElement(l.Bullseye,null,i.a.createElement(f.EmptyState,null,i.a.createElement(m.EmptyStateIcon,{icon:g.a}),i.a.createElement(v.Title,{headingLevel:"h5",size:"lg"},i.a.createElement(u.a,C.a.emptyStateNoData)),i.a.createElement(d.EmptyStateBody,null,i.a.createElement(u.a,C.a.emptyStateActivateInsights)),i.a.createElement(p.Button,{variant:"primary",component:"a",href:"http://access.redhat.com/products/cloud_management_services_for_rhel#getstarted"},i.a.createElement(u.a,C.a.emptyStateLearnInsights)))),I=i.a.createElement(l.Bullseye,null,i.a.createElement(f.EmptyState,{variant:f.EmptyStateVariant.large},i.a.createElement(m.EmptyStateIcon,{icon:S.a,color:"var(--pf-global--danger-color--100)"}),i.a.createElement(v.Title,{headingLevel:"h5",size:"lg"},i.a.createElement(u.a,C.a.somethingWrong)),i.a.createElement(d.EmptyStateBody,null,i.a.createElement(u.a,C.a.tryRefreshing),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement(u.a,a()({},C.a.ifProblemPersists,{values:{statusPageLink:i.a.createElement("a",{href:"https://status.redhat.com",target:"__blank",rel:"noopener noreferrer"},i.a.createElement(u.a,C.a.statusPage))}})),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement(p.Button,{variant:"primary",onClick:function(){return history.back()}},i.a.createElement(u.a,C.a.returnPreviousPage)))))},1353:function(e,t,n){"use strict";n.d(t,"b",(function(){return P})),n.d(t,"a",(function(){return T})),n.d(t,"c",(function(){return L})),n.d(t,"d",(function(){return k})),n.d(t,"e",(function(){return x})),n.d(t,"f",(function(){return I}));var r=n(264),a=n.n(r),o=n(56),i=n(214),c=n.n(i),s=(n(269),n(137)),u=n(0),l=n.n(u),p=n(42),f=n(200),d=n(500),m=n.n(d),y=n(135),b=n(136),v=n(3),E=n.n(v),g=n(1192),_=n(159),O=n(158),h=n(6),S=function(e){var t=e.rule,n=e.cve;return l.a.createElement(u.Fragment,null,t?l.a.createElement(u.Fragment,null,l.a.createElement(b.TextContent,{className:"icon-with-label"},l.a.createElement(y.Text,{component:y.TextVariants.h3,style:{paddingLeft:"var(--pf-global--spacer--lg)"}},l.a.createElement(O.a,null,l.a.createElement(o.Tooltip,{content:l.a.createElement(f.a,h.a.rulesIconTooltip)},l.a.createElement(_.a,null))),l.a.createElement("span",{className:"rule-name"},t.rule.description||t.rule.rule_id))),l.a.createElement(g.a,{report:t})):l.a.createElement(j,{cve:n}))};S.propTypes={rule:E.a.shape({rule:E.a.object,details:E.a.object,resulotion:E.a.object}).isRequired,cve:E.a.string};var j=function(e){var t=e.cve;return l.a.createElement(b.TextContent,{className:"icon-with-label"},l.a.createElement(y.Text,{component:y.TextVariants.p},l.a.createElement(f.a,m()({},h.a.exposedSystemNoRules,{values:{cve:t}}))),l.a.createElement(y.Text,{component:y.TextVariants.p,className:"pf-u-mb-sm"},l.a.createElement(f.a,h.a.exposedSystemNoRulesInfo)," ",l.a.createElement(_.a,null)),l.a.createElement(y.Text,{component:y.TextVariants.a,target:"_blank",rel:"noopener noreferrer",href:"https://access.redhat.com/articles/2968471"},l.a.createElement(f.a,h.a.exposedSystemNoRulesInfoLink)))};function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(n,!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}j.propTypes={cve:E.a.string};var P=function(e){var t=e.isLoading,n=e.payload,r=e.openedRows,a=e.cve;if(t)return{data:n&&n.data||[],meta:{},isLoading:t};var o=n.data,i=n.meta,c=o&&o.length;return{data:o.map((function(e){return C({},e.attributes,{id:e.id,isOpen:r.includes(e.id),status:e.attributes.status_name,children:e.attributes.rule?l.a.createElement(S,{cve:a,rule:e.attributes.rule}):l.a.createElement(j,{cve:a})})})),meta:C({},i,{cvesCount:c}),isLoading:t}};function T(e){var t,n=e.isLoading,r=e.error;if(!n&&!r){var a=e.payload.asMutable(),o=a.data,i=a.meta;return{data:o={impact:o.attributes.impact,public_date:Object(s.processDate)(o.attributes.public_date),description:o.attributes.description,synopsis:o.attributes.synopsis,rh_link:(t=o.attributes.synopsis,l.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://access.redhat.com/security/cve/"+t},l.a.createElement(f.a,h.a.RHDBLink),l.a.createElement(c.a,{className:"pf-u-ml-sm"}))),mitre_link:D(o.attributes.synopsis),cvss3_score:o.attributes.cvss3_score,cvss2_score:o.attributes.cvss2_score,cvss2_metrics:o.attributes.cvss2_metrics,cvss3_metrics:o.attributes.cvss3_metrics,business_risk:p.a.find((function(e){return e.value===o.attributes.business_risk_id.toString()})).label,business_risk_justification:o.attributes.business_risk_text,business_risk_id:o.attributes.business_risk_id,status:p.r.find((function(e){return e.value===o.attributes.status_id.toString()})).label,status_id:o.attributes.status_id,status_justification:o.attributes.status_text,systems_status_detail:o.attributes.systems_status_detail,systems_status_divergent:o.attributes.systems_status_divergent,rules:o.attributes.rules},meta:i,isLoading:n}}return{data:[],meta:{},isLoading:n,error:r}}function D(e){return l.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://cve.mitre.org/cgi-bin/cvename.cgi?name="+e},l.a.createElement(f.a,h.a.MITRELink),l.a.createElement(c.a,null))}var L=function(e,t){return t%2==0?[{title:l.a.createElement(f.a,h.a.editBusinessRisk),onClick:function(t,n,r){return e.showBusinessRiskModal([{id:r.id,business_risk_id:r.business_risk_id,justification:r.business_risk_justification}])}},{title:l.a.createElement(f.a,h.a.editStatus),onClick:function(t,n,r){return e.showStatusModal([{id:r.id,status_id:r.status_id,justification:r.status_justification}])}}]:null},k=function(e,t,n){return n%2==0?[{title:l.a.createElement(f.a,h.a.editStatus),onClick:function(n,r,a){return e.showStatusModal([{id:a.id,display_name:t.display_name,status_id:a.status_id,cve_status_id:a.cve_status_id,justification:a.status_justification,cve_justification:a.cve_status_justification}],t)}}]:null},x=function(e,t,n){return n%2==0?[{title:l.a.createElement(f.a,h.a.editStatus),onClick:function(n,r,a){e([{id:t.id,status_id:t.status_id,justification:t.justification}],[{id:a.id,display_name:a.display_name,status_id:a.status_id,justification:a.status_text}])}}]:null},I=function(e,t){return[{title:t?l.a.createElement(f.a,h.a.kebabResumeAnalysis):l.a.createElement(f.a,h.a.kebabExcludeAnalysis),onClick:function(t,n,r){e([r.id])}}]}},1355:function(e,t,n){"use strict";var r=n(1356),a=n.n(r),o=n(6),i=n(8);t.a=function(e){var t=e.selectedItems,n=e.selectorHandler,r=e.items,c=e.fetchResource,s=e.multiRow,u=void 0!==s&&s,l=Array.from(t),p=l&&l.length,f=r.meta,d=r.data,m=d&&(Array.isArray(d)&&d.length&&u?d.length/2:d.length),y=function(){n(!1,[])},b=function(){var e=(c&&c({page_size:f.total_items,page:1})).payload;e&&e.then((function(e){var t=e.data.map((function(e){return e.id&&e.id||e}));n(!0,t)}))};return{handleOnCheckboxChange:function(){0===p?b():y()},items:[{title:i.a.formatMessage(o.a.selectNone),onClick:y},{title:"".concat(i.a.formatMessage(o.a.selectPage,{count:m})),onClick:function(){var e=r.data,t=a()(e.filter((function(e){return e.id})).map((function(e){return e.id})),l);n(!0,t)}},{title:"".concat(i.a.formatMessage(o.a.selectAll,{count:f.total_items?f.total_items:0})),onClick:b}]}}},1358:function(e,t,n){"use strict";var r=n(1238),a=n.n(r),o=n(654),i=n(8),c=n(1422),s=n.n(c),u=n(0),l=n.n(u);t.a=function(e,t,n,r){var c=l.a.useState(),u=a()(c,2),p=u[0],f=u[1],d=l.a.useState((function(){return s()((function(e){void 0!==e&&r({filter:e,page:1})}),400)})),m=a()(d,1)[0];return l.a.useEffect((function(){return f(n)}),[n]),{type:o.conditionalFilterType.text,label:i.a.formatMessage(e),filterValues:{"aria-label":"search-field",id:"search-".concat(e.id),onChange:function(e,t){f(t),m(t)},placeholder:i.a.formatMessage(t),value:p}}}},1359:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"e",(function(){return l}));var r=n(6),a=n(42),o=n(8),i=function(e,t,n){return n({page:t})},c=function(e,t,n){return n({page_size:t,page:1})},s=function(e){return{onSelect:function(t,n){return e.downloadReport(n)}}},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.filter,i=function(e,n){return a.i[e].items.reduce((function(r,a){if(n===a.value)r.name=a.label,r.value=a.value;else if("security_rule"===e&&!["true","false"].includes(n)){var o=t.find((function(e){return e.value===n}));r.name=o&&o.label||n,r.value=n}return r}),{})},c=function(e,t){return e.reduce((function(e,n){return e.push(i(t,n)),e}),[])},s=Object.keys(a.i).reduce((function(t,n){if("show_all"!==n&&Object.keys(e).includes(n)&&!["",void 0].includes(e[n])){var r="string"==typeof e[n]&&e[n].split(","),o=r&&r.length>1&&c(r,n)||[i(n,e[n])];t.push({key:n,multiValue:r,category:a.i[n].title,chips:o})}return t}),[]);return n&&s.push({key:"filter",category:o.a.formatMessage(r.a.searchLabel),chips:[{name:n}]}),s},l=function(e,t){t(e.reduce((function(e,t){return"filter"===t.key||t.multiValue&&1===t.multiValue.length?e[t.key]="":e[t.key]=t.multiValue.filter((function(e){return!t.chips.some((function(t){return t.value===e}))})).join(","),e}),{}))}},1533:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(1253),a=n.n(r),o=n(264),i=n.n(o),c=n(537);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(n,!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l={columns:[],rows:[],entities:[],selectedRows:[]};function p(e,t){if(t.selectedRows||(t.selectedRows=[]),t.loaded){var n=t.columns.filter((function(e){return"updated"===e.key}));return n=[u({},n[0],{transforms:[c.a]})],u({},t,{rows:t.rows.map((function(e){return u({},e,{selected:t.selectedRows.some((function(t){return t===e.id}))})})),columns:[].concat(a()(e||[]),a()(n||[]))})}return t}function f(e,t){var n=e.rows.slice();return e.selectedRows||(e.selectedRows=[]),u({},e,{rows:n.map((function(e){return u({},e,{selected:t.some((function(t){return t===e.id}))})})),selectedRows:a()(t)})}var d=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"LOAD_ENTITIES_FULFILLED":return p(e,t);case"SELECT_MULTIPLE_ENTITIES":return f(t,n.payload);case"EXPAND_ROW":return u({},t,{rows:t.rows.map((function(e){return u({},e,{isOpen:e.id===n.payload.id?n.payload.isOpen:e.isOpen})}))});case"CLEAR_INVENTORY_STORE":return l;default:return t}}}},1880:function(e,t,n){"use strict";n.r(t);var r=n(115),a=n.n(r),o=n(213),i=n.n(o),c=n(1238),s=n.n(c),u=n(264),l=n.n(u),p=n(502),f=n.n(p),d=n(3),m=n.n(d),y=n(47),b=n(6),v=n(89),E=n(104),g=n(1195),_=n(78),O=n(592),h=n(593),S=n(552),j=n(537),w=n(196),C=n(1253),P=n.n(C),T=n(0),D=n.n(T),L=n(112),k=n(1254),x=n(1284),I=n(266),R=n(1355),A=n(1193),N=n(1358),M=n(1359),F=n(1305);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(n,!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z=function(e){var t=e.selectedHosts,n=e.intl,r=e.parameters,a=e.systems,o=e.methods,i=o.apply,c=o.handleSelect,s=o.doOptOut,u=o.setSelectedHosts;I.b.addNew({on:"SELECT_ENTITY",callback:function(e){return function(e){var n=e.data.selected?[e.data.id].concat(P()(t)):t.filter((function(t){return t!==e.data.id}));c(!1,n)}(e)}});var l=["",{label:r.opt_out?n.formatMessage(b.a.kebabResumeAnalysis):n.formatMessage(b.a.kebabExcludeVulnerabilityAnalysis),onClick:function(){return s()},props:{isDisabled:!t.length}},{label:r.opt_out?n.formatMessage(b.a.kebabHideExcludedSystems):n.formatMessage(b.a.kebabShowExcludedSystems),onClick:function(){i({opt_out:!r.opt_out,page:1}),u([])}}],p=Object(R.a)({selectedItems:t,selectorHandler:c,items:a,fetchResource:function(e){return Object(x.v)(B({},r,{},e))}});return D.a.createElement(A.PrimaryToolbar,{bulkSelect:{count:t.length,items:p.items,isDisabled:0===a.meta.total_items&&0===t.length,checked:Boolean(t.length),onSelect:function(){return p.handleOnCheckboxChange()}},actionsConfig:{actions:l},filterConfig:{items:[Object(N.a)(b.a.systemsSearchName,b.a.searchFilterByName,r.filter,i)]},activeFiltersConfig:{filters:Object(M.a)(r),onDelete:function(e,t){return Object(M.e)(t,i)}},exportConfig:B({isDisabled:0===a.meta.total_items},Object(M.b)({downloadReport:function(e){var t=B({},r);F.a.exec(x.u,t,e,"system-list")}}))})};z.propTypes={systems:k.d,parameters:m.a.object,selectedHosts:m.a.array,methods:m.a.shape({doOptOut:m.a.func,apply:m.a.func,handleSelect:m.a.func,setSelectedHosts:m.a.func}),intl:m.a.any};var H=Object(L.o)(Object(y.c)(z)),Y=n(42),G=n(505),U=n(1353),q=n(504),J=n(501),X=n(1533),W=n(1351);function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(n,!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z=function(e){var t=e.intl,n=Object(T.useState)((function(){return function(){return D.a.createElement("div",null,"Loading...")}})),r=s()(n,2),o=r[0],c=r[1],u=Object(k.i)(Y.s),l=s()(u,2),p=l[0],d=l[1],m=Object(T.useState)(!1),y=s()(m,2),C=y[0],P=y[1],L=Object(T.useState)(!0),R=s()(L,2),A=R[0],N=R[1],M=D.a.createRef(),F=Object(E.useDispatch)(),V=Object(E.useSelector)((function(e){return e.SystemsPageStore.payload})),B=Object(E.useSelector)((function(e){return e.SystemsPageStore.params})),z=Object(E.useSelector)((function(e){return e.SystemsPageStore.metadata})),K=Object(E.useSelector)((function(e){return e.SystemsPageStore.error})),Z=Object(T.useState)(void 0),$=s()(Z,2),ee=$[0],te=$[1],ne=Object(E.useSelector)((function(e){return e.SystemsPageStore.isLoading})),re=Object(T.useMemo)((function(){return t=(e=V).data,n=e.meta,t&&t.map((function(e){var t=e.attributes,r=t.cve_count,a=f()(t,["cve_count"]);return Q({cve_count:n.opt_out?"Excluded":r,id:e.attributes.inventory_id},a)}))||[];var e,t,n}),[V]),ae=function(){var e=i()(a.a.mark((function e(){var t,n,r,o,i,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,insights.loadInventory({ReactRedux:E,react:D.a,reactRouterDom:v,pfReactTable:{Table:_.b,TableBody:O.a,TableHeader:h.a,TableGridBreakpoint:_.d,cellWidth:S.a,TableVariant:_.e,sortable:j.a,expandable:w.b,SortByDirection:_.a},pfReact:g.reactCore});case 2:t=e.sent,n=t.inventoryConnector,r=t.mergeWithEntities,o=t.mergeWithDetail,I.a.register(Q({},r(Object(X.a)(Y.w)),{},o())),i=n(I.a.getStore()),s=i.InventoryTable,c((function(){return s}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(T.useEffect)((function(){return ae(),function(){F(Object(x.i)()),F(Object(x.g)())}}),[]),Object(T.useEffect)((function(){ee&&F(Object(x.z)(ee))}),[ee,F]);var oe=function(e){F(Object(x.d)(e))};Object(T.useEffect)((function(){F(Object(J.clearNotifications)())}),[K,F]);Object(T.useEffect)((function(){!M.current&&A?(oe(d),N(!1)):(F(Object(x.u)(B)),C&&p(Q({},B))||P(!0))}),[B]);var ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(ee&&ee.length>0||e)&&F(Object(x.x)(e||ee,!B.opt_out)).then((function(){F(Object(x.u)(Q({},B,{page:1}))),!1===B.opt_out?F(Object(J.addNotification)({variant:"success",title:t.formatMessage(b.a.systemsExcludedNotification,{count:e?1:ee.length||0})})):F(Object(J.addNotification)({variant:"success",title:t.formatMessage(b.a.systemsResumedNotificationTitle,{count:e?1:ee.length||0}),description:t.formatMessage(b.a.systemsResumedNotificationBody)})),te([])}))};return D.a.createElement(T.Fragment,null,D.a.createElement(q.a,{title:t.formatMessage(b.a.systemsHeader),showBreadcrumb:!1}),D.a.createElement(G.Main,null,o&&!K&&D.a.createElement(o,{tableProps:{canSelectAll:!1,onSort:re.length>0&&function(e,t,n){return Object(k.g)(t,n,Y.x,d.sort,oe)},sortBy:re.length>0&&Object(k.c)(Y.x,d.sort)},ref:M,items:re,page:z&&z.page||1,perPage:z&&z.page_size||20,total:z&&z.total_items||0,onRefresh:function(e){var t=e.page,n=e.per_page;z.page===t&&z.limit===n||oe({page:t,page_size:n}),z&&z.total_items<=n&&M.current&&M.current.onRefreshData({page:t,page_size:n})},isLoaded:!ne,hasCheckbox:0!==V.length,actions:Object(U.f)(ie,B.opt_out)},V.data&&D.a.createElement(H,{parameters:B,systems:V,selectedHosts:ee||[],methods:{doOptOut:ie,apply:oe,handleSelect:function(e,t){t||(t=[]),te(t)},setSelectedHosts:te}}))||(F(Object(J.clearNotifications)()),W.g)))};Z.propTypes={intl:m.a.any};t.default=Object(y.c)(Z)}}]);
//# sourceMappingURL=../sourcemaps/Systems.js.map