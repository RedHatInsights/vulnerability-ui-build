(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1631:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"a",function(){return u});var r=n(296),a=n.n(r),s=n(1637),o=n(1624);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var c=Object(s.createSelector)([function(e){return e.CVEStore.cveDetails}],o.a),l=Object(s.createSelector)([function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(n,!0).forEach(function(t){a()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e.CVEStore.affectedSystemsByCVE,{cve:t})}],o.b),u=Object(s.createSelector)([function(e){return e.SystemsStore}],o.c)},1639:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var r=n(154),a=n.n(r),s=n(296),o=n.n(s);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(n,!0).forEach(function(t){o()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var l={columns:[],rows:[],entities:[]};function u(e,t,n){if(t.loaded){var r=n(),s=t.columns.filter(function(e){return"updated"===e.key});return c({},t,{rows:t.rows.filter(function(e){return e.insights_id}).map(function(e){return c({},e,{selected:r.has(e.id)})}),columns:[].concat(a()(e||[]),a()(s||[]))})}return t}function p(e,t){var n=t(),r=e.rows.slice();return c({},e,{rows:r.map(function(e){return c({},e,{selected:n.has(e.id)})})})}var f=function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case"LOAD_ENTITIES_FULFILLED":return u(e,n,t);case"SELECT_MULTIPLE_ENTITIES":return p(n,t);default:return n}}}},1712:function(e,t,n){"use strict";n.r(t);var r=n(538),a=n.n(r),s=n(187),o=n.n(s),i=n(303),c=n.n(i),l=n(296),u=n.n(l),p=n(176),f=n.n(p),d=n(177),m=n.n(d),y=n(178),b=n.n(y),h=n(179),v=n.n(h),g=n(180),O=n.n(g),w=n(117),j=n(266),_=n(581),E=n(580),S=n(297),P=n(535),D=n(205),I=n(299),T=n(1620),N=n(874),C=n.n(N),R=n(0),L=n.n(R),k=n(1625),z=n.n(k),M=n(2),x=n.n(M),F=n(181),U=n(204),A=n(832),K=n(337),B=n(1619),H=n(1639),V=n(1631),q=n(338),J=n(537),W=n(1622),G=n(1623),X=(n(1713),n(1630)),Y=n(100),Q=n(1628),Z=n(1629),$=n(10),ee=n(69);function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(n,!0).forEach(function(t){u()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var re=function(e){function t(e){var n;return f()(this,t),(n=b()(this,v()(t).call(this,e))).downloadReport=function(e){var t=n.state,r=t.opt_out,a=t.filter,s=Object(B.j)({opt_out:r,filter:a,data_format:e,page:1,page_size:Number.MAX_SAFE_INTEGER}).payload;s&&s.then(function(t){var n=t.data,r="json"===e?JSON.stringify(n):n;return Object(T.downloadFile)(r,"systems-".concat((new Date).toISOString()),e)})},n.apply=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.setState(ne({},n.state,{},e),n.sendRequest)},n.sendRequest=function(){(0,n.props.fetchData)(ne({},n.state)),n.createUrlParams(n.state)},n.createUrlParams=function(e){var t=ne({},e),r=["filter","page","page_size"];Object.keys(e).forEach(function(e){return(void 0===t[e]||""===t[e]||!r.includes(e)||!1===t[e])&&delete t[e]});var a=z.a.stringify(t);n.props.history.push("?"+a)},n.addFilter=function(e,t,r){var a;a="radio"===r||"show_all"===e?u()({},e,t):n.state[e]?u()({},e,"".concat(n.state[e],",").concat(t)):u()({},e,t),n.apply(ne({},a,{page:1}))},n.doOptOut=function(){n.state.selected.size>0&&n.props.optOutSystems(n.state.selected,!n.state.opt_out).then(function(){n.props.fetchData(ne({},n.params(),{page:1})),!1===n.state.opt_out?n.props.addNotification({variant:"success",title:n.state.selected.size+n.props.intl.formatMessage($.a.systemsExcludedNotification)}):n.props.addNotification({variant:"success",title:n.state.selected.size+n.props.intl.formatMessage($.a.systemsResumedNotificationTitle),description:n.props.intl.formatMessage($.a.systemsResumedNotificationBody)}),n.setState({selected:new Set})})},n.onSelect=function(e){var t;!e.data||Array.isArray(e.data)?t=new Set(e.data):(t=n.state.selected,e.data.selected?t.add(e.data.id):t.delete(e.data.id)),n.setState({selected:t},n.props.selectMultiple)},n.getSelected=function(){return n.state.selected},n.params=function(){var e=n.state;return{filter:e.filter,opt_out:e.opt_out,page:e.page,page_size:e.page_size}},n.handleFilterChange=C()(function(e){var t=n.props.systems.meta.page_size;n.apply({filter:e,page_size:t,page:1})},400),n.handleRefresh=function(e){var t=e.page,r=e.per_page,a=n.props.systems.meta,s=n.props.fetchData;if(a.page!==t||a.page_size!==r){var o={page:t,page_size:r||a.page_size,filter:n.state.filter,opt_out:n.state.opt_out};s(o),n.createUrlParams(o)}a.total_items<=r&&n.inventory.current&&n.inventory.current.onRefreshData({page:t,per_page:r,perPage:r})},n.handleOptOut=function(){n.setState({opt_out:!n.state.opt_out,selected:new Set,page:1},n.sendRequest)},n.handleKebabToggle=function(e){n.setState({isKebabOpen:e})},n.handleKebabSelect=function(){n.setState({isKebabOpen:!n.state.isKebabOpen})},n.inventory=x.a.createRef(),n.state={InventoryCmp:function(){return x.a.createElement("div",null,"Loading...")},filter:void 0,removeListener:function(){},columns:[{key:"display_name",title:n.props.intl.formatMessage($.a.systemsColumnHeaderName),composed:["facts.os_release","display_name"]},{key:"cve_count",title:n.props.intl.formatMessage($.a.systemsColumnHeaderCveCount)}],opt_out:!1,isKebabOpen:!1,selectListener:q.b.addNew({on:"SELECT_ENTITY",callback:function(e){return n.onSelect(e)}}),selectAllListener:q.b.addNew({on:"SELECT_ENTITIES",callback:function(e){return n.onSelect(e)}}),selected:new Set},n}var n;return O()(t,e),m()(t,[{key:"componentDidMount",value:function(){var e=z.a.parse(this.props.location.search);e.show_irrelevant="true"===e.show_irrelevant,e.show_irrelevant&&(e.show_all=void 0),this.fetchInventory(),this.apply(ne({},e))}},{key:"shouldComponentUpdate",value:function(e){return!e.systems.isLoading}},{key:"fetchInventory",value:(n=c()(o.a.mark(function e(){var t,n,r,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,insights.loadInventory({react:x.a,reactRouterDom:U,reactCore:w,reactIcons:S,pfReactTable:P});case 2:t=e.sent,n=t.inventoryConnector,r=t.mergeWithEntities,a=t.mergeWithDetail,q.a.register(ne({},r(Object(H.a)(this.state.columns,this.getSelected)),{},a())),this.setState({InventoryCmp:n(q.a.getStore()).InventoryTable}),this.state.removeListener();case 9:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,n=t.InventoryCmp,r=t.filter,s=this.props.systems,o=s.data,i=s.meta,c=o.map(function(e){var t=e.attributes,n=t.cve_count,r=a()(t,["cve_count"]);return ne({cve_count:i.opt_out?"Excluded":n,id:e.attributes.inventory_id},r)}),l=[Object(G.e)(this.doOptOut,this.state.opt_out,{isDisabled:!this.getSelected().size}),Object(G.g)(this.handleOptOut,this.state.opt_out),Object(G.b)(this.downloadReport),Object(G.a)(this.downloadReport)];return x.a.createElement(j.a,null,x.a.createElement(J.a,{showBreadcrumb:!1}),x.a.createElement(D.Main,null,x.a.createElement(n,{ref:this.inventory,hasCheckbox:0!==o.length,page:i.page,total:i.total_items,perPage:i.page_size,onRefresh:this.handleRefresh,items:c},x.a.createElement(_.a,{className:"systems-toolbar"},x.a.createElement(E.a,null,x.a.createElement(X.a,{selectedItems:this.state.selected,selectorHandler:this.props.selectRows,items:this.props.systems,fetchResource:function(t){return Object(B.j)(ne({},e.params(),{},t))}})),x.a.createElement(E.a,null,x.a.createElement(Z.a,{placeholder:this.props.intl.formatMessage($.a.searchFilterByName),value:r,apply:this.apply})),x.a.createElement(E.a,null,x.a.createElement(W.a,{dropdownItems:l,disabled:0===o.length}))),x.a.createElement(D.TableToolbar,{className:"pf-u-pl-0 system-filter-chips"},x.a.createElement(_.a,null,x.a.createElement(E.a,null,x.a.createElement(Q.a,{filterValues:this.params(),filterCategories:[Y.t],apply:this.apply})))))))}}]),t}(x.a.Component);re.propTypes={fetchData:L.a.func,systems:K.c,optOutSystems:L.a.func,addNotification:L.a.func,selectRows:L.a.func,selectMultiple:L.a.func,history:L.a.object,location:L.a.object,intl:L.a.any};t.default=Object(ee.c)(Object(A.a)(Object(F.connect)(function(e){return{systems:Object(V.a)(e)}},function(e){return{setHeader:function(t){return e(Object(B.p)(t))},fetchData:function(t){return e(Object(B.j)(t))},optOutSystems:function(t,n){return e(Object(B.m)(t,n))},addNotification:function(t){return e(Object(I.addNotification)(t))},selectRows:function(t,n){return e(Object(B.o)(t,n))},selectMultiple:function(){return e({type:"SELECT_MULTIPLE_ENTITIES"})}}})(re)))},1713:function(e,t,n){var r=n(1714);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(20)(r,a);r.locals&&(e.exports=r.locals)},1714:function(e,t,n){(e.exports=n(19)(!1)).push([e.i,".systems-toolbar > div {\n  margin-right: var(--pf-global--spacer--sm); }\n\n.space-between-toolbar-items {\n  justify-content: space-between;\n  flex-wrap: nowrap; }\n  .space-between-toolbar-items > div {\n    flex-wrap: nowrap; }\n\n.vulnerability-toolbar-spacing {\n  justify-content: flex-start; }\n  .vulnerability-toolbar-spacing > div:not(:last-child) {\n    margin-right: var(--pf-global--spacer--sm); }\n\n.system-filter-chips {\n  order: 6;\n  flex-basis: 100%; }\n",""])}}]);
//# sourceMappingURL=../sourcemaps/Systems.js.map