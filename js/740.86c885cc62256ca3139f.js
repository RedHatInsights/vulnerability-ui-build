"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[740],{41740:(e,t,n)=>{n.d(t,{d3:()=>se,QE:()=>ue,ZP:()=>pe});var r=n(45987),o=n(4942),a=n(29439),i=n(77865),c=n.n(i),s=n(83594),l=n(45697),u=n.n(l),d=n(30893),p=n(5977),f=n(87462),m=n(93433),v=n(3351),y=n(22860),b=n(6934),g=n(75863),O=n(75959),E=n(43003),h=n(29648),Z=n(5938),P=n(24788);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C=function(e){var t,n=e.context,r=e.header,o=e.entity,a=n.cves,s=n.methods,l=n.selectedCves,u=n.expandedRows,p=n.canEditStatus;null!=a&&null!==(t=a.meta)&&void 0!==t&&t.patch_access||(r=r.filter((function(e){return"advisory"!==e.key})));var f=!a.data||0===a.data.length,S=f?[]:a.data.map((function(e){return l.includes(e.id)&&j(j({},e),{},{selected:!0})||e})).map((function(e,t){var n=t%2==0?u.find((function(t){return t.id===e.id}))||!1:{isOpen:void 0};return j(j({},e),{},{isOpen:n&&n.isOpen})}));return a.isLoading?c().createElement(O.Z,{colSize:6,rowSize:20,variant:g.B.compact}):c().createElement(i.Fragment,null,c().createElement(v.i,{isStickyHeader:!0,canSelectAll:!1,"aria-label":"Vulnerability CVE table",cells:r,rows:f?[{heightAuto:!0,cells:[{props:{colSpan:8},title:c().createElement(P.lP,{secondParagraph:d.Z.emptyStateThisSystemShouldHaveCVEs})}]}]:S,onSelect:f?void 0:function(e,t,r){var o=n.cves,a=n.methods,i=o.data[r]&&o.data[r].id;a.selectCves(t,i)},actionResolver:!f&&p&&function(e,t){return(0,E.k8)(s,o,t.rowIndex)},sortBy:f?void 0:(0,h.hO)([{key:"collapse"},{key:"checkbox"}].concat((0,m.Z)(r)),a.meta.sort),onCollapse:f?void 0:function(e,t,r){return function(e,t,r){var o=n.cves,a=n.methods,i=n.isAllExpanded,c=o.data[t]&&o.data[t].id;a.openCves(r,[c],i)}(0,t,r)},onSort:f?void 0:function(e,t,n){return(0,h.L6)(t,n,[{key:"collapse"},{key:"checkbox"}].concat((0,m.Z)(r)),a.meta.sort,s.apply)},gridBreakPoint:"grid-lg",ouiaId:"cves-table",variant:g.B.compact},c().createElement(i.Fragment,null,c().createElement(b.x,null),c().createElement(y.R,null))),c().createElement(Z.Z,{meta:a.meta,apply:s.apply}))};C.propTypes={context:u().any,header:u().array,entity:u().string};const _=function(e){return c().createElement(se.Consumer,null,(function(t){return c().createElement(C,(0,f.Z)({context:t},e))}))};var w=n(74806),x=n(85104),k=n(28216),T=n(52837),D=n(52064),M=n(49739),A=n(83826),R=n(68340),I=n(68774),H=n(62215),L=n(66516),B=n(16493),F=n(93400),V=n(49629),z=n(95859),K=n(9088),N=n(90960),U=n(95351),X=n(16369),q=n(35938),G=n(54534),J=n(1792),Q=n(15248);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Y=function(e){var t=e.entity,n=e.intl,r=e.context,o=r.cves,a=r.parameters,s=r.methods,l=r.selectedCves,u=r.isAllExpanded,p=r.canEditStatus,f=r.canRemediate,v=a.filter,y=a.advisory,b=f&&(l&&l.length||0),g=(0,i.useMemo)((function(){return(0,F.Z)({selectedItems:l,selectorHandler:s.selectCves,items:o,fetchResource:function(e){return s.fetchResource(W(W({},a),e))},multiRow:!0})}),[l,o,a,s]),O=[""].concat((0,m.Z)(p?[{label:n.formatMessage(d.Z.editStatus),onClick:function(){return s.showStatusModal((0,m.Z)(l).map((function(e){return W({id:e},o.data.filter((function(t){return e===t.id})).map((function(e){return{status_id:e.status_id,cve_status_id:e.cve_status_id,justification:e.status_justification,cve_justification:e.cve_status_justification}}))[0])})),[],!0)},props:{isDisabled:!b}}]:[]),[{label:n.formatMessage(d.Z.columnManagementModalTitle),onClick:function(){return s.setColumnModalOpen(!0)}}]),E=l.flatMap((function(e){return o.data.filter((function(t){return e===t.id}))}));return c().createElement(V.Z,{pagination:{itemCount:o.meta.total_items||0,page:o.meta.page||1,perPage:o.meta.page_size||1,ouiaId:"pagination-top",onSetPage:function(e,t){return(0,Q.A6)(e,t,s.apply)},onPerPageSelect:function(e,t){return(0,Q.lO)(e,t,s.apply)}},dedicatedAction:f&&t&&c().createElement(B.Z,{systems:t,cves:E}),actionsConfig:{actions:O,dropdownProps:{ouiaId:"toolbar-actions"}},bulkSelect:{count:b,items:g.items,isDisabled:0===o.meta.total_items&&0===b,checked:Boolean(b),ouiaId:"bulk-select",onSelect:function(){return g.handleOnCheckboxChange()}},filterConfig:{items:[(0,U.Z)("filter",d.Z.cve,d.Z.searchFilterByCveID,v,s.apply),(0,X.Z)(s.apply,a),(0,G.Z)(s.apply,a),(0,N.Z)(s.apply,a),(0,K.Z)(s.apply,a),(0,q.Z)(s.apply,a),(0,z.Z)(s.apply,a),(0,J.Z)(s.apply,a),(0,U.Z)("advisory",d.Z.advisory,d.Z.search,y,s.apply)]},activeFiltersConfig:{filters:(0,Q.DU)(a),onDelete:function(e,t){return(0,Q.vH)(t,s.apply)},deleteTitle:n.formatMessage(d.Z.resetFilters)},exportConfig:W({isDisabled:0===o.meta.total_items,ouiaId:"export"},(0,Q.HV)(s)),expandAll:{isAllExpanded:u,onClick:function(){var e=r.cves,t=r.methods,n=r.isAllExpanded,o=!n,a=n?[]:e.data.filter((function(e){return e.id})).map((function(e){return e.id}));t.openCves(o,a,!n)}}})};Y.defaultProps={totalNumber:0,apply:function(){},downloadReport:function(){}},Y.propTypes={entity:u().string,context:u().object,intl:u().any};const ee=(0,w.ZP)((function(e){return c().createElement(se.Consumer,null,(function(t){return c().createElement(Y,(0,f.Z)({context:t},e))}))}));var te=n(66123),ne=n(83215),re=n(87135),oe=n(66761),ae=["customItnlProvider"];function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var se=(0,i.createContext)({}),le=function(e){var t,n,r=e.entity,o=e.intl,l=e.allowedCveActions,u=e.showHeaderLabel,p=e.setPageTitle,f=(0,k.I0)(),m=(0,i.useState)((function(){return function(){return null}})),v=(0,a.Z)(m,2),y=v[0],b=v[1],g=(0,i.useState)(!1),O=(0,a.Z)(g,2),E=O[0],Z=O[1],P=(0,i.useState)(!0),S=(0,a.Z)(P,2),j=S[0],C=S[1],w=(0,i.useState)(T.Vm),x=(0,a.Z)(w,2),B=x[0],F=x[1],V=(0,i.useState)(!1),z=(0,a.Z)(V,2),K=z[0],N=z[1],U=(0,k.v9)((function(e){return e.SystemCvesStore.cveList})),X=(0,k.v9)((function(e){return e.SystemCvesStore.parameters})),q=(0,k.v9)((function(e){return e.SystemCvesStore.selectedCves})),G=(0,k.v9)((function(e){return e.SystemCvesStore.expandedRows})),J=(0,k.v9)((function(e){return e.SystemCvesStore.isAllExpanded})),Q=["REMEDIATE","EDIT_STATUS"].map((function(e){return l.includes(e)})),$=(0,a.Z)(Q,2),W=$[0],Y=$[1],ae=(0,i.useMemo)((function(){return(0,D.l3)(r.id,U,B)}),[U,r.id,B]),ie=(0,h.H1)(T.kO),le=(0,a.Z)(ie,2),ue=le[0],de=le[1],pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,h.pX)(e);f((0,s.KV)(t))};return(0,i.useEffect)((function(){p&&(document.title="".concat(r.display_name,"\n                - ").concat(o.formatMessage(d.Z.systemsHeader)," - ").concat(o.formatMessage(d.Z.pageTitleSuffix))),j?(pe(ce({sort:"-public_date"},ue)),C(!1)):(f((0,s.E8)(ce(ce({},X),{},{system:r.id}))),E&&de(ce({},X))||Z(!0))}),[X]),(0,i.useEffect)((function(){return function(){f((0,s.jS)())}}),[f]),U.payload.errors?(t=U.payload.errors.status,404===(n=parseInt(t))&&r.id?c().createElement(re.Z,{titleText:o.formatMessage(d.Z.notConnectedTitleText),bodyText:o.formatMessage(d.Z.notConnectedBodyText),buttonText:o.formatMessage(d.Z.notConnectedButtonText)}):c().createElement(te.Z,{code:n})):c().createElement(se.Provider,{value:{cves:ae,parameters:X,selectedCves:q,expandedRows:G,isAllExpanded:J,canRemediate:W,canEditStatus:Y,methods:{apply:pe,downloadReport:function(e){var t=ce(ce({},X),{},{system:r.id});H.Z.exec(s.E8,t,e,"system-cves",(function(e){return f((0,ne.wN)(e))}),(function(){return f((0,ne.L1)())}))},selectCves:function(e,t){f((0,s.TT)(t))},openCves:function(e,t,n){f((0,s.pJ)({isOpen:e,cves:t,isAllExpanded:n}))},showStatusModal:function(e,t){var n=Array.from(ae.data.filter((function(t){return e.some((function(e){return e.id===t.id}))})));n=n.map((function(e){return{id:e.id,cve_status_id:e.cve_status_id,status_id:e.status_id,justification:e.status_justification,cve_justification:e.cve_status_justification}})),b((function(){return function(){return c().createElement(L.Z,{cveList:n,updateRef:function(){return(0,h.$)(t?ce(ce({},ae.meta),{},{page:1}):ae.meta,pe)},inventoryList:[{id:r.id,display_name:r.display_name}],type:"systemDetail"})}}))},setColumnModalOpen:N,fetchResource:function(e){return(0,s.KX)(ce(ce({},e),{},{system:r.id}))}}}},c().createElement(y,null),c().createElement(oe.Z,{appliedColumns:B,applyColumns:F,isModalOpen:K,setModalOpen:N}),c().createElement(M.K,{hasGutter:!0},u&&c().createElement(A.v,null,c().createElement(I.D,null,c().createElement(R.x,{component:R.q.h2},o.formatMessage(d.Z.cvesHeader)))),c().createElement(A.v,null,c().createElement(ee,{entity:r.id}))),c().createElement(_,{header:B.filter((function(e){return e.isShown})),entity:r.id}))};le.defaultProps={allowedCveActions:[],showHeaderLabel:!1,setPageTitle:!1},le.propTypes={entity:u().object,intl:u().any,allowedCveActions:u().array,showHeaderLabel:u().bool,setPageTitle:u().bool};var ue=(0,p.EN)((0,w.ZP)(le)),de=function(e){var t=e.customItnlProvider,n=(0,r.Z)(e,ae),o=t?x.Z:i.Fragment;return c().createElement(o,t&&{locale:navigator.language.slice(0,2),messages:d.Z},c().createElement(ue,n))};de.propTypes={customItnlProvider:u().bool,customRouter:u().bool},de.defaultProps={customItnlProvider:!1,customRouter:!1};const pe=174==n.j?de:null}}]);
//# sourceMappingURL=../sourcemaps/740.95cae9e116e169f567f22e618565e27c.js.map