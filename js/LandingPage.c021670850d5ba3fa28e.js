(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[13],{53651:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>se});var r=n(77865),o=n.n(r),c=n(86350),a=n(23320),i=n(96156),l=n(85061),s=n(28481),u=n(37703),p=n(49739),f=n(83826),d=n(6208),m=n(52064),v=n(29648),b=n(74372),y=n(19738),h=n(22122),O=n(45697),g=n.n(O),E=n(3351),j=n(22860),S=n(6934),Z=n(75863),_=n(75959),w=n(32875),C=n(99385),P=n(5938),k=n(24788);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R=function(e){var t=e.context,n=e.header,c=e.entity,a=t.cves,i=t.methods,s=t.selectedCves,u=t.expandedRows,p=0===a.data.length,f=a.data&&a.data.map((function(e){return s.includes(e.id)&&D(D({},e),{},{selected:!0})||e})).map((function(e,t){var n=t%2==0?u.includes(e.id):void 0;return D(D({},e),{},{isOpen:n})}));return o().createElement(r.Fragment,null,a.isLoading?o().createElement(_.Z,{colSize:7,rowSize:20,variant:Z.B.compact}):o().createElement(r.Fragment,null,o().createElement(E.i,{canSelectAll:!1,"aria-label":"Vulnerability CVE table",cells:n,rows:p?function(){var e=t.cves;return[{heightAuto:!0,cells:[{props:{colSpan:8},title:0!==["filter","cvss_from","cvss_to","public_from","public_to","impact","status_id"].filter((function(t){return Object.prototype.hasOwnProperty.call(e.meta,t)&&e.meta[t]})).length?k.Sl:c?k.dX:0===e.data.length&&k.vb}]}]}():f,onSelect:p?void 0:function(e,n,r){var o=t.cves,c=t.methods,a=o.data[r]&&o.data[r].id;c.selectCves(n,a)},onCollapse:p?void 0:function(e,t){return i.openCves(t)},actionResolver:0!==a.data.length?function(e,t){return(0,C.hA)(i,t.rowIndex)}:void 0,sortBy:p?void 0:(0,v.hO)([{key:"collapse"},{key:"checkbox"}].concat((0,l.Z)(n)),a.meta.sort),onSort:p?void 0:function(e,t,r){return(0,v.L6)(t,r,[{key:"collapse"},{key:"checkbox"}].concat((0,l.Z)(n)),a.meta.sort,i.apply)},ouiaId:"cves-table",isStickyHeader:!0,variant:Z.B.compact},o().createElement(r.Fragment,null,o().createElement(S.x,null),o().createElement(j.R,null))),o().createElement(w.Z,null,o().createElement(P.Z,{meta:a.meta,apply:i.apply}))))};R.propTypes={context:g().any,header:g().array,entity:g().object};const A=function(e){return o().createElement(ie.Consumer,null,(function(t){return o().createElement(R,(0,h.Z)({context:t},e))}))};var B=n(74806),I=n(30893),M=n(64196),V=n(93400),F=n(49629),L=n(89421),H=n(32132);const z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.affecting,r=function(t){var n=[!1,!1];t.forEach((function(e){n[e]=!0}));var r=n.join(",");e({affecting:"false,false"===r?"":r,page:1})};return{label:H.N.formatMessage(I.Z.filterSystemsExposed),type:L.Yu.checkbox,urlParam:"affecting",filterValues:{onChange:function(e,t){r(t)},items:d.qr.map((function(e){return{label:e.label,value:e.value}})),value:null==n?void 0:n.split(",").flatMap((function(e,t){return"true"===(null==e?void 0:e.toLowerCase())?t.toString():[]}))}}};var N=n(95859),T=n(9088),U=n(90960),X=n(95351),Y=n(16369),$=n(35938),q=n(54534),G=n(1792),K=n(65538),W=n(33084),J=n(15248);function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var te=function(e){var t=(0,r.useState)(!1),n=(0,s.Z)(t,2),c=n[0],a=n[1],i=e.context,l=i.cves,u=i.params,p=i.methods,f=i.selectedCves,d=i.isAllExpanded,m=u.filter,v=f&&f.length,b=(0,V.Z)({selectedItems:f,selectorHandler:p.selectCves,items:l,fetchResource:function(e){return(0,M.cW)(ee(ee({},u),e))},multiRow:!0}),y=["",{label:e.intl.formatMessage(I.Z.editBusinessRisk),onClick:function(){return p.showBusinessRiskModal(l.data.filter((function(e){return f.includes(e.id)})).map((function(e){return{id:e.id,business_risk_id:e.business_risk_id,business_risk_text:e.business_risk_justification}})))},props:{isDisabled:!v}},{label:e.intl.formatMessage(I.Z.editStatus),onClick:function(){return p.showStatusModal(l.data.filter((function(e){return f.includes(e.id)})).map((function(e){return{id:e.id,exposed_systems_count:e.exposed_systems_count,justification:e.status_justification,status_id:e.status_id}}),[]))},props:{isDisabled:!v}}];return o().createElement(o().Fragment,null,o().createElement(F.Z,{pagination:{itemCount:l.meta.total_items||0,page:l.meta.page||1,perPage:l.meta.page_size||1,ouiaId:"pagination-top",onSetPage:function(e,t){return(0,J.A6)(e,t,p.apply)},onPerPageSelect:function(e,t){return(0,J.lO)(e,t,p.apply)}},actionsConfig:{actions:y,dropdownProps:{ouiaId:"toolbar-actions"}},bulkSelect:{count:v,items:b.items,isDisabled:0===l.meta.total_items&&0===v,checked:Boolean(v),ouiaId:"bulk-select",onSelect:function(){return b.handleOnCheckboxChange()}},filterConfig:{items:[(0,X.Z)("filter",I.Z.cve,I.Z.searchFilterByCveID,m,p.apply),(0,Y.Z)(p.apply,u),(0,q.Z)(p.apply,u),(0,U.Z)(p.apply,u),(0,T.Z)(p.apply,u),(0,$.Z)(p.apply,u),z(p.apply,u),(0,N.Z)(p.apply,u),(0,G.Z)(p.apply,u)]},activeFiltersConfig:{filters:(0,J.DU)(u),onDelete:function(e,t){return(0,J.vH)(t,p.apply)}},exportConfig:ee({isDisabled:0===l.meta.total_items,extraItems:[(0,K.Ec)(c,a)],ouiaId:"export"},(0,J.HV)(p)),expandAll:{isAllExpanded:d,onClick:function(){var t=e.context,n=t.cves,r=t.methods,o=t.isAllExpanded?[]:n.data.filter((function(e){return e.id})).map((function(e){return e.id}));r.openCves(o)}}}),c&&o().createElement(W.Z,{showButton:!1,params:u,filters:(0,J.DU)(u),onSuccess:function(){return a(!1)}}))};te.propTypes={context:g().object,intl:g().object},te.defaultProps={totalNumber:0,apply:function(){},downloadReport:function(){}};const ne=(0,B.ZP)((function(e){return o().createElement(ie.Consumer,null,(function(t){return o().createElement(te,(0,h.Z)({context:t},e))}))}));var re=n(62215),oe=n(83215),ce=n(66123);function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var ie=o().createContext({});const le=function(){var e=(0,u.useDispatch)(),t=(0,r.useState)((function(){return function(){return null}})),n=(0,s.Z)(t,2),c=n[0],a=n[1],h=(0,r.useState)((function(){return function(){return null}})),O=(0,s.Z)(h,2),g=O[0],E=O[1],j=(0,r.useState)(!1),S=(0,s.Z)(j,2),Z=S[0],_=S[1],w=(0,r.useState)(!0),C=(0,s.Z)(w,2),P=C[0],k=C[1],x=(0,u.useSelector)((function(e){return e.CVEsStore.cveList})),D=(0,u.useSelector)((function(e){return e.CVEsStore.parameters})),R=(0,u.useSelector)((function(e){return e.CVEsStore.selectedCves})),B=(0,u.useSelector)((function(e){return e.CVEsStore.expandedRows})),I=(0,u.useSelector)((function(e){return e.CVEsStore.isAllExpanded})),V=(0,r.useMemo)((function(){return(0,m.c_)(x)}),[x]),F=(0,v.H1)(["show_irrelevant"].concat((0,l.Z)(d.kO))),L=(0,s.Z)(F,2),H=L[0],z=L[1],N=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,v.pX)(t);e((0,M.yM)(n))};return(0,r.useEffect)((function(){P?(N(H),k(!1)):(e((0,M.jh)(D)),Z&&z(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},D))||_(!0))}),[D]),(0,r.useEffect)((function(){return function(){e((0,M.Ss)()),e((0,oe.L1)())}}),[e]),V.errors?o().createElement(ce.Z,{code:parseInt(V.errors.status)}):o().createElement(ie.Provider,{value:{cves:V,params:D,selectedCves:R,expandedRows:B,isAllExpanded:I,methods:{apply:N,downloadReport:function(e){re.Z.exec(M.jh,D,e,"cves")},selectCves:function(t,n){e((0,M.EY)(n||[]))},showBusinessRiskModal:function(e){var t=V.meta;E((function(){return function(){return o().createElement(b.Z,{cves:e,updateRef:function(){return(0,v.$)(t,N)}})}}))},showStatusModal:function(e){var t=V.meta;a((function(){return function(){return o().createElement(y.Z,{cves:e,updateRef:function(){return(0,v.$)(t,N)}})}}))},openCves:function(t){e((0,M.Rk)(t))}}}},o().createElement(g,null),o().createElement(c,null),o().createElement(p.K,null,o().createElement(f.v,null,o().createElement(ne,null)),o().createElement(f.v,null,o().createElement(A,{header:d.GL}))))},se=function(){return o().createElement(r.Fragment,null,o().createElement(a.Z,{showBreadcrumb:!1}),o().createElement(c.Z,null,o().createElement(le,null)))}}}]);