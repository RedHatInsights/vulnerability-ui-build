(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[774],{12456:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>xe});var r=n(59713),o=n.n(r),i=n(34575),a=n.n(i),c=n(93913),s=n.n(c),u=n(2205),l=n.n(u),p=n(78585),f=n.n(p),d=n(29754),m=n.n(d),y=n(89583),v=n(90017),b=n(45697),O=n.n(b),g=n(25558),h=n.n(g),E=n(44981),S=n(5977),j=n(65159),P=n(6479),_=n.n(P),D=n(63038),C=n.n(D),w=n(18623),k=n(67154),T=n.n(k),Z=n(319),R=n.n(Z),I=n(72573),x=n(62851),A=n(29515),M=n(52906),L=n(81815),F=n(27272),H=n(67006);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var B=function(e){var t,n=e.context,r=e.header,o=e.entity,i=n.cves,a=n.methods,c=n.selectedCves,s=n.openedCves,u=n.canEditStatus;(null==i||null===(t=i.meta)||void 0===t?void 0:t.patch_access)||(r=r.filter((function(e){return"advisory"!==e.key})));var l=!i.data||0===i.data.length,p=l?[]:i.data.map((function(e){return c.includes(e.id)&&V(V({},e),{},{selected:!0})||e})).map((function(e,t){var n=t%2==0?s.find((function(t){return t.id===e.id}))||!1:{isOpen:void 0};return V(V({},e),{},{isOpen:n&&n.isOpen})}));return h().createElement(g.Fragment,null,i.isLoading?h().createElement(x.c,{colSize:6,rowSize:20}):h().createElement(g.Fragment,null,h().createElement(I.Table,{isStickyHeader:!0,canSelectAll:!1,"aria-label":"Vulnerability CVE table",cells:r,rows:l?function(){var e=n.cves;return[{heightAuto:!0,cells:[{props:{colSpan:8},title:0!==["filter","cvss_from","cvss_to","public_from","public_to","impact","status_id"].filter((function(t){return Object.prototype.hasOwnProperty.call(e.meta,t)&&e.meta[t]})).length?H.UA:o?H.dX:e.data&&0!==e.data.length?void 0:H.vb}]}]}():p,onSelect:l?void 0:function(e,t,r){var o=n.cves,i=n.methods,a=o.data[r]&&o.data[r].id;i.selectCves(t,a)},actionResolver:!l&&u&&function(e,t){return(0,M.k8)(a,o,t.rowIndex)},sortBy:l?void 0:(0,L.hO)([{key:"collapse"},{key:"checkbox"}].concat(R()(r)),i.meta.sort),onCollapse:l?void 0:function(e,t,r){return function(e,t,r){var o=n.cves,i=n.methods,a=n.expandCveDescription,c=o.data[t]&&o.data[t].id;i.openCves(r,[c],a)}(0,t,r)},onSort:l?void 0:function(e,t,n){return(0,L.L6)(t,n,[{key:"collapse"},{key:"checkbox"}].concat(R()(r)),i.meta.sort,a.apply)},gridBreakPoint:"grid-lg",ouiaId:"cves-table"},h().createElement(g.Fragment,null,h().createElement(I.TableHeader,null),h().createElement(I.TableBody,null))),h().createElement(A.f,null,h().createElement(F.Z,{meta:i.meta,apply:a.apply}))))};B.propTypes={context:O().any,header:O().array,entity:O().string};const U=function(e){return h().createElement(Oe.Consumer,null,(function(t){return h().createElement(B,T()({context:t},e))}))};var Y=n(74806),K=n(60120),z=n(73966),W=n(67754),X=n(81159),J=n(34023),$=n(63540),G=n(20018),q=n(64739),Q=n(39888),ee=n(1658),te=n(74268),ne=n(47835),re=n(84589),oe=n(52663),ie=n(96184),ae=n(16721),ce=n(58671),se=n(34970),ue=n(61369),le=n(25032);function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var de=function(e){var t=e.entity,n=e.intl,r=e.context,o=r.cves,i=r.parameters,a=r.methods,c=r.selectedCves,s=r.expandCveDescription,u=r.canEditStatus,l=r.canRemediate,p=i.filter,f=i.advisory,d=l&&(c&&c.length||0),m=(0,g.useMemo)((function(){return(0,te.Z)({selectedItems:c,selectorHandler:a.selectCves,items:o,fetchResource:function(e){return a.fetchResource(fe(fe({},i),e))},multiRow:!0})}),[c,o,i,a]),y=[""].concat(R()(u?[{label:n.formatMessage(w.Z.editStatus),onClick:function(){return a.showStatusModal(R()(c).map((function(e){return fe({id:e},o.data.filter((function(t){return e===t.id})).map((function(e){return{status_id:e.status_id,cve_status_id:e.cve_status_id,justification:e.status_justification,cve_justification:e.cve_status_justification}}))[0])})),[])},props:{isDisabled:!d}}]:[]),[{label:s?n.formatMessage(w.Z.kebabCollapseCves):n.formatMessage(w.Z.kebabExpandCves),onClick:function(){var e=r.cves,t=r.methods,n=r.expandCveDescription,o=!n,i=n?[]:e.data.filter((function(e){return e.id})).map((function(e){return e.id}));t.openCves(o,i,!n)},props:{isDisabled:0===o.meta.total_items}}]),v=c.flatMap((function(e){return o.data.filter((function(t){return e===t.id}))}));return h().createElement(h().Fragment,null,h().createElement(ne.U,{pagination:{itemCount:o.meta.total_items||0,page:o.meta.page||1,perPage:o.meta.page_size||1,ouiaId:"pagination-top",onSetPage:function(e,t){return(0,le.A6)(e,t,a.apply)},onPerPageSelect:function(e,t){return(0,le.lO)(e,t,a.apply)}},dedicatedAction:l&&t&&h().createElement(ee.Z,{systems:t,cves:v}),actionsConfig:{actions:y,kebabToggleProps:{isDisabled:!d&&0===o.meta.total_items},dropdownProps:{ouiaId:"toolbar-actions"}},bulkSelect:{count:d,items:m.items,isDisabled:0===o.meta.total_items&&0===d,checked:Boolean(d),ouiaId:"bulk-select",onSelect:function(){return m.handleOnCheckboxChange()}},filterConfig:{items:[(0,ae.Z)("filter",w.Z.cve,w.Z.searchFilterByCveID,p,a.apply),(0,ce.Z)(a.apply,i),(0,ie.Z)(a.apply,i),(0,oe.Z)(a.apply,i),(0,se.Z)(a.apply,i),(0,ue.Z)(a.apply,i),(0,re.Z)(a.apply,i),(0,ae.Z)("advisory",w.Z.advisory,w.Z.search,f,a.apply)]},activeFiltersConfig:{filters:(0,le.DU)(i),onDelete:function(e,t){return(0,le.vH)(t,a.apply)}},exportConfig:fe({isDisabled:0===o.meta.total_items,ouiaId:"export"},(0,le.HV)(a))}))};de.defaultProps={totalNumber:0,apply:function(){},downloadReport:function(){}},de.propTypes={entity:O().string,context:O().object,intl:O().any};const me=(0,Y.ZP)((function(e){return h().createElement(Oe.Consumer,null,(function(t){return h().createElement(de,T()({context:t},e))}))}));var ye=n(73727);function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Oe=(0,g.createContext)({}),ge=function(e){var t,n=e.entity,r=e.intl,o=e.allowedCveActions,i=e.showHeaderLabel,a=e.setPageTitle,c=(0,E.useDispatch)(),s=(0,g.useState)((function(){return function(){return null}})),u=C()(s,2),l=u[0],p=u[1],f=(0,g.useState)(!1),d=C()(f,2),m=d[0],y=d[1],b=(0,g.useState)(!0),O=C()(b,2),S=O[0],P=O[1],_=(0,E.useSelector)((function(e){return e.SystemCvesStore.cveList})),D=(0,E.useSelector)((function(e){return e.SystemCvesStore.parameters})),k=(0,E.useSelector)((function(e){return e.SystemCvesStore.selectedCves})),T=(0,E.useSelector)((function(e){return e.SystemCvesStore.openedCves})),Z=(0,E.useSelector)((function(e){return e.SystemCvesStore.expandCveDescription})),R=["REMEDIATE","EDIT_STATUS"].map((function(e){return o.includes(e)})),I=C()(R,2),x=I[0],A=I[1],M=(0,g.useMemo)((function(){return(0,W.l3)(n.id,_)}),[_]),F=(0,L._W)(z.kO),N=C()(F,2),V=N[0],B=N[1],Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,L.pX)(e);c((0,j.KV)(t))};return(0,g.useEffect)((function(){a&&(document.title="".concat(n.display_name,"\n                - ").concat(r.formatMessage(w.Z.systemsHeader)," - ").concat(r.formatMessage(w.Z.pageTitleSuffix))),S?(Y(be({sort:"-public_date"},B)),P(!1)):(c((0,j.E8)(be(be({},D),{},{system:n.id}))),m&&V(be({},D))||y(!0))}),[D]),(0,g.useEffect)((function(){return function(){c((0,j.jS)())}}),[]),_.payload.errors?(t=_.payload.errors.status,404===parseInt(t)&&n.id?H.yE:(c((0,v.clearNotifications)()),H.pY)):h().createElement(Oe.Provider,{value:{cves:M,parameters:D,selectedCves:k,openedCves:T,expandCveDescription:Z,canRemediate:x,canEditStatus:A,methods:{apply:Y,downloadReport:function(e){var t=be(be({},D),{},{system:n.id});q.Z.exec(j.E8,t,e,"system-cves")},selectCves:function(e,t){c((0,j.TT)(t))},openCves:function(e,t,n){c((0,j.pJ)({isOpen:e,cves:t,expandCveDescription:n}))},showStatusModal:function(e){var t=Array.from(M.data.filter((function(t){return e.some((function(e){return e.id===t.id}))})));t=t.map((function(e){return{id:e.id,cve_status_id:e.cve_status_id,status_id:e.status_id,justification:e.status_justification,cve_justification:e.cve_status_justification}})),p((function(){return function(){return h().createElement(Q.Z,{cveList:t,updateRef:function(){return(0,L.$)(M.meta,Y)},inventoryList:[{id:n.id,display_name:n.display_name}],type:"systemDetail"})}}))},fetchResource:function(e){return(0,j.KX)(be(be({},e),{},{system:n.id}))}}}},h().createElement(l,null),h().createElement(X.Stack,{hasGutter:!0},i&&h().createElement(J.StackItem,null,h().createElement(G.TextContent,null,h().createElement($.Text,{component:$.TextVariants.h2},r.formatMessage(w.Z.cvesHeader)))),h().createElement(J.StackItem,null,h().createElement(me,{entity:n.id}))),h().createElement(U,{header:z.Vm,entity:n.id}))};ge.defaultProps={allowedCveActions:[],showHeaderLabel:!1,setPageTitle:!1},ge.propTypes={entity:O().object,intl:O().any,allowedCveActions:O().array,showHeaderLabel:O().bool};var he=(0,S.EN)((0,Y.ZP)(ge)),Ee=function(e){var t=e.customItnlProvider,n=e.customRouter,r=_()(e,["customItnlProvider","customRouter"]),o=n?ye.BrowserRouter:g.Fragment,i=t?K.Z:g.Fragment;return h().createElement(i,t&&{locale:navigator.language.slice(0,2),messages:w.Z},h().createElement(o,n&&{basename:"".concat(window.location.pathname)},h().createElement(he,r)))};Ee.propTypes={customItnlProvider:O().bool,customRouter:O().bool},Ee.defaultProps={customItnlProvider:!1,customRouter:!1};var Se=function(e){l()(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=m()(t);if(n){var o=m()(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return f()(this,e)});function o(e){return a()(this,o),r.call(this,e)}return s()(o,[{key:"render",value:function(){var e=this.props,t=e.entity,n=e.isOptOut,r=e.optOutSystemHandler,o=e.loaded;return t&&o?n?h().createElement(h().Fragment,null,h().createElement(H.o0,{buttonAction:function(){return r(!1)}})):h().createElement(h().Fragment,null,h().createElement(he,{entity:{id:t.id,display_name:t.display_name},allowedCveActions:["EDIT_STATUS","REMEDIATE"],showHeaderLabel:!0,setPageTitle:!0})):null}}]),o}(h().Component);Se.propTypes={entity:O().object,isOptOut:O().bool,loaded:O().bool,optOutSystemHandler:O().func};const je=(0,S.EN)((0,E.connect)((function(e){var t=e.entityDetails;return{entity:t.entity,isOptOut:t.opt_out,loaded:t.loaded}}),null)(Se));var Pe=n(2545);function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function De(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ce={loaded:!1},we=n(51937),ke=n(91067),Te=n(58135);function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ie=function(e){l()(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=m()(t);if(n){var o=m()(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return f()(this,e)});function o(e){var t;return a()(this,o),(t=r.call(this,e)).optOutSystem=function(e){t.props.optOutSystem(t.state.inventoryId,e).then((function(){t.props.fetchSystemDetails(t.state.inventoryId),!0===e?t.props.addNotification({variant:"success",title:t.props.intl.formatMessage(w.Z.inventoryOptOutSuccess)}):t.props.addNotification({variant:"success",title:t.props.intl.formatMessage(w.Z.inventoryResumeAnalysisTitle),description:t.props.intl.formatMessage(w.Z.inventoryResumeAnalysisDescription)})}))},t.state={inventoryId:t.props.match.params.inventoryId},t}return s()(o,[{key:"componentDidMount",value:function(){this.props.fetchSystemDetails(this.state.inventoryId)}},{key:"render",value:function(){var e=this,t=this.props,n=t.systemDetails,r=void 0===n?{}:n,o=t.errors,i=r.opt_out,a=void 0!==i&&i,c=r.entity,s=r.loaded;return h().createElement(h().Fragment,null,h().createElement(Te.c0,null,h().createElement(ke.Z,{title:"",breadcrumbs:[{title:z.yy.systemsPage.title,to:z.yy.systemsPage.to,loaded:!0},{title:(null==c?void 0:c.display_name)||this.props.intl.formatMessage(w.Z.invalidSystem),isActive:!0,loaded:s}]},!o&&h().createElement(Te.$w,{onLoad:function(t){var n=t.mergeWithEntities,r=t.mergeWithDetail,o=t.INVENTORY_ACTION_TYPES;we.Z.register(Re(Re({},n()),r(function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case Pe.up+"_FULFILLED":return De(De({},n),r.payload.data);case e.LOAD_ENTITY_FULFILLED:return De(De({},n),{},{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return h().createElement(je,{optOutSystemHandler:t})}}]});case e.LOAD_ENTITY_REJECTED:return De(De({},n),{},{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return h().createElement(je,null)}}]});default:return n}}}(o,e.optOutSystem))))},hideBack:!0,actions:c&&[a?{title:this.props.intl.formatMessage(w.Z.inventoryKebabOptionsResume),onClick:function(){return e.optOutSystem(!1)}}:{title:this.props.intl.formatMessage(w.Z.inventoryKebabOptionsExclude),onClick:function(){return e.optOutSystem(!0)}}]})),h().createElement(y.o,null,h().createElement(h().Fragment,null,h().createElement(Te.my,{optOutSystemHandler:this.optOutSystem})))))}}]),o}(h().Component);Ie.propTypes={fetchSystemDetails:O().func,systemDetails:O().object,optOutSystem:O().func,match:O().object,addNotification:O().func,intl:O().any,errors:O().object};const xe=(0,S.EN)((0,Y.ZP)((0,E.connect)((function(e){return{errors:e.SystemCvesStore.cveList.payload.errors,systemDetails:e.entityDetails}}),(function(e){return{optOutSystem:function(t,n){return e((0,j.DP)(t,n))},fetchSystemDetails:function(t){return e((0,j.o0)(t))},addNotification:function(t){return e((0,v.addNotification)(t))}}}))(Ie)))}}]);
//# sourceMappingURL=SystemDetailsPage.6094c6a805f6058721d4.js.map