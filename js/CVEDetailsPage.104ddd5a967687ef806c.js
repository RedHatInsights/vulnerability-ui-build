(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[226],{87110:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var r=a(94015),n=a.n(r),s=a(23645),l=a.n(s)()(n());l.push([e.id,".vulnerability .label{min-width:140px}.vulnerability .l-sm-spacer{margin-left:var(--pf-global--spacer--sm)}.vulnerability .ansible-success{color:var(--pf-global--success-color--200)}.vulnerability .card-box{border:1px solid var(--pf-global--BorderColor--dark-100)}.vulnerability .fontsize--lg{font-size:var(--pf-global--FontSize--lg)}.vulnerability .checkCircleIcon{color:var(--pf-global--success-color--100);vertical-align:-0.15em}.vulnerability .powerOffIcon{color:var(--pf-global--danger-color--100);vertical-align:'-0.125em'}.vulnerability .outlinedQuestionCircleIcon{color:var(--pf-global--secondary-color--100)}\n","",{version:3,sources:["webpack://./src/Components/PresentationalComponents/CSAwRuleBox/CSAwRuleBox.scss"],names:[],mappings:"AAAA,sBACO,eAAe,CADtB,4BACoC,wCAAwC,CAD5E,gCAC8F,0CAA0C,CADxI,yBACmJ,wDAAwD,CAD3M,6BAC0N,wCAAwC,CADlQ,gCACoR,0CAA0C,CAAC,sBAAsB,CADrV,6BACoW,yCAAyC,CAAC,yBAAyB,CADva,2CACoc,4CAA4C",sourcesContent:[".vulnerability{\n.label{min-width:140px}.l-sm-spacer{margin-left:var(--pf-global--spacer--sm)}.ansible-success{color:var(--pf-global--success-color--200)}.card-box{border:1px solid var(--pf-global--BorderColor--dark-100)}.fontsize--lg{font-size:var(--pf-global--FontSize--lg)}.checkCircleIcon{color:var(--pf-global--success-color--100);vertical-align:-0.15em}.powerOffIcon{color:var(--pf-global--danger-color--100);vertical-align:'-0.125em'}.outlinedQuestionCircleIcon{color:var(--pf-global--secondary-color--100)}\n\n}"],sourceRoot:""}]);const c=l},36257:(e,t,a)=>{"use strict";a.r(t),a.d(t,{CVEPageContext:()=>Ye,default:()=>Xe});var r=a(63038),n=a.n(r),s=a(98446),l=a(86350),c=a(45697),o=a.n(c),i=a(25558),u=a.n(i),m=a(52906),f=a(276),v=a(57721),d=a(5977),p=a(59912),g=a(50693),E=a(16475),y=a(49739),b=a(83826),Z=a(68340),h=a(68774),N=a(74806),C=a(18623),M=function(e){var t=e.cveAttributes,a=e.intl,r=t.public_date,n=t.description,s=t.rh_link;return u().createElement(y.K,{hasGutter:!0},u().createElement(b.v,{className:"pf-u-mt-sm"},u().createElement("div",null,a.formatMessage(C.Z.publishDate),": ",r)),u().createElement(b.v,null,u().createElement(h.D,null,u().createElement(Z.x,{component:Z.q.p},n))),u().createElement(b.v,{className:"pf-u-mt-sm pf-u-mb-md"},s))};M.propTypes={cveAttributes:o().any,intl:o().any};const _=(0,N.ZP)(M);var V=a(79851),x=a(34512),A=a(90496),P=a(81815),S=a(6479),w=a.n(S),k=a(22210),D=a(91290),O=a(3351),j=a(22860),L=a(6934),R=a(75863),B=a(56455),I=a(6023),T=a(24561),H=function(e){if(void 0===e||!1!==e.loading)switch(e.variant){case"spinner":return u().createElement(I.Z,{centered:!0});case"cvePageOverviewItem":return u().createElement(z,null);case"list":return u().createElement(T.aV,null);case"bulletList":return u().createElement(T.DY,null);case"trendBox":return u().createElement(F,null);case"currentVulnerabilitiesItem":return u().createElement(q,null);default:return u().createElement(B.Z,{size:B.i.lg})}return e.children},z=function(){return u().createElement(T.ZP,{height:61,width:120},u().createElement("rect",{x:"35",y:"0",rx:"0",ry:"0",width:"50",height:"35"}),u().createElement("rect",{x:"0",y:"45",rx:"0",ry:"0",width:"120",height:"16"}))},F=function(){return u().createElement(T.ZP,{height:100,width:300},u().createElement("rect",{x:"388.58",y:"109.13",rx:"0",ry:"0",width:"0",height:"0"}),u().createElement("rect",{x:"11.58",y:"16.13",rx:"0",ry:"0",width:"37",height:"62"}),u().createElement("rect",{x:"52.58",y:"52.13",rx:"0",ry:"0",width:"17",height:"26"}),u().createElement("rect",{x:"76.58",y:"52.13",rx:"0",ry:"0",width:"17",height:"26"}),u().createElement("rect",{x:"4.58",y:"82.13",rx:"0",ry:"0",width:"154",height:"22"}))},q=function(){return u().createElement(T.ZP,{height:50,width:200,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},u().createElement("rect",{x:"82.58",y:"15.13",rx:"0",ry:"0",width:"110.88",height:"21.42"}),u().createElement("circle",{cx:"25",cy:"25",r:"25"}))};H.propTypes={loading:o().bool,variant:o().string};const J=H;var K=a(11550),G={AV:{name:K.N.formatMessage(C.Z.vectorNamesV3AV),values:{N:K.N.formatMessage(C.Z.vectorValuesNetwork),A:K.N.formatMessage(C.Z.vectorValuesAdjacent),L:K.N.formatMessage(C.Z.vectorValuesLocal),P:K.N.formatMessage(C.Z.vectorValuesPhysical)}},AC:{name:K.N.formatMessage(C.Z.vectorNamesV3AC),values:{L:K.N.formatMessage(C.Z.vectorValuesLow),H:K.N.formatMessage(C.Z.vectorValuesHigh)}},PR:{name:K.N.formatMessage(C.Z.vectorNamesV3PR),values:{N:K.N.formatMessage(C.Z.vectorValuesNone),L:K.N.formatMessage(C.Z.vectorValuesLow),H:K.N.formatMessage(C.Z.vectorValuesHigh)}},UI:{name:K.N.formatMessage(C.Z.vectorNamesV3UI),values:{N:K.N.formatMessage(C.Z.vectorValuesNone),R:K.N.formatMessage(C.Z.vectorValuesRequired)}},S:{name:K.N.formatMessage(C.Z.vectorNamesV3S),values:{U:K.N.formatMessage(C.Z.vectorValuesUnchanged),C:K.N.formatMessage(C.Z.vectorValuesChanged)}},C:{name:K.N.formatMessage(C.Z.vectorNamesV3C),values:{N:K.N.formatMessage(C.Z.vectorValuesNone),L:K.N.formatMessage(C.Z.vectorValuesLow),H:K.N.formatMessage(C.Z.vectorValuesHigh)}},I:{name:K.N.formatMessage(C.Z.vectorNamesV3I),values:{N:K.N.formatMessage(C.Z.vectorValuesNone),L:K.N.formatMessage(C.Z.vectorValuesLow),H:K.N.formatMessage(C.Z.vectorValuesHigh)}},A:{name:K.N.formatMessage(C.Z.vectorNamesV3A),values:{N:K.N.formatMessage(C.Z.vectorValuesNone),L:K.N.formatMessage(C.Z.vectorValuesLow),H:K.N.formatMessage(C.Z.vectorValuesHigh)}},CVSS:{name:K.N.formatMessage(C.Z.vectorNamesCvssVersion),values:{"3.0":3}}},W={AV:{name:K.N.formatMessage(C.Z.vectorNamesV2AV),values:{N:K.N.formatMessage(C.Z.vectorValuesNetwork),A:K.N.formatMessage(C.Z.vectorValuesAdjacentNetwork),L:K.N.formatMessage(C.Z.vectorValuesLocal)}},AC:{name:K.N.formatMessage(C.Z.vectorNamesV2AC),values:{N:K.N.formatMessage(C.Z.vectorValuesNone),L:K.N.formatMessage(C.Z.vectorValuesLow),H:K.N.formatMessage(C.Z.vectorValuesHigh)}},Au:{name:K.N.formatMessage(C.Z.vectorNamesV2AU),values:{M:K.N.formatMessage(C.Z.vectorValuesMultiple),S:K.N.formatMessage(C.Z.vectorValuesSingle),N:K.N.formatMessage(C.Z.vectorValuesNone)}},C:{name:K.N.formatMessage(C.Z.vectorNamesV2C),values:{C:K.N.formatMessage(C.Z.vectorValuesComplete),P:K.N.formatMessage(C.Z.vectorValuesPartial),N:K.N.formatMessage(C.Z.vectorValuesNone)}},I:{name:K.N.formatMessage(C.Z.vectorNamesV2I),values:{C:K.N.formatMessage(C.Z.vectorValuesComplete),P:K.N.formatMessage(C.Z.vectorValuesPartial),N:K.N.formatMessage(C.Z.vectorValuesNone)}},A:{name:K.N.formatMessage(C.Z.vectorNamesV2A),values:{C:K.N.formatMessage(C.Z.vectorValuesComplete),P:K.N.formatMessage(C.Z.vectorValuesPartial),N:K.N.formatMessage(C.Z.vectorValuesNone)}}},U=a(93329),Q=function(e){var t,a,r,s=e.cvss2_metrics,l=e.cvss3_metrics,c=e.intl,o=(l?"CVSS 3.0":s&&"CVSS 2.0")||"CVSS 3.0",i=l||s,m=(a=l&&G||s&&W,r={},(t=i)&&t.split("/").forEach((function(e){var t=e.split(":"),s=n()(t,2),l=s[0],c=s[1],o=a[l]&&a[l].name,i=a[l]&&a[l].values[c]||"N/A";o&&(r[o]=i)})),r),f=(m.cvssVersion,w()(m,["cvssVersion"]));return u().createElement(Ye.Consumer,null,(function(t){return u().createElement(h.D,null,u().createElement(J,{loading:t.isLoading},u().createElement(k.J,{id:"popover-cvss",position:"bottom",maxWidth:"100%",enableFlip:!0,headerContent:"".concat(o," ").concat(c.formatMessage(C.Z.cvssVectorPopoverTitle)),bodyContent:i?u().createElement(O.i,{"aria-label":"Metric breakdown",variant:R.B.compact,gridBreakPoint:null,cells:[c.formatMessage(C.Z.cvssVectorMetric),c.formatMessage(C.Z.cvssVectorValue)],rows:Object.entries(f)},u().createElement(L.x,null),u().createElement(j.R,null)):"N/A"},u().createElement(u().Fragment,null,u().createElement(U.Z,{isLarge:!0,style:{cursor:"pointer"},className:"pf-u-mb-xs"},o," ",c.formatMessage(C.Z.cvssVectorVectorString),u().createElement(D.ZP,{color:"var(--pf-global--secondary-color--100)",className:"pf-u-ml-xs",style:{verticalAlign:"-0.125em"}}))))),u().createElement(J,{loading:t.isLoading},u().createElement("span",{className:"pf-u-mr-md"},e.score),u().createElement("span",{style:{fontSize:"small"}},c.formatMessage(C.Z.vector)+": ",(null==i?void 0:i.substring(i.indexOf("/")+1))||"N/A")))}))};Q.propTypes={cvss2_metrics:o().string,cvss3_metrics:o().string,score:o().any,intl:o().any};const Y=(0,N.ZP)(Q);var $=function(e){var t=e.title,a=e.value,r=e.content;return u().createElement(k.J,{id:"popover",bodyContent:r,headerContent:"","aria-label":"Business risk popover",position:"right"},u().createElement(y.K,{style:{display:"inline-block",cursor:"pointer"}},u().createElement(b.v,null,u().createElement(U.Z,{isLarge:!0},t)),u().createElement(b.v,null,u().createElement("a",null,a))))};$.propTypes={title:o().any,value:o().any,content:o().any};const X=$;var ee=a(69957),te=a(89687),ae=function(e){var t=e.cveAttributes,a=e.intl,r=(0,P.nJ)(t.impact||"Unknown"),n=t.business_risk,s=t.business_risk_justification,l=t.status,c=t.status_justification,o=t.systems_status_detail,i=t.systems_status_divergent,m=o&&Object.keys(o).map((function(e){return[p.Em.find((function(t){return t.value===e.toString()})).label,o[e].toString()]})),f=u().createElement(y.K,{className:"pf-u-p-xs"},u().createElement(b.v,null,u().createElement(U.Z,{className:"pf-u-mb-xs"},a.formatMessage(C.Z.justificationNote))),u().createElement(b.v,null,s||"--")),v=u().createElement(y.K,{className:"pf-u-p-xs"},u().createElement(b.v,null,u().createElement(U.Z,{className:"pf-u-mb-xs"},a.formatMessage(C.Z.cveStatus)),l||"--",u().createElement(U.Z,{className:"pf-u-mb-xs pf-u-mt-sm"},a.formatMessage(C.Z.justificationNote)),c||"--"),i>0&&u().createElement(b.v,null,u().createElement(h.D,null,u().createElement("hr",{className:"pf-u-mt-sm pf-u-mb-sm"})),u().createElement(U.Z,{isLarge:!0},a.formatMessage(C.Z.cveDetailsPageSystemsWTCves)),u().createElement(O.i,{"aria-label":"Status details",gridBreakPoint:null,cells:[a.formatMessage(C.Z.statusLabel),a.formatMessage(C.Z.count)],rows:m,className:"status-breakdown-table",variant:"compact"},u().createElement(L.x,null),u().createElement(j.R,null))));return u().createElement(y.K,{hasGutter:!0},u().createElement(b.v,null,u().createElement(V.P,{hasGutter:!0},u().createElement(x.J,null,u().createElement(X,{title:a.formatMessage(C.Z.businessRiskLabel),value:n,content:f})),u().createElement(x.J,{className:"pf-u-ml-lg"},u().createElement(X,{title:a.formatMessage(C.Z.statusLabel),content:v,value:u().createElement("span",null,i>0&&u().createElement(ee.ZP,{color:"var(--pf-global--primary-color--100)"})," ",l)})))),u().createElement(b.v,null,u().createElement(U.Z,{className:"pf-u-mb-xs",isLarge:!0},a.formatMessage(C.Z.impact)),u().createElement("span",{style:{fontWeight:700,color:r.color}},u().createElement(te.Z,{impact:r.title,hasLabel:!0}))),u().createElement(b.v,null,u().createElement(Y,{cvss2_metrics:t.cvss2_metrics,cvss3_metrics:t.cvss3_metrics,score:(0,A.Z)(t.cvss2_score,t.cvss3_score)})))};ae.propTypes={cveAttributes:o().any,intl:o().any};const re=(0,N.ZP)(ae);var ne=a(44479),se=a(32203),le=a(62394),ce=a(47173),oe=a(73727),ie=a(78216),ue=a(68778),me=a(15265),fe=a(26076),ve=a(10816),de=a(56223),pe=(a(15047),function(e){var t=e.rules,a=e.synopsis,r=e.changeExposedSystemsParameters,s=e.intl,l=(0,f.useDispatch)(),c=(0,i.useState)(2),o=n()(c,2),m=o[0],v=o[1],d=[].concat(t).sort((function(e,t){return t.systems_affected-e.systems_affected})),N=d.length>m&&d.slice(0,m)||d;return u().createElement(i.Fragment,null,N&&N.map((function(e){var t;return e.summary&&u().createElement(se.Z,{className:"card-box",key:e.rule_id},u().createElement(le.e,null,u().createElement(g.r,{hasGutter:!0},u().createElement(E.P,{span:12},u().createElement(h.D,null,u().createElement(Z.x,{component:Z.q.h3},u().createElement(ne.u,{content:s.formatMessage(C.Z.rulesIconTooltip)},u().createElement(ve.Z,{className:"pf-u-mr-sm"})),e.description))),u().createElement(E.P,{md:8,sm:12},u().createElement(y.K,{hasGutter:!0},u().createElement(b.v,null,u().createElement(de.Z,{text:e.summary})),u().createElement(b.v,null,u().createElement(h.D,null,u().createElement(V.P,null,e.rule_impact&&u().createElement(x.J,null,u().createElement(U.Z,{className:"label pf-u-mb-xs"},s.formatMessage(C.Z.impact)),u().createElement(ne.u,{content:Object.values(p.l8)[e.rule_impact-1]},u().createElement(ie.Z,{value:e.rule_impact}))),u().createElement(x.J,null,u().createElement(U.Z,{className:"label pf-u-mb-xs"},s.formatMessage(C.Z.riskOfChange)),u().createElement(ne.u,{content:p.p3[e.change_risk]},p.MS[e.change_risk])),u().createElement(x.J,null,u().createElement(U.Z,{className:"label pf-u-mb-xs"},s.formatMessage(C.Z.remediationLabel)),u().createElement(V.P,null,u().createElement(x.J,null,e.playbook_count?u().createElement(i.Fragment,null,u().createElement(ue.ZP,{className:"checkCircleIcon pf-u-mr-xs"}),s.formatMessage(C.Z.yes),u().createElement(ne.u,{content:s.formatMessage(C.Z.ansibleRemediationTooltip)},u().createElement(D.ZP,{className:"l-sm-spacer outlinedQuestionCircleIcon"}))):s.formatMessage(C.Z.no)),u().createElement(x.J,{className:"pf-u-ml-md"},e.reboot_required&&u().createElement(Z.x,null,u().createElement(fe.ZP,{className:"pf-u-mr-xs powerOffIcon"}),s.formatMessage(C.Z.rebootRequired)))))))),e.kbase_node_id&&u().createElement(b.v,null,u().createElement(h.D,null,u().createElement(Z.x,{className:"pf-u-mt-xs",component:Z.q.p},u().createElement("a",{className:"kb-link",href:"".concat(p.E7,"/").concat(e.kbase_node_id),target:"_blank",rel:"noopener noreferrer"},s.formatMessage(C.Z.knowledgebaseArticle),u().createElement(me.ZP,{className:"l-sm-spacer"}))))))),u().createElement(E.P,{md:4,sm:12},u().createElement(y.K,{hasGutter:!0},e.rule_id&&u().createElement(b.v,null,u().createElement(h.D,null,u().createElement(Z.x,{className:"filter-affected-systems",onClick:function(){return t=e.rule_id,void l(r({rule_key:t,rule_presence:"true"}));var t}},u().createElement(oe.Link,{key:e.rule_id,to:"/cves/".concat(a,"/?rule_key=").concat(e.rule_id)},s.formatMessage(C.Z.filterByAffectedSystems,{count:null!==(t=e.systems_affected)&&void 0!==t?t:-1}))))),u().createElement(b.v,null,u().createElement(h.D,null,u().createElement(U.Z,null,s.formatMessage(C.Z.associatedCves)),u().createElement(Z.x,{component:Z.q.p,className:"pf-u-mt-xs"},a," (",s.formatMessage(C.Z.current),")",e.associated_cves.filter((function(e){return e!==a})).map((function(e,t){return u().createElement("a",{className:"associated-cve-link",key:t,href:"".concat(p.OF,"/").concat(e)},e)})).reduce((function(e,t){return[e,", ",t]}),[""])))))))))})),t.length>m&&u().createElement(g.r,null,u().createElement(E.P,null,u().createElement(ce.zx,{key:"viewMoreRules",variant:"secondary",onClick:function(){return v(t.length)}},s.formatMessage(C.Z.viewMoreSecurityRules,{rules:t.length-m})))))});pe.defaultProps={rules:[]},pe.propTypes={intl:o().any,rules:o().array,synopsis:o().string,changeExposedSystemsParameters:o().func};const ge=(0,N.ZP)(pe);var Ee=a(70),ye=a(86896),be=a(59713),Ze=a.n(be),he=a(69174);function Ne(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ce(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(a),!0).forEach((function(t){Ze()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ne(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Me=function(e){var t=e.style,a=e.className;return u().createElement(he._,{color:"red-50",style:Ce({fontWeight:200},t),className:a},"Known exploit")};Me.propTypes={style:o().object,className:o().string};const _e=Me;var Ve=function(){var e=(0,ye.Z)();return u().createElement(se.Z,{className:"card-box"},u().createElement(Ee.l,null,u().createElement(h.D,null,u().createElement(Z.x,{component:Z.q.h3},u().createElement(_e,{className:"pf-u-mr-sm"}),e.formatMessage(C.Z.knownExploitHeader)))),u().createElement(le.e,null,e.formatMessage(C.Z.knownExploitBody)))},xe=function(e){var t=e.data,a=e.changeExposedSystemsParameters;return u().createElement(Ye.Consumer,null,(function(e){return u().createElement(g.r,{hasGutter:!0},u().createElement(E.P,{md:8,sm:12},u().createElement(J,{loading:e.isLoading,variant:"spinner"},u().createElement(_,{cveAttributes:t.data}))),u().createElement(E.P,{md:4,sm:12,className:"pf-u-mt-sm pf-u-ml-sm"},u().createElement(re,{cveAttributes:t.data})),t.data.known_exploit&&u().createElement(Ve,null),u().createElement(ge,{changeExposedSystemsParameters:a,synopsis:t.data.synopsis,rules:t.data.rules}))}))};xe.propTypes={data:o().object,changeExposedSystemsParameters:o().func};const Ae=xe;var Pe=a(16343),Se=a(96282),we=a(39005),ke=a(319),De=a.n(ke),Oe=a(39888),je=a(51937),Le=a(74268),Re=a(25413),Be=a(64739),Ie=a(1658),Te=a(16721),He=a(58671),ze=a(61369),Fe=a(25032),qe=a(33739),Je=a(12140);function Ke(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ge(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(a),!0).forEach((function(t){Ze()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ke(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var We=function(e){var t,a=(0,i.useState)((function(){return function(){return null}})),r=n()(a,2),s=r[0],l=r[1],c=(0,i.useState)(void 0),o=n()(c,2),d=o[0],g=o[1],E=u().createRef(),N=(0,f.useDispatch)(),M=(0,P.H1)(p.qB),_=n()(M,2),V=_[0],x=_[1],A=(0,i.useState)(!0),S=n()(A,2),w=S[0],k=S[1],D=(0,f.useSelector)((function(e){return e.CVEDetailsPageStore.affectedSystemsByCVE})),O=(0,f.useSelector)((function(e){return e.CVEDetailsPageStore.affectedSystemsByCVE.isLoading})),j=(0,f.useSelector)((function(e){return e.CVEDetailsPageStore.parameters}),f.shallowEqual),L=(0,f.useSelector)((function(e){return e.CVEDetailsPageStore.affectedSystemsByCVE.payload.meta})),B=(0,i.useMemo)((function(){return(0,m.q6)(Ge({},D),e.cve)}),[D]),I=function(e){return N((0,v.vv)(e))},T=function(e,t){g(t||[])};je.N.addNew({on:"SELECT_ENTITY",callback:function(e){return function(e){var t=e.data.selected?[e.data.id].concat(De()(d||[])):d&&d.filter((function(t){return t!==e.data.id}));T(0,t)}(e)}}),(0,i.useEffect)((function(){I(V),k(!1)}),[]),(0,Je.Z)((function(){w||(x(Ge({},j)),N((0,v.TA)(e.cve,Ge({},j))))}),[j,w]),(0,i.useEffect)((function(){d&&N((0,v.lA)(d))}),[d,N]),(0,i.useEffect)((function(){return function(){N((0,v.ds)()),N((0,v.r5)())}}),[]);var H=function(t,a){l((function(){return function(){return u().createElement(Oe.Z,{cveList:t,updateRef:function(){(0,P.$)(B.meta,I),(0,v.ZO)(e.cve)},inventoryList:a,type:"systemsExposed"})}}))},z=["",{label:e.intl.formatMessage(C.Z.editStatus),onClick:function(){return H([e.cveStatusDetails],B.data.filter((function(e){return d.includes(e.inventory_id)})).map((function(e){return{inventory_id:e.inventory_id,display_name:e.display_name,status_id:e.status_id,justification:e.status_text}})))},props:{isDisabled:!d||0===d.length}}],F=(0,i.useMemo)((function(){return(0,Le.Z)({selectedItems:d||[],selectorHandler:T,items:B.data&&B||{data:[],meta:{total_items:0}},fetchResource:function(t){return(0,v.Wf)(e.cve,Ge(Ge({},j),t))}})}),[B,d,j]),q=(0,i.useMemo)((function(){return null==B?void 0:B.data.filter((function(e){return null==d?void 0:d.includes(e.id)}))}),[d,B]),J=(null==B||null===(t=B.meta)||void 0===t?void 0:t.patch_access)?p.RD:p.RD.filter((function(e){return"advisory"!==e.key}));return u().createElement(u().Fragment,null,u().createElement(y.K,{hasGutter:!0},u().createElement(b.v,null,u().createElement(h.D,null,u().createElement(Z.x,{component:Z.q.h2},e.intl.formatMessage(C.Z.systemsExposedTableHeader)))),u().createElement(b.v,null,u().createElement(qe.Z,{onLoad:function(e){var t=e.mergeWithEntities,a=e.mergeWithDetail;je.Z.register(Ge(Ge({},t((0,Re.K)(p.jp))),a()))},tableProps:{isStickyHeader:!0,canSelectAll:!1,onSort:B.data.length>0&&function(e,t,a){return(0,P.L6)(t,a,J,V.sort,I)},sortBy:B.data.length>0&&(0,P.hO)(J,L.sort),actionResolver:function(t,a){return B.data.length>0&&(0,m.ji)(H,e.cveStatusDetails,a.rowIndex)},variant:R.B.compact},showTags:!0,items:B.data,key:"inventory",ref:E,expandable:"true",onRefresh:function(e){var t=e.page,a=e.per_page;!E.current||L.page===t&&L.page_size===a||I({page:t,page_size:a}),L&&L.total_items<=a&&E.current&&E.current.onRefreshData({page:t,page_size:a})},page:j.page,total:L.total_items,isLoaded:!O,perPage:j.page_size,hasCheckbox:B&&0!==B.length,showActions:B&&0!==B.length,exportConfig:Ge({isDisabled:0===B.meta.total_items&&(!d||0===d.length),ouiaId:"export"},(0,Fe.HV)({downloadReport:function(t){var a=[e.cve,Ge({},j)];Be.Z.exec(v.TA,a,t,"systems-exposed")}})),onExpandClick:function(e,t,a,r){var n=r.id;return N((0,v.yw)(n,a))},dedicatedAction:!O&&u().createElement(Ie.Z,{manyRules:!0,systems:q,cves:{id:e.cve,rules:e.filterRuleValues}}),actionsConfig:{actions:z,kebabToggleProps:{isDisabled:!d||0===d.length},dropdownProps:{ouiaId:"toolbar-actions"}},activeFiltersConfig:{filters:(0,Fe.DU)(Ge({},j),e.filterRuleValues),onDelete:function(e,t){return(0,Fe.vH)(t,I)}},bulkSelect:F&&{count:d&&d.length,items:F.items,isDisabled:0===B.meta.total_items&&(!d||0===d.length),checked:Boolean(d&&d.length),ouiaId:"bulk-select",onSelect:function(){return F.handleOnCheckboxChange()}},filterConfig:{items:[(0,Te.Z)("filter",C.Z.systemsSearchName,C.Z.searchFilterByName,j.filter,I),(0,He.Z)(I,j,e.filterRuleValues),(0,ze.Z)(I,j),(0,Te.Z)("advisory",C.Z.advisory,C.Z.search,j.advisory,I)]}},s&&u().createElement(s,null)))))};We.propTypes={intl:o().object,cve:o().string,cveStatusDetails:o().object,filterRuleValues:o().array};const Ue=(0,N.ZP)((0,d.EN)(We));var Qe=a(91067),Ye=u().createContext({isLoading:!0}),$e=function(e){var t,a,r=(0,f.useDispatch)(),c=(0,i.useState)(e.match.params.cve),o=n()(c,1)[0],d=(0,i.useState)((function(){return function(){return null}})),g=n()(d,2),E=g[0],y=g[1],b=(0,i.useState)((function(){return function(){return null}})),Z=n()(b,2),h=Z[0],N=Z[1],C=(0,f.useSelector)((function(e){return e.CVEDetailsPageStore.cveDetails})),M=(0,i.useMemo)((function(){return(0,m.m4)(C)}),[C]),_=(0,f.useSelector)((function(e){return e.CVEDetailsPageStore.affectedSystemsByCVE}));(0,i.useEffect)((function(){r((0,v.ZO)(o))}),[]);var V,x=function(e){N((function(){return function(){return u().createElement(we.Z,{cves:e,updateRef:function(){r((0,v.ZO)(o)),r((0,v.TA)(o))}})}}))},A=M.error,P=M.data,S={id:o,status_id:M.data.status_id,justification:M.data.status_justification,exposed_systems_count:(null==_||null===(t=_.payload)||void 0===t||null===(a=t.meta)||void 0===a?void 0:a.total_items)||0},w=[(0,Pe.Eh)((function(e){y((function(){return function(){return u().createElement(Se.Z,{open:!0,cves:e,updateRef:function(){return r((0,v.ZO)(o))}})}}))}),[{business_risk_id:M.data.business_risk_id,id:o,justification:M.data.business_risk_justification}]),(0,Pe.bp)(x,[S])],k=P.rules,D=k&&k.map((function(e){return{value:e.rule_id,label:e.description}}));return A?u().createElement(u().Fragment,null,u().createElement(Qe.Z,{title:o}),u().createElement(s.Z,null)):u().createElement(u().Fragment,null,u().createElement(Ye.Provider,{value:M&&{isLoading:M.isLoading}},u().createElement(Qe.Z,{title:P.celebrity_name?o+" - "+P.celebrity_name:o,actions:w,actionsOuiaId:"cve-actions",breadcrumbs:[{title:p.yy.cvesPage.title,to:p.yy.cvesPage.to,loaded:!0},{title:o,isActive:!0,loaded:!0}],labels:(null===(V=C.payload.data)||void 0===V?void 0:V.attributes.rules.length)>0?u().createElement(ve.Z,null):null},u().createElement(Ae,{changeExposedSystemsParameters:v.vv,data:M}),u().createElement(h,null),u().createElement(E,null)),u().createElement(l.Z,null,u().createElement(Ue,{cve:o,filterRuleValues:D,cveStatusDetails:S,methods:{showStatusModal:x}}))))};$e.propTypes={match:o().object,cveDetails:o().object,fetchCveDetails:o().func,handleCveDetailsError:o().func};const Xe=(0,d.EN)($e)},15047:(e,t,a)=>{"use strict";var r=a(93379),n=a.n(r),s=a(87110),l=n()(s.default,{insert:"head",singleton:!1});if(!s.default.locals||e.hot.invalidate){var c=s.default.locals;e.hot.accept(87110,(t=>{s=a(87110),function(e,t,a){if(!e&&t||e&&!t)return!1;var r;for(r in e)if(e[r]!==t[r])return!1;for(r in t)if(!e[r])return!1;return!0}(c,s.default.locals)?(c=s.default.locals,l(s.default)):e.hot.invalidate()}))}e.hot.dispose((function(){l()})),s.default.locals}}]);
//# sourceMappingURL=CVEDetailsPage.104ddd5a967687ef806c.js.map