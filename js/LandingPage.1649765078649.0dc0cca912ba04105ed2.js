"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[13],{38828:(e,t,n)=>{n.r(t),n.d(t,{default:()=>De});var r=n(22491),a=n.n(r),o=n(44012),c=n(72683),i=n(91290),l=n(15265),s=n(30893),u=n(86350),p=n(75115),f=n(4942),m=n(93433),d=n(29439),v=n(28216),b=n(49739),E=n(83826),h=n(78733),y=n(52064),g=n(29648),O=n(74372),Z=n(19738),k=n(87462),w=n(45697),S=n.n(w),P=n(3351),C=n(22860),_=n(6934),j=n(75863),x=n(75959),R=n(22167),M=n(5938),D=n(24788);function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){(0,f.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var V=function(e){var t=e.context,n=e.header,o=e.canEditStatusOrBusinessRisk,c=t.cves,i=t.methods,l=t.selectedCves,u=t.expandedRows,p=0===c.data.length,f=c.data&&c.data.map((function(e){return l.includes(e.id)&&I(I({},e),{},{selected:!0})||e})).map((function(e,t){var n=t%2==0?u.includes(e.id):void 0;return I(I({},e),{},{isOpen:n})}));return c.isLoading?a().createElement(x.Z,{colSize:null==n?void 0:n.length,rowSize:20,variant:j.B.compact}):a().createElement(r.Fragment,null,a().createElement(P.i,{canCollapseAll:!1,canSelectAll:!1,"aria-label":"Vulnerability CVE table",cells:n,rows:p?[{heightAuto:!0,cells:[{props:{colSpan:null==n?void 0:n.length},title:a().createElement(D.lP,{secondParagraph:s.Z.emptyStateThereShouldBeCVEs})}]}]:f,onSelect:p?void 0:function(e,n,r){var a=t.cves,o=t.methods,c=a.data[r]&&a.data[r].id;o.selectCves(n,c)},onCollapse:p?void 0:function(e,t){return i.openCves(t)},actionResolver:o&&c.data.length>0?function(e,t){return(0,R.hA)(i,t.rowIndex)}:void 0,sortBy:p?void 0:(0,g.hO)([{key:"collapse"},{key:"checkbox"}].concat((0,m.Z)(n)),c.meta.sort),onSort:p?void 0:function(e,t,r){return(0,g.L6)(t,r,[{key:"collapse"},{key:"checkbox"}].concat((0,m.Z)(n)),c.meta.sort,i.apply)},ouiaId:"cves-table",isStickyHeader:!0,variant:j.B.compact},a().createElement(_.x,null),a().createElement(C.R,null)),a().createElement(M.Z,{meta:c.meta,apply:i.apply}))};V.propTypes={context:S().any,header:S().array,canEditStatusOrBusinessRisk:S().bool};const L=function(e){return a().createElement(de.Consumer,null,(function(t){return a().createElement(V,(0,k.Z)({context:t},e))}))};var A=n(74806),T=n(40306),H=n(93400),F=n(6982),N=n(44612),z=n(32132);const q=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.affecting,r=function(t){e({affecting:t.length>0?null==t?void 0:t.join(","):void 0,page:1})};return{label:z.N.formatMessage(s.Z.filterSystemsExposed),type:N.Y.checkbox,urlParam:"affecting",filterValues:{onChange:function(e,t){r(t)},items:h.qr.map((function(e){return{label:e.label,value:e.value}})),value:null==n?void 0:n.split(",")}}};var U=n(95859),Y=n(9088),G=n(90960),K=n(95351),W=n(16369),X=n(35938),$=n(54534),J=n(1792),Q=n(41489),ee=n(33084),te=n(15248);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,f.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae=function(e){var t=e.context,n=e.canEditStatusOrBusinessRisk,o=e.canExport,c=e.intl,i=(0,r.useState)(!1),l=(0,d.Z)(i,2),u=l[0],p=l[1],f=t.cves,v=t.params,b=t.methods,E=t.selectedCves,y=t.isAllExpanded,g=t.selectedRowsRawData,O=v.filter,Z=E&&E.length,k=(0,H.Z)({selectedItems:E,selectorHandler:b.selectCves,items:f,fetchResource:function(e){return(0,T.cW)(re(re({},v),e))},multiRow:!0}),w=[""].concat((0,m.Z)(n?[{label:c.formatMessage(s.Z.editBusinessRisk),onClick:function(){return b.showBusinessRiskModal(g.map((function(e){var t=e.id,n=e.attributes;return{id:t,business_risk_id:n.business_risk_id,justification:n.business_risk_text}})),!0)},props:{isDisabled:!Z}},{label:c.formatMessage(s.Z.editStatus),onClick:function(){return b.showStatusModal(g.map((function(e){var t=e.id,n=e.attributes;return{id:t,exposed_systems_count:n.systems_affected,justification:n.status_text,status_id:n.status_id}}),[]),!0)},props:{isDisabled:!Z}}]:[]),[{label:c.formatMessage(s.Z.columnManagementModalTitle),onClick:function(){return b.setColumnModalOpen(!0)}}]);return a().createElement(a().Fragment,null,a().createElement(F.Z,{pagination:{isDisabled:0===f.meta.total_items,itemCount:f.meta.total_items||0,page:f.meta.page||1,perPage:f.meta.page_size||1,ouiaId:"pagination-top",onSetPage:function(e,t){return(0,te.A6)(e,t,b.apply)},onPerPageSelect:function(e,t){return(0,te.lO)(e,t,b.apply)}},actionsConfig:{actions:w,dropdownProps:{ouiaId:"toolbar-actions"}},bulkSelect:{count:Z,items:k.items,isDisabled:0===f.meta.total_items&&0===Z,checked:Boolean(Z),ouiaId:"bulk-select",onSelect:function(){return k.handleOnCheckboxChange()}},filterConfig:{items:[(0,K.Z)("filter",s.Z.cve,s.Z.searchFilterByCveID,O,b.apply),(0,W.Z)(b.apply,v),(0,$.Z)(b.apply,v),(0,G.Z)(b.apply,v),(0,Y.Z)(b.apply,v),(0,X.Z)(b.apply,v),q(b.apply,v),(0,U.Z)(b.apply,v),(0,J.Z)(b.apply,v)]},activeFiltersConfig:{filters:(0,te.DU)(v),onDelete:function(e,t,n){return(0,te.vH)(t,b.apply,n,h.MM)},deleteTitle:c.formatMessage(s.Z.resetFilters),showDeleteButton:!(0,te.Yy)(v,h.MM,h.fU)},exportConfig:o&&re({isDisabled:0===f.meta.total_items,extraItems:[(0,Q.Ec)(u,p)],ouiaId:"export"},(0,te.HV)(b)),expandAll:{isAllExpanded:y,onClick:function(){var e=t.cves,n=t.methods,r=t.isAllExpanded?[]:e.data.filter((function(e){return e.id})).map((function(e){return e.id}));n.openCves(r)}}}),u&&a().createElement(ee.Z,{showButton:!1,params:v,filters:(0,te.DU)(v),onSuccess:function(){return p(!1)}}))};ae.propTypes={context:S().object,intl:S().object,canEditStatusOrBusinessRisk:S().bool,canExport:S().bool},ae.defaultProps={totalNumber:0,apply:function(){},downloadReport:function(){}};const oe=(0,A.ZP)((function(e){return a().createElement(de.Consumer,null,(function(t){return a().createElement(ae,(0,k.Z)({context:t},e))}))}));var ce=n(62215),ie=n(83215),le=n(66123),se=n(66761),ue=n(6023),pe=n(37450);function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){(0,f.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var de=a().createContext({});const ve=function(){var e=(0,v.I0)(),t=(0,r.useState)((function(){return function(){return null}})),n=(0,d.Z)(t,2),o=n[0],c=n[1],i=(0,r.useState)((function(){return function(){return null}})),l=(0,d.Z)(i,2),s=l[0],u=l[1],p=(0,r.useState)(!0),f=(0,d.Z)(p,2),k=f[0],w=f[1],S=(0,r.useState)(!1),P=(0,d.Z)(S,2),C=P[0],_=P[1],j=(0,pe.Wu)([h._I.setCveStatusAndBusinessRisk,h._I.setPairStatus,h._I.basicReporting,h._I.readVulnerabilityResults]),x=(0,d.Z)(j,2),R=(0,d.Z)(x[0],4),M=R[0],B=R[1],I=R[2],V=R[3],A=x[1],H=(0,v.v9)((function(e){return e.CVEsStore.cveList})),F=(0,v.v9)((function(e){return e.CVEsStore.parameters})),N=(0,v.v9)((function(e){return e.CVEsStore.columns})),z=(0,v.v9)((function(e){return e.CVEsStore.selectedCves})),q=(0,v.v9)((function(e){return e.CVEsStore.selectedRowsRawData})),U=(0,v.v9)((function(e){return e.CVEsStore.expandedRows})),Y=(0,v.v9)((function(e){return e.CVEsStore.isAllExpanded})),G=(0,r.useMemo)((function(){return(0,y.c_)(H,N)}),[H,N]),K=(0,g.H1)(["show_irrelevant"].concat((0,m.Z)(h.kO))),W=(0,d.Z)(K,2),X=W[0],$=W[1],J=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,g.pX)(t);e((0,T.yM)(n))};return(0,r.useEffect)((function(){J(X)}),[]),(0,r.useEffect)((function(){k?w(!1):(e((0,T.jh)(F)),$(me({},F)))}),[F]),(0,r.useEffect)((function(){return function(){e((0,T.Ss)()),e((0,ie.L1)())}}),[e]),G.errors?a().createElement(le.Z,{code:G.errors.status}):A?a().createElement(ue.Z,{centered:!0}):V?a().createElement(de.Provider,{value:{cves:G,selectedRowsRawData:q,params:F,selectedCves:z,expandedRows:U,isAllExpanded:Y,methods:{apply:J,downloadReport:function(t){ce.Z.exec(T.jh,F,t,"cves",(function(t){return e((0,ie.wN)(t))}),(function(){return e((0,ie.L1)())}))},selectCves:function(t,n){e((0,T.EY)(n||[]))},showBusinessRiskModal:function(t,n){var r=G.meta;u((function(){return function(){return a().createElement(O.Z,{cves:t,updateRef:function(){w(!0),e((0,T.Ss)()),(0,g.$)(n?me(me({},r),{},{page:1}):r,F,J)}})}}))},showStatusModal:function(t,n){var r=G.meta;c((function(){return function(){return a().createElement(Z.Z,{cves:t,canEditPairStatus:B,updateRef:function(){w(!0),e((0,T.Ss)()),(0,g.$)(n?me(me({},r),{},{page:1}):r,F,J)}})}}))},openCves:function(t){e((0,T.Rk)(t))},setColumnModalOpen:_}}},a().createElement(s,null),a().createElement(o,null),a().createElement(se.Z,{appliedColumns:N,applyColumns:function(t){return e((0,T.vP)(t))},isModalOpen:C,setModalOpen:_}),a().createElement(b.K,null,a().createElement(E.v,null,a().createElement(oe,{canEditStatusOrBusinessRisk:M,canExport:I})),a().createElement(E.v,null,a().createElement(L,{header:N.filter((function(e){var t;return null!==(t=e.isShown)&&void 0!==t?t:e.isShownByDefault})),canEditStatusOrBusinessRisk:M})))):a().createElement(D.bY,null)};var be=n(15861),Ee=n(87757),he=n.n(Ee),ye=n(32203),ge=n(50693),Oe=n(16475),Ze=n(87116),ke=n(62394),we=n(68340),Se=n(27578),Pe=n(71478),Ce=n(42601),_e=n(86896);function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){(0,f.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Re=function(e){var t,n=e.title,r=e.count,o=e.impact,c=e.onLinkClick,i=e.hasIcon;return a().createElement(ye.Z,{isFullHeight:!0,className:"card-box"},a().createElement(ke.e,null,a().createElement(we.x,{className:"pf-u-font-size-lg pf-u-font-weight-bold"},n),a().createElement(we.x,{className:"pf-u-font-size-lg pf-u-font-weight-bold pf-u-mt-xs"},a().createElement("a",{onClick:c},i&&a().createElement(Se.ZP,{color:null===(t=h.cv[o])||void 0===t?void 0:t.iconColor,size:"sm",className:"pf-u-mr-sm"}),r))))};Re.propTypes={title:S().node,count:S().number.isRequired,impact:S().oneOf(Object.keys(h.cv)),onLinkClick:S().func.isRequired,hasIcon:S().bool};const Me=function(){var e=(0,_e.Z)(),t=(0,v.I0)(),n=(0,g.H1)([h.kO]),c=(0,d.Z)(n,1)[0],i=(0,r.useState)({}),l=(0,d.Z)(i,2),p=l[0],f=l[1],m=(0,r.useState)({}),y=(0,d.Z)(m,2),O=y[0],Z=y[1],k=(0,r.useState)(!0),w=(0,d.Z)(k,2),S=w[0],P=w[1],C=(0,v.v9)((function(e){return e.CVEsStore.parameters})),_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,g.pX)(e);t((0,T.yM)(n))},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,te.DU)(C);(0,te.vH)(t,_,!0,e)};return(0,r.useEffect)((function(){var e=function(){var e=(0,be.Z)(he().mark((function e(){var t;return he().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Pe.k5)();case 2:t=e.sent,Z(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=function(){var e=(0,be.Z)(he().mark((function e(){var t;return he().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Pe.rF)();case 2:t=e.sent,f(t),P(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),t()}),[]),"true"===(null==c?void 0:c.dashbar)&&a().createElement(u.Z,{style:{paddingBottom:0}},a().createElement(b.K,{hasGutter:!0},a().createElement(E.v,null,S?a().createElement(ge.r,{hasGutter:!0},a().createElement(Oe.P,{span:12,md:3},a().createElement(Ce.Z,{isLoading:S,variant:Ce.t.inlineSkeleton,style:{height:"100px"}})),a().createElement(Oe.P,{span:12,md:3},a().createElement(Ce.Z,{isLoading:S,variant:Ce.t.inlineSkeleton,style:{height:"100px"}})),a().createElement(Oe.P,{span:12,md:3},a().createElement(Ce.Z,{isLoading:S,variant:Ce.t.inlineSkeleton,style:{height:"100px"}})),a().createElement(Oe.P,{span:12,md:3},a().createElement(Ce.Z,{isLoading:S,variant:Ce.t.inlineSkeleton,style:{height:"100px"}}))):a().createElement(ge.r,{hasGutter:!0},a().createElement(Oe.P,{span:12,md:3},a().createElement(Re,{title:a().createElement(o.Z,s.Z.dashbarKnownExploitsTitle),count:null==p?void 0:p.exploitable_cves,onLinkClick:function(){return j(xe(xe({},h.MM),{},{known_exploit:"true"}))}})),a().createElement(Oe.P,{span:12,md:3},a().createElement(Re,{title:a().createElement(o.Z,s.Z.dashbarSecurityRulesTitle),count:null==p?void 0:p.cves_with_rule,onLinkClick:function(){return j(xe(xe({},h.MM),{},{rule_presence:"true"}))}})),a().createElement(Oe.P,{span:12,md:3},a().createElement(Re,{title:a().createElement(o.Z,s.Z.dashbarCriticalVulnerabilitiesTitle),count:null==p?void 0:p.critical_cves,onLinkClick:function(){return j(xe(xe({},h.MM),{},{impact:"7"}))},impact:"Critical",hasIcon:!0})),a().createElement(Oe.P,{span:12,md:3},a().createElement(Re,{title:a().createElement(o.Z,s.Z.dashbarImportantVulnerabilitiesTitle),count:null==p?void 0:p.important_cves,onLinkClick:function(){return j(xe(xe({},h.MM),{},{impact:"5"}))},impact:"Important",hasIcon:!0})))),(null==O?void 0:O.message)&&a().createElement(E.v,null,a().createElement(Ze.b,{variant:"warning",isInline:!0,title:e.formatMessage(s.Z.dashbarAnnouncementTitle)},O.message))))},De=function(){var e=a().createElement(c.J,{enableFlip:!0,position:"right",headerContent:a().createElement(o.Z,s.Z.ovalPopoverHeader),bodyContent:a().createElement(o.Z,s.Z.ovalPopoverBody),footerContent:a().createElement("a",{href:"https://access.redhat.com/documentation/en-us/red_hat_insights/2021/html/assessing_and_monitoring_security_vulnerabilities_on_rhel_systems/index",target:"__blank",rel:"noopener noreferrer"},a().createElement(o.Z,s.Z.learnMore)," ",a().createElement(l.ZP,null))},a().createElement("span",null,a().createElement(o.Z,s.Z.cvesHeader),a().createElement(i.ZP,{color:"var(--pf-global--secondary-color--100)",className:"pf-u-ml-sm pointer cves-header-questionmark",style:{verticalAlign:"0"}})));return a().createElement(r.Fragment,null,a().createElement(p.Z,{title:e,showBreadcrumb:!1}),a().createElement(Me,null),a().createElement(u.Z,null,a().createElement(ve,null)))}}}]);
//# sourceMappingURL=../sourcemaps/LandingPage.49d7cb2ce67e707bfccd81d5270860e8.js.map