"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[743],{75584:(e,t,r)=>{r.r(t),r.d(t,{default:()=>ae});var n=r(4942),o=r(29439),a=r(77865),s=r.n(a),l=r(86896),c=r(30893),i=r(28216),u=r(45697),p=r.n(u),f=r(74806),d=r(5977),m=r(29648),b=r(83594),y=r(49629),v=r(95351),g=r(15248),O=r(62215),w=r(87462),h=r(93433),Z=r(15861),P=r(45987),j=r(87757),D=r.n(j),E=r(3968),S=r(71478),R=r(43198),C=r(62598),k=r(52837),M=r(37450),_=["filters","params","reportData","buttonProps","label"];function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var I=function(e){var t=e.filters,r=e.params,n=e.reportData,i=void 0===n?{}:n,u=e.buttonProps,p=e.label,f=(0,P.Z)(e,_),d=(0,l.Z)(),b=(0,a.useState)(!1),y=(0,o.Z)(b,2),v=y[0],g=y[1],j=(0,M.lm)(),x=(0,o.Z)(j,2),I=x[0],N=x[1],T=k.tp.systemsReportRestPages,B=k.tp.systemsReportFirstPage;(0,a.useEffect)((function(){g(!0),I({msg:d.formatMessage(c.Z.notificationReportDownloadStart)})}),[]);var U=function(e){return(0,m.F3)(e,T)},A=function(){var e=(0,Z.Z)(D().mark((function e(){var n,o,a,s,l;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,S.vk)(F(F({},r),O.Z.defaultParams));case 3:a=e.sent,n=a.data,o=a.meta,e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(0),N(),I({variant:"danger",autoDismiss:!1,msg:d.formatMessage(c.Z.notificationReportDownloadFailureTitle),description:d.formatMessage(c.Z.notificationReportDownloadFailureBody)}),e.abrupt("return",[]);case 13:return s=(0,R.Z)({data:n.splice(0,B),meta:o,filters:t,intl:d}),l=U(n),g(!1),N(),I({variant:"success",msg:d.formatMessage(c.Z.notificationReportDownloadSuccess)}),e.abrupt("return",[s].concat((0,h.Z)(l.map((function(e,t){return(0,C.Z)({data:e,page:t,intl:d,header:i&&i.header})})))));case 19:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return s().createElement("div",null,s().createElement(E.o6,(0,w.Z)({},f,{fallback:null,label:v?d.formatMessage(c.Z.loading):d.formatMessage(p),asyncFunction:A,buttonProps:F({component:"button"},u),reportName:d.formatMessage(c.Z.systemPDFReportName),type:"",fileName:"".concat(O.Z.filename("system-list"),".pdf"),allPagesHaveTitle:!1,size:"A4",orientation:"landscape"})))};I.defaultProps={label:c.Z.kebabExportAsPDF},I.propTypes={filters:p().oneOfType([p().array,p().object]),params:p().object,reportData:p().object,buttonProps:p().object,label:p().oneOfType([p().array,p().object])};const N=I;var T=r(41489),B=r(44612),U=r(32132);const A=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.excluded,n=function(t){e({excluded:t.length>0?null==t?void 0:t.join(","):void 0,page:1})};return{label:U.N.formatMessage(c.Z.filterSystemsIncludedInAnalysis),type:B.Y.checkbox,urlParam:"excluded",filterValues:{onChange:function(e,t){n(t)},items:k._9.map((function(e){return{label:e.label,value:e.value}})),value:(null==r?void 0:r.length)>0?null==r?void 0:r.split(","):void 0}}};var H=r(83215);function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var K=function(e){var t=e.selectedRows,r=e.selectedRowsCount,n=e.selectedRowsRawData,l=e.intl,u=e.parameters,p=e.systems,f=e.methods,d=(0,a.useState)(!1),m=(0,o.Z)(d,2),w=m[0],h=m[1],Z=f.apply,P=f.handleSelect,j=f.doOptOut,D=f.setColumnModalOpen,E=(0,i.I0)(),S=(0,a.useMemo)((function(){return{selectedExcluded:n.some((function(e){return!0===e.opt_out})),selectedIncluded:n.some((function(e){return!1===e.opt_out}))}}),[n]),R=["",{label:l.formatMessage(c.Z.systemKebabExcludeAnalysis,{count:r}),onClick:function(){return j(t,null==n?void 0:n[0].display_name,!0)},props:{isDisabled:!r||!S.selectedIncluded}},{label:l.formatMessage(c.Z.systemKebabIncludeAnalysis,{count:r}),onClick:function(){return j(t,null==n?void 0:n[0].display_name,!1,t)},props:{isDisabled:!r||!S.selectedExcluded}},{label:l.formatMessage(c.Z.columnManagementModalTitle),onClick:function(){return D(!0)}}],C=(0,M.ZS)({rawData:p,selectedRows:t,selectedRowsCount:r,handleSelect:P,fetchResource:function(e){return(0,b.ip)(z(z({},u),e))}});return s().createElement(a.Fragment,null,s().createElement(y.Z,{className:"vuln-systems-primary-toolbar",bulkSelect:C,actionsConfig:{actions:R,dropdownProps:{ouiaId:"toolbar-actions"}},filterConfig:{items:[(0,v.Z)("filter",c.Z.systemsSearchName,c.Z.searchFilterByName,u.filter,Z),A(Z,u)]},activeFiltersConfig:{filters:(0,g.DU)(u),onDelete:function(e,t,r){return(0,g.vH)(t,f.apply,r,k.Sy)},deleteTitle:l.formatMessage(c.Z.resetFilters),showDeleteButton:!(0,g.Yy)(u,k.Sy,k.D2)},exportConfig:z({isDisabled:0===p.meta.total_items,extraItems:[(0,T.Ec)(w,h)],ouiaId:"export"},(0,g.HV)({downloadReport:function(e){var t=z({},u);O.Z.exec(b.lc,t,e,"system-list",(function(e){return E((0,H.wN)(e))}),(function(){return E((0,H.L1)())}))}}))}),w&&s().createElement(N,{showButton:!1,params:u,filters:(0,g.DU)(u),onSuccess:function(){return h(!1)}}))};K.propTypes={systems:m.nE,parameters:p().object,selectedRows:p().array,selectedRowsCount:p().number,selectedRowsRawData:p().array,methods:p().shape({doOptOut:p().func,apply:p().func,handleSelect:p().func,setColumnModalOpen:p().func}),intl:p().any};const L=(0,d.EN)((0,f.ZP)(K));var Y=r(83296),W=r(86350),q=r(43003),G=r(75115),J=r(15768),Q=r(33739),X=r(66123),$=r(75863),ee=r(12140),te=r(24788),re=r(66761);function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const ae=function(){var e=s().createRef(),t=(0,i.I0)(),r=(0,l.Z)(),n=(0,m.H1)(k.IV),u=(0,o.Z)(n,2),p=u[0],f=u[1],d=(0,i.v9)((function(e){var t=e.entities;return(null==t?void 0:t.rows)||[]}),i.wU),y=(0,i.v9)((function(e){var t=e.entities;return null==t?void 0:t.total})),v=(0,i.v9)((function(e){var t=e.entities;return(null==t?void 0:t.selectedRows)||{}})),g=(0,i.v9)((function(e){var t=e.entities;return null==t?void 0:t.selectedRowsCount})),O=(0,i.v9)((function(e){var t=e.entities;return(null==t?void 0:t.selectedRowsRawData)||[]})),w=(0,i.v9)((function(e){return e.SystemsPageStore.params}),i.wU),h=(0,i.v9)((function(e){return e.SystemsPageStore.error})),Z=h.hasError,P=h.errorCode,j=(0,a.useState)(k.Bi),D=(0,o.Z)(j,2),E=D[0],R=D[1],C=(0,a.useState)(!1),_=(0,o.Z)(C,2),x=_[0],F=_[1];(0,a.useEffect)((function(){return function(){t((0,b.re)()),t((0,b.r5)())}}),[t]);var I=function(e){return t((0,b.SF)(e))};(0,a.useEffect)((function(){return I(p)}),[]),(0,ee.ZP)((function(){return f(oe({},w))}),[w]);var N=(0,M.a9)((function(){return t((0,b.r5)()),e.current.onRefreshData({page:1})})),T=(0,M.U)(S.vk,{setUrlParams:f}),B=(0,a.useState)(0),U=(0,o.Z)(B,2),A=U[0],H=U[1];return(0,a.useEffect)((function(){return H(A+1)}),[E]),s().createElement(a.Fragment,null,s().createElement(re.Z,{appliedColumns:E,applyColumns:R,isModalOpen:x,setModalOpen:F}),s().createElement(G.Z,{title:r.formatMessage(c.Z.vulnerabilitySystemsHeader),showBreadcrumb:!1}),s().createElement(W.Z,null,Z?s().createElement(X.Z,{code:P}):s().createElement(Q.Z,{disableDefaultColumns:!0,onLoad:function(e){var t=e.mergeWithEntities;Y.Z.register(oe({},t((0,J.K)(k.Bi),oe({page:Number(w.page||1),perPage:Number(w.page_size||20)},w.sort&&{sortBy:{key:w.sort.replace(/^-/,""),direction:w.sort.match(/^-/)?"desc":"asc"}}))))},tableProps:{isStickyHeader:!0,canSelectAll:!1,actionResolver:(null==d?void 0:d.length)>0&&function(e){return(0,q.zs)(e,N)},variant:$.B.compact},showTagModal:!0,isFullView:!0,ref:e,autoRefresh:!0,customFilters:{vulnerabilityParams:oe({},w)},hasCheckbox:0!==(null==d?void 0:d.length),columnsCounter:A,columns:function(e){return t=e,E.filter((function(e){return e.isShown})).map((function(e){return oe(oe({},t.find((function(t){var r=t.key;return e.key===r}))),e)}));var t},getEntities:T,hideFilters:{all:!0},noSystemsTable:s().createElement(te.UE,null)},s().createElement(L,{parameters:w,systems:{data:d,meta:{total_items:y}},selectedRows:v,selectedRowsCount:g,selectedRowsRawData:O,methods:{doOptOut:N,apply:I,handleSelect:function(e){return t((0,b.hd)(e))},setColumnModalOpen:F},actions:!0}))))}}}]);
//# sourceMappingURL=../sourcemaps/Systems.bc4b557c1f335af9203db4e43f124541.js.map