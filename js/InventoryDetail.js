(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{364:function(t,e,n){"use strict";n.r(e);var r=n(366),a=n(373),o=n(389),i=n(378),s=n(376),c=n(384),u=n(374),l=n(390),p=n(379),f=n(377),d=n(372),m=n(383),y=n(367);n.d(e,"TableGridBreakpoint",function(){return r.d}),n.d(e,"TableVariant",function(){return r.e}),n.d(e,"SortByDirection",function(){return r.a}),n.d(e,"TableContext",function(){return r.c}),n.d(e,"Table",function(){return r.b}),n.d(e,"ActionsColumn",function(){return a.a}),n.d(e,"TableBody",function(){return o.a}),n.d(e,"BodyCell",function(){return i.a}),n.d(e,"BodyWrapper",function(){return s.a}),n.d(e,"CollapseColumn",function(){return c.a}),n.d(e,"ExpandableRowContent",function(){return u.a}),n.d(e,"TableHeader",function(){return l.a}),n.d(e,"HeaderCell",function(){return p.a}),n.d(e,"RowWrapper",function(){return f.a}),n.d(e,"SelectColumn",function(){return d.a}),n.d(e,"SortColumn",function(){return m.a}),n.d(e,"selectable",function(){return y.t}),n.d(e,"sortable",function(){return y.u}),n.d(e,"cellActions",function(){return y.c}),n.d(e,"cellWidth",function(){return y.e}),n.d(e,"cellHeightAuto",function(){return y.d}),n.d(e,"wrappable",function(){return y.w}),n.d(e,"textCenter",function(){return y.v}),n.d(e,"collapsible",function(){return y.g}),n.d(e,"expandedRow",function(){return y.m}),n.d(e,"expandable",function(){return y.l}),n.d(e,"compoundExpand",function(){return y.h}),n.d(e,"headerCol",function(){return y.n}),n.d(e,"classNames",function(){return y.f}),n.d(e,"Visibility",function(){return y.a}),n.d(e,"emptyTD",function(){return y.k}),n.d(e,"scopeColTransformer",function(){return y.s}),n.d(e,"emptyCol",function(){return y.j}),n.d(e,"parentId",function(){return y.r}),n.d(e,"mapProps",function(){return y.q}),n.d(e,"mapOpenedRows",function(){return y.p}),n.d(e,"calculateColumns",function(){return y.b}),n.d(e,"defaultTitle",function(){return y.i}),n.d(e,"isRowExpanded",function(){return y.o})},367:function(t,e,n){"use strict";var r=n(382);n.d(e,"a",function(){return r.a}),n.d(e,"c",function(){return r.b}),n.d(e,"d",function(){return r.c}),n.d(e,"e",function(){return r.d}),n.d(e,"f",function(){return r.e}),n.d(e,"g",function(){return r.f}),n.d(e,"h",function(){return r.g}),n.d(e,"j",function(){return r.h}),n.d(e,"k",function(){return r.i}),n.d(e,"l",function(){return r.j}),n.d(e,"m",function(){return r.k}),n.d(e,"n",function(){return r.l}),n.d(e,"q",function(){return r.m}),n.d(e,"r",function(){return r.n}),n.d(e,"s",function(){return r.o}),n.d(e,"t",function(){return r.p}),n.d(e,"u",function(){return r.q}),n.d(e,"v",function(){return r.r}),n.d(e,"w",function(){return r.s});var a=n(368);n.d(e,"b",function(){return a.a}),n.d(e,"p",function(){return a.b});var o=n(375);n.d(e,"i",function(){return o.a});var i=n(388);n.d(e,"o",function(){return i.a})},414:function(t,e,n){"use strict";var r=n(365),a=n.n(r),o=n(179),i=n(180),s=n(162),c=n(163),u=n(154),l=n(1),p=n.n(l),f=n(2),d=n.n(f),m=n(370),y=n(386),b=function(t){var e=t.cves,n=t.updateRef,r=t.inventoryIds,l=Object(f.useState)(e),p=a()(l,1)[0],b=Object(y.c)(p&&1===p.length&&p[0].status_id.toString()||"0"),v=b.StatusSelect,h=b.statusId,O=b.setProps,j=Object(y.b)(p&&1===p.length&&p[0].justification||""),E=j.JustificationInput,w=j.justification,g=j.setProps,S=Object(f.useState)(!1),C=a()(S,2),P=C[0],D=C[1];var k="Set status for this CVE and system pair";return(r.length>1||e.length>1)&&(k="Set status for these CVE and system pairs"),d.a.createElement(y.a,{items:p,onSave:function(){var t=p.map(function(t){return t.id}),e=P?{cve:t,inventory_id:r}:{status_id:parseInt(h),cve:t,status_text:w,inventory_id:r};return Object(m.l)(e).then(n)},onSuccessNotification:{variant:"success",title:"CVE status updated"},title:k},d.a.createElement(o.a,{gutter:"md"},d.a.createElement(i.a,null,d.a.createElement(s.a,{key:"key"},d.a.createElement(c.a,{fieldId:"overall"},d.a.createElement(u.a,{label:"Use overall CVE status",id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:P,onChange:function(t){var e={isDisabled:t};D(t),O(e),g(e)}})),v,E))))};b.propTypes={cves:p.a.array,updateRef:p.a.func,inventoryIds:p.a.array},e.a=b},655:function(t,e,n){"use strict";n.r(e);var r=n(111),a=n.n(r),o=n(137),i=n.n(o),s=n(358),c=n.n(s),u=n(80),l=n.n(u),p=n(81),f=n.n(p),d=n(82),m=n.n(d),y=n(83),b=n.n(y),v=n(84),h=n.n(v),O=n(203),j=n(67),E=n(204),w=n(362),g=n(75),S=n(364),C=n(1),P=n.n(C),D=n(2),k=n.n(D),_=n(74),I=n(132),T=n(351),R=n(369),x=n(360),L=n(135),N=n(179),H=n(180),B=n(553),F=n(402),V=n(396),M=n(380),A=n(404),Y=n.n(A),q=n(371),z=n(559),J=(n(562),n(414)),U=n(133),W=n.n(U),G=n(385),X=n.n(G),K=n(366),Q=n(390),Z=n(389),$=n(391),tt=n(397);function et(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function nt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?et(n,!0).forEach(function(e){c()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):et(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var rt=function(t){function e(){var t,n,r;l()(this,e);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return m()(r,(n=r=m()(this,(t=b()(e)).call.apply(t,[this].concat(o))),r.noCves=function(){var t=r.props,e=t.entity,n=t.context.cves;return 0!==["filter","cvss_from","cvss_to","public_from","public_to","impact","status_id"].filter(function(t){return n.meta.hasOwnProperty(t)&&n.meta[t]}).length?x.e:e?x.d:0===n.data.length?x.c:void 0},r.handleOnSelect=function(t,e,n){var a=r.props.context,o=a.cves,i=a.methods,s=o.data[n]&&o.data[n].id;i.selectCves(e,s)},n))}return h()(e,t),f()(e,[{key:"handleOnCollapse",value:function(t,e,n){var r=this.props.context,a=r.cves,o=r.methods,i=a.data[e]&&a.data[e].id;o.openCves(n,i)}},{key:"render",value:function(){var t=this,e=this.props,n=e.context,r=e.header,a=n.params,o=n.cves,i=n.methods,s=a.selectedCves,c=a.openedCves,u=o.data.map(function(t){return s.has(t.id)&&nt({},t,{selected:!0})||t}).map(function(t){return c.has(t.id)&&nt({},t,{isOpen:!0})||t});return k.a.createElement(D.Fragment,null,o.isLoading?k.a.createElement(w.SkeletonTable,{colSize:2,rowSize:20}):k.a.createElement(D.Fragment,null,k.a.createElement(K.b,{"aria-label":"Vulnerability CVE table",onSelect:this.handleOnSelect,cells:r,rows:u,actions:Object($.d)(i),sortBy:Object(q.b)([{key:"collapse"},{key:"checkbox"}].concat(X()(r)),o.meta.sort),onSort:function(t,e,n){return Object(q.e)(e,n,[{key:"collapse"},{key:"checkbox"}].concat(X()(r)),o.meta.sort,i.apply)},gridBreakPoint:"grid-lg",onCollapse:function(e,n,r){return t.handleOnCollapse(e,n,r)}},!o.isLoading&&0===o.data.length&&this.noCves()||k.a.createElement(D.Fragment,null,k.a.createElement(Q.a,null),k.a.createElement(Z.a,null))),k.a.createElement(w.TableToolbar,null,k.a.createElement(tt.a,{variant:"bottom",meta:o.meta,apply:i.apply}))))}}]),e}(D.Component);rt.propTypes={context:P.a.any,header:P.a.array,entity:P.a.object};var at=function(t){return k.a.createElement(ht.Consumer,null,function(e){return k.a.createElement(rt,W()({context:e},t))})},ot=n(182),it=n(181),st=n(392),ct=n(393),ut=n(409),lt=n(410),pt=n(565),ft=n(398);function dt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}var mt=function(t){function e(){return l()(this,e),m()(this,b()(e).apply(this,arguments))}return h()(e,t),f()(e,[{key:"render",value:function(){var t=this.props,e=t.showRemediationButton,n=t.entity,r=t.context,a=r.cves,o=r.params,i=r.methods,s=o.selectedCves,u=!0===this.props.showRemediationButton?s&&s.size||0:void 0,l=[x.o,x.q,x.n,x.p,x.s],p=[Object(ct.d)(i.showStatusModal,X()(s).map(function(t){return{id:t,status_id:"0"}}),void 0,{isDisabled:!u}),Object(ct.b)(i.downloadReport),Object(ct.a)(i.downloadReport)];return k.a.createElement(k.a.Fragment,null,k.a.createElement(w.TableToolbar,{className:"space-between-toolbar-items"},k.a.createElement(ot.a,{className:"vulnerability-toolbar-spacing"},e&&k.a.createElement(ft.a,{selectedItems:u,selectorHandler:i.selectCves,items:a,fetchResource:function(t){return i.fetchResource(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?dt(n,!0).forEach(function(e){c()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dt(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},o,{},t))},multiRow:!0}),k.a.createElement(lt.a,{searchPlaceholder:"Find a CVEâ€¦",apply:i.apply,filterValues:o,filterCategories:l}),e&&k.a.createElement(pt.a,{systemId:n.id,selectedCves:s}),k.a.createElement(st.a,{dropdownItems:p})),k.a.createElement(ot.a,null,k.a.createElement(tt.a,{apply:i.apply,meta:a.meta}))),k.a.createElement(w.TableToolbar,{className:"pf-u-pt-0"},k.a.createElement(ot.a,null,k.a.createElement(it.a,null,k.a.createElement(ut.a,{filterValues:o,filterCategories:l,apply:i.apply})))))}}]),e}(D.Component);mt.propTypes={showRemediationButton:P.a.bool,entity:P.a.object,context:P.a.object},mt.defaultProps={showRemediationButton:!1,totalNumber:0,apply:function(){},downloadReport:function(){}};var yt=function(t){return k.a.createElement(ht.Consumer,null,function(e){return k.a.createElement(mt,W()({context:e},t))})};function bt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function vt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bt(n,!0).forEach(function(e){c()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bt(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var ht=k.a.createContext({}),Ot=[{title:"CVE ID",key:"synopsis",transforms:[B.a,Object(F.b)("col-width-10")],columnTransforms:[Object(F.b)("no-wrap")],cellFormatters:[V.b]},{title:"Publish date",key:"public_date",transforms:[B.a,Object(F.b)("col-width-10")]},{title:"CVSS base score",key:"cvss_score",transforms:[B.a,Object(F.b)("col-width-10")]},{title:"Impact",key:"impact",transforms:[B.a,Object(F.b)("col-width-10")],columnTransforms:[Object(F.b)("no-wrap")]},{title:"Business risk",key:"business_risk",transforms:[B.a,Object(F.b)("col-width-10")]},{title:"Status",key:"status",transforms:[B.a,Object(F.b)("col-width-10")]}],jt=function(t){function e(t){var n;return l()(this,e),(n=m()(this,b()(e).call(this,t))).processError=function(t){var e=t.status;return 404===parseInt(e)&&n.props.entity?x.g:x.f},n.apply=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.hasOwnProperty("cvss_filter")){var e=x.a.find(function(e){return e.value===t.cvss_filter});if(void 0===e&&void 0!==t.cvss_filter){var r=t.cvss_filter.split(/[^0-9]+/).filter(function(t){return parseFloat(t)});e={from:r[0],to:r[1]}}else void 0===e&&void 0===t.cvss_filter&&(e={from:void 0,to:void 0});t.cvss_from=e.from,t.cvss_to=e.to}if(t.hasOwnProperty("publish_date")){var a=x.i.find(function(e){return e.value===t.publish_date});void 0!==a?(t.public_from=a.from&&a.from.format("YYYY-MM-DD"),t.public_to=a.to&&a.to.format("YYYY-MM-DD")):(t.public_from=void 0,t.public_to=void 0,t.publish_date=void 0)}n.setState(vt({},n.state,{},t),n.sendRequest)},n.selectCves=function(t,e){var r=n.state.selectedCves;r=e?Object(q.f)(r,e,t):new Set,n.setState(vt({},n.state,{selectedCves:new Set(r)}))},n.openCves=function(t,e){var r=n.state.openedCves;r=e?Object(q.f)(r,e,t):new Set,n.setState(vt({},n.state,{openedCves:new Set(r)}))},n.createUrlParams=function(t){var e=vt({},t),r=["cvss_filter","publish_date","filter","limit","offset","page","page_size","sort","impact","business_risk_id","status_id"];Object.keys(t).forEach(function(t){return(void 0===e[t]||""===e[t]||!r.includes(t)||!1===e[t])&&delete e[t]});var a=Y.a.stringify(e);n.props.history.push("?"+a)},n.sendRequest=function(){var t=n.props,e=t.fetchData,r=t.entity;e&&e(vt({},n.state,{system:r.id})),n.createUrlParams(n.state)},n.downloadReport=function(t){var e=vt({},n.state),r=n.props.entity,a=Object(R.f)(vt({},e,{page_size:Number.MAX_SAFE_INTEGER,data_format:t,page:1,system:r.id})).payload;a&&a.then(function(e){var n=e.data,r="json"===t?JSON.stringify(n):n;return Object(M.downloadFile)(r,"vulnerability_cves-".concat((new Date).toISOString()),t)})},n.showStatusModal=function(t){n.setState({StatusModal:function(){return k.a.createElement(J.a,{cves:t,updateRef:n.apply,inventoryIds:[n.props.entity&&n.props.entity.id]})}})},n.state={selectedCves:new Set,openedCves:new Set,StatusModal:function(){return null}},n}return h()(e,t),f()(e,[{key:"componentDidMount",value:function(){var t=Y.a.parse(this.props.location.search);this.apply(vt({},{sort:"-public_date"},{},t))}},{key:"render",value:function(){var t=this.props,e=t.cveList,n=t.entity,r=this.apply,a=this.downloadReport,o=this.selectCves,i=this.openCves,s=this.showStatusModal,c=this.state.StatusModal,u=e,l=u.errors;return l?this.processError(l):k.a.createElement(ht.Provider,{value:{cves:u,params:this.state,methods:{apply:r,downloadReport:a,selectCves:o,openCves:i,showStatusModal:s,fetchResource:function(t){return Object(R.f)(vt({},t,{system:n.id}))}}}},k.a.createElement(c,null),k.a.createElement(N.a,null,k.a.createElement(H.a,null,k.a.createElement(yt,{showRemediationButton:!0,entity:n})),k.a.createElement(H.a,null,k.a.createElement(at,{header:Ot,entity:n}))))}}]),e}(D.Component);jt.propTypes={entity:P.a.object,cveList:P.a.any,fetchData:P.a.func,history:P.a.object,location:P.a.object};var Et=Object(T.a)(Object(_.connect)(function(t){var e=t.SystemCvesStore,n=t.entityDetails.entity;return{cveList:e&&Object(z.b)(n.id,e.cveList),entity:n}},function(t){return{fetchData:function(e){return t(Object(R.f)(e))}}})(jt)),wt=function(t){function e(t){return l()(this,e),m()(this,b()(e).call(this,t))}return h()(e,t),f()(e,[{key:"render",value:function(){var t=this.props,e=t.entity,n=t.isOptOut,r=t.optOutSystemHandler;return this.props.setHeader({breadcrumbs:[{title:L.b.vulnerabilities.title,to:L.b.vulnerabilities.to},{title:L.b.systems.title,to:L.b.systems.to},{title:e&&e.display_name||"Invalid System",isActive:!0}]}),e?n?k.a.createElement(k.a.Fragment,null,k.a.createElement(x.l,{buttonAction:function(){return r(!1)}})):k.a.createElement(k.a.Fragment,null,k.a.createElement(Et,{entity:e.id})):k.a.createElement(w.InvalidObject,null)}}]),e}(k.a.Component);wt.propTypes={setHeader:P.a.func,entity:P.a.object,isOptOut:P.a.bool,optOutSystemHandler:P.a.func};var gt=Object(T.a)(Object(_.connect)(function(t){var e=t.entityDetails;return{entity:e.entity,isOptOut:e.opt_out}},function(t){return{setHeader:function(e){return t(Object(R.n)(e))}}})(wt)),St=n(381);function Ct(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Pt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ct(n,!0).forEach(function(e){c()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ct(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var Dt={loaded:!1},kt=function(t,e){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dt,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case St.i+"_FULFILLED":return Pt({},n,{},r.payload.data);case t.LOAD_ENTITY_FULFILLED:return Pt({},n,{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return k.a.createElement(gt,{optOutSystemHandler:e})}}]});case t.LOAD_ENTITY_REJECTED:return Pt({},n,{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return k.a.createElement(gt,null)}}]});default:return n}}},_t=n(85),It=n(394);function Tt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Rt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Tt(n,!0).forEach(function(e){c()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Tt(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var xt=function(t){function e(t){var n;return l()(this,e),(n=m()(this,b()(e).call(this,t))).checkItem=function(t,e){var r=n.state.systemList;r[t].selected=e,n.setState({systemList:r})},n.toggleLinkHover=function(t){n.setState(Rt({},n.state,{linkHovered:t}))},n.optOutSystem=function(t){n.props.optOutSystem(n.state.inventoryId,t).then(function(){n.props.fetchSystemDetails(n.state.inventoryId),!0===t?n.props.addNotification({variant:"success",title:"System successfully excluded from vulnerability analysis"}):n.props.addNotification({variant:"success",title:"System successfully resumed vulnerability analysis",description:"There may be 24 hours before data is available"})})},n.state={inventoryId:n.props.match.params.inventoryId,removeListener:function(){},linkHovered:!1},n}var n;return h()(e,t),f()(e,[{key:"componentDidMount",value:function(){this.props.fetchSystemDetails(this.state.inventoryId),this.fetchInventory()}},{key:"fetchInventory",value:(n=i()(a.a.mark(function t(){var e,n,r,o,i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,insights.loadInventory({react:k.a,reactRouterDom:I,reactCore:O,reactIcons:E,pfReactTable:S});case 2:e=t.sent,n=e.inventoryConnector,r=e.mergeWithEntities,o=e.mergeWithDetail,i=e.INVENTORY_ACTION_TYPES,_t.a.register(Rt({},r(),{},o(kt(i,this.optOutSystem)))),this.setState({InventoryHeader:n().InventoryDetailHead,InventoryBody:n().AppInfo}),this.state.removeListener();case 10:case"end":return t.stop()}},t,this)})),function(){return n.apply(this,arguments)})},{key:"render",value:function(){var t=this,e=this.state,n=e.InventoryHeader,r=e.InventoryBody,a=this.props.systemDetails,o=void 0===a?{}:a,i=o.opt_out,s=void 0!==i&&i,c=o.entity;return k.a.createElement(j.a,null,k.a.createElement(It.a,{title:"",showTabs:!1},n&&k.a.createElement(n,{hideBack:!0,actions:c&&[s?{title:"Resume vulnerability analysis",onClick:function(){return t.optOutSystem(!1)}}:{title:"Exclude from vulnerability analysis",onClick:function(){return t.optOutSystem(!0)}}]})),r&&k.a.createElement(w.Main,null,k.a.createElement(k.a.Fragment,null,k.a.createElement(r,{optOutSystemHandler:this.optOutSystem}))))}}]),e}(k.a.Component);xt.propTypes={fetchSystemDetails:P.a.func,systemDetails:P.a.object,optOutSystem:P.a.func,match:P.a.object,addNotification:P.a.func};e.default=Object(T.a)(Object(_.connect)(function(t){return{systemDetails:t.entityDetails}},function(t){return{optOutSystem:function(e,n){return t(Object(R.j)(e,n))},fetchSystemDetails:function(e){return t(Object(R.g)(e))},addNotification:function(e){return t(Object(g.addNotification)(e))}}})(xt))}}]);
//# sourceMappingURL=../sourcemaps/InventoryDetail.js.map