(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{1666:function(e,t,n){"use strict";var a=n(332),r=n.n(a),o=n(296),i=n.n(o),s=n(552),c=n.n(s),l=n(580),u=n(581),p=n(0),f=n.n(p),d=n(2),m=n.n(d),v=function(e){var t=e.dropdownItems,n=e.disabled,a=c()(e,["dropdownItems","disabled"]),o=Object(d.useState)(!1),s=i()(o,2),p=s[0],f=s[1];return m.a.createElement("div",null,m.a.createElement(l.a,r()({onSelect:function(){f(!p)},toggle:m.a.createElement(u.a,{onToggle:function(e){f(e)},isDisabled:n}),isOpen:p,isPlain:!0,dropdownItems:t},a)))};v.propTypes={dropdownItems:f.a.array,disabled:f.a.bool},t.a=v},1667:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return p}),n.d(t,"c",function(){return f}),n.d(t,"d",function(){return d}),n.d(t,"e",function(){return m});var a=n(332),r=n.n(a),o=n(565),i=n(2),s=n.n(i),c=n(9),l=n(323),u=function(e,t){var n=r()({},t);return s.a.createElement(o.a,r()({key:"json",component:"button",onClick:function(){return e("json")}},n),s.a.createElement(l.a,c.a.kebabExportAsJson))},p=function(e,t){var n=r()({},t);return s.a.createElement(o.a,r()({key:"csv",component:"button",onClick:function(){return e("csv")}},n),s.a.createElement(l.a,c.a.kebabExportAsCsv))},f=function(e,t,n){var a=r()({},n);return s.a.createElement(o.a,r()({key:"editBusinessRisk",component:"button",onClick:function(){return e(t)}},a),s.a.createElement(l.a,c.a.kebabEditBusinessRisk))},d=function(e,t,n,a){var i=r()({},a);return s.a.createElement(o.a,r()({key:"editStatus",component:"button",onClick:function(){return e(t,n)}},i),s.a.createElement(l.a,c.a.kebabEditStatus))},m=function(e,t,n){var a=r()({},n);return s.a.createElement(o.a,r()({key:"toggleCveDescription",component:"button",onClick:function(){return e()}},a),t?s.a.createElement(l.a,c.a.kebabCollapseCves):s.a.createElement(l.a,c.a.kebabExpandCves))}},1681:function(e,t,n){"use strict";var a=n(296),r=n.n(a),o=n(163),i=n.n(o),s=n(295),c=n.n(s),l=n(2),u=n.n(l),p=n(372),f=n(575),d=n(373),m=n(410),v=n(0),y=n.n(v),b=n(9),h=n(323);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(n,!0).forEach(function(t){c()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var j=function(e){var t=e.filterValues,n=e.filterCategories,a=e.apply,o=g({},t),s=i()(n);delete o.show_all;var l=s.map(function(e){var t=e.urlParam;return Object.entries(o).find(function(e){return r()(e,1)[0]===t})}).filter(function(e){return function(e){return e&&!e.includes(void 0)&&!e.includes("")}(e)});return l.length>0&&u.a.createElement(u.a.Fragment,null,u.a.createElement(p.a,{withToolbar:!0},l.map(function(e){var n=r()(e,2),o=n[0],i=n[1],l=s.find(function(e){return e.urlParam===o}),p=l.title,m=l.urlParam,v=l.values;return u.a.createElement(f.a,{key:o,categoryName:p},i&&i.toString().split(",").map(function(e){var n=v.find(function(t){return-1!==t.value.indexOf(e)}),r=n?g({},n):{value:o,label:e},i=r.value,s=r.label;return u.a.createElement(d.a,{key:i,onClick:function(){return function(e,n){var r=n.split(","),o=c()({},e,t[e].split(",").filter(function(e){return!r.includes(e)}).join(","));if(0!==o[e].length)a(g({},o,{page:1}));else{var i=g({},t,c()({},e,void 0));a(g({},i,{page:1}))}}(m,e)}},s)}))})),u.a.createElement(m.a,{variant:"link",onClick:function(){return function(e){var t=e.reduce(function(e,t){return g({},e,c()({},t[0],void 0))},{});a(g({},t,{page:1}))}(l)}},u.a.createElement(h.a,b.a.filterChipsClear)))};j.propTypes={filterValues:y.a.object,filterCategories:y.a.array,apply:y.a.func},t.a=j},1682:function(e,t,n){"use strict";var a=n(295),r=n.n(a),o=n(294),i=n(0),s=n.n(i),c=n(2),l=n.n(c);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(n,!0).forEach(function(t){r()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var f=function(e){var t=e.filterValues,n=e.filterCategories,a=e.apply;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",null,l.a.createElement(o.FilterDropdown,{addFilter:function(e,n,o){var i;i="radio"===o||"show_all"===e?r()({},e,n):t[e]?r()({},e,"".concat(t[e],",").concat(n)):r()({},e,n),a(p({},i,{page:1}))},removeFilter:function(e,n){var o=n.split(","),i=r()({},e,t[e].split(",").filter(function(e){return!o.includes(e)}).join(","));if(0!==i.length)a(p({},i,{page:1}));else{var s=p({},t,r()({},e,void 0));a(p({},s,{page:1}))}},filters:t,filterCategories:n})))};f.propTypes={filterValues:s.a.object,filterCategories:s.a.array,apply:s.a.func},t.a=f},1683:function(e,t,n){"use strict";var a=n(296),r=n.n(a),o=n(294),i=n(909),s=n.n(i),c=n(0),l=n.n(c),u=n(2),p=n.n(u),f=function(e){var t=e.placeholder,n=e.value,a=e.apply,i=Object(u.useState)(n),c=r()(i,2),l=c[0],f=c[1],d=Object(u.useState)(function(){return s()(function(e){void 0!==e&&a({filter:e,page:1})},400)}),m=r()(d,1)[0];return Object(u.useEffect)(function(){return m(l)},[l,m]),Object(u.useEffect)(function(){return f(n)},[n]),p.a.createElement(o.ConditionalFilter,{placeholder:t,onChange:function(e,t){return f(t)},value:l})};f.propTypes={placeholder:l.a.string,value:l.a.string,apply:l.a.func},t.a=f},1684:function(e,t,n){"use strict";var a=n(296),r=n.n(a),o=n(602),i=n(603),s=n(855),c=n(586),l=n(587),u=n(600),p=n(601),f=n(574),d=n(288),m=n(458),v=n(0),y=n.n(v),b=n(2),h=n.n(b),O=n(551),g=n(1657),j=n(73),E=n(9),w=function(e){var t=e.cves,n=e.updateRef,a=e.inventories,v=e.hasDifferentStatus,y=void 0!==v&&v,j=e.intl,w=e.type,S=Object(b.useState)(t),P=r()(S,1)[0],C=Object(b.useState)(a),k=r()(C,1)[0],D=Object(g.b)(function(){if(k&&1===k.length&&k[0].justification)return k&&1===k.length&&k[0].justification||"";if(P&&1===P.length)return z()}()),_=D.JustificationInput,I=D.justification,M=D.setJustification,T=D.setProps,x=Object(b.useState)(function(){if(k&&1===k.length&&k[0].status_id){var e=r()(k,1)[0];return P.some(function(t){return t.status_id===e.status_id})}if(P&&1===P.length)return!0;return!1}()),R=r()(x,2),A=R[0],L=R[1],F=Object(g.c)(function(){if(k&&k.length>0&&k[0].status_id)return k&&k[0].status_id.toString()||"0";if(P&&P.length>0)return U()}()),H=F.StatusSelect,N=F.statusId,B=F.setStatusId,Y=F.setProps,V=k.map(function(e){return e.id});Object(b.useEffect)(function(){A&&(Y({isDisabled:!0}),T({disabled:!0}))},[A,Y,T]),Object(b.useEffect)(function(){B(U())},[A,B]);function U(){switch(w){case"systemsExposed":return P&&1===P.length&&P[0].status_id.toString()||"0";case"systemDetail":return P?A&&!y?P[0].cve_status_id||0:y?"0":A||y?"0":P[0].status_id:"0";default:return"0"}}function z(){return P&&1===P.length&&P[0].justification||""}var J={variant:"success",title:j.formatMessage(E.a.cvePairStatusModalUpdateSuccessful)},W=j.formatMessage(E.a.cvePairStatusModalTitle,{count:V.length*t.length});return h.a.createElement(g.a,{items:P,onSave:function(){var e=P.map(function(e){return e.id}),t=A?{cve:e,inventory_id:V}:{status_id:parseInt(N),cve:e,status_text:I,inventory_id:V};return Object(O.l)(t).then(n)},onSuccessNotification:J,title:W},h.a.createElement(o.a,{gutter:"md"},y&&h.a.createElement(i.a,null,h.a.createElement(s.a,{variant:"warning",isInline:!0,title:j.formatMessage(E.a.cvePairStatusModalAlert)})),h.a.createElement(i.a,null,j.formatMessage(E.a.cvePairStatusModalSelected,{cveCount:P.length||0,cveId:P[0].id,systemCount:k.length||0,systemName:V[0],b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return h.a.createElement("b",null,t)}})),h.a.createElement(i.a,null,h.a.createElement(c.a,{key:"key"},h.a.createElement(l.a,{fieldId:"overall"},h.a.createElement(u.a,null,h.a.createElement(p.a,null,h.a.createElement(f.a,{label:j.formatMessage(E.a.cvePairStatusModalUseOverallCheckbox),id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:A,onChange:function(e){L(e),Y({isDisabled:e}),B(U()),M(z()),T({disabled:e})}})),h.a.createElement(p.a,null,h.a.createElement(d.a,{content:j.formatMessage(E.a.cvePairStatusModalUseOverallTooltip)},h.a.createElement(m.b,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)",style:{verticalAlign:"0"}}))))),H,_))))};w.propTypes={cves:y.a.array,updateRef:y.a.func,inventories:y.a.array,hasDifferentStatus:y.a.bool,intl:y.a.any,type:y.a.string},t.a=Object(j.c)(w)},1685:function(e,t,n){"use strict";var a=n(296),r=n.n(a),o=n(565),i=n(580),s=n(568),c=n(574),l=n(0),u=n.n(l),p=n(2),f=n.n(p),d=n(1664),m=n.n(d),v=n(9),y=n(73),b=function(e){var t=Object(p.useState)(!1),n=r()(t,2),a=n[0],l=n[1],u=e.selectedItems,d=e.items,y=e.multiRow,b=Array.from(u),h=b&&b.length,O=d.meta,g=d.data,j=Boolean(h)&&"".concat(h," selected"),E=y?g.length/2:g.length,w=function(){(0,e.selectorHandler)(!1,void 0)},S=function(){var t=e.items.meta,n=e.selectorHandler,a=e.fetchResource,r=(a&&a({page_size:t.total_items,page:1})).payload;r&&r.then(function(e){var t=e.data.map(function(e){return e.id});n(!0,t)})},P=[f.a.createElement(o.a,{key:"none",onClick:w},e.intl.formatMessage(v.a.selectNone)),f.a.createElement(o.a,{key:"page",onClick:function(){var t=e.items.data;(0,e.selectorHandler)(!0,m()(t.filter(function(e){return e.id}).map(function(e){return e.id}),b))},isDisabled:0===O.total_items},e.intl.formatMessage(v.a.selectPage,{count:E})),f.a.createElement(o.a,{key:"all",onClick:S,isDisabled:0===O.total_items},e.intl.formatMessage(v.a.selectAll,{count:O.total_items}))];return f.a.createElement(i.a,{onSelect:function(){l(!a)},toggle:f.a.createElement(s.a,{splitButtonItems:[f.a.createElement(c.a,{id:"selectAllcheckbox",key:"selectAllcheckbox",isChecked:0!==h&&(O.total_items===h||null),onChange:function(){0===h?S():w()}}),j],onToggle:function(e){l(e)},isDisabled:0===O.total_items&&0===h}),isOpen:a,dropdownItems:P})};b.propTypes={selectorHandler:u.a.func,fetchResource:u.a.func,selectedItems:u.a.oneOfType([u.a.array,u.a.object]),items:u.a.object,multiRow:u.a.bool,intl:u.a.any},b.defaultProps={impact:"Unknown",selectedItems:[],items:{},multiRow:!1},t.a=Object(y.c)(b)},1769:function(e,t,n){"use strict";n.r(t);var a=n(135),r=n.n(a),o=n(206),i=n.n(o),s=n(295),c=n.n(s),l=n(182),u=n.n(l),p=n(183),f=n.n(p),d=n(184),m=n.n(d),v=n(185),y=n.n(v),b=n(186),h=n.n(b),O=n(226),g=n(267),j=n(297),E=n(294),w=n(298),S=n(550),P=n(0),C=n.n(P),k=n(2),D=n.n(k),_=n(187),I=n(162),M=n(154),T=n(1654),x=n(323),R=n(9),A=n(217),L=n(552),F=n.n(L),H=n(1658),N=n.n(H),B=n(73),Y=n(407),V=n(746),U=n(462),z=n(271),J=n(602),W=n(603),q=n(593),K=n(594),G=n(1659),Q=n(1668),X=n(103),Z=n(334),$=n(1665),ee=n(1684),te=n(332),ne=n.n(te),ae=n(163),re=n.n(ae),oe=n(605),ie=n(604),se=n(1666),ce=n(1667),le=n(1681),ue=n(1682),pe=n(1683),fe=n(1676),de=n(1697),me=n(1685);function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(n,!0).forEach(function(t){c()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var be=function(e){function t(){var e,n,a;u()(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return m()(a,(n=a=m()(this,(e=y()(t)).call.apply(e,[this].concat(o))),a.handleCveDescription=function(){var e=a.props.context,t=e.cves,n=e.methods,r=e.params.expandCveDescription,o=!r,i=r?[]:t.data.filter(function(e){return e.id}).map(function(e){return e.id});n.openCves(o,i,!r)},n))}return h()(t,e),f()(t,[{key:"render",value:function(){var e=this.props,t=e.showRemediationButton,n=e.entity,a=e.context,r=a.cves,o=a.params,i=a.methods,s=o.selectedCves,c=o.expandCveDescription,l=o.filter,u=!0===this.props.showRemediationButton?s&&s.size||0:void 0,p=[X.v,X.w,X.t,X.r,X.x,X.u],f=[Object(ce.d)(i.showStatusModal,re()(s).map(function(e){return ye({id:e},r.data.filter(function(t){return e===t.id}).map(function(e){return{status_id:e.status_id,cve_status_id:e.cve_status_id}})[0])}),[],{isDisabled:!u}),Object(ce.e)(this.handleCveDescription,c,{isDisabled:0===r.data.length}),Object(ce.b)(i.downloadReport,{isDisabled:0===r.data.length}),Object(ce.a)(i.downloadReport,{isDisabled:0===r.data.length})];return D.a.createElement(D.a.Fragment,null,D.a.createElement(E.TableToolbar,{className:"space-between-toolbar-items"},D.a.createElement(oe.a,{className:"vulnerability-toolbar-spacing"},t&&D.a.createElement(me.a,{selectedItems:s,selectorHandler:i.selectCves,items:r,fetchResource:function(e){return i.fetchResource(ye({},o,{},e))},multiRow:!0}),D.a.createElement(pe.a,{placeholder:this.props.intl.formatMessage(R.a.searchFilterLabel),value:l,apply:i.apply}),D.a.createElement(ue.a,{filterValues:o,filterCategories:p,apply:i.apply}),t&&D.a.createElement(de.a,{systemId:n.id,selectedCves:s}),D.a.createElement(se.a,{dropdownItems:f,disabled:0===r.data.length&&0===u})),D.a.createElement(oe.a,null,D.a.createElement(fe.a,{apply:i.apply,meta:r.meta}))),D.a.createElement(E.TableToolbar,{className:"pf-u-pt-0"},D.a.createElement(oe.a,null,D.a.createElement(ie.a,null,D.a.createElement(le.a,{filterValues:o,filterCategories:[X.p].concat(p),apply:i.apply})))))}}]),t}(k.Component);be.propTypes={showRemediationButton:C.a.bool,entity:C.a.object,context:C.a.object,intl:C.a.any},be.defaultProps={showRemediationButton:!1,totalNumber:0,apply:function(){},downloadReport:function(){}};var he=Object(B.c)(function(e){return D.a.createElement(_e.Consumer,null,function(t){return D.a.createElement(be,ne()({context:t},e))})}),Oe=n(93),ge=n(852),je=n(849),Ee=n(1662);function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(n,!0).forEach(function(t){c()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Pe=function(e){function t(){var e,n,a;u()(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return m()(a,(n=a=m()(this,(e=y()(t)).call.apply(e,[this].concat(o))),a.noCves=function(){var e=a.props,t=e.entity,n=e.context.cves;return[{heightAuto:!0,cells:[{props:{colSpan:8},title:0!==["filter","cvss_from","cvss_to","public_from","public_to","impact","status_id"].filter(function(e){return Object.prototype.hasOwnProperty.call(n.meta,e)&&n.meta[e]}).length?G.f:t?G.b:0===n.data.length?G.a:void 0}]}]},a.handleOnSelect=function(e,t,n){var r=a.props.context,o=r.cves,i=r.methods,s=o.data[n]&&o.data[n].id;i.selectCves(t,s)},n))}return h()(t,e),f()(t,[{key:"handleOnCollapse",value:function(e,t,n){var a=this.props.context,r=a.cves,o=a.methods,i=a.params.expandCveDescription,s=r.data[t]&&r.data[t].id;o.openCves(n,s,i)}},{key:"render",value:function(){var e=this,t=this.props,n=t.context,a=t.header,r=n.params,o=n.cves,i=n.methods,s=r.selectedCves,c=r.openedCves,l=o.data.map(function(e){return s.has(e.id)&&Se({},e,{selected:!0})||e}).map(function(e){return c.has(e.id)&&Se({},e,{isOpen:!0})||e});return D.a.createElement(k.Fragment,null,o.isLoading?D.a.createElement(E.SkeletonTable,{colSize:2,rowSize:20}):D.a.createElement(k.Fragment,null,D.a.createElement(Oe.b,{"aria-label":"Vulnerability CVE table",cells:a,rows:0===o.data.length?this.noCves():l,onSelect:0!==o.data.length?this.handleOnSelect:void 0,actions:0!==o.data.length?Object(Ee.e)(i):void 0,sortBy:0!==o.data.length?Object(Z.b)([{key:"collapse"},{key:"checkbox"}].concat(re()(a)),o.meta.sort):void 0,onCollapse:0!==o.data.length?function(t,n,a){return e.handleOnCollapse(t,n,a)}:void 0,onSort:0!==o.data.length?function(e,t,n){return Object(Z.e)(t,n,[{key:"collapse"},{key:"checkbox"}].concat(re()(a)),o.meta.sort,i.apply)}:void 0,gridBreakPoint:"grid-lg"},D.a.createElement(k.Fragment,null,D.a.createElement(ge.a,null),D.a.createElement(je.a,null))),D.a.createElement(E.TableToolbar,null,D.a.createElement(fe.a,{variant:"bottom",meta:o.meta,apply:i.apply}))))}}]),t}(k.Component);Pe.propTypes={context:C.a.any,header:C.a.array,entity:C.a.object};var Ce=function(e){return D.a.createElement(_e.Consumer,null,function(t){return D.a.createElement(Pe,ne()({context:t},e))})};n(1694);function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function De(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(n,!0).forEach(function(t){c()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var _e=D.a.createContext({}),Ie=function(e){function t(e){var n;return u()(this,t),(n=m()(this,y()(t).call(this,e))).processError=function(e){var t=e.status;return 404===parseInt(t)&&n.props.entity?G.d:G.g},n.dataReload=function(){var e=n.props.cveList,t=e.meta,a=e.data,r=t.page,o=r===t.pages&&a.length/2==1?1:r;n.setState(De({},n.state,{page:o,page_size:t.page_size}),n.apply)},n.apply=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object.prototype.hasOwnProperty.call(e,"cvss_filter")){var t=X.e.find(function(t){return t.value===e.cvss_filter});if(void 0===t&&void 0!==e.cvss_filter){var a=e.cvss_filter.split(/[^0-9]+/).filter(function(e){return parseFloat(e)});t={from:a[0],to:a[1]}}else void 0===t&&void 0===e.cvss_filter&&(t={from:void 0,to:void 0});e.cvss_from=t.from,e.cvss_to=t.to}if(Object.prototype.hasOwnProperty.call(e,"publish_date")){var r=X.i.find(function(t){return t.value===e.publish_date});void 0!==r?(e.public_from=r.from&&r.from.format("YYYY-MM-DD"),e.public_to=r.to&&r.to.format("YYYY-MM-DD")):(e.public_from=void 0,e.public_to=void 0,e.publish_date=void 0)}n.setState(De({},n.state,{},e),n.sendRequest)},n.selectCves=function(e,t){var a=n.state.selectedCves;a=t?Object(Z.f)(a,t,e):new Set,n.setState(De({},n.state,{selectedCves:new Set(a)}))},n.openCves=function(e,t,a){var r=n.state,o=r.openedCves;if(r.expandCveDescription&&!t.length&&(o=t),o=t?Object(Z.f)(o,t,e):new Set,!Array.isArray(t)){var i=n.props.cveList.data,s=i.filter(function(e){return o.has(e.id)});a=i.length/2===s.length}n.setState(De({},n.state,{openedCves:new Set(o),expandCveDescription:a}))},n.createUrlParams=function(e){var t=De({},e),a=["cvss_filter","publish_date","filter","limit","offset","page","page_size","sort","impact","business_risk_id","status_id","security_rule"];Object.keys(e).forEach(function(e){return(void 0===t[e]||""===t[e]||!a.includes(e)||!1===t[e])&&delete t[e]});var r=N.a.stringify(t);n.props.history.push("?"+r)},n.sendRequest=function(){var e=n.props,t=e.fetchData,a=e.entity,r=n.state.expandCveDescription;t&&t(De({},n.state,{system:a.id})).then(function(e){var t=e.data;if(r){var a=t&&t.map(function(e){return e.id});n.openCves(!0,a,r)}}),n.createUrlParams(n.state)},n.downloadReport=function(e){var t=n.props.entity,a=De({},n.state,{system:t.id});$.a.exec(T.h,a,e,"system-cves")},n.showStatusModal=function(e){var t;if(e.length>1){var a=Array.from(n.props.cveList.data.filter(function(t){return e.some(function(e){return e.id===t.id})}));t=a.some(function(e){return!(a.filter(function(t){return t.status_id===e.status_id}).length>1)})}n.setState({StatusModal:function(){return D.a.createElement(ee.a,{cves:e,updateRef:n.dataReload,inventories:[{id:n.props.entity&&n.props.entity.id}],hasDifferentStatus:t,type:"systemDetail"})}})},n.state={selectedCves:new Set,openedCves:new Set,StatusModal:function(){return null},expandCveDescription:!1},n}return h()(t,e),f()(t,[{key:"componentDidMount",value:function(){var e=N.a.parse(this.props.location.search);this.apply(De({},{sort:"-public_date"},{},e))}},{key:"render",value:function(){var e=this.props,t=e.cveList,n=e.entity,a=this.apply,r=this.downloadReport,o=this.selectCves,i=this.openCves,s=this.showStatusModal,c=this.state.StatusModal,l=t,u=l.errors,p=[{title:this.props.intl.formatMessage(R.a.cveId),key:"synopsis",transforms:[V.a,Object(U.b)("col-width-10")],columnTransforms:[Object(U.b)("no-wrap")],cellFormatters:[z.b]},{title:this.props.intl.formatMessage(R.a.publishDate),key:"public_date",transforms:[V.a,Object(U.b)("col-width-10")]},{title:this.props.intl.formatMessage(R.a.impact),key:"impact",transforms:[V.a,Object(U.b)("col-width-10")],columnTransforms:[Object(U.b)("no-wrap")]},{title:this.props.intl.formatMessage(R.a.cvssBaseScore),key:"cvss_score",transforms:[V.a,Object(U.b)("col-width-10")]},{title:this.props.intl.formatMessage(R.a.businessRisk),key:"business_risk",transforms:[V.a,Object(U.b)("col-width-10")]},{title:this.props.intl.formatMessage(R.a.status),key:"status",transforms:[V.a,Object(U.b)("col-width-10")]}];return u?this.processError(u):D.a.createElement(_e.Provider,{value:{cves:l,params:this.state,methods:{apply:a,downloadReport:r,selectCves:o,openCves:i,showStatusModal:s,fetchResource:function(e){return Object(T.h)(De({},e,{system:n.id}))}}}},D.a.createElement(c,null),D.a.createElement(J.a,null,D.a.createElement(W.a,null,D.a.createElement(q.a,null,D.a.createElement(K.a,{component:K.b.h2},this.props.intl.formatMessage(R.a.systemCvesTableHeader)))),D.a.createElement(W.a,null,D.a.createElement(he,{showRemediationButton:!0,entity:n})),D.a.createElement(W.a,null,D.a.createElement(Ce,{header:p,entity:n}))))}}]),t}(k.Component);Ie.propTypes={entity:C.a.object,cveList:C.a.any,fetchData:C.a.func,history:C.a.object,location:C.a.object,intl:C.a.any};var Me=Object(M.o)(Object(B.c)(Object(_.connect)(function(e){var t=e.SystemCvesStore,n=e.entityDetails.entity;return{cveList:t&&Object(Q.c)(n.id,t.cveList),entity:n}},function(e){return{fetchData:function(t){var n=Object(T.h)(t);return e(n),n.payload}}})(Ie))),Te=function(e){var t=e.customItnlProvider,n=F()(e,["customItnlProvider"]),a=t?{Wrapper:Y.b,intProps:{locale:navigator.language.slice(0,2),messages:R.a}}:{wrapper:k.Fragment,intlProps:{}},r=a.Wrapper,o=a.intlProps;return D.a.createElement(r,o,D.a.createElement(Me,n))};Te.propTypes={customItnlProvider:C.a.bool},Te.defaultProps={customItnlProvider:!1};var xe=function(e){function t(e){return u()(this,t),m()(this,y()(t).call(this,e))}return h()(t,e),f()(t,[{key:"render",value:function(){var e=this.props,t=e.entity,n=e.isOptOut,a=e.optOutSystemHandler;return this.props.setHeader({breadcrumbs:[{title:A.b.vulnerabilities.title,to:A.b.vulnerabilities.to},{title:A.b.systems.title,to:A.b.systems.to},{title:t&&t.display_name||D.a.createElement(x.a,R.a.invalidSystem),isActive:!0}]}),t?n?D.a.createElement(D.a.Fragment,null,D.a.createElement(G.c,{buttonAction:function(){return a(!1)}})):D.a.createElement(D.a.Fragment,null,D.a.createElement(Me,{entity:t.id})):null}}]),t}(D.a.Component);xe.propTypes={setHeader:C.a.func,entity:C.a.object,isOptOut:C.a.bool,optOutSystemHandler:C.a.func};var Re=Object(M.o)(Object(_.connect)(function(e){var t=e.entityDetails;return{entity:t.entity,isOptOut:t.opt_out}},function(e){return{setHeader:function(t){return e(Object(T.q)(t))}}})(xe)),Ae=n(1655);function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(n,!0).forEach(function(t){c()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var He={loaded:!1},Ne=function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:He,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case Ae.k+"_FULFILLED":return Fe({},n,{},a.payload.data);case e.LOAD_ENTITY_FULFILLED:return Fe({},n,{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return D.a.createElement(Re,{optOutSystemHandler:t})}}]});case e.LOAD_ENTITY_REJECTED:return Fe({},n,{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return D.a.createElement(Re,null)}}]});default:return n}}},Be=n(333),Ye=n(553);function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(n,!0).forEach(function(t){c()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ze=function(e){function t(e){var n;return u()(this,t),(n=m()(this,y()(t).call(this,e))).checkItem=function(e,t){var a=n.state.systemList;a[e].selected=t,n.setState({systemList:a})},n.toggleLinkHover=function(e){n.setState(Ue({},n.state,{linkHovered:e}))},n.optOutSystem=function(e){n.props.optOutSystem(n.state.inventoryId,e).then(function(){n.props.fetchSystemDetails(n.state.inventoryId),!0===e?n.props.addNotification({variant:"success",title:n.props.intl.formatMessage(R.a.inventoryOptOutSuccess)}):n.props.addNotification({variant:"success",title:n.props.intl.formatMessage(R.a.inventoryResumeAnalysisTitle),description:n.props.intl.formatMessage(R.a.inventoryResumeAnalysisDescription)})})},n.state={inventoryId:n.props.match.params.inventoryId,removeListener:function(){},linkHovered:!1},n}var n;return h()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.props.fetchSystemDetails(this.state.inventoryId),this.fetchInventory()}},{key:"fetchInventory",value:(n=i()(r.a.mark(function e(){var t,n,a,o,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,insights.loadInventory({react:D.a,reactRouterDom:I,reactCore:O,reactIcons:j,pfReactTable:S});case 2:t=e.sent,n=t.inventoryConnector,a=t.mergeWithEntities,o=t.mergeWithDetail,i=t.INVENTORY_ACTION_TYPES,Be.a.register(Ue({},a(),{},o(Ne(i,this.optOutSystem)))),this.setState({InventoryHeader:n(Be.a.getStore()).InventoryDetailHead,InventoryBody:n(Be.a.getStore()).AppInfo}),this.state.removeListener();case 10:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,n=t.InventoryHeader,a=t.InventoryBody,r=this.props.systemDetails,o=void 0===r?{}:r,i=o.opt_out,s=void 0!==i&&i,c=o.entity;return D.a.createElement(g.a,null,D.a.createElement(Ye.a,{title:"",showTabs:!1},n&&D.a.createElement(n,{hideBack:!0,actions:c&&[s?{title:this.props.intl.formatMessage(R.a.inventoryKebabOptionsResume),onClick:function(){return e.optOutSystem(!1)}}:{title:this.props.intl.formatMessage(R.a.inventoryKebabOptionsExclude),onClick:function(){return e.optOutSystem(!0)}}]})),a&&D.a.createElement(E.Main,null,D.a.createElement(D.a.Fragment,null,D.a.createElement(a,{optOutSystemHandler:this.optOutSystem}))))}}]),t}(D.a.Component);ze.propTypes={fetchSystemDetails:C.a.func,systemDetails:C.a.object,optOutSystem:C.a.func,match:C.a.object,addNotification:C.a.func,intl:C.a.any};t.default=Object(M.o)(Object(B.c)(Object(_.connect)(function(e){return{systemDetails:e.entityDetails}},function(e){return{optOutSystem:function(t,n){return e(Object(T.l)(t,n))},fetchSystemDetails:function(t){return e(Object(T.i)(t))},addNotification:function(t){return e(Object(w.addNotification)(t))}}})(ze)))}}]);
//# sourceMappingURL=../sourcemaps/InventoryDetail.js.map