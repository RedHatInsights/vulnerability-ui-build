(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1690:function(e,t,n){"use strict";n.d(t,"e",function(){return j}),n.d(t,"f",function(){return w}),n.d(t,"b",function(){return P}),n.d(t,"c",function(){return C}),n.d(t,"a",function(){return k}),n.d(t,"d",function(){return D}),n.d(t,"g",function(){return x});var a=n(2),r=n.n(a),i=n(0),l=n.n(i),o=n(328),s=n(616),c=n(604),u=n(423),p=n(529),m=n(605),f=n(615),d=n(606),v=n(422),b=n(593),y=n(595),g=n(594),h=n(469),_=n(391),E=n(467),O=n(470),S=n(8),j=r.a.createElement(s.a,{style:{height:"auto"}},r.a.createElement(c.a,{variant:c.b.large},r.a.createElement(u.a,{headingLevel:"h5",size:"lg"},r.a.createElement(o.a,S.a.emptyStateNoMatchingCves)),r.a.createElement(p.a,null,r.a.createElement(m.a,{style:{whiteSpace:"normal"}},r.a.createElement(o.a,S.a.emptyStateMaybeFollowing),r.a.createElement(f.a,null,r.a.createElement(o.a,S.a.emptyStateNoCveReported)),r.a.createElement(f.a,{component:f.b.p},r.a.createElement(o.a,S.a.emptyStateForMoreInfo),r.a.createElement("a",{href:"https://access.redhat.com/security/team/contact/",target:"__blank",rel:"noopener noreferrer"},r.a.createElement(o.a,S.a.emptyStateForMoreLink),"  ",r.a.createElement(h.b,null))))))),w=r.a.createElement(s.a,{style:{height:"auto"}},r.a.createElement(c.a,{variant:c.b.large},r.a.createElement(u.a,{headingLevel:"h5",size:"lg"},r.a.createElement(o.a,S.a.emptyStateNoMatchingCves)),r.a.createElement(p.a,null,r.a.createElement(m.a,{style:{whiteSpace:"normal"}},r.a.createElement(o.a,S.a.emptyStateMaybeFollowing),r.a.createElement("br",null),r.a.createElement(f.a,{component:f.b.p},r.a.createElement(o.a,S.a.emptyStateNoSystemsMatching)),r.a.createElement(f.a,{component:f.b.p},r.a.createElement(o.a,S.a.emptyStateMaybeExcluded)),r.a.createElement("br",null),r.a.createElement(f.a,{component:f.b.p},r.a.createElement(o.a,S.a.emptyStateIfCveForSystem),r.a.createElement("a",{href:"https://access.redhat.com/security/team/contact/",target:"__blank",rel:"noopener noreferrer"},r.a.createElement(o.a,S.a.emptyStateForMoreLink),"  ",r.a.createElement(h.b,null))))))),P=r.a.createElement(s.a,{style:{height:"auto"}},r.a.createElement(c.a,{variant:c.b.large},r.a.createElement(u.a,{headingLevel:"h5",size:"lg"},r.a.createElement(o.a,S.a.emptyStateNoReportedSystem)),r.a.createElement(p.a,null,r.a.createElement(m.a,{style:{whiteSpace:"normal"}},r.a.createElement(f.a,null,r.a.createElement(o.a,S.a.emptyStateNoCveAffects)),r.a.createElement(f.a,{component:f.b.p},r.a.createElement(o.a,S.a.emptyStateIfCveForSystem),r.a.createElement("a",{href:"https://access.redhat.com/security/team/contact/",target:"__blank",rel:"noopener noreferrer"},r.a.createElement(o.a,S.a.emptyStateForMoreLink),"  ",r.a.createElement(h.b,null)),"."))))),C=function(e){var t=e.buttonAction;return r.a.createElement(s.a,null,r.a.createElement(c.a,{variant:c.b.large},r.a.createElement(d.a,{icon:_.b,size:"sm"}),r.a.createElement(u.a,{headingLevel:"h5",size:"lg"},r.a.createElement(o.a,S.a.emptyStateSystemExcludedTitle)),r.a.createElement(m.a,null,r.a.createElement(o.a,S.a.emptyStateSystemExcludedBody)),r.a.createElement(v.a,{variant:"primary",component:"a",onClick:t},r.a.createElement(o.a,S.a.emptyStateSystemResumeAnalysis))))};C.propTypes={buttonAction:l.a.func};var k=r.a.createElement(s.a,{style:{height:"auto"}},r.a.createElement(c.a,{variant:c.b.large},r.a.createElement(u.a,{headingLevel:"h5",size:"lg"},r.a.createElement(o.a,S.a.emptyStateNoReportedSystem)),r.a.createElement(p.a,null,r.a.createElement(m.a,{style:{whiteSpace:"normal"}},r.a.createElement(f.a,null,r.a.createElement(o.a,S.a.emptyStateNoCveAffects)),r.a.createElement(o.a,S.a.emptyStateIfCveForSystems),r.a.createElement("a",{href:"https://access.redhat.com/security/team/contact/",target:"__blank",rel:"noopener noreferrer"},r.a.createElement(o.a,S.a.emptyStateForMoreLink)," ",r.a.createElement(h.b,null)),".")))),D=r.a.createElement(s.a,null,r.a.createElement(c.a,null,r.a.createElement(d.a,{icon:E.b}),r.a.createElement(u.a,{headingLevel:"h5",size:"lg"},r.a.createElement(o.a,S.a.emptyStateNoData)),r.a.createElement(m.a,null,r.a.createElement(o.a,S.a.emptyStateActivateInsights)),r.a.createElement(v.a,{variant:"primary",component:"a",href:"http://access.redhat.com/products/cloud_management_services_for_rhel#getstarted"},r.a.createElement(o.a,S.a.emptyStateLearnInsights)))),x=r.a.createElement(b.a,{className:"ins-empty-rule-cards"},r.a.createElement(y.a,null,r.a.createElement(O.b,{size:"lg"})),r.a.createElement(g.a,null,r.a.createElement(o.a,S.a.errorReload)))},1700:function(e,t,n){var a=n(1701);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(22)(a,r);a.locals&&(e.exports=a.locals)},1701:function(e,t,n){(e.exports=n(20)(!1)).push([e.i,".ins-active-app-vulnerabilities .cvetable-toolbar,\n.page__Vulnerabilities .cvetable-toolbar {\n  justify-content: space-between; }\n  .ins-active-app-vulnerabilities .cvetable-toolbar > div,\n  .page__Vulnerabilities .cvetable-toolbar > div {\n    align-self: flex-end; }\n\n.ins-active-app-vulnerabilities .space-between-toolbar-items,\n.page__Vulnerabilities .space-between-toolbar-items {\n  justify-content: space-between;\n  flex-wrap: nowrap; }\n  .ins-active-app-vulnerabilities .space-between-toolbar-items > div,\n  .page__Vulnerabilities .space-between-toolbar-items > div {\n    flex-wrap: nowrap; }\n\n.ins-active-app-vulnerabilities .vulnerability-toolbar-spacing,\n.page__Vulnerabilities .vulnerability-toolbar-spacing {\n  justify-content: flex-start; }\n  .ins-active-app-vulnerabilities .vulnerability-toolbar-spacing > div:not(:last-child),\n  .page__Vulnerabilities .vulnerability-toolbar-spacing > div:not(:last-child) {\n    margin-right: var(--pf-global--spacer--sm); }\n\n@media screen and (max-width: 1100px) {\n  .ins-active-app-vulnerabilities .pf-c-pagination:not(.pf-m-footer) .pf-c-options-menu,\n  .ins-active-app-vulnerabilities .pf-c-pagination:not(.pf-m-footer) .pf-c-pagination__nav,\n  .page__Vulnerabilities .pf-c-pagination:not(.pf-m-footer) .pf-c-options-menu,\n  .page__Vulnerabilities .pf-c-pagination:not(.pf-m-footer) .pf-c-pagination__nav {\n    display: none;\n    visibility: hidden; }\n  .ins-active-app-vulnerabilities .pf-c-pagination__total-items,\n  .page__Vulnerabilities .pf-c-pagination__total-items {\n    display: flex;\n    visibility: visible; } }\n\n.ins-active-app-vulnerabilities .pf-c-pagination.pf-m-footer.ins-c-pagination-next,\n.page__Vulnerabilities .pf-c-pagination.pf-m-footer.ins-c-pagination-next {\n  margin-left: auto; }\n\n.ins-active-app-vulnerabilities #download-report,\n.page__Vulnerabilities #download-report {\n  cursor: pointer; }\n\n.ins-active-app-vulnerabilities .number-of-results,\n.page__Vulnerabilities .number-of-results {\n  display: inline-block;\n  min-width: 55px;\n  text-align: right;\n  margin-right: 5px; }\n\n.ins-active-app-vulnerabilities .table-header-icon,\n.page__Vulnerabilities .table-header-icon {\n  margin-right: 5px;\n  margin-right: 0.3125rem; }\n\n.ins-active-app-vulnerabilities .status-dropdown-column > svg,\n.page__Vulnerabilities .status-dropdown-column > svg {\n  color: var(--pf-global--primary-color--100); }\n\n.ins-active-app-vulnerabilities .status-dropdown-column:hover,\n.page__Vulnerabilities .status-dropdown-column:hover {\n  cursor: pointer; }\n  .ins-active-app-vulnerabilities .status-dropdown-column:hover > svg,\n  .page__Vulnerabilities .status-dropdown-column:hover > svg {\n    visibility: visible; }\n\n.ins-active-app-vulnerabilities .status-dropdown-column > svg,\n.page__Vulnerabilities .status-dropdown-column > svg {\n  visibility: hidden; }\n\n.ins-active-app-vulnerabilities tbody > tr > td.pf-c-table__check,\n.page__Vulnerabilities tbody > tr > td.pf-c-table__check {\n  vertical-align: middle;\n  padding-top: 0px !important;\n  padding-bottom: 0px !important; }\n\n.ins-active-app-vulnerabilities thead > tr > td.pf-c-table__check,\n.page__Vulnerabilities thead > tr > td.pf-c-table__check {\n  visibility: hidden; }\n\n.ins-active-app-vulnerabilities p.pf-c-empty-state__body ul,\n.page__Vulnerabilities p.pf-c-empty-state__body ul {\n  margin-top: 0px;\n  margin-bottom: var(--pf-global--spacer--sm); }\n  .ins-active-app-vulnerabilities p.pf-c-empty-state__body ul li,\n  .page__Vulnerabilities p.pf-c-empty-state__body ul li {\n    margin-top: 0px; }\n\n@media (max-width: 1500px) and (min-width: 992px) {\n  .ins-active-app-vulnerabilities .hide-description,\n  .page__Vulnerabilities .hide-description {\n    --pf-hidden-visible--Display: var(\n                --pf-hidden-visible--hidden--Display\n            );\n    --pf-hidden-visible--Visibility: var(\n                --pf-hidden-visible--hidden--Visibility\n            ); } }\n\n@media (min-width: 1400px) {\n  .ins-active-app-vulnerabilities .remediation-btn-sml,\n  .page__Vulnerabilities .remediation-btn-sml {\n    display: none;\n    visibility: hidden; } }\n\n@media (max-width: 1400px) {\n  .ins-active-app-vulnerabilities .remediation-btn-lg,\n  .page__Vulnerabilities .remediation-btn-lg {\n    display: none;\n    visibility: none; } }\n\n.ins-active-app-vulnerabilities .col-width-10,\n.page__Vulnerabilities .col-width-10 {\n  width: 10%; }\n\n.ins-active-app-vulnerabilities .col-width-15,\n.page__Vulnerabilities .col-width-15 {\n  width: 15%; }\n\n.ins-active-app-vulnerabilities .col-width-description,\n.page__Vulnerabilities .col-width-description {\n  width: 35%; }\n\n.ins-active-app-vulnerabilities .no-wrap,\n.page__Vulnerabilities .no-wrap {\n  white-space: nowrap; }\n\n.ins-active-app-vulnerabilities .pf-c-table__expandable-row-content,\n.page__Vulnerabilities .pf-c-table__expandable-row-content {\n  white-space: normal; }\n\n.ins-active-app-vulnerabilities tr.pf-m-expanded .pf-c-table__action,\n.page__Vulnerabilities tr.pf-m-expanded .pf-c-table__action {\n  display: none; }\n\n.ins-active-app-vulnerabilities .pf-c-table__check,\n.page__Vulnerabilities .pf-c-table__check {\n  vertical-align: unset !important; }\n",""])},1702:function(e,t,n){"use strict";var a=n(191),r=n.n(a),i=n(192),l=n.n(i),o=n(193),s=n.n(o),c=n(194),u=n.n(c),p=n(195),m=n.n(p),f=n(872),d=n(0),v=n.n(d),b=n(2),y=n.n(b),g=n(67),h=function(e){function t(){var e,n,a;r()(this,t);for(var i=arguments.length,l=new Array(i),o=0;o<i;o++)l[o]=arguments[o];return s()(a,(n=a=s()(this,(e=u()(t)).call.apply(e,[this].concat(l))),a.handleChangePage=function(e,t){return a.props.apply({page:t})},a.handleSetPageSize=function(e,t){return a.props.apply({page_size:t,page:1})},n))}return m()(t,e),l()(t,[{key:"shouldComponentUpdate",value:function(e){return e.meta!==this.props.meta}},{key:"render",value:function(){var e=this.props,t=e.meta,n=e.variant,a=t.page,r=t.total_items,i=t.page_size;return y.a.createElement(y.a.Fragment,null,y.a.createElement(f.a,{page:a||1,itemCount:r||0,perPage:i||g.f,onSetPage:this.handleChangePage,onPerPageSelect:this.handleSetPageSize,variant:f.b[n]}))}}]),t}(b.Component);h.propTypes={apply:v.a.func,meta:v.a.object,variant:v.a.string},h.defaultProps={variant:"top"},t.a=h},1704:function(e,t,n){"use strict";var a=n(188),r=n(67),i=n(11),l=n(8);t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.publish_date;""!==n&&n||(n="0");var o=function(t){e({publish_date:"0"!==t&&t||"",page:1})};return{label:i.a.formatMessage(l.a.publishDate),type:a.conditionalFilterType.radio,urlParam:"publish_date",filterValues:{onChange:function(e,t){o(t)},items:r.i.map(function(e){return{label:e.label,value:e.value}}),value:n}}}},1705:function(e,t,n){"use strict";var a=n(188),r=n(67),i=n(11),l=n(8);t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.cvss_filter;""!==n&&n||(n="0");var o=function(t){e({cvss_filter:"0"!==t&&t||"",page:1})};return{label:i.a.formatMessage(l.a.cvssBaseScore),type:a.conditionalFilterType.radio,urlParam:"cvss_filter",filterValues:{onChange:function(e,t){o(t)},items:r.e.map(function(e){return{label:e.label,value:e.value}}),value:n}}}},1706:function(e,t,n){"use strict";var a=n(2),r=n.n(a),i=n(188),l=n(67),o=n(11),s=n(8),c=n(391);t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.impact,a=function(t){e({impact:t.length>"0"&&t.filter(function(e){return","!==e}).join(",")||"",page:1})};return{label:o.a.formatMessage(s.a.impact),type:i.conditionalFilterType.checkbox,urlParam:"impact",filterValues:{onChange:function(e,t){a(t)},items:l.h.map(function(e){return{label:r.a.createElement(r.a.Fragment,null,e.hasIcon&&r.a.createElement(c.b,{className:"pf-u-mr-xs",color:e.iconColor}),e.label),value:e.value}}),value:n?n.split(","):[]}}}},1708:function(e,t,n){"use strict";var a=n(188),r=n(67),i=n(11),l=n(8);t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.business_risk_id,o=function(t){e({business_risk_id:t.length>"0"&&t.filter(function(e){return","!==e}).join(",")||"",page:1})};return{label:i.a.formatMessage(l.a.businessRisk),type:a.conditionalFilterType.checkbox,urlParam:"business_risk_id",filterValues:{onChange:function(e,t){o(t)},items:r.s.map(function(e){return{label:e.label,value:e.value}}),value:n?n.split(","):[]}}}},1710:function(e,t,n){"use strict";var a=n(188),r=n(67),i=n(11),l=n(8);t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.show_all;n=""!==n&&n?"hide":"show";var o=function(t){e({show_all:t="hide"===t||"",page:1})};return{label:i.a.formatMessage(l.a.filterAffectingCVEs),type:a.conditionalFilterType.radio,urlParam:"show_all",filterValues:{onChange:function(e,t){o(t)},items:r.a.map(function(e){return{label:e.label,value:e.value}}),value:n}}}},1711:function(e,t,n){"use strict";var a=n(303),r=n.n(a),i=n(531),l=n(432),o=n(875),s=n(608),c=n(609),u=n(621),p=n(622),m=n(596),f=n(296),d=n(475),v=n(0),b=n.n(v),y=n(2),g=n.n(y),h=n(572),_=n(1691),E=n(76),O=n(8),S=function(e){var t=e.cves,n=e.updateRef,a=e.inventories,v=e.hasDifferentStatus,b=void 0!==v&&v,E=e.intl,S=e.type,j=Object(y.useState)(t),w=r()(j,1)[0],P=Object(y.useState)(a),C=r()(P,1)[0],k=Object(_.b)(function(){if(C&&1===C.length&&C[0].justification)return C&&1===C.length&&C[0].justification||"";if(w&&1===w.length)return U()}()),D=k.JustificationInput,x=k.justification,M=k.setJustification,I=k.setProps,V=Object(y.useState)(function(){if(C&&1===C.length&&C[0].status_id){var e=r()(C,1)[0];return w.some(function(t){return t.status_id===e.status_id})}if(w&&1===w.length)return!0;return!1}()),F=r()(V,2),T=F[0],L=F[1],N=Object(_.c)(function(){if(C&&C.length>0&&C[0].status_id)return C&&C[0].status_id.toString()||"0";if(w&&w.length>0)return Y()}()),R=N.StatusSelect,A=N.statusId,z=N.setStatusId,H=N.setProps,B=C.map(function(e){return e.id});Object(y.useEffect)(function(){H({isDisabled:T}),I({disabled:T}),z(Y()),M(U())},[T,H,I]),Object(y.useEffect)(function(){z(Y())},[T,z]);function Y(){switch(S){case"systemsExposed":return w&&1===w.length&&w[0].status_id.toString()||"0";case"systemDetail":return w?T?b?"0":w[0].cve_status_id||"0":b?"0":w[0].status_id||"0":"0";default:return"0"}}function U(){switch(S){case"systemsExposed":return w&&1===w.length&&w[0].justification||"";case"systemDetail":return T?w&&1===w.length&&w[0].cve_justification||"":w&&1===w.length&&w[0].justification||"";default:return""}}var J={variant:"success",title:E.formatMessage(O.a.cvePairStatusModalUpdateSuccessful)},W=E.formatMessage(O.a.cvePairStatusModalTitle,{count:B.length*t.length});return g.a.createElement(_.a,{items:w,onSave:function(){var e=w.map(function(e){return e.id}),t=T?{cve:e,inventory_id:B}:{status_id:parseInt(A),cve:e,status_text:x,inventory_id:B};return Object(h.l)(t).then(n)},onSuccessNotification:J,title:W},g.a.createElement(i.a,{gutter:"md"},b&&g.a.createElement(l.a,null,g.a.createElement(o.a,{variant:"warning",isInline:!0,title:E.formatMessage(O.a.cvePairStatusModalAlert)})),g.a.createElement(l.a,null,E.formatMessage(O.a.cvePairStatusModalSelected,{cveCount:w.length||0,cveId:w[0].id,systemCount:C.length||0,systemName:B[0],b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return g.a.createElement("b",null,t)}})),g.a.createElement(l.a,null,g.a.createElement(s.a,{key:"key"},g.a.createElement(c.a,{fieldId:"overall"},g.a.createElement(u.a,null,g.a.createElement(p.a,null,g.a.createElement(m.a,{label:E.formatMessage(O.a.cvePairStatusModalUseOverallCheckbox),id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:T,onChange:function(e){return L(e)}})),g.a.createElement(p.a,null,g.a.createElement(f.a,{content:E.formatMessage(O.a.cvePairStatusModalUseOverallTooltip)},g.a.createElement(d.b,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)",style:{verticalAlign:"0"}}))))),R,D))))};S.propTypes={cves:b.a.array,updateRef:b.a.func,inventories:b.a.array,hasDifferentStatus:b.a.bool,intl:b.a.any,type:b.a.string},t.a=Object(E.c)(S)},1770:function(e,t,n){"use strict";n.r(t);var a=n(140),r=n.n(a),i=n(215),l=n.n(i),o=n(212),s=n.n(o),c=n(191),u=n.n(c),p=n(192),m=n.n(p),f=n(193),d=n.n(f),v=n(194),b=n.n(v),y=n(195),g=n.n(y),h=n(124),_=n(275),E=n(189),O=n(188),S=n(304),j=n(451),w=n(0),P=n.n(w),C=n(2),k=n.n(C),D=n(190),x=n(125),M=n(159),I=n(1688),V=n(328),F=n(8),T=n(225),L=n(573),N=n.n(L),R=n(303),A=n.n(R),z=n(1692),H=n.n(z),B=(n(1700),n(340)),Y=n.n(B),U=n(167),J=n.n(U),W=n(96),K=n(874),q=n(871),G=n(1693),Q=n(345),X=n(1702),Z=n(1690);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(n,!0).forEach(function(t){s()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var te=function(e){var t=e.context,n=e.header,a=e.entity,r=t.cves,i=t.methods,l=t.selectedCves,o=t.openedCves,s=0===r.data.length,c=r.data.map(function(e){return l.includes(e.id)&&ee({},e,{selected:!0})||e}).map(function(e){var t=o.find(function(t){return t.id===e.id});return ee({},e,{isOpen:t&&t.isOpen||!1})});return k.a.createElement(C.Fragment,null,r.isLoading?k.a.createElement(O.SkeletonTable,{colSize:2,rowSize:20}):k.a.createElement(C.Fragment,null,k.a.createElement(W.b,{"aria-label":"Vulnerability CVE table",cells:n,rows:s?function(){var e=t.cves;return[{heightAuto:!0,cells:[{props:{colSpan:8},title:0!==["filter","cvss_from","cvss_to","public_from","public_to","impact","status_id"].filter(function(t){return Object.prototype.hasOwnProperty.call(e.meta,t)&&e.meta[t]}).length?Z.f:a?Z.b:0===e.data.length?Z.a:void 0}]}]}():c,onSelect:s?void 0:function(e,n,a){var r=t.cves,i=t.methods,l=r.data[a]&&r.data[a].id;i.selectCves(n,l)},actions:s?void 0:Object(G.e)(i),sortBy:s?void 0:Object(Q.b)([{key:"collapse"},{key:"checkbox"}].concat(J()(n)),r.meta.sort),onCollapse:s?void 0:function(e,n,a){return function(e,n,a){var r=t.cves,i=t.methods,l=t.expandCveDescription,o=r.data[n]&&r.data[n].id;i.openCves(a,[o],l)}(0,n,a)},onSort:s?void 0:function(e,t,a){return Object(Q.e)(t,a,[{key:"collapse"},{key:"checkbox"}].concat(J()(n)),r.meta.sort,i.apply)},gridBreakPoint:"grid-lg"},k.a.createElement(C.Fragment,null,k.a.createElement(K.a,null),k.a.createElement(q.a,null))),k.a.createElement(O.TableToolbar,null,k.a.createElement(X.a,{variant:"bottom",meta:r.meta,apply:i.apply}))))};te.propTypes={context:P.a.any,header:P.a.array,entity:P.a.string};var ne=function(e){return k.a.createElement(xe.Consumer,null,function(t){return k.a.createElement(te,Y()({context:t},e))})},ae=n(76),re=n(418),ie=n(67),le=n(380),oe=n(531),se=n(432),ce=n(529),ue=n(615),pe=n(1697),me=n(1711),fe=n(1703),de=n(1694),ve=n(1704),be=n(1705),ye=n(1706),ge=n(1695),he=n(1707),_e=n(1708),Ee=n(1709),Oe=n(1710),Se=n(1696);function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(n,!0).forEach(function(t){s()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Pe=function(e){var t=e.showRemediationButton,n=e.entity,a=e.intl,r=e.context,i=r.cves,l=r.parameters,o=r.methods,s=r.selectedCves,c=r.expandCveDescription,u=l.filter,p=!0===t?s&&s.length||0:void 0,m=Object(C.useMemo)(function(){return Object(de.a)({selectedItems:s,selectorHandler:o.selectCves,items:i,fetchResource:function(e){return o.fetchResource(we({},l,{},e,{show_all:!l.show_all}))},multiRow:!0})},[s,i,l,o]),f=[t&&k.a.createElement(fe.a,{systemId:n,selectedCves:s})||"",Object(Se.e)(a.formatMessage(F.a.editStatus),function(){return o.showStatusModal(J()(s).map(function(e){return we({id:e},i.data.filter(function(t){return e===t.id}).map(function(e){return{status_id:e.status_id,cve_status_id:e.cve_status_id}})[0])}),[])},!p),Object(Se.e)(c?a.formatMessage(F.a.kebabCollapseCves):a.formatMessage(F.a.kebabExpandCves),function(){var e=r.cves,t=r.methods,n=r.expandCveDescription,a=!n,i=n?[]:e.data.filter(function(e){return e.id}).map(function(e){return e.id});t.openCves(a,i,!n)},0===i.meta.total_items)];return k.a.createElement(k.a.Fragment,null,k.a.createElement(O.PrimaryToolbar,{pagination:{itemCount:i.meta.total_items||0,page:i.meta.page||1,perPage:i.meta.page_size||1,onSetPage:function(e,t){return Object(Se.c)(e,t,o.apply)},onPerPageSelect:function(e,t){return Object(Se.d)(e,t,o.apply)}},actionsConfig:{actions:f,kebabToggleProps:{isDisabled:!p&&0===i.meta.total_items},dropdownProps:{className:"custom-class"}},bulkSelect:{count:p,items:m.items,isDisabled:0===i.meta.total_items,checked:Boolean(p),onSelect:function(){return m.handleOnCheckboxChange()}},filterConfig:{items:[Object(ge.a)(F.a.cve,F.a.searchFilterByCveID,u,o.apply),Object(Oe.a)(o.apply,l),Object(he.a)(o.apply,l),Object(ye.a)(o.apply,l),Object(be.a)(o.apply,l),Object(_e.a)(o.apply,l),Object(Ee.a)(o.apply,l),Object(ve.a)(o.apply,l)]},activeFiltersConfig:{filters:Object(Se.a)(l),onDelete:function(e,t){return Object(Se.f)(t,o.apply)}},exportConfig:Object(Se.b)(o)}))};Pe.defaultProps={showRemediationButton:!1,totalNumber:0,apply:function(){},downloadReport:function(){}},Pe.propTypes={showRemediationButton:P.a.bool,entity:P.a.string,context:P.a.object,intl:P.a.any};var Ce=Object(ae.c)(function(e){return k.a.createElement(xe.Consumer,null,function(t){return k.a.createElement(Pe,Y()({context:t},e))})});function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function De(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(n,!0).forEach(function(t){s()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var xe=Object(C.createContext)({}),Me=function(e){var t=e.intl,n=e.entity,a=e.location,r=e.history,i=Object(D.useDispatch)(),l=Object(C.useState)(function(){return function(){return null}}),o=A()(l,2),s=o[0],c=o[1],u=Object(D.useSelector)(function(e){return e.SystemCvesStore.cveList}),p=Object(D.useSelector)(function(e){return e.SystemCvesStore.parameters}),m=Object(D.useSelector)(function(e){return e.SystemCvesStore.selectedCves}),f=Object(D.useSelector)(function(e){return e.SystemCvesStore.openedCves}),d=Object(D.useSelector)(function(e){return e.SystemCvesStore.expandCveDescription}),v=Object(C.useMemo)(function(){return Object(le.b)(n,u)},[u]),b=H.a.parse(a.search);Object(C.useEffect)(function(){!p.isFirstMount&&i(Object(I.k)(De({},p,{system:n})))},[p,i]);var y=function(e){var t=De({},b,{},e),n=["cvss_filter","publish_date","filter","limit","offset","page","page_size","sort","impact","business_risk_id","status_id","security_rule"];Object.keys(e).forEach(function(e){return(void 0===t[e]||""===t[e]||!n.includes(e)||!1===t[e])&&delete t[e]});var a=H.a.stringify(t);r.push("?"+a)},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object.prototype.hasOwnProperty.call(e,"cvss_filter")){var t=ie.e.find(function(t){return t.value===e.cvss_filter});if(void 0===t&&void 0!==e.cvss_filter){var n=e.cvss_filter.split(/[^0-9]+/).filter(function(e){return parseFloat(e)});t={from:n[0],to:n[1]}}else void 0===t&&void 0===e.cvss_filter&&(t={from:void 0,to:void 0});e.cvss_from=t.from,e.cvss_to=t.to}if(Object.prototype.hasOwnProperty.call(e,"publish_date")){var a=ie.i.find(function(t){return t.value===e.publish_date});void 0!==a?(e.public_from=a.from&&a.from.format("YYYY-MM-DD"),e.public_to=a.to&&a.to.format("YYYY-MM-DD")):(e.public_from=void 0,e.public_to=void 0,e.publish_date=void 0)}y(e),i(Object(I.c)(e))};Object(C.useEffect)(function(){g(De({},p,{},b,{page:1,isFirstMount:!1,sort:"-public_date"}))},[]);var h,_;return u.errors?(h=u.errors,_=h.status,404===parseInt(_)&&n?Z.d:Z.g):k.a.createElement(C.Fragment,null,k.a.createElement(xe.Provider,{value:{cves:v,parameters:p,selectedCves:m,openedCves:f,expandCveDescription:d,methods:{apply:g,downloadReport:function(e){var t=De({},p,{system:n});pe.a.exec(I.k,t,e,"system-cves")},selectCves:function(e,t){i(Object(I.s)(t))},openCves:function(e,t,n){i(Object(I.g)({isOpen:e,cves:t,expandCveDescription:n}))},showStatusModal:function(e){var t;if(e.length>1){var a=Array.from(v.data.filter(function(t){return e.some(function(e){return e.id===t.id})}));t=a.some(function(e){return!(a.filter(function(t){return t.status_id===e.status_id}).length>1)})}c(function(){return function(){return k.a.createElement(me.a,{cves:e,updateRef:function(){g(p)},inventories:[{id:n}],hasDifferentStatus:t,type:"systemDetail"})}})},fetchResource:function(e){return Object(I.k)(De({},e,{system:n}))}}}},k.a.createElement(s,null),k.a.createElement(oe.a,null,k.a.createElement(se.a,null,k.a.createElement(ce.a,null,k.a.createElement(ue.a,{component:ue.b.h2},t.formatMessage(F.a.systemCvesTableHeader)))),k.a.createElement(se.a,null,k.a.createElement(Ce,{showRemediationButton:!0,entity:n})),k.a.createElement(se.a,null,k.a.createElement(ne,{header:ie.q,entity:n})))))};Me.propTypes={entity:P.a.string,cveList:P.a.any,fetchData:P.a.func,history:P.a.object,location:P.a.object,intl:P.a.any};var Ie=Object(M.o)(Object(ae.c)(Me)),Ve=function(e){var t=e.customItnlProvider,n=N()(e,["customItnlProvider"]),a=t?{Wrapper:re.b,intProps:{locale:navigator.language.slice(0,2),messages:F.a}}:{wrapper:C.Fragment,intlProps:{}},r=a.Wrapper,i=a.intlProps;return k.a.createElement(r,i,k.a.createElement(Ie,n))};Ve.propTypes={customItnlProvider:P.a.bool},Ve.defaultProps={customItnlProvider:!1};var Fe=function(e){function t(e){return u()(this,t),d()(this,b()(t).call(this,e))}return g()(t,e),m()(t,[{key:"render",value:function(){var e=this.props,t=e.entity,n=e.isOptOut,a=e.optOutSystemHandler;return this.props.setHeader({breadcrumbs:[{title:T.b.vulnerabilities.title,to:T.b.vulnerabilities.to},{title:T.b.systems.title,to:T.b.systems.to},{title:t&&t.display_name||k.a.createElement(V.a,F.a.invalidSystem),isActive:!0}]}),t?n?k.a.createElement(k.a.Fragment,null,k.a.createElement(Z.c,{buttonAction:function(){return a(!1)}})):k.a.createElement(k.a.Fragment,null,k.a.createElement(Ie,{entity:t.id})):null}}]),t}(k.a.Component);Fe.propTypes={setHeader:P.a.func,entity:P.a.object,isOptOut:P.a.bool,optOutSystemHandler:P.a.func};var Te=Object(M.o)(Object(D.connect)(function(e){var t=e.entityDetails;return{entity:t.entity,isOptOut:t.opt_out}},function(e){return{setHeader:function(t){return e(Object(I.t)(t))}}})(Fe)),Le=n(1689);function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(n,!0).forEach(function(t){s()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ae={loaded:!1},ze=function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ae,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case Le.n+"_FULFILLED":return Re({},n,{},a.payload.data);case e.LOAD_ENTITY_FULFILLED:return Re({},n,{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return k.a.createElement(Te,{optOutSystemHandler:t})}}]});case e.LOAD_ENTITY_REJECTED:return Re({},n,{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return k.a.createElement(Te,null)}}]});default:return n}}},He=n(341),Be=n(574);function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(n,!0).forEach(function(t){s()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Je=function(e){function t(e){var n;return u()(this,t),(n=d()(this,b()(t).call(this,e))).checkItem=function(e,t){var a=n.state.systemList;a[e].selected=t,n.setState({systemList:a})},n.toggleLinkHover=function(e){n.setState(Ue({},n.state,{linkHovered:e}))},n.optOutSystem=function(e){n.props.optOutSystem(n.state.inventoryId,e).then(function(){n.props.fetchSystemDetails(n.state.inventoryId),!0===e?n.props.addNotification({variant:"success",title:n.props.intl.formatMessage(F.a.inventoryOptOutSuccess)}):n.props.addNotification({variant:"success",title:n.props.intl.formatMessage(F.a.inventoryResumeAnalysisTitle),description:n.props.intl.formatMessage(F.a.inventoryResumeAnalysisDescription)})})},n.state={inventoryId:n.props.match.params.inventoryId,removeListener:function(){},linkHovered:!1},n}var n;return g()(t,e),m()(t,[{key:"componentDidMount",value:function(){this.props.fetchSystemDetails(this.state.inventoryId),this.fetchInventory()}},{key:"fetchInventory",value:(n=l()(r.a.mark(function e(){var t,n,a,i,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,insights.loadInventory({react:k.a,reactRouterDom:x,reactCore:h,reactIcons:E,pfReactTable:j});case 2:t=e.sent,n=t.inventoryConnector,a=t.mergeWithEntities,i=t.mergeWithDetail,l=t.INVENTORY_ACTION_TYPES,He.a.register(Ue({},a(),{},i(ze(l,this.optOutSystem)))),this.setState({InventoryHeader:n(He.a.getStore()).InventoryDetailHead,InventoryBody:n(He.a.getStore()).AppInfo}),this.state.removeListener();case 10:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,n=t.InventoryHeader,a=t.InventoryBody,r=this.props.systemDetails,i=void 0===r?{}:r,l=i.opt_out,o=void 0!==l&&l,s=i.entity;return k.a.createElement(_.a,null,k.a.createElement(Be.a,{title:"",showTabs:!1},n&&k.a.createElement(n,{hideBack:!0,actions:s&&[o?{title:this.props.intl.formatMessage(F.a.inventoryKebabOptionsResume),onClick:function(){return e.optOutSystem(!1)}}:{title:this.props.intl.formatMessage(F.a.inventoryKebabOptionsExclude),onClick:function(){return e.optOutSystem(!0)}}]})),a&&k.a.createElement(O.Main,null,k.a.createElement(k.a.Fragment,null,k.a.createElement(a,{optOutSystemHandler:this.optOutSystem}))))}}]),t}(k.a.Component);Je.propTypes={fetchSystemDetails:P.a.func,systemDetails:P.a.object,optOutSystem:P.a.func,match:P.a.object,addNotification:P.a.func,intl:P.a.any};t.default=Object(M.o)(Object(ae.c)(Object(D.connect)(function(e){return{systemDetails:e.entityDetails}},function(e){return{optOutSystem:function(t,n){return e(Object(I.o)(t,n))},fetchSystemDetails:function(t){return e(Object(I.l)(t))},addNotification:function(t){return e(Object(S.addNotification)(t))}}})(Je)))}}]);
//# sourceMappingURL=../sourcemaps/InventoryDetail.js.map