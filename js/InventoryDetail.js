(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{643:function(e,t,n){"use strict";n.r(t);var r=n(112),a=n.n(r),o=n(137),s=n.n(o),i=n(354),c=n.n(i),l=n(81),u=n.n(l),p=n(82),f=n.n(p),d=n(83),m=n.n(d),y=n(84),v=n.n(y),b=n(85),h=n.n(b),O=n(200),j=n(66),E=n(201),w=n(357),g=n(74),S=n(1),k=n.n(S),P=n(2),D=n.n(P),_=n(73),C=n(132),I=n(348),R=n(359),T=n(356),M=n(135),x=n(176),L=n(177),N=n(546),B=n(394),F=n(384),H=n(365),V=n(397),Y=n.n(V),A=n(363),z=n(552),J=(n(554),n(398)),U=n(361),q=n.n(U),W=n(161),G=n(162),X=n(153),K=n(369),Q=n(385),Z=function(e){var t=e.cves,n=e.updateRef,r=e.inventoryId,a=Object(P.useState)(t),o=q()(a,1)[0],s=Object(Q.c)(o&&1===o.length&&o[0].status_id.toString()||"0"),i=s.StatusSelect,c=s.statusId,l=s.setProps,u=Object(Q.b)(o&&1===o.length&&o[0].justification||""),p=u.JustificationInput,f=u.justification,d=u.setProps,m=Object(P.useState)(!1),y=q()(m,2),v=y[0],b=y[1];var h={variant:"success",title:"Status updated for ".concat(o.length," CVEs")};return D.a.createElement(Q.a,{items:o,onSave:function(){var e=o.map(function(e){return e.id}),t=v?{cve:e,inventory_id:r}:{status_id:parseInt(c),cve:e,status_text:f,inventory_id:r};return Object(K.l)(t).then(n)},onSuccessNotification:h,title:"Set status for this CVE and host pair"},D.a.createElement(x.a,{gutter:"md"},D.a.createElement(L.a,null,D.a.createElement(W.a,{key:"key"},D.a.createElement(G.a,{fieldId:"overall"},D.a.createElement(X.a,{label:"Use overall CVE status",id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:v,onChange:function(e){var t={isDisabled:e};b(e),l(t),d(t)}})),i,p))))};Z.propTypes={cves:k.a.array,updateRef:k.a.func,inventoryId:k.a.string};var $=Z,ee=n(133),te=n.n(ee),ne=n(370),re=n.n(ne),ae=n(362),oe=n(391),se=n(390),ie=n(386),ce=n(387);function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(n,!0).forEach(function(t){c()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var pe=function(e){function t(){var e,n,r;u()(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return m()(r,(n=r=m()(this,(e=v()(t)).call.apply(e,[this].concat(o))),r.noCves=function(){var e=r.props,t=e.entity,n=e.context.cves;return 0!==["filter","cvss_from","cvss_to","public_from","public_to","impact","status_id"].filter(function(e){return n.meta.hasOwnProperty(e)&&n.meta[e]}).length?T.e:t?T.d:0===n.data.length?T.c:void 0},r.handleOnSelect=function(e,t,n){var a=r.props.context,o=a.cves,s=a.methods,i=o.data[n]&&o.data[n].id;s.selectCves(t,i)},n))}return h()(t,e),f()(t,[{key:"handleOnCollapse",value:function(e,t,n){var r=this.props.context,a=r.cves,o=r.methods,s=a.data[t]&&a.data[t].id;o.openCves(n,s)}},{key:"render",value:function(){var e=this,t=this.props,n=t.context,r=t.header,a=n.params,o=n.cves,s=n.methods,i=a.selectedCves,c=a.openedCves,l=o.data.map(function(e){return i.has(e.id)&&ue({},e,{selected:!0})||e}).map(function(e){return c.has(e.id)&&ue({},e,{isOpen:!0})||e});return D.a.createElement(P.Fragment,null,o.isLoading?D.a.createElement(w.SkeletonTable,{colSize:2,rowSize:20}):D.a.createElement(P.Fragment,null,D.a.createElement(ae.b,{"aria-label":"Vulnerability CVE table",onSelect:this.handleOnSelect,cells:r,rows:l,actions:Object(ie.c)(s),sortBy:Object(A.b)([{key:"collapse"},{key:"checkbox"}].concat(re()(r)),o.meta.sort),onSort:function(e,t,n){return Object(A.e)(t,n,[{key:"collapse"},{key:"checkbox"}].concat(re()(r)),o.meta.sort,s.apply)},gridBreakPoint:"grid-lg",onCollapse:function(t,n,r){return e.handleOnCollapse(t,n,r)}},!o.isLoading&&0===o.data.length&&this.noCves()||D.a.createElement(P.Fragment,null,D.a.createElement(oe.a,null),D.a.createElement(se.a,null))),D.a.createElement(w.TableToolbar,null,D.a.createElement(ce.a,{variant:"bottom",meta:o.meta,apply:s.apply}))))}}]),t}(P.Component);pe.propTypes={context:k.a.any,header:k.a.array,entity:k.a.object};var fe=function(e){return D.a.createElement(Pe.Consumer,null,function(t){return D.a.createElement(pe,te()({context:t},e))})},de=n(179),me=n(178),ye=n(401),ve=n(402),be=n(403),he=n(404),Oe=n(557),je=n(559);function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var we=function(e){function t(){return u()(this,t),m()(this,v()(t).apply(this,arguments))}return h()(t,e),f()(t,[{key:"render",value:function(){var e=this.props,t=e.showRemediationButton,n=e.entity,r=e.context,a=r.cves,o=r.params,s=r.methods,i=o.selectedCves,l=!0===this.props.showRemediationButton?i&&i.size||0:void 0,u=[T.o,T.q,T.n,T.p,T.s],p=[Object(ve.c)(s.showBusinessRiskModal,re()(i).map(function(e){return{id:e,business_risk_id:"0"}}),{isDisabled:!l}),Object(ve.d)(s.showStatusModal,re()(i).map(function(e){return{id:e,status_id:"0"}}),{isDisabled:!l}),Object(ve.b)(s.downloadReport),Object(ve.a)(s.downloadReport)];return D.a.createElement(D.a.Fragment,null,D.a.createElement(w.TableToolbar,{className:"space-between-toolbar-items"},D.a.createElement(de.a,{className:"vulnerability-toolbar-spacing"},t&&D.a.createElement(je.a,{selectedItems:l,selectorHandler:s.selectCves,cves:a,fetchResource:function(e){return s.fetchResource(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(n,!0).forEach(function(t){c()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},o,{},e))}}),D.a.createElement(he.a,{searchPlaceholder:"Find a CVEâ€¦",apply:s.apply,filterValues:o,filterCategories:u}),t&&D.a.createElement(Oe.a,{systemId:n.id,selectedCves:i}),D.a.createElement(ye.a,{dropdownItems:p})),D.a.createElement(de.a,null,D.a.createElement(ce.a,{apply:s.apply,meta:a.meta}))),D.a.createElement(w.TableToolbar,{className:"pf-u-pt-0"},D.a.createElement(de.a,null,D.a.createElement(me.a,null,D.a.createElement(be.a,{filterValues:o,filterCategories:u,apply:s.apply})))))}}]),t}(P.Component);we.propTypes={showRemediationButton:k.a.bool,entity:k.a.object,context:k.a.object},we.defaultProps={showRemediationButton:!1,totalNumber:0,apply:function(){},downloadReport:function(){}};var ge=function(e){return D.a.createElement(Pe.Consumer,null,function(t){return D.a.createElement(we,te()({context:t},e))})};function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(n,!0).forEach(function(t){c()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Pe=D.a.createContext({}),De=[{title:"Name",key:"synopsis",transforms:[N.a,Object(B.b)("col-width-10")],columnTransforms:[Object(B.b)("no-wrap")],cellFormatters:[F.b]},{title:"Publish date",key:"public_date",transforms:[N.a,Object(B.b)("col-width-10")]},{title:"CVSS base ",key:"cvss_score",transforms:[N.a,Object(B.b)("col-width-10")]},{title:"Impact",key:"impact",transforms:[N.a,Object(B.b)("col-width-10")],columnTransforms:[Object(B.b)("no-wrap")]},{title:"Business risk",key:"business_risk",transforms:[N.a,Object(B.b)("col-width-10")]},{title:"Status",key:"status",transforms:[N.a,Object(B.b)("col-width-10")]}],_e=function(e){function t(e){var n;return u()(this,t),(n=m()(this,v()(t).call(this,e))).processError=function(e){var t=e.status;return 404===parseInt(t)&&n.props.entity?T.g:T.f},n.apply=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.hasOwnProperty("cvss_filter")){var t=T.a.find(function(t){return t.value===e.cvss_filter});if(void 0===t&&void 0!==e.cvss_filter){var r=e.cvss_filter.split(/[^0-9]+/).filter(function(e){return parseFloat(e)});t={from:r[0],to:r[1]}}else void 0===t&&void 0===e.cvss_filter&&(t={from:void 0,to:void 0});e.cvss_from=t.from,e.cvss_to=t.to}if(e.hasOwnProperty("publish_date")){var a=T.i.find(function(t){return t.value===e.publish_date});void 0!==a?(e.public_from=a.from&&a.from.format("YYYY-MM-DD"),e.public_to=a.to&&a.to.format("YYYY-MM-DD")):(e.public_from=void 0,e.public_to=void 0,e.publish_date=void 0)}n.setState(ke({},n.state,{},e),n.sendRequest)},n.selectCves=function(e,t){var r=n.state.selectedCves;r=t?Object(A.f)(r,t,e):new Set,n.setState(ke({},n.state,{selectedCves:new Set(r)}))},n.openCves=function(e,t){var r=n.state.openedCves;r=t?Object(A.f)(r,t,e):new Set,n.setState(ke({},n.state,{openedCves:new Set(r)}))},n.createUrlParams=function(e){var t=ke({},e),r=["cvss_filter","publish_date","filter","limit","offset","page","page_size","sort","impact","business_risk_id"];Object.keys(e).forEach(function(e){return(void 0===t[e]||""===t[e]||!r.includes(e)||!1===t[e])&&delete t[e]});var a=Y.a.stringify(t);n.props.history.push("?"+a)},n.sendRequest=function(){var e=n.props,t=e.fetchData,r=e.entity;t&&t(ke({},n.state,{system:r.id})),n.createUrlParams(n.state)},n.downloadReport=function(e){var t=ke({},n.state),r=Object(R.f)(ke({},t,{page_size:Number.MAX_SAFE_INTEGER,data_format:e,page:1})).payload;r&&r.then(function(t){var n=t.data,r="json"===e?JSON.stringify(n):n;return Object(H.downloadFile)(r,"vulnerability_cves-".concat((new Date).toISOString()),e)})},n.showBusinessRiskModal=function(e){n.setState({BusinessRiskModal:function(){return D.a.createElement(J.a,{open:!0,cves:e,updateRef:n.apply})}})},n.showStatusModal=function(e){n.setState({StatusModal:function(){return D.a.createElement($,{cves:e,updateRef:n.apply,inventoryId:n.props.entity&&n.props.entity.id})}})},n.state={selectedCves:new Set,openedCves:new Set,BusinessRiskModal:function(){return null},StatusModal:function(){return null}},n}return h()(t,e),f()(t,[{key:"componentDidMount",value:function(){var e=Y.a.parse(this.props.location.search);this.apply(ke({},{sort:"-public_date"},{},e))}},{key:"render",value:function(){var e=this.props,t=e.cveList,n=e.entity,r=this.apply,a=this.downloadReport,o=this.selectCves,s=this.openCves,i=this.showBusinessRiskModal,c=this.showStatusModal,l=this.state,u=l.BusinessRiskModal,p=l.StatusModal,f=t,d=f.errors;return d?this.processError(d):D.a.createElement(Pe.Provider,{value:{cves:f,params:this.state,methods:{apply:r,downloadReport:a,selectCves:o,openCves:s,showBusinessRiskModal:i,showStatusModal:c,fetchResource:function(e){return Object(R.f)(ke({},e,{system:n.id}))}}}},D.a.createElement(p,null),D.a.createElement(u,null),D.a.createElement(x.a,null,D.a.createElement(L.a,null,D.a.createElement(ge,{showRemediationButton:!0,entity:n})),D.a.createElement(L.a,null,D.a.createElement(fe,{header:De,entity:n}))))}}]),t}(P.Component);_e.propTypes={entity:k.a.object,cveList:k.a.any,fetchData:k.a.func,history:k.a.object,location:k.a.object};var Ce=Object(I.a)(Object(_.connect)(function(e){var t=e.SystemCvesStore,n=e.entityDetails.entity;return{cveList:t&&Object(z.b)(n.id,t.cveList),entity:n}},function(e){return{fetchData:function(t){return e(Object(R.f)(t))}}})(_e)),Ie=function(e){function t(e){return u()(this,t),m()(this,v()(t).call(this,e))}return h()(t,e),f()(t,[{key:"render",value:function(){var e=this.props,t=e.entity,n=e.isOptOut,r=e.optOutSystemHandler;return this.props.setHeader({breadcrumbs:[{title:M.b.vulnerabilities.title,to:M.b.vulnerabilities.to},{title:M.b.systems.title,to:M.b.systems.to},{title:t&&t.display_name||"Invalid System",isActive:!0}]}),t?n?D.a.createElement(D.a.Fragment,null,D.a.createElement(T.l,{buttonAction:function(){return r(!1)}})):D.a.createElement(D.a.Fragment,null,D.a.createElement(Ce,{entity:t.id})):D.a.createElement(w.InvalidObject,null)}}]),t}(D.a.Component);Ie.propTypes={setHeader:k.a.func,entity:k.a.object,isOptOut:k.a.bool,optOutSystemHandler:k.a.func};var Re=Object(I.a)(Object(_.connect)(function(e){var t=e.entityDetails;return{entity:t.entity,isOptOut:t.opt_out}},function(e){return{setHeader:function(t){return e(Object(R.m)(t))}}})(Ie)),Te=n(364);function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(n,!0).forEach(function(t){c()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Le={loaded:!1},Ne=function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case Te.i+"_FULFILLED":return xe({},n,{},r.payload.data);case e.LOAD_ENTITY_FULFILLED:return xe({},n,{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return D.a.createElement(Re,{optOutSystemHandler:t})}}]});case e.LOAD_ENTITY_REJECTED:return xe({},n,{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return D.a.createElement(Re,null)}}]});default:return n}}},Be=n(86),Fe=n(382);function He(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?He(n,!0).forEach(function(t){c()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):He(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ye=function(e){function t(e){var n;return u()(this,t),(n=m()(this,v()(t).call(this,e))).checkItem=function(e,t){var r=n.state.systemList;r[e].selected=t,n.setState({systemList:r})},n.toggleLinkHover=function(e){n.setState(Ve({},n.state,{linkHovered:e}))},n.optOutSystem=function(e){n.props.optOutSystem(n.state.inventoryId,e).then(function(){n.props.fetchSystemDetails(n.state.inventoryId),!0===e?n.props.addNotification({variant:"success",title:"System successfully excluded from vulnerability analysis"}):n.props.addNotification({variant:"success",title:"System successfully resumed vulnerability analysis",description:"There may be 24 hours before data is available"})})},n.state={inventoryId:n.props.match.params.inventoryId,removeListener:function(){},linkHovered:!1},n}var n;return h()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.props.fetchSystemDetails(this.state.inventoryId),this.fetchInventory()}},{key:"fetchInventory",value:(n=s()(a.a.mark(function e(){var t,n,r,o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,insights.loadInventory({react:D.a,reactRouterDom:C,reactCore:O,reactIcons:E});case 2:t=e.sent,n=t.inventoryConnector,r=t.mergeWithEntities,o=t.mergeWithDetail,s=t.INVENTORY_ACTION_TYPES,Be.a.register(Ve({},r(),{},o(Ne(s,this.optOutSystem)))),this.setState({InventoryHeader:n().InventoryDetailHead,InventoryBody:n().AppInfo}),this.state.removeListener();case 10:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,n=t.InventoryHeader,r=t.InventoryBody,a=this.props.systemDetails,o=void 0===a?{}:a,s=o.opt_out,i=void 0!==s&&s,c=o.entity;return D.a.createElement(j.a,null,D.a.createElement(Fe.a,{title:"",showTabs:!1},n&&D.a.createElement(n,{hideBack:!0,actions:c&&[i?{title:"Resume vulnerability analysis",onClick:function(){return e.optOutSystem(!1)}}:{title:"Exclude from vulnerability analysis",onClick:function(){return e.optOutSystem(!0)}}]})),r&&D.a.createElement(w.Main,null,D.a.createElement(D.a.Fragment,null,D.a.createElement(r,{optOutSystemHandler:this.optOutSystem}))))}}]),t}(D.a.Component);Ye.propTypes={fetchSystemDetails:k.a.func,systemDetails:k.a.object,optOutSystem:k.a.func,match:k.a.object,addNotification:k.a.func};t.default=Object(I.a)(Object(_.connect)(function(e){return{systemDetails:e.entityDetails}},function(e){return{optOutSystem:function(t,n){return e(Object(R.j)(t,n))},fetchSystemDetails:function(t){return e(Object(R.g)(t))},addNotification:function(t){return e(Object(g.addNotification)(t))}}})(Ye))}}]);
//# sourceMappingURL=../sourcemaps/InventoryDetail.js.map