(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{669:function(e,t,n){"use strict";n.r(t);var r=n(107),a=n.n(r),o=n(127),s=n.n(o),c=n(355),i=n.n(c),l=n(75),u=n.n(l),p=n(76),f=n.n(p),y=n(77),m=n.n(y),b=n(78),d=n.n(b),v=n(79),h=n.n(v),O=n(212),j=n(64),w=n(12),g=n(357),E=n(73),S=n(1),P=n.n(S),D=n(2),k=n.n(D),C=n(72),_=n(122),I=n(351),R=n(365),T=n(360),x=n(362),L=n(126),N=n(180),H=n(181),A=n(572),F=n(400),B=n(364),Y=n(559),M=(n(561),n(369)),V=n(123),z=n.n(V),U=n(372),q=n.n(U),J=n(361),W=n(384),G=n(383),X=n(367),K=n(379);function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var Z=function(e){function t(){var e,n,r;u()(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return m()(r,(n=r=m()(this,(e=d()(t)).call.apply(e,[this].concat(o))),r.noCves=function(){var e=r.props,t=e.entity,n=e.context.cves;return 0!==["filter","cvss_from","cvss_to","public_from","public_to","impact","status_id"].filter(function(e){return n.meta.hasOwnProperty(e)&&n.meta[e]}).length?x.e:t?x.d:0===n.data.length?x.c:void 0},r.handleOnSelect=function(e,t,n){var a=r.props.context,o=a.cves,s=a.methods,c=o.data[n]&&o.data[n].id;s.selectCves(t,c)},n))}return h()(t,e),f()(t,[{key:"render",value:function(){var e=this.props,t=e.context,n=e.header,r=t.params,a=t.cves,o=t.methods,s=r.selectedCves,c=a.data.map(function(e){return s.has(e.id)&&function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(n,!0).forEach(function(t){i()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{selected:!0})||e});return k.a.createElement(D.Fragment,null,a.isLoading?k.a.createElement(g.SkeletonTable,{colSize:2,rowSize:20}):k.a.createElement(D.Fragment,null,k.a.createElement(J.d,{"aria-label":"Vulnerability CVE table",onSelect:this.props.isSelectable&&this.handleOnSelect||void 0,cells:n,rows:c,sortBy:Object(X.b)([{key:"checkbox"}].concat(q()(n)),a.meta.sort),onSort:function(e,t,r){return Object(X.e)(t,r,[{key:"checkbox"}].concat(q()(n)),a.meta.sort,o.apply)},gridBreakPoint:"grid-lg"},!a.isLoading&&0===a.data.length&&this.noCves()||k.a.createElement(D.Fragment,null,k.a.createElement(W.a,null),k.a.createElement(G.a,null))),k.a.createElement(g.TableToolbar,null,k.a.createElement(K.a,{variant:"bottom",meta:a.meta,apply:o.apply}))))}}]),t}(D.Component);Z.propTypes={context:P.a.any,header:P.a.array,isSelectable:P.a.bool,entity:P.a.object};var $=function(e){return k.a.createElement(be.Consumer,null,function(t){return k.a.createElement(Z,z()({context:t},e))})},ee=n(183),te=n(381),ne=n(382),re=function(e){var t=e.downloadReport,n=[Object(ne.b)(t),Object(ne.a)(t)];return k.a.createElement("div",null,k.a.createElement(te.a,{dropdownItems:n}))};re.propTypes={downloadReport:P.a.func};var ae=re,oe=n(568),se=n(570),ce=n(571);function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var le=function(e){function t(){return u()(this,t),m()(this,d()(t).apply(this,arguments))}return h()(t,e),f()(t,[{key:"render",value:function(){var e=this.props,t=e.showAllCheckbox,n=e.showRemediationButton,r=e.entity,a=e.context,o=a.cves,s=a.params,c=a.methods,l=s.selectedCves,u=!0===this.props.showRemediationButton?l&&l.size||0:void 0;return k.a.createElement(g.TableToolbar,{className:"space-between-toolbar-items"},k.a.createElement(ee.a,{className:"vulnerability-toolbar-spacing"},n&&k.a.createElement(ce.a,{selectedItems:u,selectorHandler:c.selectCves,cves:o,fetchResource:function(e){return c.fetchResource(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(n,!0).forEach(function(t){i()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},s,{},e))}}),k.a.createElement(oe.a,{apply:c.apply,showStatusList:Boolean(r),showAllCheckbox:t,filterValues:s}),n&&k.a.createElement(se.a,{systemId:r.id,selectedCves:l}),k.a.createElement(ae,{downloadReport:c.downloadReport})),k.a.createElement(ee.a,null,k.a.createElement(K.a,{apply:c.apply,meta:o.meta})))}}]),t}(D.Component);le.propTypes={showAllCheckbox:P.a.bool,showRemediationButton:P.a.bool,entity:P.a.object,context:P.a.object},le.defaultProps={showAllCheckbox:!1,showRemediationButton:!1,totalNumber:0,apply:function(){},downloadReport:function(){}};var ue=function(e){return k.a.createElement(be.Consumer,null,function(t){return k.a.createElement(le,z()({context:t},e))})},pe=n(558),fe=n.n(pe);function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(n,!0).forEach(function(t){i()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var be=k.a.createContext({}),de=[{title:"Name",key:"synopsis",transforms:[A.a,Object(F.b)("col-width-10")],columnTransforms:[Object(F.b)("no-wrap")]},{title:"Description",key:"description",transforms:[Object(F.b)("col-width-description")],columnTransforms:[Object(F.b)("hide-description")]},{title:"Publish date",key:"public_date",transforms:[A.a,Object(F.b)("col-width-10")]},{title:"CVSS base ",key:"cvss_score",transforms:[A.a,Object(F.b)("col-width-10")]},{title:"Impact",key:"impact",transforms:[A.a,Object(F.b)("col-width-10")],columnTransforms:[Object(F.b)("no-wrap")]},{title:"Status",key:"status",transforms:[A.a,Object(F.b)("col-width-15")]}],ve=function(e){function t(e){var n;return u()(this,t),(n=m()(this,d()(t).call(this,e))).processError=function(e){var t=e.status;return 404===parseInt(t)&&n.props.entity?x.g:x.f},n.apply=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.hasOwnProperty("cvss_filter")){var t=x.a.find(function(t){return t.value===e.cvss_filter});if(!t){var r=e.cvss_filter.split(/[^0-9]+/).filter(function(e){return parseFloat(e)});t={value:e.cvss_filter,from:r[0],to:r[1]}}e.cvss_from=t.from,e.cvss_to=t.to}if(e.hasOwnProperty("publish_date")){var a=x.i.find(function(t){return t.value===e.publish_date});e.public_from=a.from&&a.from.format("YYYY-MM-DD"),e.public_to=a.to&&a.to.format("YYYY-MM-DD")}n.setState(me({},n.state,{},e),n.sendRequest)},n.selectCves=function(e,t){var r=n.state.selectedCves;t?[].concat(t).forEach(function(t){e?r.add(t):r.delete(t)}):r=new Set,n.setState(me({},n.state,{selectedCves:new Set(r)}))},n.createUrlParams=function(e){var t=me({},e),r=["cvss_filter","publish_date","filter","limit","offset","page","page_size","sort","impact"];Object.keys(e).forEach(function(e){return(void 0===t[e]||""===t[e]||!r.includes(e)||!1===t[e])&&delete t[e]});var a=fe.a.stringify(t);n.props.history.push("?"+a)},n.sendRequest=function(){var e=n.props,t=e.fetchData,r=e.entity;t&&t(me({},n.state,{system:r.id})),n.createUrlParams(n.state)},n.downloadReport=function(e){var t=me({},n.state),r=Object(T.g)(me({},t,{page_size:Number.MAX_SAFE_INTEGER,data_format:e,page:1})).payload;r&&r.then(function(t){var n=t.data,r="json"===e?JSON.stringify(n):n;return Object(B.downloadFile)(r,"vulnerability_cves-".concat((new Date).toISOString()),e)})},n.state={selectedCves:new Set},n}return h()(t,e),f()(t,[{key:"componentDidMount",value:function(){M.a.setCallback(this.sendRequest);var e=fe.a.parse(this.props.location.search);this.apply(me({},{sort:"-public_date"},{},e))}},{key:"render",value:function(){var e=this.props,t=e.cveList,n=e.entity,r=this.apply,a=this.downloadReport,o=this.selectCves,s=Object(Y.b)(n.id,t),c=s.errors;return c?this.processError(c):k.a.createElement(be.Provider,{value:{cves:s,params:this.state,methods:{apply:r,downloadReport:a,selectCves:o,fetchResource:function(e){return Object(T.g)(me({},e,{system:n.id}))}}}},k.a.createElement(N.a,null,k.a.createElement(H.a,null,k.a.createElement(ue,{showRemediationButton:!0,entity:n})),k.a.createElement(H.a,null,k.a.createElement($,{header:de,isSelectable:!0,entity:n}))))}}]),t}(D.Component);ve.propTypes={entity:P.a.object,cveList:P.a.any,fetchData:P.a.func,history:P.a.object,location:P.a.object};var he=Object(I.a)(Object(C.connect)(function(e){var t=e.SystemCvesStore,n=e.entityDetails.entity;return{cveList:t&&t.cveList,entity:n}},function(e){return{fetchData:function(t){return e(Object(T.g)(t))}}})(ve)),Oe=function(e){function t(e){return u()(this,t),m()(this,d()(t).call(this,e))}return h()(t,e),f()(t,[{key:"render",value:function(){var e=this.props,t=e.entity,n=e.isOptOut,r=e.optOutSystemHandler;return this.props.setHeader({breadcrumbs:[{title:L.b.vulnerabilities.title,to:L.b.vulnerabilities.to},{title:L.b.systems.title,to:L.b.systems.to},{title:t&&t.display_name||"Invalid System",isActive:!0}]}),t?n?k.a.createElement(k.a.Fragment,null,k.a.createElement(x.k,{buttonAction:function(){return r(!1)}})):k.a.createElement(k.a.Fragment,null,k.a.createElement(he,{entity:t.id})):k.a.createElement(x.l,null)}}]),t}(k.a.Component);Oe.propTypes={setHeader:P.a.func,entity:P.a.object,isOptOut:P.a.bool,optOutSystemHandler:P.a.func};var je=Object(I.a)(Object(C.connect)(function(e){var t=e.entityDetails;return{entity:t.entity,isOptOut:t.opt_out}},function(){return{setHeader:function(e){return Object(R.a)(Object(T.n)(e))}}})(Oe)),we=n(366);function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(n,!0).forEach(function(t){i()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Se={loaded:!1},Pe=function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Se,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case we.i+"_FULFILLED":return Ee({},n,{},r.payload.data);case e.LOAD_ENTITY_FULFILLED:return Ee({},n,{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return k.a.createElement(je,{optOutSystemHandler:t})}}]});default:return n}}},De=n(80),ke=n(378);function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(n,!0).forEach(function(t){i()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ie=function(e){function t(e){var n;return u()(this,t),(n=m()(this,d()(t).call(this,e))).checkItem=function(e,t){var r=n.state.systemList;r[e].selected=t,n.setState({systemList:r})},n.toggleLinkHover=function(e){n.setState(_e({},n.state,{linkHovered:e}))},n.optOutSystem=function(e){n.props.optOutSystem(n.state.inventoryId,e).then(function(){n.props.fetchSystemDetails(n.state.inventoryId),!0===e?n.props.addNotification({variant:"success",title:"System successfully excluded from vulnerability analysis"}):n.props.addNotification({variant:"success",title:"System successfully resumed vulnerability analysis",description:"There may be 24 hours before data is available"})})},n.state={inventoryId:n.props.match.params.inventoryId,removeListener:function(){},linkHovered:!1},n}var n;return h()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.props.fetchSystemDetails(this.state.inventoryId),this.fetchInventory()}},{key:"fetchInventory",value:(n=s()(a.a.mark(function e(){var t,n,r,o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,insights.loadInventory({react:k.a,reactRouterDom:_,reactCore:O,reactIcons:w});case 2:t=e.sent,n=t.inventoryConnector,r=t.mergeWithEntities,o=t.mergeWithDetail,s=t.INVENTORY_ACTION_TYPES,De.a.register(_e({},r(),{},o(Pe(s,this.optOutSystem)))),this.setState({InventoryHeader:n().InventoryDetailHead,InventoryBody:n().AppInfo}),this.state.removeListener();case 10:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,n=t.InventoryHeader,r=t.InventoryBody,a=this.props.systemDetails,o=void 0===a?{}:a,s=o.opt_out,c=void 0!==s&&s,i=o.entity;return k.a.createElement(j.a,null,k.a.createElement(ke.a,{title:"",showTabs:!1},n&&k.a.createElement(n,{hideBack:!0,actions:i&&[c?{title:"Resume vulnerability analysis",onClick:function(){return e.optOutSystem(!1)}}:{title:"Exclude from vulnerability analysis",onClick:function(){return e.optOutSystem(!0)}}]})),r&&k.a.createElement(g.Main,null,k.a.createElement(k.a.Fragment,null,k.a.createElement(r,{optOutSystemHandler:this.optOutSystem}))))}}]),t}(k.a.Component);Ie.propTypes={fetchSystemDetails:P.a.func,systemDetails:P.a.object,optOutSystem:P.a.func,match:P.a.object,addNotification:P.a.func};t.default=Object(I.a)(Object(C.connect)(function(e){return{systemDetails:e.entityDetails}},function(){return{optOutSystem:function(e,t){return Object(R.a)(Object(T.k)(e,t))},fetchSystemDetails:function(e){return Object(R.a)(Object(T.i)(e))},addNotification:function(e){return Object(R.a)(Object(E.addNotification)(e))}}})(Ie))}}]);
//# sourceMappingURL=../sourcemaps/InventoryDetail.js.map