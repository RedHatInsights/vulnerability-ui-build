(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1316:function(e,t,n){"use strict";n.r(t);var r=n(121),a=n.n(r),o=n(151),i=n.n(o),s=n(383),c=n.n(s),l=n(91),u=n.n(l),p=n(92),f=n.n(p),d=n(93),v=n.n(d),m=n(94),y=n.n(m),b=n(95),h=n.n(b),O=n(216),j=n(76),g=n(217),E=n(392),S=n(85),w=n(411),D=n(1),C=n.n(D),_=n(2),P=n.n(_),k=n(84),I=n(143),x=n(372),R=n(433),T=n(385),L=n(149),N=n(193),F=n(194),M=n(746),A=n(524),H=n(472),V=n(431),Y=n(513),B=n.n(Y),z=n(424),J=n(876),U=(n(868),n(601)),q=n(145),W=n.n(q),G=n(423),X=n.n(G),K=n(434),Q=n(874),Z=n(872),$=n(466),ee=n(514);function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(n,!0).forEach(function(t){c()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var re=function(e){function t(){var e,n,r;u()(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return v()(r,(n=r=v()(this,(e=y()(t)).call.apply(e,[this].concat(o))),r.noCves=function(){var e=r.props,t=e.entity,n=e.context.cves;return[{heightAuto:!0,cells:[{props:{colSpan:8},title:0!==["filter","cvss_from","cvss_to","public_from","public_to","impact","status_id"].filter(function(e){return Object.prototype.hasOwnProperty.call(n.meta,e)&&n.meta[e]}).length?T.h:t?T.f:0===n.data.length?T.e:void 0}]}]},r.handleOnSelect=function(e,t,n){var a=r.props.context,o=a.cves,i=a.methods,s=o.data[n]&&o.data[n].id;i.selectCves(t,s)},n))}return h()(t,e),f()(t,[{key:"handleOnCollapse",value:function(e,t,n){var r=this.props.context,a=r.cves,o=r.methods,i=r.params.expandCveDescription,s=a.data[t]&&a.data[t].id;o.openCves(n,s,i)}},{key:"render",value:function(){var e=this,t=this.props,n=t.context,r=t.header,a=n.params,o=n.cves,i=n.methods,s=a.selectedCves,c=a.openedCves,l=o.data.map(function(e){return s.has(e.id)&&ne({},e,{selected:!0})||e}).map(function(e){return c.has(e.id)&&ne({},e,{isOpen:!0})||e});return P.a.createElement(_.Fragment,null,o.isLoading?P.a.createElement(E.SkeletonTable,{colSize:2,rowSize:20}):P.a.createElement(_.Fragment,null,P.a.createElement(K.b,{"aria-label":"Vulnerability CVE table",cells:r,rows:0===o.data.length?this.noCves():l,onSelect:0!==o.data.length?this.handleOnSelect:void 0,actions:0!==o.data.length?Object($.d)(i):void 0,sortBy:0!==o.data.length?Object(z.b)([{key:"collapse"},{key:"checkbox"}].concat(X()(r)),o.meta.sort):void 0,onCollapse:0!==o.data.length?function(t,n,r){return e.handleOnCollapse(t,n,r)}:void 0,onSort:0!==o.data.length?function(e,t,n){return Object(z.e)(t,n,[{key:"collapse"},{key:"checkbox"}].concat(X()(r)),o.meta.sort,i.apply)}:void 0,gridBreakPoint:"grid-lg"},P.a.createElement(_.Fragment,null,P.a.createElement(Q.a,null),P.a.createElement(Z.a,null))),P.a.createElement(E.TableToolbar,null,P.a.createElement(ee.a,{variant:"bottom",meta:o.meta,apply:i.apply}))))}}]),t}(_.Component);re.propTypes={context:C.a.any,header:C.a.array,entity:C.a.object};var ae=function(e){return P.a.createElement(Oe.Consumer,null,function(t){return P.a.createElement(re,W()({context:t},e))})},oe=n(196),ie=n(195),se=n(467),ce=n(468),le=n(515),ue=n(597),pe=n(516),fe=n(869),de=n(517);function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var me=function(e){function t(){var e,n,r;u()(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return v()(r,(n=r=v()(this,(e=y()(t)).call.apply(e,[this].concat(o))),r.handleCveDescription=function(){var e=r.props.context,t=e.cves,n=e.methods,a=e.params.expandCveDescription,o=!a,i=a?[]:t.data.filter(function(e){return e.id}).map(function(e){return e.id});n.openCves(o,i,!a)},n))}return h()(t,e),f()(t,[{key:"render",value:function(){var e=this.props,t=e.showRemediationButton,n=e.entity,r=e.context,a=r.cves,o=r.params,i=r.methods,s=o.selectedCves,l=o.expandCveDescription,u=o.filter,p=!0===this.props.showRemediationButton?s&&s.size||0:void 0,f=[T.t,T.v,T.s,T.u,T.x],d=[Object(ce.d)(i.showStatusModal,X()(s).map(function(e){return{id:e,status_id:"0"}}),[],{isDisabled:!p}),Object(ce.f)(this.handleCveDescription,l),Object(ce.b)(i.downloadReport),Object(ce.a)(i.downloadReport)];return P.a.createElement(P.a.Fragment,null,P.a.createElement(E.TableToolbar,{className:"space-between-toolbar-items"},P.a.createElement(oe.a,{className:"vulnerability-toolbar-spacing"},t&&P.a.createElement(de.a,{selectedItems:s,selectorHandler:i.selectCves,items:a,fetchResource:function(e){return i.fetchResource(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(n,!0).forEach(function(t){c()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},o,{},e))},multiRow:!0}),P.a.createElement(pe.a,{placeholder:"Find a CVE...",value:u,apply:i.apply}),P.a.createElement(ue.a,{filterValues:o,filterCategories:f,apply:i.apply}),t&&P.a.createElement(fe.a,{systemId:n.id,selectedCves:s}),P.a.createElement(se.a,{dropdownItems:d})),P.a.createElement(oe.a,null,P.a.createElement(ee.a,{apply:i.apply,meta:a.meta}))),P.a.createElement(E.TableToolbar,{className:"pf-u-pt-0"},P.a.createElement(oe.a,null,P.a.createElement(ie.a,null,P.a.createElement(le.a,{filterValues:o,filterCategories:[T.q].concat(f),apply:i.apply})))))}}]),t}(_.Component);me.propTypes={showRemediationButton:C.a.bool,entity:C.a.object,context:C.a.object},me.defaultProps={showRemediationButton:!1,totalNumber:0,apply:function(){},downloadReport:function(){}};var ye=function(e){return P.a.createElement(Oe.Consumer,null,function(t){return P.a.createElement(me,W()({context:t},e))})};function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(n,!0).forEach(function(t){c()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Oe=P.a.createContext({}),je=[{title:"CVE ID",key:"synopsis",transforms:[M.a,Object(A.b)("col-width-10")],columnTransforms:[Object(A.b)("no-wrap")],cellFormatters:[H.b]},{title:"Publish date",key:"public_date",transforms:[M.a,Object(A.b)("col-width-10")]},{title:"CVSS base score",key:"cvss_score",transforms:[M.a,Object(A.b)("col-width-10")]},{title:"Impact",key:"impact",transforms:[M.a,Object(A.b)("col-width-10")],columnTransforms:[Object(A.b)("no-wrap")]},{title:"Business risk",key:"business_risk",transforms:[M.a,Object(A.b)("col-width-10")]},{title:"Status",key:"status",transforms:[M.a,Object(A.b)("col-width-10")]}],ge=function(e){function t(e){var n;return u()(this,t),(n=v()(this,y()(t).call(this,e))).processError=function(e){var t=e.status;return 404===parseInt(t)&&n.props.entity?T.j:T.i},n.dataReload=function(){var e=n.props.cveList,t=e.meta,r=e.data,a=t.page,o=a===t.pages&&r.length/2==1?1:a;n.setState(he({},n.state,{page:o,page_size:t.page_size}),n.apply)},n.apply=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object.prototype.hasOwnProperty.call(e,"cvss_filter")){var t=T.c.find(function(t){return t.value===e.cvss_filter});if(void 0===t&&void 0!==e.cvss_filter){var r=e.cvss_filter.split(/[^0-9]+/).filter(function(e){return parseFloat(e)});t={from:r[0],to:r[1]}}else void 0===t&&void 0===e.cvss_filter&&(t={from:void 0,to:void 0});e.cvss_from=t.from,e.cvss_to=t.to}if(Object.prototype.hasOwnProperty.call(e,"publish_date")){var a=T.l.find(function(t){return t.value===e.publish_date});void 0!==a?(e.public_from=a.from&&a.from.format("YYYY-MM-DD"),e.public_to=a.to&&a.to.format("YYYY-MM-DD")):(e.public_from=void 0,e.public_to=void 0,e.publish_date=void 0)}n.setState(he({},n.state,{},e),n.sendRequest)},n.selectCves=function(e,t){var r=n.state.selectedCves;r=t?Object(z.f)(r,t,e):new Set,n.setState(he({},n.state,{selectedCves:new Set(r)}))},n.openCves=function(e,t,r){var a=n.state,o=a.openedCves;a.expandCveDescription&&!t.length&&(o=t),o=t?Object(z.f)(o,t,e):new Set,n.setState(he({},n.state,{openedCves:new Set(o),expandCveDescription:r}))},n.createUrlParams=function(e){var t=he({},e),r=["cvss_filter","publish_date","filter","limit","offset","page","page_size","sort","impact","business_risk_id","status_id"];Object.keys(e).forEach(function(e){return(void 0===t[e]||""===t[e]||!r.includes(e)||!1===t[e])&&delete t[e]});var a=B.a.stringify(t);n.props.history.push("?"+a)},n.sendRequest=function(){var e=n.props,t=e.fetchData,r=e.entity,a=n.state.expandCveDescription;t&&t(he({},n.state,{system:r.id})).then(function(e){var t=e.data;if(a){var r=t&&t.map(function(e){return e.id});n.openCves(!0,r,a)}}),n.createUrlParams(n.state)},n.downloadReport=function(e){var t=he({},n.state),r=n.props.entity,a=Object(R.f)(he({},t,{page_size:Number.MAX_SAFE_INTEGER,data_format:e,page:1,system:r.id})).payload;a&&a.then(function(t){var n=t.data,r="json"===e?JSON.stringify(n):n;return Object(V.downloadFile)(r,"vulnerability_cves-".concat((new Date).toISOString()),e)})},n.showStatusModal=function(e){var t;if(e.length>1){var r=Array.from(n.props.cveList.data.filter(function(t){return e.some(function(e){return e.id===t.id})}));t=r.some(function(e){return!(r.filter(function(t){return t.status_id===e.status_id}).length>1)})}n.setState({StatusModal:function(){return P.a.createElement(U.a,{cves:e,updateRef:n.dataReload,inventories:[{id:n.props.entity&&n.props.entity.id}],hasDifferentStatus:t})}})},n.state={selectedCves:new Set,openedCves:new Set,StatusModal:function(){return null},expandCveDescription:!1},n}return h()(t,e),f()(t,[{key:"componentDidMount",value:function(){var e=B.a.parse(this.props.location.search);this.apply(he({},{sort:"-public_date"},{},e))}},{key:"render",value:function(){var e=this.props,t=e.cveList,n=e.entity,r=this.apply,a=this.downloadReport,o=this.selectCves,i=this.openCves,s=this.showStatusModal,c=this.state.StatusModal,l=t,u=l.errors;return u?this.processError(u):P.a.createElement(Oe.Provider,{value:{cves:l,params:this.state,methods:{apply:r,downloadReport:a,selectCves:o,openCves:i,showStatusModal:s,fetchResource:function(e){return Object(R.f)(he({},e,{system:n.id}))}}}},P.a.createElement(c,null),P.a.createElement(N.a,null,P.a.createElement(F.a,null,P.a.createElement(ye,{showRemediationButton:!0,entity:n})),P.a.createElement(F.a,null,P.a.createElement(ae,{header:je,entity:n}))))}}]),t}(_.Component);ge.propTypes={entity:C.a.object,cveList:C.a.any,fetchData:C.a.func,history:C.a.object,location:C.a.object};var Ee=Object(x.a)(Object(k.connect)(function(e){var t=e.SystemCvesStore,n=e.entityDetails.entity;return{cveList:t&&Object(J.b)(n.id,t.cveList),entity:n}},function(e){return{fetchData:function(t){var n=Object(R.f)(t);return e(n),n.payload}}})(ge)),Se=function(e){function t(e){return u()(this,t),v()(this,y()(t).call(this,e))}return h()(t,e),f()(t,[{key:"render",value:function(){var e=this.props,t=e.entity,n=e.isOptOut,r=e.optOutSystemHandler;return this.props.setHeader({breadcrumbs:[{title:L.b.vulnerabilities.title,to:L.b.vulnerabilities.to},{title:L.b.systems.title,to:L.b.systems.to},{title:t&&t.display_name||"Invalid System",isActive:!0}]}),t?n?P.a.createElement(P.a.Fragment,null,P.a.createElement(T.o,{buttonAction:function(){return r(!1)}})):P.a.createElement(P.a.Fragment,null,P.a.createElement(Ee,{entity:t.id})):P.a.createElement(E.InvalidObject,null)}}]),t}(P.a.Component);Se.propTypes={setHeader:C.a.func,entity:C.a.object,isOptOut:C.a.bool,optOutSystemHandler:C.a.func};var we=Object(x.a)(Object(k.connect)(function(e){var t=e.entityDetails;return{entity:t.entity,isOptOut:t.opt_out}},function(e){return{setHeader:function(t){return e(Object(R.n)(t))}}})(Se)),De=n(432);function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(n,!0).forEach(function(t){c()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Pe={loaded:!1},ke=function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pe,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case De.i+"_FULFILLED":return _e({},n,{},r.payload.data);case e.LOAD_ENTITY_FULFILLED:return _e({},n,{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return P.a.createElement(we,{optOutSystemHandler:t})}}]});case e.LOAD_ENTITY_REJECTED:return _e({},n,{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return P.a.createElement(we,null)}}]});default:return n}}},Ie=n(97),xe=n(469);function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(n,!0).forEach(function(t){c()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Le=function(e){function t(e){var n;return u()(this,t),(n=v()(this,y()(t).call(this,e))).checkItem=function(e,t){var r=n.state.systemList;r[e].selected=t,n.setState({systemList:r})},n.toggleLinkHover=function(e){n.setState(Te({},n.state,{linkHovered:e}))},n.optOutSystem=function(e){n.props.optOutSystem(n.state.inventoryId,e).then(function(){n.props.fetchSystemDetails(n.state.inventoryId),!0===e?n.props.addNotification({variant:"success",title:"System successfully excluded from vulnerability analysis"}):n.props.addNotification({variant:"success",title:"System successfully resumed vulnerability analysis",description:"There may be 24 hours before data is available"})})},n.state={inventoryId:n.props.match.params.inventoryId,removeListener:function(){},linkHovered:!1},n}var n;return h()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.props.fetchSystemDetails(this.state.inventoryId),this.fetchInventory()}},{key:"fetchInventory",value:(n=i()(a.a.mark(function e(){var t,n,r,o,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,insights.loadInventory({react:P.a,reactRouterDom:I,reactCore:O,reactIcons:g,pfReactTable:w});case 2:t=e.sent,n=t.inventoryConnector,r=t.mergeWithEntities,o=t.mergeWithDetail,i=t.INVENTORY_ACTION_TYPES,Ie.a.register(Te({},r(),{},o(ke(i,this.optOutSystem)))),this.setState({InventoryHeader:n().InventoryDetailHead,InventoryBody:n().AppInfo}),this.state.removeListener();case 10:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,n=t.InventoryHeader,r=t.InventoryBody,a=this.props.systemDetails,o=void 0===a?{}:a,i=o.opt_out,s=void 0!==i&&i,c=o.entity;return P.a.createElement(j.a,null,P.a.createElement(xe.a,{title:"",showTabs:!1},n&&P.a.createElement(n,{hideBack:!0,actions:c&&[s?{title:"Resume vulnerability analysis",onClick:function(){return e.optOutSystem(!1)}}:{title:"Exclude from vulnerability analysis",onClick:function(){return e.optOutSystem(!0)}}]})),r&&P.a.createElement(E.Main,null,P.a.createElement(P.a.Fragment,null,P.a.createElement(r,{optOutSystemHandler:this.optOutSystem}))))}}]),t}(P.a.Component);Le.propTypes={fetchSystemDetails:C.a.func,systemDetails:C.a.object,optOutSystem:C.a.func,match:C.a.object,addNotification:C.a.func};t.default=Object(x.a)(Object(k.connect)(function(e){return{systemDetails:e.entityDetails}},function(e){return{optOutSystem:function(t,n){return e(Object(R.j)(t,n))},fetchSystemDetails:function(t){return e(Object(R.g)(t))},addNotification:function(t){return e(Object(S.addNotification)(t))}}})(Le))},601:function(e,t,n){"use strict";var r=n(393),a=n.n(r),o=n(193),i=n(194),s=n(204),c=n(178),l=n(179),u=n(168),p=n(1),f=n.n(p),d=n(2),v=n.n(d),m=n(417),y=n(446),b=function(e){var t=e.cves,n=e.updateRef,r=e.inventories,p=e.hasDifferentStatus,f=void 0!==p&&p,b=Object(d.useState)(t),h=a()(b,1)[0],O=Object(d.useState)(r),j=a()(O,1)[0],g=Object(y.c)(function(){if(j&&j.length>0&&j[0].status_id)return j&&j[0].status_id.toString()||"0";if(h&&h.length>0)return F()}()),E=g.StatusSelect,S=g.statusId,w=g.setStatusId,D=g.setProps,C=Object(y.b)(function(){if(j&&1===j.length&&j[0].justification)return j&&1===j.length&&j[0].justification||"";if(h&&1===h.length)return M()}()),_=C.JustificationInput,P=C.justification,k=C.setJustification,I=C.setProps,x=Object(d.useState)(function(){if(j&&1===j.length&&j[0].status_id){var e=a()(j,1)[0];return h.some(function(t){return t.status_id===e.status_id})}if(h&&1===h.length)return!0;return!1}()),R=a()(x,2),T=R[0],L=R[1],N=j.map(function(e){return e.id});Object(d.useEffect)(function(){if(T){var e={isDisabled:!0};D(e),I(e)}},[]);function F(){return h&&h[0].status_id.toString()||"0"}function M(){return h&&1===h.length&&h[0].justification||""}var A="Set status for this CVE and system pair";return(N.length>1||t.length>1)&&(A="Set status for these CVE and system pairs"),v.a.createElement(y.a,{items:h,onSave:function(){var e=h.map(function(e){return e.id}),t=T?{cve:e,inventory_id:N}:{status_id:parseInt(S),cve:e,status_text:P,inventory_id:N};return Object(m.m)(t).then(n)},onSuccessNotification:{variant:"success",title:"CVE status updated"},title:A},v.a.createElement(o.a,{gutter:"md"},v.a.createElement(i.a,null,f?v.a.createElement(s.a,{variant:"warning",isInline:!0,title:"Selected pairs have different statuses. Changes will be applied to all "}):""),v.a.createElement(i.a,null,v.a.createElement(c.a,{key:"key"},v.a.createElement(l.a,{fieldId:"overall"},v.a.createElement(u.a,{label:"Use overall CVE status",id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:T,onChange:function(e){var t={isDisabled:e};L(e),D(t),w(F()),k(M()),I(t)}})),E,_))))};b.propTypes={cves:f.a.array,updateRef:f.a.func,inventories:f.a.array,hasDifferentStatus:f.a.bool},t.a=b}}]);
//# sourceMappingURL=../sourcemaps/InventoryDetail.js.map