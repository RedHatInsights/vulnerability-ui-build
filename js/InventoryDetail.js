(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{380:function(e,t,n){"use strict";var a=n(75),i=n.n(a),r=n(76),s=n.n(r),o=n(77),l=n.n(o),c=n(78),u=n.n(c),p=n(79),d=n.n(p),b=n(195),f=n(1),v=n.n(f),m=n(2),y=n.n(m),h=n(352),g=function(e){function t(){var e,n,a;i()(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return l()(a,(n=a=l()(this,(e=u()(t)).call.apply(e,[this].concat(s))),a.handleChangePage=function(e,t){return a.props.apply({page:t})},a.handleSetPageSize=function(e,t){return a.props.apply({page_size:t,page:1})},n))}return d()(t,e),s()(t,[{key:"shouldComponentUpdate",value:function(e){return e.meta!==this.props.meta}},{key:"render",value:function(){var e=this.props,t=e.meta,n=e.variant,a=t.page,i=t.total_items,r=t.page_size;return y.a.createElement(y.a.Fragment,null,y.a.createElement(b.a,{page:a||1,itemCount:i||0,perPage:r||h.b,perPageOptions:h.h,onSetPage:this.handleChangePage,onPerPageSelect:this.handleSetPageSize,variant:b.b[n]}))}}]),t}(m.Component);g.propTypes={apply:v.a.func,meta:v.a.object,variant:v.a.string},g.defaultProps={variant:"top"},t.a=g},403:function(e,t,n){"use strict";n.d(t,"a",function(){return m}),n.d(t,"b",function(){return y});var a=n(404),i=n.n(a),r=n(93),s=n(170),o=n(171),l=n(135),c=n(188),u=n(353),p=n(361),d=n(2),b=n.n(d),f=n(400),v=n(352);function m(e){var t=e.cveList,n=e.parameters,a=t.isLoading;if(!a){var c=t.payload,d=c.data,m=c.meta,y=c.errors;return{data:d=d&&i()(d,function(e,t){return[{id:e.id,business_risk_id:e.attributes.business_risk_id,business_risk_justification:e.attributes.business_risk_text,status_id:e.attributes.status_id,status_justification:e.attributes.status_text,cells:[{title:b.a.createElement("span",{key:e.id},b.a.createElement(f.a,{to:"/cves/"+e.attributes.synopsis},e.attributes.synopsis))},{title:b.a.createElement("span",{key:e.id},Object(p.processDate)(e.attributes.public_date))},{title:b.a.createElement("span",{key:e.id},b.a.createElement(u.Shield,{impact:e.attributes.impact,hasLabel:!0}))},{title:b.a.createElement("span",{key:e.id},Object(p.parseCvssScore)(e.attributes.cvss2_score,e.attributes.cvss3_score,!0))},{title:b.a.createElement("span",{key:e.id},e.attributes.systems_affected.toString())},{title:b.a.createElement("span",{key:e.id},v.m.find(function(t){return t.value===e.attributes.business_risk_id.toString()}).label)},{title:b.a.createElement("span",{key:e.id},e.attributes.systems_status_divergent>0?b.a.createElement(r.a,{content:"Individual CVE-Status pairs have differences from overall CVE status"},b.a.createElement(l.a,{color:"var(--pf-global--warning-color--100)"})):""," ",v.k.find(function(t){return t.value===e.attributes.status_id.toString()}).label)}],isOpen:n.openedCves.includes(e.id),selected:n.selectedCves.includes(e.id)},{cells:[{title:b.a.createElement(s.a,null,b.a.createElement(o.a,{component:o.b.h6},"Description"),b.a.createElement(o.a,{component:o.b.p},e.attributes.description))}],parent:2*t}]}),meta:m,isLoading:a,errors:y}}return{data:[],meta:t.payload&&t.payload.meta||{},isLoading:a}}function y(e,t){var n=t&&t.isLoading;if(!n){var a=t.payload,s=a.data,o=a.meta,l=a.errors;return{data:s&&i()(s,function(e,t){return[{id:e.id,business_risk_id:e.attributes.business_risk_id,business_risk_justification:e.attributes.business_risk_text,status_id:e.attributes.status_id,status_justification:e.attributes.status_text,cells:[{title:b.a.createElement("span",{key:e.id},h(e.attributes.synopsis))},{title:b.a.createElement("span",{key:e.id},Object(p.processDate)(e.attributes.public_date))},{title:b.a.createElement("span",{key:e.id},Object(p.parseCvssScore)(e.attributes.cvss2_score,e.attributes.cvss3_score,!0))},{title:b.a.createElement("span",{key:e.id},b.a.createElement(u.Shield,{impact:e.attributes.impact,tooltipPosition:"right",hasLabel:!0}))},{title:b.a.createElement("span",{key:e.id},v.m.find(function(t){return t.value===e.attributes.business_risk_id.toString()}).label)},{title:b.a.createElement("span",{key:e.id},e.attributes.cve_status_id!==e.attributes.status_id?b.a.createElement(r.a,{content:"Applies only to this system-CVE pair"},b.a.createElement(c.a,null)):""," ",v.k.find(function(t){return t.value===e.attributes.status_id.toString()}).label)}],isOpen:!1,selected:!1},{cells:[{title:e.attributes.description}],parent:2*t}]}),meta:o,errors:l,isLoading:n}}return{data:[],meta:t.payload&&t.payload.meta||{},isLoading:n}}function h(e){return-1!==location.href.indexOf("vulnerability")?b.a.createElement(f.a,{to:"/cves/"+e},e):b.a.createElement("a",{href:"".concat(document.baseURI,"rhel/vulnerability/cves/").concat(e)},e)}},404:function(e,t,n){var a=n(405),i=n(412);e.exports=function(e,t){return a(i(e,t),1)}},405:function(e,t,n){var a=n(406),i=n(407);e.exports=function e(t,n,r,s,o){var l=-1,c=t.length;for(r||(r=i),o||(o=[]);++l<c;){var u=t[l];n>0&&r(u)?n>1?e(u,n-1,r,s,o):a(o,u):s||(o[o.length]=u)}return o}},406:function(e,t){e.exports=function(e,t){for(var n=-1,a=t.length,i=e.length;++n<a;)e[i+n]=t[n];return e}},407:function(e,t,n){var a=n(408),i=n(410),r=n(411),s=a?a.isConcatSpreadable:void 0;e.exports=function(e){return r(e)||i(e)||!!(s&&e&&e[s])}},408:function(e,t,n){var a=n(409).Symbol;e.exports=a},410:function(e,t){e.exports=function(){return!1}},411:function(e,t){var n=Array.isArray;e.exports=n},412:function(e,t){e.exports=function(e,t){for(var n=-1,a=null==e?0:e.length,i=Array(a);++n<a;)i[n]=t(e[n],n,e);return i}},415:function(e,t,n){var a=n(416);"string"==typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(6)(a,i);a.locals&&(e.exports=a.locals)},416:function(e,t,n){(e.exports=n(5)(!1)).push([e.i,".ins-active-app-vulnerabilities .cvetable-toolbar,\n.page__Vulnerabilities .cvetable-toolbar {\n  justify-content: space-between; }\n  .ins-active-app-vulnerabilities .cvetable-toolbar > div,\n  .page__Vulnerabilities .cvetable-toolbar > div {\n    align-self: flex-end; }\n\n.ins-active-app-vulnerabilities .space-between-toolbar-items,\n.page__Vulnerabilities .space-between-toolbar-items {\n  justify-content: space-between;\n  flex-wrap: nowrap; }\n  .ins-active-app-vulnerabilities .space-between-toolbar-items > div,\n  .page__Vulnerabilities .space-between-toolbar-items > div {\n    flex-wrap: nowrap; }\n\n.ins-active-app-vulnerabilities .vulnerability-toolbar-spacing,\n.page__Vulnerabilities .vulnerability-toolbar-spacing {\n  justify-content: flex-start; }\n  .ins-active-app-vulnerabilities .vulnerability-toolbar-spacing > div:not(:last-child),\n  .page__Vulnerabilities .vulnerability-toolbar-spacing > div:not(:last-child) {\n    margin-right: var(--pf-global--spacer--sm); }\n\n@media screen and (max-width: 1100px) {\n  .ins-active-app-vulnerabilities .pf-c-pagination:not(.pf-m-footer) .pf-c-options-menu,\n  .ins-active-app-vulnerabilities .pf-c-pagination:not(.pf-m-footer) .pf-c-pagination__nav,\n  .page__Vulnerabilities .pf-c-pagination:not(.pf-m-footer) .pf-c-options-menu,\n  .page__Vulnerabilities .pf-c-pagination:not(.pf-m-footer) .pf-c-pagination__nav {\n    display: none;\n    visibility: hidden; }\n  .ins-active-app-vulnerabilities .pf-c-pagination__total-items,\n  .page__Vulnerabilities .pf-c-pagination__total-items {\n    display: flex;\n    visibility: visible; } }\n\n.ins-active-app-vulnerabilities .pf-c-pagination.pf-m-footer.ins-c-pagination-next,\n.page__Vulnerabilities .pf-c-pagination.pf-m-footer.ins-c-pagination-next {\n  margin-left: auto; }\n\n.ins-active-app-vulnerabilities #download-report,\n.page__Vulnerabilities #download-report {\n  cursor: pointer; }\n\n.ins-active-app-vulnerabilities .number-of-results,\n.page__Vulnerabilities .number-of-results {\n  display: inline-block;\n  min-width: 55px;\n  text-align: right;\n  margin-right: 5px; }\n\n.ins-active-app-vulnerabilities .table-header-icon,\n.page__Vulnerabilities .table-header-icon {\n  margin-right: 5px;\n  margin-right: 0.3125rem; }\n\n.ins-active-app-vulnerabilities .status-dropdown-column > svg,\n.page__Vulnerabilities .status-dropdown-column > svg {\n  color: var(--pf-global--primary-color--100); }\n\n.ins-active-app-vulnerabilities .status-dropdown-column:hover,\n.page__Vulnerabilities .status-dropdown-column:hover {\n  cursor: pointer; }\n  .ins-active-app-vulnerabilities .status-dropdown-column:hover > svg,\n  .page__Vulnerabilities .status-dropdown-column:hover > svg {\n    visibility: visible; }\n\n.ins-active-app-vulnerabilities .status-dropdown-column > svg,\n.page__Vulnerabilities .status-dropdown-column > svg {\n  visibility: hidden; }\n\n.ins-active-app-vulnerabilities tbody > tr > td.pf-c-table__check,\n.page__Vulnerabilities tbody > tr > td.pf-c-table__check {\n  vertical-align: middle;\n  padding-top: 0px !important;\n  padding-bottom: 0px !important; }\n\n.ins-active-app-vulnerabilities thead > tr > td.pf-c-table__check,\n.page__Vulnerabilities thead > tr > td.pf-c-table__check {\n  visibility: hidden; }\n\n.ins-active-app-vulnerabilities .pf-c-table tr > *,\n.page__Vulnerabilities .pf-c-table tr > * {\n  vertical-align: middle !important; }\n\n.ins-active-app-vulnerabilities p.pf-c-empty-state__body ul,\n.page__Vulnerabilities p.pf-c-empty-state__body ul {\n  margin-top: 0px;\n  margin-bottom: var(--pf-global--spacer--sm); }\n  .ins-active-app-vulnerabilities p.pf-c-empty-state__body ul li,\n  .page__Vulnerabilities p.pf-c-empty-state__body ul li {\n    margin-top: 0px; }\n\n@media (max-width: 1400px) and (min-width: 992px) {\n  .ins-active-app-vulnerabilities .hide-description,\n  .page__Vulnerabilities .hide-description {\n    --pf-hidden-visible--Display: var(\n                --pf-hidden-visible--hidden--Display\n            );\n    --pf-hidden-visible--Visibility: var(\n                --pf-hidden-visible--hidden--Visibility\n            ); } }\n\n@media (min-width: 1400px) {\n  .ins-active-app-vulnerabilities .remediation-btn-sml,\n  .page__Vulnerabilities .remediation-btn-sml {\n    display: none;\n    visibility: hidden; } }\n\n@media (max-width: 1400px) {\n  .ins-active-app-vulnerabilities .remediation-btn-lg,\n  .page__Vulnerabilities .remediation-btn-lg {\n    display: none;\n    visibility: none; } }\n\n.ins-active-app-vulnerabilities .col-width-10,\n.page__Vulnerabilities .col-width-10 {\n  width: 10%; }\n\n.ins-active-app-vulnerabilities .col-width-15,\n.page__Vulnerabilities .col-width-15 {\n  width: 15%; }\n\n.ins-active-app-vulnerabilities .col-width-description,\n.page__Vulnerabilities .col-width-description {\n  width: 35%; }\n\n.ins-active-app-vulnerabilities .no-wrap,\n.page__Vulnerabilities .no-wrap {\n  white-space: nowrap; }\n\n.ins-active-app-vulnerabilities .pf-c-table__expandable-row-content,\n.page__Vulnerabilities .pf-c-table__expandable-row-content {\n  white-space: normal; }\n\n.ins-active-app-vulnerabilities tr.pf-m-expanded .pf-c-table__action,\n.page__Vulnerabilities tr.pf-m-expanded .pf-c-table__action {\n  display: none; }\n",""])},424:function(e,t,n){"use strict";var a=n(366),i=n.n(a),r=n(75),s=n.n(r),o=n(76),l=n.n(o),c=n(77),u=n.n(c),p=n(78),d=n.n(p),b=n(79),f=n.n(b),v=n(73),m=n(425),y=n.n(m),h=n(422),g=n.n(h),_=n(1),O=n.n(_),w=n(2),E=n.n(w),j=n(72),S=function(e){function t(){var e,n,a;s()(this,t);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return u()(a,(n=a=u()(this,(e=d()(t)).call.apply(e,[this].concat(o))),a.remediationProvider=function(e){return!(!e||0===e.size)&&{issues:i()(e).map(function(e){return{id:"vulnerabilities:".concat(e),description:e}}),systems:[a.props.systemId]}},n))}return f()(t,e),l()(t,[{key:"shouldComponentUpdate",value:function(e){return e.selectedCves!==this.props.selectedCves}},{key:"render",value:function(){var e=this,t=this.props,n=t.selectedCves,a=t.addNotification;return E.a.createElement("div",null,E.a.createElement(y.a,{dataProvider:function(){return e.remediationProvider(n)},isDisabled:!1===this.remediationProvider(n),onRemediationCreated:function(e){return a(e.getNotification())}},E.a.createElement("span",{className:"remediation-btn-lg"},"Remediate with Ansible"),E.a.createElement("span",{className:"remediation-btn-sml"},"Remediate")))}}]),t}(w.Component);S.propTypes={systemId:O.a.string,selectedCves:O.a.object,addNotification:O.a.func},t.a=Object(j.connect)(null,function(e){return{addNotification:function(t){return e(Object(v.addNotification)(t))}}})(g()(S))},426:function(e,t,n){"use strict";var a=n(75),i=n.n(a),r=n(76),s=n.n(r),o=n(77),l=n.n(o),c=n(78),u=n.n(c),p=n(79),d=n.n(p),b=n(139),f=n(95),v=n(137),m=n(149),y=n(1),h=n.n(y),g=n(2),_=n.n(g),O=function(e){function t(e){var n;return i()(this,t),(n=l()(this,u()(t).call(this,e))).handleOnToggle=function(e){n.setState({isOpen:e})},n.handleOnSelect=function(){n.setState({isOpen:!n.state.isOpen})},n.handleSelectPage=function(){var e=n.props,t=e.cves.data;(0,e.selectorHandler)(!0,t.filter(function(e){return e.id}).map(function(e){return e.id}))},n.handleSelectAll=function(){var e=n.props,t=e.cves.meta,a=e.selectorHandler,i=e.fetchResource,r=(i&&i({page_size:t.total_items,page:1})).payload;r&&r.then(function(e){var t=e.data.map(function(e){return e.id});a(!0,t)})},n.handleUnselectAll=function(){(0,n.props.selectorHandler)(!1,void 0)},n.handleOnCheckboxChange=function(){0===n.props.selectedItems?n.handleSelectAll():n.handleUnselectAll()},n.state={isOpen:!1},n}return d()(t,e),s()(t,[{key:"shouldComponentUpdate",value:function(e,t){return t.isOpen!==this.state.isOpen||e.selectedItems!==this.props.selectedItems}},{key:"render",value:function(){var e=this.props,t=e.selectedItems,n=e.cves,a=n.meta,i=n.data,r=this.state.isOpen,s=Boolean(t)&&"".concat(t," selected"),o=i.length/2,l=function(e){return e>1?"items":"item"},c=[_.a.createElement(b.a,{key:"none",onClick:this.handleUnselectAll},"Select none (0 items)"),_.a.createElement(b.a,{key:"page",onClick:this.handleSelectPage},"Select page (",o," ",l(o),")"),_.a.createElement(b.a,{key:"all",onClick:this.handleSelectAll},"Select all (",a.total_items," ",l(a.total_items),")")];return _.a.createElement(f.b,{onSelect:this.handleOnSelect,toggle:_.a.createElement(v.a,{splitButtonItems:[_.a.createElement(m.a,{key:"selectAllcheckbox",isChecked:a.total_items===t||0!==t&&null,onChange:this.handleOnCheckboxChange}),s],onToggle:this.handleOnToggle}),isOpen:r,dropdownItems:c})}}]),t}(g.Component);O.propTypes={selectedItems:h.a.number,selectorHandler:h.a.func,fetchResource:h.a.func,cves:h.a.object},t.a=O},691:function(e,t,n){"use strict";n.r(t);var a=n(108),i=n.n(a),r=n(128),s=n.n(r),o=n(351),l=n.n(o),c=n(75),u=n.n(c),p=n(76),d=n.n(p),b=n(77),f=n.n(b),v=n(78),m=n.n(v),y=n(79),h=n.n(y),g=n(207),_=n(64),O=n(12),w=n(353),E=n(73),j=n(1),S=n.n(j),k=n(2),C=n.n(k),P=n(72),x=n(123),D=n(346),I=n(364),V=n(357),R=n(352),T=n(126),L=n(179),N=n(180),A=n(576),M=n(399),B=n(387),H=n(361),F=n(402),U=n.n(F),Y=n(362),z=n(403),J=(n(415),n(413)),q=n(359),W=n.n(q),G=n(160),X=n(161),K=n(149),Q=n(371),Z=n(388),$=function(e){var t=e.cves,n=e.updateRef,a=e.inventoryId,i=Object(k.useState)(t),r=W()(i,1)[0],s=Object(Z.c)(r&&1===r.length&&r[0].status_id.toString()||"0"),o=s.StatusSelect,l=s.statusId,c=s.setProps,u=Object(Z.b)(r&&1===r.length&&r[0].justification||""),p=u.JustificationInput,d=u.justification,b=u.setProps,f=Object(k.useState)(!1),v=W()(f,2),m=v[0],y=v[1];var h={variant:"success",title:"Status updated for ".concat(r.length," CVEs")};return C.a.createElement(Z.a,{items:r,onSave:function(){var e=r.map(function(e){return e.id}),t=m?{cve:e,inventory_id:a}:{status_id:parseInt(l),cve:e,status_text:d,inventory_id:a};return Object(Q.l)(t).then(n)},onSuccessNotification:h,title:"Set status for this CVE and host pair"},C.a.createElement(L.a,{gutter:"md"},C.a.createElement(N.a,null,C.a.createElement(G.a,{key:"key"},C.a.createElement(X.a,{fieldId:"overall"},C.a.createElement(K.a,{label:"Use overall CVE status",id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:m,onChange:function(e){var t={isDisabled:e};y(e),c(t),b(t)}})),o,p))))};$.propTypes={cves:S.a.array,updateRef:S.a.func,inventoryId:S.a.string};var ee=$,te=n(124),ne=n.n(te),ae=n(366),ie=n.n(ae),re=n(360),se=n(393),oe=n(392),le=n(389),ce=n(380);function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(n,!0).forEach(function(t){l()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var de=function(e){function t(){var e,n,a;u()(this,t);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return f()(a,(n=a=f()(this,(e=m()(t)).call.apply(e,[this].concat(r))),a.noCves=function(){var e=a.props,t=e.entity,n=e.context.cves;return 0!==["filter","cvss_from","cvss_to","public_from","public_to","impact","status_id"].filter(function(e){return n.meta.hasOwnProperty(e)&&n.meta[e]}).length?R.e:t?R.d:0===n.data.length?R.c:void 0},a.handleOnSelect=function(e,t,n){var i=a.props.context,r=i.cves,s=i.methods,o=r.data[n]&&r.data[n].id;s.selectCves(t,o)},n))}return h()(t,e),d()(t,[{key:"handleOnCollapse",value:function(e,t,n){var a=this.props.context,i=a.cves,r=a.methods,s=i.data[t]&&i.data[t].id;r.openCves(n,s)}},{key:"render",value:function(){var e=this,t=this.props,n=t.context,a=t.header,i=n.params,r=n.cves,s=n.methods,o=i.selectedCves,l=i.openedCves,c=r.data.map(function(e){return o.has(e.id)&&pe({},e,{selected:!0})||e}).map(function(e){return l.has(e.id)&&pe({},e,{isOpen:!0})||e});return C.a.createElement(k.Fragment,null,r.isLoading?C.a.createElement(w.SkeletonTable,{colSize:2,rowSize:20}):C.a.createElement(k.Fragment,null,C.a.createElement(re.b,{"aria-label":"Vulnerability CVE table",onSelect:this.handleOnSelect,cells:a,rows:c,actions:Object(le.c)(s),sortBy:Object(Y.b)([{key:"collapse"},{key:"checkbox"}].concat(ie()(a)),r.meta.sort),onSort:function(e,t,n){return Object(Y.e)(t,n,[{key:"collapse"},{key:"checkbox"}].concat(ie()(a)),r.meta.sort,s.apply)},gridBreakPoint:"grid-lg",onCollapse:function(t,n,a){return e.handleOnCollapse(t,n,a)}},!r.isLoading&&0===r.data.length&&this.noCves()||C.a.createElement(k.Fragment,null,C.a.createElement(se.a,null),C.a.createElement(oe.a,null))),C.a.createElement(w.TableToolbar,null,C.a.createElement(ce.a,{variant:"bottom",meta:r.meta,apply:s.apply}))))}}]),t}(k.Component);de.propTypes={context:S.a.any,header:S.a.array,entity:S.a.object};var be=function(e){return C.a.createElement(Ce.Consumer,null,function(t){return C.a.createElement(de,ne()({context:t},e))})},fe=n(182),ve=n(181),me=n(418),ye=n(419),he=n(420),ge=n(421),_e=n(424),Oe=n(426);function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var Ee=function(e){function t(){return u()(this,t),f()(this,m()(t).apply(this,arguments))}return h()(t,e),d()(t,[{key:"render",value:function(){var e=this.props,t=e.showRemediationButton,n=e.entity,a=e.context,i=a.cves,r=a.params,s=a.methods,o=r.selectedCves,c=!0===this.props.showRemediationButton?o&&o.size||0:void 0,u=[R.o,R.q,R.n,R.p,R.s],p=[Object(ye.c)(s.showBusinessRiskModal,ie()(o).map(function(e){return{id:e,business_risk_id:"0"}}),{isDisabled:!c}),Object(ye.d)(s.showStatusModal,ie()(o).map(function(e){return{id:e,status_id:"0"}}),{isDisabled:!c}),Object(ye.b)(s.downloadReport),Object(ye.a)(s.downloadReport)];return C.a.createElement(C.a.Fragment,null,C.a.createElement(w.TableToolbar,{className:"space-between-toolbar-items"},C.a.createElement(fe.a,{className:"vulnerability-toolbar-spacing"},t&&C.a.createElement(Oe.a,{selectedItems:c,selectorHandler:s.selectCves,cves:i,fetchResource:function(e){return s.fetchResource(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(n,!0).forEach(function(t){l()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},r,{},e))}}),C.a.createElement(ge.a,{searchPlaceholder:"Find a CVE…",apply:s.apply,filterValues:r,filterCategories:u}),t&&C.a.createElement(_e.a,{systemId:n.id,selectedCves:o}),C.a.createElement(me.a,{dropdownItems:p})),C.a.createElement(fe.a,null,C.a.createElement(ce.a,{apply:s.apply,meta:i.meta}))),C.a.createElement(w.TableToolbar,{className:"pf-u-pt-0"},C.a.createElement(fe.a,null,C.a.createElement(ve.a,null,C.a.createElement(he.a,{filterValues:r,filterCategories:u,apply:s.apply})))))}}]),t}(k.Component);Ee.propTypes={showRemediationButton:S.a.bool,entity:S.a.object,context:S.a.object},Ee.defaultProps={showRemediationButton:!1,totalNumber:0,apply:function(){},downloadReport:function(){}};var je=function(e){return C.a.createElement(Ce.Consumer,null,function(t){return C.a.createElement(Ee,ne()({context:t},e))})};function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(n,!0).forEach(function(t){l()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ce=C.a.createContext({}),Pe=[{title:"Name",key:"synopsis",transforms:[A.a,Object(M.b)("col-width-10")],columnTransforms:[Object(M.b)("no-wrap")],cellFormatters:[B.b]},{title:"Publish date",key:"public_date",transforms:[A.a,Object(M.b)("col-width-10")]},{title:"CVSS base ",key:"cvss_score",transforms:[A.a,Object(M.b)("col-width-10")]},{title:"Impact",key:"impact",transforms:[A.a,Object(M.b)("col-width-10")],columnTransforms:[Object(M.b)("no-wrap")]},{title:"Business risk",key:"business_risk",transforms:[A.a,Object(M.b)("col-width-10")]},{title:"Status",key:"status",transforms:[A.a,Object(M.b)("col-width-10")]}],xe=function(e){function t(e){var n;return u()(this,t),(n=f()(this,m()(t).call(this,e))).processError=function(e){var t=e.status;return 404===parseInt(t)&&n.props.entity?R.g:R.f},n.apply=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.hasOwnProperty("cvss_filter")){var t=R.a.find(function(t){return t.value===e.cvss_filter});if(void 0===t&&void 0!==e.cvss_filter){var a=e.cvss_filter.split(/[^0-9]+/).filter(function(e){return parseFloat(e)});t={from:a[0],to:a[1]}}else void 0===t&&void 0===e.cvss_filter&&(t={from:void 0,to:void 0});e.cvss_from=t.from,e.cvss_to=t.to}if(e.hasOwnProperty("publish_date")){var i=R.i.find(function(t){return t.value===e.publish_date});void 0!==i?(e.public_from=i.from&&i.from.format("YYYY-MM-DD"),e.public_to=i.to&&i.to.format("YYYY-MM-DD")):(e.public_from=void 0,e.public_to=void 0,e.publish_date=void 0)}n.setState(ke({},n.state,{},e),n.sendRequest)},n.selectCves=function(e,t){var a=n.state.selectedCves;a=t?Object(Y.f)(a,t,e):new Set,n.setState(ke({},n.state,{selectedCves:new Set(a)}))},n.openCves=function(e,t){var a=n.state.openedCves;a=t?Object(Y.f)(a,t,e):new Set,n.setState(ke({},n.state,{openedCves:new Set(a)}))},n.createUrlParams=function(e){var t=ke({},e),a=["cvss_filter","publish_date","filter","limit","offset","page","page_size","sort","impact","business_risk_id"];Object.keys(e).forEach(function(e){return(void 0===t[e]||""===t[e]||!a.includes(e)||!1===t[e])&&delete t[e]});var i=U.a.stringify(t);n.props.history.push("?"+i)},n.sendRequest=function(){var e=n.props,t=e.fetchData,a=e.entity;t&&t(ke({},n.state,{system:a.id})),n.createUrlParams(n.state)},n.downloadReport=function(e){var t=ke({},n.state),a=Object(V.f)(ke({},t,{page_size:Number.MAX_SAFE_INTEGER,data_format:e,page:1})).payload;a&&a.then(function(t){var n=t.data,a="json"===e?JSON.stringify(n):n;return Object(H.downloadFile)(a,"vulnerability_cves-".concat((new Date).toISOString()),e)})},n.showBusinessRiskModal=function(e){n.setState({BusinessRiskModal:function(){return C.a.createElement(J.a,{open:!0,cves:e,updateRef:n.apply})}})},n.showStatusModal=function(e){n.setState({StatusModal:function(){return C.a.createElement(ee,{cves:e,updateRef:n.apply,inventoryId:n.props.entity&&n.props.entity.id})}})},n.state={selectedCves:new Set,openedCves:new Set,BusinessRiskModal:function(){return null},StatusModal:function(){return null}},n}return h()(t,e),d()(t,[{key:"componentDidMount",value:function(){var e=U.a.parse(this.props.location.search);this.apply(ke({},{sort:"-public_date"},{},e))}},{key:"render",value:function(){var e=this.props,t=e.cveList,n=e.entity,a=this.apply,i=this.downloadReport,r=this.selectCves,s=this.openCves,o=this.showBusinessRiskModal,l=this.showStatusModal,c=this.state,u=c.BusinessRiskModal,p=c.StatusModal,d=t,b=d.errors;return b?this.processError(b):C.a.createElement(Ce.Provider,{value:{cves:d,params:this.state,methods:{apply:a,downloadReport:i,selectCves:r,openCves:s,showBusinessRiskModal:o,showStatusModal:l,fetchResource:function(e){return Object(V.f)(ke({},e,{system:n.id}))}}}},C.a.createElement(p,null),C.a.createElement(u,null),C.a.createElement(L.a,null,C.a.createElement(N.a,null,C.a.createElement(je,{showRemediationButton:!0,entity:n})),C.a.createElement(N.a,null,C.a.createElement(be,{header:Pe,entity:n}))))}}]),t}(k.Component);xe.propTypes={entity:S.a.object,cveList:S.a.any,fetchData:S.a.func,history:S.a.object,location:S.a.object};var De=Object(D.a)(Object(P.connect)(function(e){var t=e.SystemCvesStore,n=e.entityDetails.entity;return{cveList:t&&Object(z.b)(n.id,t.cveList),entity:n}},function(e){return{fetchData:function(t){return e(Object(V.f)(t))}}})(xe)),Ie=function(e){function t(e){return u()(this,t),f()(this,m()(t).call(this,e))}return h()(t,e),d()(t,[{key:"render",value:function(){var e=this.props,t=e.entity,n=e.isOptOut,a=e.optOutSystemHandler;return this.props.setHeader({breadcrumbs:[{title:T.b.vulnerabilities.title,to:T.b.vulnerabilities.to},{title:T.b.systems.title,to:T.b.systems.to},{title:t&&t.display_name||"Invalid System",isActive:!0}]}),t?n?C.a.createElement(C.a.Fragment,null,C.a.createElement(R.l,{buttonAction:function(){return a(!1)}})):C.a.createElement(C.a.Fragment,null,C.a.createElement(De,{entity:t.id})):C.a.createElement(w.InvalidObject,null)}}]),t}(C.a.Component);Ie.propTypes={setHeader:S.a.func,entity:S.a.object,isOptOut:S.a.bool,optOutSystemHandler:S.a.func};var Ve=Object(D.a)(Object(P.connect)(function(e){var t=e.entityDetails;return{entity:t.entity,isOptOut:t.opt_out}},function(){return{setHeader:function(e){return Object(I.a)(Object(V.m)(e))}}})(Ie)),Re=n(365);function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(n,!0).forEach(function(t){l()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ne={loaded:!1},Ae=function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ne,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case Re.i+"_FULFILLED":return Le({},n,{},a.payload.data);case e.LOAD_ENTITY_FULFILLED:return Le({},n,{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return C.a.createElement(Ve,{optOutSystemHandler:t})}}]});case e.LOAD_ENTITY_REJECTED:return Le({},n,{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return C.a.createElement(Ve,null)}}]});default:return n}}},Me=n(80),Be=n(385);function He(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?He(n,!0).forEach(function(t){l()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):He(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ue=function(e){function t(e){var n;return u()(this,t),(n=f()(this,m()(t).call(this,e))).checkItem=function(e,t){var a=n.state.systemList;a[e].selected=t,n.setState({systemList:a})},n.toggleLinkHover=function(e){n.setState(Fe({},n.state,{linkHovered:e}))},n.optOutSystem=function(e){n.props.optOutSystem(n.state.inventoryId,e).then(function(){n.props.fetchSystemDetails(n.state.inventoryId),!0===e?n.props.addNotification({variant:"success",title:"System successfully excluded from vulnerability analysis"}):n.props.addNotification({variant:"success",title:"System successfully resumed vulnerability analysis",description:"There may be 24 hours before data is available"})})},n.state={inventoryId:n.props.match.params.inventoryId,removeListener:function(){},linkHovered:!1},n}var n;return h()(t,e),d()(t,[{key:"componentDidMount",value:function(){this.props.fetchSystemDetails(this.state.inventoryId),this.fetchInventory()}},{key:"fetchInventory",value:(n=s()(i.a.mark(function e(){var t,n,a,r,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,insights.loadInventory({react:C.a,reactRouterDom:x,reactCore:g,reactIcons:O});case 2:t=e.sent,n=t.inventoryConnector,a=t.mergeWithEntities,r=t.mergeWithDetail,s=t.INVENTORY_ACTION_TYPES,Me.a.register(Fe({},a(),{},r(Ae(s,this.optOutSystem)))),this.setState({InventoryHeader:n().InventoryDetailHead,InventoryBody:n().AppInfo}),this.state.removeListener();case 10:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,n=t.InventoryHeader,a=t.InventoryBody,i=this.props.systemDetails,r=void 0===i?{}:i,s=r.opt_out,o=void 0!==s&&s,l=r.entity;return C.a.createElement(_.a,null,C.a.createElement(Be.a,{title:"",showTabs:!1},n&&C.a.createElement(n,{hideBack:!0,actions:l&&[o?{title:"Resume vulnerability analysis",onClick:function(){return e.optOutSystem(!1)}}:{title:"Exclude from vulnerability analysis",onClick:function(){return e.optOutSystem(!0)}}]})),a&&C.a.createElement(w.Main,null,C.a.createElement(C.a.Fragment,null,C.a.createElement(a,{optOutSystemHandler:this.optOutSystem}))))}}]),t}(C.a.Component);Ue.propTypes={fetchSystemDetails:S.a.func,systemDetails:S.a.object,optOutSystem:S.a.func,match:S.a.object,addNotification:S.a.func};t.default=Object(D.a)(Object(P.connect)(function(e){return{systemDetails:e.entityDetails}},function(){return{optOutSystem:function(e,t){return Object(I.a)(Object(V.j)(e,t))},fetchSystemDetails:function(e){return Object(I.a)(Object(V.g)(e))},addNotification:function(e){return Object(I.a)(Object(E.addNotification)(e))}}})(Ue))}}]);
//# sourceMappingURL=../sourcemaps/InventoryDetail.js.map