"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[5514],{67463:(e,t,n)=>{t.S3=void 0;const i=n(70655);i.__importStar(n(77865)),i.__importDefault(n(62698)),n(38296);var a;(a=t.S3||(t.S3={})).sm="sm",a.md="md",a.lg="lg",a.xl="xl"},63368:(e,t,n)=>{n.d(t,{Z:()=>o});var i=n(83237),a=n(78733),r=n(32132),s=n(30893);const o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.remediation,o=function(t){e({remediation:t.length>"0"&&t.filter((function(e){return","!==e})).join(",")||"",page:1})};return{label:r.N.formatMessage(s.Z.filterRemediation),type:i.Y.checkbox,urlParam:"remediation",key:"remediation",filterValues:{onChange:function(e,t){o(t)},items:a.Iv.map((function(e){return{label:e.label,value:e.value}})),value:n?n.split(","):[]}}}},66516:(e,t,n)=>{n.d(t,{Z:()=>j});var i=n(29439),a=n(93149),r=n(83115),s=n(59775),o=n(49739),l=n(83826),u=n(41448),c=n(79851),d=n(75824),v=n(34512),f=n(91290),m=n(45697),p=n.n(m),y=n(77865),_=n.n(y),g=n(71478),b=n(91709),h=n(74806),E=n(30893),S=function(e){var t,n=e.cveList,m=e.updateRef,p=e.inventoryList,h=e.intl,S=e.type,j=(0,b.fj)(A()),Z=j.JustificationInput,k=j.justification,x=j.setJustification,O=j.setProps,P=(0,y.useState)(function(){switch(S){case"systemsExposed":if(p.every((function(e){var t,i;return e.status_id===(null===(t=n[0])||void 0===t?void 0:t.status_id)&&e.justification===(null===(i=n[0])||void 0===i?void 0:i.justification)})))return!0;break;case"systemDetail":var e=n.every((function(e,t,n){var i,a;return e.status_id===(null===(i=n[0])||void 0===i?void 0:i.status_id)&&e.justification===(null===(a=n[0])||void 0===a?void 0:a.justification)})),t=n.every((function(e){return e.status_id===e.cve_status_id&&e.justification===e.cve_justification}));if(e&&t)return!0}return!1}()),N=(0,i.Z)(P,2),M=N[0],w=N[1],C=(0,b.Hb)(J()),I=C.StatusSelect,D=C.statusId,R=C.setStatusId,T=C.setProps,U=p.map((function(e){return e.id||e.inventory_id})),L=p.map((function(e){return e.display_name}));function J(){switch(S){case"systemsExposed":return M?n[0].status_id:p.every((function(e,t,n){return e.status_id===n[0].status_id}))?null===(e=p[0])||void 0===e?void 0:e.status_id:"0";var e;case"systemDetail":var t,i;return M?n.every((function(e,t,n){return e.cve_status_id===n[0].cve_status_id}))?null===(t=n[0])||void 0===t?void 0:t.cve_status_id:"0":n.every((function(e,t,n){return e.status_id===n[0].status_id}))?null===(i=n[0])||void 0===i?void 0:i.status_id:"0"}}function A(){switch(S){case"systemsExposed":return M?n[0].justification:p.every((function(e,t,n){var i;return e.justification===(null===(i=n[0])||void 0===i?void 0:i.justification)}))&&(null===(e=p[0])||void 0===e?void 0:e.justification)||"";var e;case"systemDetail":var t,i;return M?n.every((function(e,t,n){var i;return e.cve_justification===(null===(i=n[0])||void 0===i?void 0:i.cve_justification)}))&&(null===(t=n[0])||void 0===t?void 0:t.cve_justification)||"":n.every((function(e,t,n){var i;return e.justification===(null===(i=n[0])||void 0===i?void 0:i.justification)}))&&(null===(i=n[0])||void 0===i?void 0:i.justification)||""}}(0,y.useEffect)((function(){T({isDisabled:M,ouiaId:"status-select"}),O({disabled:M}),R(J()),x(A())}),[M,T,O]);var B={variant:"success",title:"systemsExposed"===S?h.formatMessage(E.Z.notificationSystemStatusUpdateSuccessful,{count:p.length||0,systemName:L[0]}):h.formatMessage(E.Z.notificationStatusUpdateSuccessful,{count:n.length||0})},F={variant:"danger",autoDismiss:!1,title:h.formatMessage(E.Z.notificationStatusUpdateFailureTitle),description:h.formatMessage(E.Z.notificationStatusUpdateFailureBody)},z=h.formatMessage(E.Z.cvePairStatusModalTitle,{count:U.length*n.length});return _().createElement(b.ZP,{items:n,onSave:function(){var e=n.map((function(e){return e.id})),t=M?{cve:e,inventory_id:U}:{status_id:parseInt(D),cve:e,status_text:k,inventory_id:U};return(0,g.cr)(t).then(m)},onSuccessNotification:B,onFailureNotification:F,title:z,ouiaId:"status-modal"},_().createElement(o.K,{hasGutter:!0},function(){switch(S){case"systemsExposed":return p.some((function(e,t,n){var i;return e.status_id!==(null===(i=n[0])||void 0===i?void 0:i.status_id)}));case"systemDetail":return n.some((function(e,t,n){var i;return e.status_id!==(null===(i=n[0])||void 0===i?void 0:i.status_id)}))}}()&&_().createElement(l.v,null,_().createElement(u.b,{variant:"warning",isInline:!0,title:h.formatMessage(E.Z.cvePairStatusModalAlert)})),_().createElement(l.v,null,h.formatMessage(E.Z.cvePairStatusModalSelected,{cveCount:n.length||0,cveId:null===(t=n[0])||void 0===t?void 0:t.id,systemCount:p.length||0,systemName:L[0],b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return _().createElement("b",null,t)}})),_().createElement(l.v,null,_().createElement(r.l,{key:"key"},_().createElement(s.c,{fieldId:"overall"},_().createElement(c.P,null,_().createElement(v.J,null,_().createElement(a.X,{label:h.formatMessage(E.Z.cvePairStatusModalUseOverallCheckbox),id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:M,onChange:function(e){return w(e)}})),_().createElement(v.J,null,_().createElement(d.u,{content:h.formatMessage(E.Z.cvePairStatusModalUseOverallTooltip)},_().createElement(f.ZP,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)",style:{verticalAlign:"0"}}))))),I,Z))))};S.propTypes={cveList:p().array,updateRef:p().func,inventoryList:p().array,intl:p().any,type:p().oneOf(["systemsExposed","systemDetail"])};const j=(0,h.ZP)(S)},7092:(e,t,n)=>{n.d(t,{Z:()=>Z});var i=n(93433),a=n(29439),r=n(77865),s=n.n(r),o=n(45697),l=n.n(o),u=n(83215),c=n(86706),d=n(30893),v=n(44012),f=n(29648),m=n(2372),p=n(67463),y=n(54025),_=n(14938),g=n(94184),b=n.n(g),h=function(){return h=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},h.apply(this,arguments)},E=function(e){var t=e.appName,n=e.scope,i=e.module,a=e.fallback,r=void 0===a?s().createElement(_.Bullseye,null,s().createElement(_.Spinner,{size:"xl"})):a,o=e.innerRef,l=e.className,u=e.component,c=void 0===u?"section":u,d=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]])}return n}(e,["appName","scope","module","fallback","innerRef","className","component"]);return s().createElement(c,{className:b()(l,t)},s().createElement(y.ScalprumComponent,h({className:l,appName:t,module:i,scope:null!=n?n:t,ErrorComponent:r,ref:o,fallback:r},d)))};const S=s().forwardRef((function(e,t){return s().createElement(E,h({innerRef:t},e))}));var j=function(e){var t=e.cves,n=e.systems,r=e.manyRules,o=e.isDisabled,l=(0,c.I0)(),y=function(e,t){return{id:"vulnerabilities:".concat(e),description:e,systems:[t]}};return s().createElement(S,{appName:"remediations",module:"./RemediationButton",fallback:s().createElement(m.$,{size:p.S3.lg}),isDisabled:o,dataProvider:function(){return function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[].concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]),r=[].concat(e),s=[];if(t&&1===n.length){var o=(0,a.Z)(n,1)[0];s=r.reduce((function(e,t){var n,a=t.id,r=t.rule,s=y(o.id,a);return r&&(s.id="".concat(s.id,":").concat(null==r||null===(n=r.rule)||void 0===n?void 0:n.rule_id)),[].concat((0,i.Z)(e),[s])}),[]),s=(0,f.X8)(s,"systems")}if(!t&&1===(null==r?void 0:r.length)){var l=(0,a.Z)(r,1)[0];s=n.reduce((function(e,t){var n=t.id,a=t.attributes.rule,r=y(n,l);return null!=a&&a.rule_id&&(r.id="".concat(r.id,":").concat(a.rule_id)),[].concat((0,i.Z)(e),[r])}),[])}return!(!n.length||!r.length)&&{issues:s}}(t,n,r)},onRemediationCreated:function(e){return l((0,u.wN)(e.getNotification()))}},s().createElement(v.Z,d.Z.remediateLabel))};j.propTypes={cves:l().oneOfType([l().array,l().string]),systems:l().oneOfType([l().array,l().string]),manyRules:l().bool,isDisabled:l().bool};const Z=j}}]);
//# sourceMappingURL=../sourcemaps/5514.fd34ffe8caf3a314373491fe5911c455.js.map