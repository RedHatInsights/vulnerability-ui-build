(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[743],{75584:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ne});var n=r(28481),o=r(96156),a=r(81253),s=r(77865),c=r.n(s),i=r(45697),l=r.n(i),u=r(74806),f=r(30893),p=r(37703),d=r(85061),m=r(5977),b=r(29648),g=r(64196),y=r(83296),v=r(93400),h=r(49629),O=r(95351),P=r(15248),Z=r(62215),S=r(22122),j=r(92137),E=r(87757),w=r.n(E),_=r(86896),D=r(58141),k=r(45243),x=r(43198),C=r(62598),M=r(6208),N=r(37450);function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var I=function(e){var t=e.filters,r=e.params,o=e.reportData,i=void 0===o?{}:o,l=e.buttonProps,u=e.label,p=(0,a.Z)(e,["filters","params","reportData","buttonProps","label"]),m=(0,_.Z)(),g=(0,s.useState)(!1),y=(0,n.Z)(g,2),v=y[0],h=y[1],O=(0,N.l)(),P=function(e){return(0,b.F3)(e,M.tp.systemsReportRestPages)},E=function(){var e=(0,j.Z)(w().mark((function e(){var n,o,a,s,c;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),O({msg:m.formatMessage(f.Z.customReportNotificationSystem)}),e.next=4,(0,k.vk)(F(F({},r),Z.Z.defaultParams));case 4:return n=e.sent,o=n.data,a=n.meta,s=(0,x.Z)({data:o.splice(0,M.tp.systemsReportFirstPage),meta:a,filters:t,intl:m}),c=P(o),h(!1),e.abrupt("return",[s].concat((0,d.Z)(c.map((function(e,t){return(0,C.Z)({data:e,page:t,intl:m,header:i&&i.header})})))));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c().createElement("div",null,c().createElement(D.o6,(0,S.Z)({},p,{label:v?m.formatMessage(f.Z.loading):m.formatMessage(u),asyncFunction:E,buttonProps:F({component:"button"},l),reportName:m.formatMessage(f.Z.systemPDFReportName),type:"",fileName:"".concat(Z.Z.filename("system-list"),".pdf"),allPagesHaveTitle:!1,size:"A4",orientation:"landscape"})))};I.defaultProps={label:f.Z.kebabExportAsPDF},I.propTypes={filters:l().oneOfType([l().array,l().object]),params:l().object,reportData:l().object,buttonProps:l().object,label:l().oneOfType([l().array,l().object])};const H=I;var T=r(65538),B=r(89421),A=r(32132);const L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.excluded,n=function(t){var r=[!1,!1];t.forEach((function(e){r[e]=!0}));var n=r.join(",");e({excluded:"false,false"===n?"":n,page:1})};return{label:A.N.formatMessage(f.Z.filterSystemsIncludedInAnalysis),type:B.Yu.checkbox,urlParam:"excluded",filterValues:{onChange:function(e,t){n(t)},items:M._9.map((function(e){return{label:e.label,value:e.value}})),value:null==r?void 0:r.split(",").flatMap((function(e,t){return"true"===(null==e?void 0:e.toLowerCase())?t.toString():[]}))}}};function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var K=function(e){var t=e.selectedHosts,r=e.intl,o=e.parameters,a=e.systems,i=e.methods,l=(0,s.useState)(!1),u=(0,n.Z)(l,2),p=u[0],m=u[1],b=i.apply,S=i.handleSelect,j=i.doOptOut;y.N.addNew({on:"SELECT_ENTITY",callback:function(e){return function(e){var r=e.data.selected?[e.data.id].concat((0,d.Z)(t)):t.filter((function(t){return t!==e.data.id}));S(!1,r)}(e)}});var E=(0,s.useMemo)((function(){var e=null==a?void 0:a.data.filter((function(e){return t.includes(e.id)}));return{selectedExcluded:e.some((function(e){return!0===e.attributes.opt_out})),selectedIncluded:e.some((function(e){return!1===e.attributes.opt_out}))}}),[t,a]),w=["",{label:r.formatMessage(f.Z.systemKebabExcludeAnalysis,{count:t.length||0}),onClick:function(){return j(null,!0)},props:{isDisabled:!t.length||!E.selectedIncluded}},{label:r.formatMessage(f.Z.systemKebabIncludeAnalysis,{count:t.length||0}),onClick:function(){return j(null,!1)},props:{isDisabled:!t.length||!E.selectedExcluded}}],_=(0,v.Z)({selectedItems:t,selectorHandler:S,items:a,fetchResource:function(e){return(0,g.ip)(V(V({},o),e))}});return c().createElement(s.Fragment,null,c().createElement(h.Z,{id:"vuln-systems-primary-toolbar",bulkSelect:{count:t.length,items:_.items,isDisabled:0===a.meta.total_items&&0===t.length,checked:Boolean(t.length),ouiaId:"bulk-select",onSelect:function(){return _.handleOnCheckboxChange()}},actionsConfig:{actions:w,dropdownProps:{ouiaId:"toolbar-actions"}},filterConfig:{items:[(0,O.Z)("filter",f.Z.systemsSearchName,f.Z.searchFilterByName,o.filter,b),L(b,o)]},activeFiltersConfig:{filters:(0,P.DU)(o),onDelete:function(e,t){return(0,P.vH)(t,b)}},exportConfig:V({isDisabled:0===a.meta.total_items,extraItems:[(0,T.Ec)(p,m)],ouiaId:"export"},(0,P.HV)({downloadReport:function(e){var t=V({},o);Z.Z.exec(g.lc,t,e,"system-list")}}))}),p&&c().createElement(H,{showButton:!1,params:o,filters:(0,P.DU)(o),onSuccess:function(){return m(!1)}}))};K.propTypes={systems:b.nE,parameters:l().object,selectedHosts:l().array,methods:l().shape({doOptOut:l().func,apply:l().func,handleSelect:l().func}),intl:l().any};const U=(0,m.EN)((0,u.ZP)(K));var W=r(86350),Y=r(99385),$=r(23320),q=r(57998),G=r(33739),J=r(66123),Q=r(75863),X=r(12140);function ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var re=function(e){var t=e.intl,r=(0,s.useState)(void 0),o=(0,n.Z)(r,2),i=o[0],l=o[1],u=(0,b.H1)(M.IV),d=(0,n.Z)(u,2),m=d[0],v=d[1],h=(0,s.useState)(!0),O=(0,n.Z)(h,2),P=O[0],Z=O[1],S=(0,N.l)({variant:"success"}),j=c().createRef(),E=(0,p.useDispatch)(),w=(0,p.useSelector)((function(e){return e.SystemsPageStore.payload})),_=(0,p.useSelector)((function(e){return e.SystemsPageStore.params}),p.shallowEqual),D=(0,p.useSelector)((function(e){return e.SystemsPageStore.metadata})),k=(0,p.useSelector)((function(e){return e.SystemsPageStore.error})),x=k.hasError,C=k.errorCode,R=(0,p.useSelector)((function(e){return e.SystemsPageStore.isLoading})),F=(0,s.useMemo)((function(){return(null==(e=w.data)?void 0:e.map((function(e){var t=e.attributes,r=t.cve_count,n=(0,a.Z)(t,["cve_count"]);return te({cve_count:r,id:e.attributes.inventory_id},n)})))||[];var e}),[w]);(0,s.useEffect)((function(){return function(){E((0,g.re)()),E((0,g.r5)())}}),[E]),(0,s.useEffect)((function(){i&&E((0,g.lA)(i))}),[i,E]);var I=function(e){E((0,g.SF)(e))};(0,s.useEffect)((function(){I(m),Z(!1)}),[]),(0,X.Z)((function(){P||(v(te({},_)),E((0,g.lc)(_)))}),[_,P]);var H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0;(i&&i.length>0||e)&&E((0,g.R0)(e||i,r)).then((function(){E((0,g.lc)(te(te({},_),{},{page:1})));var n=e?1:i.length||0;S(r?{msg:t.formatMessage(f.Z.systemsExcludedNotification,{count:n})}:{msg:t.formatMessage(f.Z.systemsResumedNotificationTitle,{count:n}),description:t.formatMessage(f.Z.systemsResumedNotificationBody)}),l([])}))};return c().createElement(s.Fragment,null,c().createElement($.Z,{title:t.formatMessage(f.Z.systemsHeader),showBreadcrumb:!1}),c().createElement(W.Z,null,c().createElement(s.Fragment,null,x?c().createElement(J.Z,{code:C}):c().createElement(G.Z,{onLoad:function(e){var t=e.mergeWithEntities,r=e.mergeWithDetail;y.Z.register(te(te({},t((0,q.K)(M.Bi))),r()))},tableProps:{isStickyHeader:!0,canSelectAll:!1,onSort:F.length>0&&function(e,t,r){return(0,b.L6)(t,r,M.d$,m.sort,I)},sortBy:F.length>0&&(0,b.hO)(M.d$,D.sort),actionResolver:function(e){return(0,Y.zs)(e,H)},variant:Q.B.compact},showTags:!0,isFullView:!0,ref:j,items:F,page:D&&D.page||1,perPage:D&&D.page_size||20,total:D&&D.total_items||0,onRefresh:function(e){var t=e.page,r=e.per_page;D.page===t&&D.limit===r||I({page:t,page_size:r}),D&&D.total_items<=r&&j.current&&j.current.onRefreshData({page:t,page_size:r})},isLoaded:!R,hasCheckbox:0!==w.length},w.data&&c().createElement(U,{parameters:_,systems:w,selectedHosts:i||[],methods:{doOptOut:H,apply:I,handleSelect:function(e,t){t||(t=[]),l(t)},setSelectedHosts:l},actions:!0})))))};re.propTypes={intl:l().any};const ne=(0,u.ZP)(re)}}]);
//# sourceMappingURL=../sourcemaps/Systems.7d72bff04b6147cc311a.js.map