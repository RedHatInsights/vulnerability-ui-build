(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[743],{75584:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>se});var n=r(81253),o=r(92137),a=r(28481),s=r(85061),i=r(96156),c=r(99809),l=r(87757),u=r.n(l),p=r(77865),f=r.n(p),d=r(86896),m=r(30893),b=r(14494),g=r(45697),y=r.n(g),h=r(74806),v=r(5977),O=r(29648),P=r(9048),Z=r(83296),j=r(93400),w=r(49629),E=r(95351),S=r(15248),D=r(62215),_=r(22122),k=r(3968),x=r(71478),C=r(43198),N=r(62598),F=r(6208),M=r(37450),R=["filters","params","reportData","buttonProps","label"];function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var I=function(e){var t=e.filters,r=e.params,i=e.reportData,c=void 0===i?{}:i,l=e.buttonProps,b=e.label,g=(0,n.Z)(e,R),y=(0,d.Z)(),h=(0,p.useState)(!1),v=(0,a.Z)(h,2),P=v[0],Z=v[1],j=(0,M.l)(),w=function(e){return(0,O.F3)(e,F.tp.systemsReportRestPages)},E=function(){var e=(0,o.Z)(u().mark((function e(){var n,o,a,i,l;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Z(!0),j({msg:y.formatMessage(m.Z.customReportNotificationSystem)}),e.next=4,(0,x.vk)(B(B({},r),D.Z.defaultParams));case 4:return n=e.sent,o=n.data,a=n.meta,i=(0,C.Z)({data:o.splice(0,F.tp.systemsReportFirstPage),meta:a,filters:t,intl:y}),l=w(o),Z(!1),e.abrupt("return",[i].concat((0,s.Z)(l.map((function(e,t){return(0,N.Z)({data:e,page:t,intl:y,header:c&&c.header})})))));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return f().createElement("div",null,f().createElement(k.o6,(0,_.Z)({},g,{label:P?y.formatMessage(m.Z.loading):y.formatMessage(b),asyncFunction:E,buttonProps:B({component:"button"},l),reportName:y.formatMessage(m.Z.systemPDFReportName),type:"",fileName:"".concat(D.Z.filename("system-list"),".pdf"),allPagesHaveTitle:!1,size:"A4",orientation:"landscape"})))};I.defaultProps={label:m.Z.kebabExportAsPDF},I.propTypes={filters:y().oneOfType([y().array,y().object]),params:y().object,reportData:y().object,buttonProps:y().object,label:y().oneOfType([y().array,y().object])};const H=I;var A=r(19281),z=r(89421),V=r(32132);const K=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.excluded,n=function(t){e({excluded:t.length>0?null==t?void 0:t.join(","):void 0,page:1})};return{label:V.N.formatMessage(m.Z.filterSystemsIncludedInAnalysis),type:z.Yu.checkbox,urlParam:"excluded",filterValues:{onChange:function(e,t){n(t)},items:F._9.map((function(e){return{label:e.label,value:e.value}})),value:(null==r?void 0:r.length)>0?null==r?void 0:r.split(","):void 0}}};function Y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var L=function(e){var t=e.selectedHosts,r=e.intl,n=e.parameters,o=e.systems,i=e.methods,c=(0,p.useState)(!1),l=(0,a.Z)(c,2),u=l[0],d=l[1],b=i.apply,g=i.handleSelect,y=i.doOptOut;Z.N.addNew({on:"SELECT_ENTITY",callback:function(e){return function(e){var r=e.data.selected?[e.data.id].concat((0,s.Z)(t)):t.filter((function(t){return t!==e.data.id}));g(!1,r)}(e)}});var h=(0,p.useMemo)((function(){var e=null==o?void 0:o.data.filter((function(e){return t.includes(e.id)}));return{selectedExcluded:e.some((function(e){return!0===e.attributes.opt_out})),selectedIncluded:e.some((function(e){return!1===e.attributes.opt_out}))}}),[t,o]),v=["",{label:r.formatMessage(m.Z.systemKebabExcludeAnalysis,{count:t.length||0}),onClick:function(){return y(null,!0)},props:{isDisabled:!t.length||!h.selectedIncluded}},{label:r.formatMessage(m.Z.systemKebabIncludeAnalysis,{count:t.length||0}),onClick:function(){return y(null,!1)},props:{isDisabled:!t.length||!h.selectedExcluded}}],O=(0,j.Z)({selectedItems:t,selectorHandler:g,items:o,fetchResource:function(e){return(0,P.ip)(q(q({},n),e))}});return f().createElement(p.Fragment,null,f().createElement(w.Z,{className:"vuln-systems-primary-toolbar",bulkSelect:{count:t.length,items:O.items,isDisabled:0===o.meta.total_items&&0===t.length,checked:Boolean(t.length),ouiaId:"bulk-select",onSelect:function(){return O.handleOnCheckboxChange()}},actionsConfig:{actions:v,kebabToggleProps:{isDisabled:!t.length||0===o.meta.total_items},dropdownProps:{ouiaId:"toolbar-actions"}},filterConfig:{items:[(0,E.Z)("filter",m.Z.systemsSearchName,m.Z.searchFilterByName,n.filter,b),K(b,n)]},activeFiltersConfig:{filters:(0,S.DU)(n),onDelete:function(e,t,r){return(0,S.vH)(t,i.apply,r,F.Sy)},deleteTitle:r.formatMessage(m.Z.resetFilters),showDeleteButton:!(0,S.Yy)(n,F.Sy,F.D2)},exportConfig:q({isDisabled:0===o.meta.total_items,extraItems:[(0,A.Ec)(u,d)],ouiaId:"export"},(0,S.HV)({downloadReport:function(e){var t=q({},n);D.Z.exec(P.lc,t,e,"system-list")}}))}),u&&f().createElement(H,{showButton:!1,params:n,filters:(0,S.DU)(n),onSuccess:function(){return d(!1)}}))};L.propTypes={systems:O.nE,parameters:y().object,selectedHosts:y().array,methods:y().shape({doOptOut:y().func,apply:y().func,handleSelect:y().func}),intl:y().any};const U=(0,v.EN)((0,h.ZP)(L));var W=r(86350),G=r(99385),J=r(23320),Q=r(15768),X=r(33739),$=r(66123),ee=r(14112),te=r(75863),re=r(12140),ne=["vulnerabilityParams","orderBy","orderDirection"];function oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const se=function(){var e=(0,d.Z)(),t=(0,p.useState)(void 0),r=(0,a.Z)(t,2),i=r[0],l=r[1],g=(0,O.H1)(F.IV),y=(0,a.Z)(g,2),h=y[0],v=y[1],j=(0,p.useState)(!0),w=(0,a.Z)(j,2),E=w[0],S=w[1],D=(0,M.l)({variant:"success"}),_=f().createRef(),k=(0,b.useDispatch)(),C=(0,b.useSelector)((function(e){var t=e.entities;return(null==t?void 0:t.rows)||[]}),b.shallowEqual),N=(0,b.useSelector)((function(e){var t=e.entities;return null==t?void 0:t.total})),R=(0,b.useSelector)((function(e){return e.SystemsPageStore.params}),b.shallowEqual),T=(0,b.useSelector)((function(e){return e.SystemsPageStore.error})),B=T.hasError,I=T.errorCode;(0,p.useEffect)((function(){return function(){k((0,P.re)()),k((0,P.r5)())}}),[k]),(0,p.useEffect)((function(){i&&k((0,P.lA)(i))}),[i,k]);var H=function(e){k((0,P.SF)(e))};(0,p.useEffect)((function(){H(h),S(!1)}),[]),(0,re.Z)((function(){E||v(ae({},R))}),[R,E]);var A=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0;(i&&i.length>0||t)&&k((0,P.R0)(t||i,r)).then((function(){_.current.onRefreshData({page:1});var n=t?1:i.length||0;D(r?{msg:e.formatMessage(m.Z.systemsExcludedNotification,{count:n})}:{msg:e.formatMessage(m.Z.systemsResumedNotificationTitle,{count:n}),description:e.formatMessage(m.Z.systemsResumedNotificationBody)}),l([])}))},z=(0,p.useMemo)((function(){return z?z++:0}),[]);return f().createElement(p.Fragment,null,f().createElement(J.Z,{title:e.formatMessage(m.Z.systemsHeader),showBreadcrumb:!1}),f().createElement(W.Z,null,f().createElement(p.Fragment,null,B?f().createElement($.Z,{code:I}):f().createElement(X.Z,{disableDefaultColumns:!0,onLoad:function(e){var t=e.mergeWithEntities,r=e.mergeWithDetail;Z.Z.register(ae(ae({},t((0,Q.K)(F.Bi),ae({page:Number(R.page||1),perPage:Number(R.page_size||20)},R.sort&&{sortBy:{key:R.sort.replace(/^-/,""),direction:R.sort.match(/^-/)?"desc":"asc"}}))),r()))},tableProps:{isStickyHeader:!0,canSelectAll:!1,actionResolver:(null==C?void 0:C.length)>0&&function(e){return(0,G.zs)(e,A)},variant:te.B.compact},showTagModal:!0,isFullView:!0,ref:_,autoRefresh:!0,customFilters:{vulnerabilityParams:ae({},R)},hasCheckbox:0!==(null==C?void 0:C.length),columnCounter:z,columns:function(e){return function(e){var t=(0,c.Z)(F.Bi),r=t[0],n=t.slice(1),o=e.find((function(e){return"updated"===e.key})),a=e.find((function(e){return"tags"===e.key}));return a=ae(ae({},a),{},{props:{width:10,isStatic:!0}}),o=ae(ae({},o),{},{cellTransforms:[ee.P8],props:{width:20}}),[r,a].concat((0,s.Z)(n),[o])}(e)},getEntities:function(){var e=(0,o.Z)(u().mark((function e(t,r){var o,a,s,i,c,l;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.vulnerabilityParams,a=r.orderBy,s=r.orderDirection,i=(0,n.Z)(r,ne),c="".concat("ASC"===s?"":"-").concat(a),H({page:o.page,page_size:o.per_page,sort:c}),e.next=5,x.vk(ae(ae({},o),{},{page:i.page,page_size:i.per_page,sort:c}));case 5:return l=e.sent,e.abrupt("return",Promise.resolve({results:l.data.map((function(e){return ae(ae(ae({},e),e.attributes),{},{insights_id:e.attributes.insights_id})})),total:l.meta.total_items}));case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),hideFilters:{all:!0}},f().createElement(U,{parameters:R,systems:{data:C,meta:{total_items:N}},selectedHosts:i||[],methods:{doOptOut:A,apply:H,handleSelect:function(e,t){t||(t=[]),l(t)},setSelectedHosts:l},actions:!0})))))}}}]);
//# sourceMappingURL=../sourcemaps/Systems.1c3860927a1fc9d71cb0.js.map