"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[226],{74976:(e,t,a)=>{a.r(t),a.d(t,{CVEPageContext:()=>Ge,default:()=>Qe});var r=a(29439),n=a(86350),s=a(45697),l=a.n(s),c=a(77865),o=a.n(c),i=a(43003),u=a(28216),m=a(83594),f=a(5977),d=a(52837),v=a(50693),p=a(16475),g=a(49739),E=a(83826),Z=a(68340),y=a(68774),N=a(74806),b=a(30893),h=a(4942),M=a(87462),_=a(45987),V=a(56455),P=a(60448),S=a(28873),x=a(75863),k=["isLoading","variant","children"];function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,h.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var w={spinner:"spinner",table:"table",compactTable:"compactTable",rectangle:"rectangle",inlineSkeleton:"inlineSkeleton",skeleton:"skeleton"},O=function(e){var t=e.isLoading,a=e.variant,r=e.children,n=(0,_.Z)(e,k);if(t)switch(a){case w.spinner:return o().createElement(S.Z,(0,M.Z)({centered:!0},n));case w.table:return o().createElement(P.Z,n);case w.compactTable:return o().createElement(P.Z,(0,M.Z)({variant:x.B.compact},n));case w.rectangle:return o().createElement(V.Z,(0,M.Z)({shape:"square"},n));case w.inlineSkeleton:return o().createElement(V.Z,(0,M.Z)({size:V.i.lg},n,{style:L({display:"inline-block"},n.style)}));default:return o().createElement(V.Z,(0,M.Z)({size:V.i.lg},n))}return r};O.propTypes={isLoading:l().bool,variant:l().oneOf(Object.keys(w)),style:l().object,children:l().node};const j=O;var D=function(e){var t=e.cveAttributes,a=e.intl,r=t.public_date,n=t.description,s=t.rh_link;return o().createElement(Ge.Consumer,null,(function(e){return o().createElement(g.K,{hasGutter:!0},o().createElement(E.v,{className:"pf-u-mt-sm"},o().createElement("div",null,o().createElement("span",{className:"pf-u-mr-xs"},a.formatMessage(b.Z.publishDate),":"),o().createElement(j,{isLoading:e.isLoading,variant:w.inlineSkeleton,style:{width:"100px"}},r))),o().createElement(E.v,null,o().createElement(j,{isLoading:e.isLoading,variant:w.rectangle,style:{height:"132px",width:"100%"}},o().createElement(y.D,{style:{textAlign:"justify"}},o().createElement(Z.x,{component:Z.q.p},n)))),o().createElement(E.v,{className:"pf-u-mt-sm pf-u-mb-md"},s))}))};D.propTypes={cveAttributes:l().any,intl:l().any};const A=(0,N.ZP)(D);var T=a(79851),R=a(34512),I=a(90496),H=a(29648),q=a(37377),B=a(91290),J=a(3351),U=a(22860),K=a(6934),z=a(32132),F={AV:{name:z.N.formatMessage(b.Z.vectorNamesV3AV),values:{N:z.N.formatMessage(b.Z.vectorValuesNetwork),A:z.N.formatMessage(b.Z.vectorValuesAdjacent),L:z.N.formatMessage(b.Z.vectorValuesLocal),P:z.N.formatMessage(b.Z.vectorValuesPhysical)}},AC:{name:z.N.formatMessage(b.Z.vectorNamesV3AC),values:{L:z.N.formatMessage(b.Z.vectorValuesLow),H:z.N.formatMessage(b.Z.vectorValuesHigh)}},PR:{name:z.N.formatMessage(b.Z.vectorNamesV3PR),values:{N:z.N.formatMessage(b.Z.vectorValuesNone),L:z.N.formatMessage(b.Z.vectorValuesLow),H:z.N.formatMessage(b.Z.vectorValuesHigh)}},UI:{name:z.N.formatMessage(b.Z.vectorNamesV3UI),values:{N:z.N.formatMessage(b.Z.vectorValuesNone),R:z.N.formatMessage(b.Z.vectorValuesRequired)}},S:{name:z.N.formatMessage(b.Z.vectorNamesV3S),values:{U:z.N.formatMessage(b.Z.vectorValuesUnchanged),C:z.N.formatMessage(b.Z.vectorValuesChanged)}},C:{name:z.N.formatMessage(b.Z.vectorNamesV3C),values:{N:z.N.formatMessage(b.Z.vectorValuesNone),L:z.N.formatMessage(b.Z.vectorValuesLow),H:z.N.formatMessage(b.Z.vectorValuesHigh)}},I:{name:z.N.formatMessage(b.Z.vectorNamesV3I),values:{N:z.N.formatMessage(b.Z.vectorValuesNone),L:z.N.formatMessage(b.Z.vectorValuesLow),H:z.N.formatMessage(b.Z.vectorValuesHigh)}},A:{name:z.N.formatMessage(b.Z.vectorNamesV3A),values:{N:z.N.formatMessage(b.Z.vectorValuesNone),L:z.N.formatMessage(b.Z.vectorValuesLow),H:z.N.formatMessage(b.Z.vectorValuesHigh)}},CVSS:{name:z.N.formatMessage(b.Z.vectorNamesCvssVersion),values:{"3.0":3}}},G={AV:{name:z.N.formatMessage(b.Z.vectorNamesV2AV),values:{N:z.N.formatMessage(b.Z.vectorValuesNetwork),A:z.N.formatMessage(b.Z.vectorValuesAdjacentNetwork),L:z.N.formatMessage(b.Z.vectorValuesLocal)}},AC:{name:z.N.formatMessage(b.Z.vectorNamesV2AC),values:{N:z.N.formatMessage(b.Z.vectorValuesNone),L:z.N.formatMessage(b.Z.vectorValuesLow),H:z.N.formatMessage(b.Z.vectorValuesHigh)}},Au:{name:z.N.formatMessage(b.Z.vectorNamesV2AU),values:{M:z.N.formatMessage(b.Z.vectorValuesMultiple),S:z.N.formatMessage(b.Z.vectorValuesSingle),N:z.N.formatMessage(b.Z.vectorValuesNone)}},C:{name:z.N.formatMessage(b.Z.vectorNamesV2C),values:{C:z.N.formatMessage(b.Z.vectorValuesComplete),P:z.N.formatMessage(b.Z.vectorValuesPartial),N:z.N.formatMessage(b.Z.vectorValuesNone)}},I:{name:z.N.formatMessage(b.Z.vectorNamesV2I),values:{C:z.N.formatMessage(b.Z.vectorValuesComplete),P:z.N.formatMessage(b.Z.vectorValuesPartial),N:z.N.formatMessage(b.Z.vectorValuesNone)}},A:{name:z.N.formatMessage(b.Z.vectorNamesV2A),values:{C:z.N.formatMessage(b.Z.vectorValuesComplete),P:z.N.formatMessage(b.Z.vectorValuesPartial),N:z.N.formatMessage(b.Z.vectorValuesNone)}}},W=a(60329),Q=function(e){var t,a,n,s=e.cvss2_metrics,l=e.cvss3_metrics,c=e.intl,i=(l?"CVSS 3.0":s&&"CVSS 2.0")||"CVSS 3.0",u=l||s,m=(a=l&&F||s&&G,n={},(t=u)&&t.split("/").forEach((function(e){var t=e.split(":"),s=(0,r.Z)(t,2),l=s[0],c=s[1],o=a[l]&&a[l].name,i=a[l]&&a[l].values[c]||"N/A";o&&(n[o]=i)})),n);return delete m.cvssVersion,o().createElement(Ge.Consumer,null,(function(t){return o().createElement(y.D,null,o().createElement(q.J,{id:"popover-cvss",position:"bottom",maxWidth:"100%",enableFlip:!0,headerContent:"".concat(i," ").concat(c.formatMessage(b.Z.cvssVectorPopoverTitle)),bodyContent:o().createElement(j,{isLoading:t.isLoading,colSize:2,rowSize:8,variant:w.compactTable},u?o().createElement(J.i,{"aria-label":"Metric breakdown",variant:x.B.compact,gridBreakPoint:"",cells:[c.formatMessage(b.Z.cvssVectorMetric),c.formatMessage(b.Z.cvssVectorValue)],rows:Object.entries(m)},o().createElement(K.x,null),o().createElement(U.R,null)):"N/A")},o().createElement(W.Z,{isLarge:!0,className:"pf-u-mb-xs pointer"},i," ",c.formatMessage(b.Z.cvssVectorVectorString),o().createElement(B.ZP,{color:"var(--pf-global--secondary-color--100)",className:"pf-u-ml-xs"}))),o().createElement(j,{isLoading:t.isLoading,style:{width:"320px"}},o().createElement("span",{className:"pf-u-mr-md"},e.score),o().createElement("span",{id:"cvss-vector-content"},c.formatMessage(b.Z.vector)+": ",(null==u?void 0:u.substring(u.indexOf("/")+1))||"N/A")))}))};Q.propTypes={cvss2_metrics:l().string,cvss3_metrics:l().string,score:l().any,intl:l().any};const Y=(0,N.ZP)(Q);var X=function(e){var t=e.title,a=e.value,r=e.content;return o().createElement(q.J,{id:"popover",bodyContent:r,headerContent:"",position:"bottom",appendTo:document.querySelector(".vulnerability")},o().createElement(g.K,{className:"popover-content"},o().createElement(E.v,null,o().createElement(W.Z,{isLarge:!0},t)),o().createElement(E.v,null,o().createElement("a",null,a))))};X.propTypes={title:l().any,value:l().any,content:l().any};const $=X;var ee=a(69957),te=a(89687),ae=function(e){var t=e.cveAttributes,a=e.intl,r=(0,H.nJ)(t.impact||"Unknown"),n=t.business_risk,s=t.business_risk_justification,l=t.status,c=t.status_justification,i=t.systems_status_detail,u=t.systems_status_divergent,m=i&&Object.keys(i).map((function(e){return[d.Em.find((function(t){return t.value===e.toString()})).label,i[e].toString()]})),f=o().createElement(g.K,{className:"pf-u-p-xs"},o().createElement(E.v,null,o().createElement(W.Z,{className:"pf-u-mb-xs"},a.formatMessage(b.Z.justificationNote))),o().createElement(E.v,null,s||"--")),v=o().createElement(g.K,{className:"pf-u-p-xs"},o().createElement(E.v,null,o().createElement(W.Z,{className:"pf-u-mb-xs"},a.formatMessage(b.Z.cveStatus)),l||"--",o().createElement(W.Z,{className:"pf-u-mb-xs pf-u-mt-sm"},a.formatMessage(b.Z.justificationNote)),c||"--"),u>0&&o().createElement(E.v,null,o().createElement(y.D,null,o().createElement("hr",{className:"pf-u-mt-sm pf-u-mb-sm"})),o().createElement(W.Z,{isLarge:!0},a.formatMessage(b.Z.cveDetailsPageSystemsWTCves)),o().createElement(J.i,{"aria-label":"Status details",gridBreakPoint:"",cells:[a.formatMessage(b.Z.statusLabel),a.formatMessage(b.Z.count)],rows:m,className:"status-breakdown-table",variant:"compact"},o().createElement(K.x,null),o().createElement(U.R,null))));return o().createElement(Ge.Consumer,null,(function(e){return o().createElement(g.K,{hasGutter:!0},o().createElement(E.v,null,o().createElement(T.P,{hasGutter:!0},o().createElement(R.J,null,o().createElement($,{title:a.formatMessage(b.Z.businessRiskLabel),value:o().createElement(j,{isLoading:e.isLoading,style:{width:"100px"}},n),content:f})),o().createElement(R.J,{className:"pf-u-ml-lg"},o().createElement($,{title:a.formatMessage(b.Z.statusLabel),content:v,value:o().createElement(j,{isLoading:e.isLoading,style:{width:"100px"}},o().createElement("span",null,u>0&&o().createElement(ee.ZP,{color:"var(--pf-global--primary-color--100)"})," ",l))})))),o().createElement(E.v,null,o().createElement(W.Z,{className:"pf-u-mb-xs",isLarge:!0},a.formatMessage(b.Z.impact)),o().createElement(j,{isLoading:e.isLoading,style:{width:"100px"}},o().createElement("span",{id:"severity-shield",style:{color:r.color}},o().createElement(te.Z,{impact:r.title,hasLabel:!0})))),o().createElement(E.v,null,o().createElement(Y,{cvss2_metrics:t.cvss2_metrics,cvss3_metrics:t.cvss3_metrics,score:(0,I.Z)(t.cvss2_score,t.cvss3_score)})))}))};ae.propTypes={cveAttributes:l().any,intl:l().any};const re=(0,N.ZP)(ae);var ne=a(35224),se=a(32203),le=a(62394),ce=a(61932),oe=a(73727),ie=a(78216),ue=a(68778),me=a(15265),fe=a(26076),de=a(53411),ve=a(38463),pe=function(e){var t=e.rules,a=e.synopsis,r=e.changeExposedSystemsParameters,n=e.intl,s=(0,u.I0)(),l=[].concat(t).sort((function(e,t){return t.systems_affected-e.systems_affected}));return l&&l.map((function(e,t){var l;return e.summary&&o().createElement(se.Z,{className:"card-box",key:e.rule_id,ouiaId:"security-rule-card-"+t},o().createElement(ce.L,{toggleText:o().createElement(T.P,null,o().createElement(R.J,{className:"pf-u-mr-xl"},o().createElement(y.D,null,o().createElement(Z.x,{component:Z.q.h4},o().createElement(de.Z,{className:"pf-u-mr-sm"}),e.description))),o().createElement(R.J,{id:"filter-affected-systems-split"},e.rule_id&&o().createElement(y.D,null,o().createElement(Z.x,{id:"filter-affected-systems",onClick:function(t){var a;a=e.rule_id,s(r({rule:a})),t.stopPropagation()},component:Z.q.small},o().createElement(oe.rU,{key:e.rule_id,to:"/cves/".concat(a,"/?rule=").concat(e.rule_id)},n.formatMessage(b.Z.filterByAffectedSystems,{count:null!==(l=e.systems_affected)&&void 0!==l?l:-1}))))))},o().createElement(le.e,{className:"rule-card-body"},o().createElement(v.r,{hasGutter:!0},o().createElement(p.P,{md:9,sm:12},o().createElement(g.K,{hasGutter:!0},o().createElement(E.v,null,o().createElement(ve.Z,{text:e.summary})),o().createElement(E.v,null,o().createElement(y.D,null,o().createElement(T.P,null,e.rule_impact&&o().createElement(R.J,null,o().createElement(W.Z,{className:"label pf-u-mb-xs"},n.formatMessage(b.Z.impact)),o().createElement(ne.u,{content:Object.values(d.l8)[e.rule_impact-1]},o().createElement(ie.Z,{value:e.rule_impact,className:"severity-label"}))),o().createElement(R.J,null,o().createElement(W.Z,{className:"label pf-u-mb-xs"},n.formatMessage(b.Z.riskOfChange)),o().createElement(ne.u,{content:d.p3[e.change_risk]},d.MS[e.change_risk])),o().createElement(R.J,null,o().createElement(W.Z,{className:"label pf-u-mb-xs"},n.formatMessage(b.Z.remediationLabel)),o().createElement(T.P,null,o().createElement(R.J,null,e.playbook_count?o().createElement(c.Fragment,null,o().createElement(ue.ZP,{className:"checkCircleIcon pf-u-mr-xs"}),n.formatMessage(b.Z.yes),o().createElement(ne.u,{content:n.formatMessage(b.Z.ansibleRemediationTooltip)},o().createElement(B.ZP,{className:"l-sm-spacer outlinedQuestionCircleIcon"}))):n.formatMessage(b.Z.no)),o().createElement(R.J,{className:"pf-u-ml-md"},e.reboot_required&&o().createElement(Z.x,null,o().createElement(fe.ZP,{className:"pf-u-mr-xs powerOffIcon"}),n.formatMessage(b.Z.rebootRequired)))))))),e.kbase_node_id&&o().createElement(E.v,null,o().createElement(y.D,null,o().createElement(Z.x,{className:"pf-u-mt-xs",component:Z.q.p},o().createElement("a",{className:"kb-link",href:"".concat(d.E7,"/").concat(e.kbase_node_id),target:"_blank",rel:"noopener noreferrer"},n.formatMessage(b.Z.knowledgebaseArticle),o().createElement(me.ZP,{className:"l-sm-spacer"}))))))),o().createElement(p.P,{md:3,sm:12},o().createElement(y.D,null,o().createElement(W.Z,null,n.formatMessage(b.Z.associatedCves)),o().createElement(Z.x,{component:Z.q.p,className:"pf-u-mt-xs associated-cves"},a," (",n.formatMessage(b.Z.current),")",e.associated_cves.filter((function(e){return e!==a})).map((function(e,t){return o().createElement("a",{className:"associated-cve-link",key:t,href:"".concat(d.OF,"/").concat(e)},e)})).reduce((function(e,t){return[e,", ",t]}),[""]))))))))}))};pe.defaultProps={rules:[]},pe.propTypes={intl:l().any,rules:l().array,synopsis:l().string,changeExposedSystemsParameters:l().func};const ge=(0,N.ZP)(pe);var Ee=a(86896),Ze=a(86135),ye=function(){var e=(0,Ee.Z)();return o().createElement(se.Z,{className:"card-box",ouiaId:"known-exploit-card"},o().createElement(ce.L,{toggleText:o().createElement(y.D,null,o().createElement(Z.x,{component:Z.q.h4},o().createElement(Ze.Z,{className:"pf-u-mr-sm"}),e.formatMessage(b.Z.knownExploitHeader)))},o().createElement(le.e,null,e.formatMessage(b.Z.knownExploitDescription))))},Ne=function(e){var t=e.data,a=e.changeExposedSystemsParameters;return o().createElement(v.r,{hasGutter:!0},o().createElement(p.P,{md:8,sm:12},o().createElement(A,{cveAttributes:t.data})),o().createElement(p.P,{md:4,sm:12,className:"pf-u-mt-sm pf-u-ml-sm"},o().createElement(re,{cveAttributes:t.data})),t.data.known_exploit&&o().createElement(ye,null),o().createElement(ge,{changeExposedSystemsParameters:a,synopsis:t.data.synopsis,rules:t.data.rules}))};Ne.propTypes={data:l().object,changeExposedSystemsParameters:l().func};const be=Ne;var he=a(41489),Me=a(74372),_e=a(19738),Ve=a(93433),Pe=a(66516),Se=a(83296),xe=a(93400),ke=a(15768),Ce=a(62215),Le=a(16493),we=a(95351),Oe=a(16369),je=a(1792),De=a(15248),Ae=a(33739),Te=a(12140),Re=a(49629),Ie=a(66123),He=a(83215),qe=a(24788);function Be(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Je(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(a),!0).forEach((function(t){(0,h.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Be(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Ue=function(e){var t,a=e.intl,n=e.cve,s=e.cveStatusDetails,l=e.filterRuleValues,f=e.hasSecurityRule,v=(0,c.useState)((function(){return function(){return null}})),p=(0,r.Z)(v,2),N=p[0],h=p[1],M=(0,c.useState)(void 0),_=(0,r.Z)(M,2),V=_[0],P=_[1],S=o().createRef(),k=(0,u.I0)(),C=(0,H.H1)(d.qB),L=(0,r.Z)(C,2),w=L[0],O=L[1],j=(0,c.useState)(!0),D=(0,r.Z)(j,2),A=D[0],T=D[1],R=(0,u.v9)((function(e){return e.CVEDetailsPageStore.affectedSystemsByCVE})),I=(0,u.v9)((function(e){return e.CVEDetailsPageStore.affectedSystemsByCVE.isLoading})),q=(0,u.v9)((function(e){return e.CVEDetailsPageStore.parameters}),u.wU),B=(0,u.v9)((function(e){return e.CVEDetailsPageStore.affectedSystemsByCVE.payload.meta})),J=(0,c.useMemo)((function(){return(0,i.q6)(Je({},R),n)}),[R,n]),U=(0,u.v9)((function(e){return e.CVEDetailsPageStore.affectedSystemsByCVE})).error,K=function(e){return k((0,m.vv)(e))},z=function(e,t){P(t||[])};Se.N.addNew({on:"SELECT_ENTITY",callback:function(e){return function(e){var t=e.data.selected?[e.data.id].concat((0,Ve.Z)(V||[])):V&&V.filter((function(t){return t!==e.data.id}));z(0,t)}(e)}}),(0,c.useEffect)((function(){K(w),T(!1)}),[]),(0,Te.ZP)((function(){A||(O(Je({},q)),k((0,m.TA)(n,Je({},q))))}),[q,A]),(0,c.useEffect)((function(){return function(){k((0,m.r5)())}}),[k]);var F=function(e,t){h((function(){return function(){return o().createElement(Pe.Z,{cveList:e,updateRef:function(){1===J.meta.page?k((0,m.TA)(n,Je({},q))):K({page:1}),k((0,m.ZO)(n))},inventoryList:t,type:"systemsExposed"})}}))},G=["",{label:a.formatMessage(b.Z.editStatus),onClick:function(){return F([s],(null===(e=J.data)||void 0===e?void 0:e.filter((function(e){return V.includes(e.inventory_id)}))).map((function(e){return{inventory_id:e.inventory_id,display_name:e.display_name,status_id:e.status_id,justification:e.status_text}})));var e},props:{isDisabled:!V||0===V.length}}],W=(0,c.useMemo)((function(){return(0,xe.Z)({selectedItems:V||[],selectorHandler:z,items:J.data&&J||{data:[],meta:{total_items:0}},fetchResource:function(e){return(0,m.Wf)(n,Je(Je({},q),e))}})}),[J,V,q,n]),Q=(0,c.useMemo)((function(){var e;return null==J||null===(e=J.data)||void 0===e?void 0:e.filter((function(e){return null==V?void 0:V.includes(e.id)}))}),[V,J]),Y=null!=J&&null!==(t=J.meta)&&void 0!==t&&t.patch_access?d.RD:d.RD.filter((function(e){return"advisory"!==e.key})),X=(0,we.Z)("filter",b.Z.systemsSearchName,b.Z.searchFilterByName,q.filter,K),$=(0,we.Z)("advisory",b.Z.advisory,b.Z.search,q.advisory,K);return o().createElement(g.K,{hasGutter:!0},o().createElement(E.v,null,o().createElement(y.D,null,o().createElement(Z.x,{component:Z.q.h2},a.formatMessage(b.Z.affectsSystems)))),o().createElement(E.v,null,null!=U&&U.hasError?o().createElement(Ie.Z,{code:null==U?void 0:U.errorCode}):o().createElement(Ae.Z,{disableDefaultColumns:!0,onLoad:function(e){var t=e.mergeWithEntities,a=e.mergeWithDetail;Se.Z.register(Je(Je({},t((0,ke.K)(d.jp))),a()))},tableProps:{isStickyHeader:!0,canSelectAll:!1,onSort:J.data.length>0&&function(e,t,a){return(0,H.L6)(t,a,Y,w.sort,K)},sortBy:J.data.length>0&&(0,H.hO)(Y,B.sort),actionResolver:function(e,t){return J.data.length>0&&(0,i.ji)(F,s,t.rowIndex)},variant:x.B.compact},showTags:!0,key:"inventory",expandable:f,ref:S,items:J.data,page:B&&B.page||1,perPage:B&&B.page_size||20,total:B&&B.total_items||0,isLoaded:!I,onRefresh:function(e){var t=e.page,a=e.per_page;!S.current||B.page===t&&B.limit===a||K({page:t,page_size:a}),B&&B.total_items<=a&&S.current&&S.current.onRefreshData({page:t,page_size:a})},hasCheckbox:J&&0!==J.length,showActions:J&&0!==J.length,onExpandClick:function(e,t,a,r){var n=r.id;return k((0,m.yw)(n,a))},noSystemsTable:o().createElement(qe.UE,null)},o().createElement(Re.Z,{className:"vuln-systems-primary-toolbar",exportConfig:Je({isDisabled:0===J.meta.total_items,ouiaId:"export"},(0,De.HV)({downloadReport:function(e){var t=[n,Je({},q)];Ce.Z.exec(m.TA,t,e,"systems-exposed",(function(e){return k((0,He.wN)(e))}),(function(){return k((0,He.L1)())}))}})),dedicatedAction:!I&&o().createElement(Le.Z,{manyRules:!0,systems:Q,cves:{id:n,rules:l}}),actionsConfig:{actions:G,kebabToggleProps:{isDisabled:!V||0===V.length},dropdownProps:{ouiaId:"toolbar-actions"}},activeFiltersConfig:{filters:(0,De.DU)(Je({},q),l),onDelete:function(e,t){return(0,De.vH)(t,K)},deleteTitle:a.formatMessage(b.Z.resetFilters)},bulkSelect:W&&{count:V&&V.length,items:W.items,isDisabled:0===J.meta.total_items&&(!V||0===V.length),checked:Boolean(V&&V.length),ouiaId:"bulk-select",onSelect:function(){return W.handleOnCheckboxChange()}},filterConfig:{items:[X,(0,Oe.Z)(K,q,l,{isDynamic:!0,dropdownItems:d.qE}),(0,je.Z)(K,q),$]}}),N&&o().createElement(N,null))))};Ue.propTypes={intl:l().object,cve:l().string,cveStatusDetails:l().object,filterRuleValues:l().array,hasSecurityRule:l().bool};const Ke=(0,N.ZP)((0,f.EN)(Ue));var ze=a(75115),Fe=a(61790),Ge=o().createContext({isLoading:!0}),We=function(e){var t,a,s=e.match,l=(0,u.I0)(),f=(0,c.useState)(s.params.cve),v=(0,r.Z)(f,1)[0],p=(0,c.useState)((function(){return function(){return null}})),g=(0,r.Z)(p,2),E=g[0],Z=g[1],y=(0,c.useState)((function(){return function(){return null}})),N=(0,r.Z)(y,2),b=N[0],h=N[1],M=(0,u.v9)((function(e){return e.CVEDetailsPageStore.cveDetails})),_=(0,c.useMemo)((function(){return(0,i.m4)(M)}),[M]),V=(0,u.v9)((function(e){return e.CVEDetailsPageStore.affectedSystemsByCVE}));(0,c.useEffect)((function(){l((0,m.ZO)(v))}),[l,v]),(0,c.useEffect)((function(){return function(){l((0,m.ds)())}}),[l]);var P,S,x=_.error,k=_.data,C={id:v,status_id:_.data.status_id,justification:_.data.status_justification,exposed_systems_count:(null==V||null===(t=V.payload)||void 0===t||null===(a=t.meta)||void 0===a?void 0:a.total_items)||0},L=[(0,he.Eh)((function(e){Z((function(){return function(){return o().createElement(Me.Z,{open:!0,cves:e,updateRef:function(){return l((0,m.ZO)(v))}})}}))}),[{business_risk_id:_.data.business_risk_id,id:v,justification:_.data.business_risk_justification}]),(0,he.bp)((function(e){h((function(){return function(){return o().createElement(_e.Z,{cves:e,updateRef:function(){l((0,m.ZO)(v)),l((0,m.TA)(v))}})}}))}),[C])],w=k.rules,O=w&&w.map((function(e){return{value:e.rule_id,label:e.description}}));return null!=x&&x.hasError?o().createElement(o().Fragment,null,o().createElement(ze.Z,{title:v}),o().createElement(Ie.Z,{code:null==x?void 0:x.errorCode})):o().createElement(Ge.Provider,{value:_&&{isLoading:_.isLoading}},o().createElement(ze.Z,{title:k.celebrity_name?v+" - "+k.celebrity_name:v,actions:L,actionsOuiaId:"cve-actions",breadcrumbs:[{title:d.yy.cvesPage.title,to:d.yy.cvesPage.to,loaded:!0},{title:v,isActive:!0,loaded:!0}],labels:[o().createElement(Fe.Z,{key:"labels",hasExploit:!(null===(P=M.payload.data)||void 0===P||!P.attributes.known_exploit),hasRule:(null===(S=M.payload.data)||void 0===S?void 0:S.attributes.rules.length)>0})]},o().createElement(be,{changeExposedSystemsParameters:m.vv,data:_}),o().createElement(b,null),o().createElement(E,null)),o().createElement(n.Z,null,o().createElement(Ke,{cve:v,filterRuleValues:O,cveStatusDetails:C,hasSecurityRule:(null==w?void 0:w.length)>0})))};We.propTypes={match:l().object};const Qe=(0,f.EN)(We)}}]);
//# sourceMappingURL=../sourcemaps/CVEDetailsPage.e81e8a91ed8292e5529d19616118a5b4.js.map