"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[662],{66516:(t,e,i)=>{i.d(e,{Z:()=>j});var n=i(29439),a=i(93149),s=i(83115),r=i(59775),o=i(49739),u=i(83826),c=i(87116),l=i(79851),d=i(35224),v=i(34512),f=i(91290),m=i(45697),y=i.n(m),_=i(77865),p=i.n(_),g=i(71478),h=i(91709),E=i(74806),Z=i(30893),b=function(t){var e,i=t.cveList,m=t.updateRef,y=t.inventoryList,E=t.intl,b=t.type,j=(0,h.fj)(A()),S=j.JustificationInput,M=j.justification,k=j.setJustification,P=j.setProps,x=(0,_.useState)(function(){switch(b){case"systemsExposed":if(y.every((function(t){var e,n;return t.status_id===(null===(e=i[0])||void 0===e?void 0:e.status_id)&&t.justification===(null===(n=i[0])||void 0===n?void 0:n.justification)})))return!0;break;case"systemDetail":var t=i.every((function(t,e,i){var n,a;return t.status_id===(null===(n=i[0])||void 0===n?void 0:n.status_id)&&t.justification===(null===(a=i[0])||void 0===a?void 0:a.justification)})),e=i.every((function(t){return t.status_id===t.cve_status_id&&t.justification===t.cve_justification}));if(t&&e)return!0}return!1}()),C=(0,n.Z)(x,2),N=C[0],w=C[1],I=(0,h.Hb)(J()),D=I.StatusSelect,T=I.statusId,U=I.setStatusId,L=I.setProps,O=y.map((function(t){return t.id||t.inventory_id})),R=y.map((function(t){return t.display_name}));function J(){switch(b){case"systemsExposed":return N?i[0].status_id:y.every((function(t,e,i){return t.status_id===i[0].status_id}))?null===(t=y[0])||void 0===t?void 0:t.status_id:"0";var t;case"systemDetail":var e,n;return N?i.every((function(t,e,i){return t.cve_status_id===i[0].cve_status_id}))?null===(e=i[0])||void 0===e?void 0:e.cve_status_id:"0":i.every((function(t,e,i){return t.status_id===i[0].status_id}))?null===(n=i[0])||void 0===n?void 0:n.status_id:"0"}}function A(){switch(b){case"systemsExposed":return N?i[0].justification:y.every((function(t,e,i){var n;return t.justification===(null===(n=i[0])||void 0===n?void 0:n.justification)}))&&(null===(t=y[0])||void 0===t?void 0:t.justification)||"";var t;case"systemDetail":var e,n;return N?i.every((function(t,e,i){var n;return t.cve_justification===(null===(n=i[0])||void 0===n?void 0:n.cve_justification)}))&&(null===(e=i[0])||void 0===e?void 0:e.cve_justification)||"":i.every((function(t,e,i){var n;return t.justification===(null===(n=i[0])||void 0===n?void 0:n.justification)}))&&(null===(n=i[0])||void 0===n?void 0:n.justification)||""}}(0,_.useEffect)((function(){L({isDisabled:N,ouiaId:"status-select"}),P({disabled:N}),U(J()),k(A())}),[N,L,P]);var F={variant:"success",title:"systemsExposed"===b?E.formatMessage(Z.Z.notificationSystemStatusUpdateSuccessful,{count:y.length||0,systemName:R[0]}):E.formatMessage(Z.Z.notificationStatusUpdateSuccessful,{count:i.length||0})},B={variant:"danger",autoDismiss:!1,title:E.formatMessage(Z.Z.notificationStatusUpdateFailureTitle),description:E.formatMessage(Z.Z.notificationStatusUpdateFailureBody)},X=E.formatMessage(Z.Z.cvePairStatusModalTitle,{count:O.length*i.length});return p().createElement(h.ZP,{items:i,onSave:function(){var t=i.map((function(t){return t.id})),e=N?{cve:t,inventory_id:O}:{status_id:parseInt(T),cve:t,status_text:M,inventory_id:O};return(0,g.cr)(e).then(m)},onSuccessNotification:F,onFailureNotification:B,title:X,ouiaId:"status-modal"},p().createElement(o.K,{hasGutter:!0},function(){switch(b){case"systemsExposed":return y.some((function(t,e,i){var n;return t.status_id!==(null===(n=i[0])||void 0===n?void 0:n.status_id)}));case"systemDetail":return i.some((function(t,e,i){var n;return t.status_id!==(null===(n=i[0])||void 0===n?void 0:n.status_id)}))}}()&&p().createElement(u.v,null,p().createElement(c.b,{variant:"warning",isInline:!0,title:E.formatMessage(Z.Z.cvePairStatusModalAlert)})),p().createElement(u.v,null,E.formatMessage(Z.Z.cvePairStatusModalSelected,{cveCount:i.length||0,cveId:null===(e=i[0])||void 0===e?void 0:e.id,systemCount:y.length||0,systemName:R[0],b:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return p().createElement("b",null,e)}})),p().createElement(u.v,null,p().createElement(s.l,{key:"key"},p().createElement(r.c,{fieldId:"overall"},p().createElement(l.P,null,p().createElement(v.J,null,p().createElement(a.X,{label:E.formatMessage(Z.Z.cvePairStatusModalUseOverallCheckbox),id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:N,onChange:function(t){return w(t)}})),p().createElement(v.J,null,p().createElement(d.u,{content:E.formatMessage(Z.Z.cvePairStatusModalUseOverallTooltip)},p().createElement(f.ZP,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)",style:{verticalAlign:"0"}}))))),D,S))))};b.propTypes={cveList:y().array,updateRef:y().func,inventoryList:y().array,intl:y().any,type:y().oneOf(["systemsExposed","systemDetail"])};const j=(0,E.ZP)(b)},16493:(t,e,i)=>{i.d(e,{Z:()=>g});var n=i(93433),a=i(29439),s=i(77865),r=i.n(s),o=i(45697),u=i.n(o),c=i(83215),l=i(98132),d=i(16712),v=i(36873),f=i(28216),m=i(30893),y=i(44012),_=i(29648),p=function(t){var e=t.cves,i=t.systems,s=t.manyRules,o=t.addNotification,u=function(t,e){return{id:"vulnerabilities:".concat(t),description:t,systems:[e]}};return r().createElement(l.Z,{fallback:null,dataProvider:function(){return function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[].concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]),s=[].concat(t),r=[];if(e&&1===i.length){var o=(0,a.Z)(i,1)[0];r=s.reduce((function(t,e){var i,a=e.id,s=e.rule,r=u(o.id,a);return s&&(r.id="".concat(r.id,":").concat(null==s||null===(i=s.rule)||void 0===i?void 0:i.rule_id)),[].concat((0,n.Z)(t),[r])}),[]),r=(0,_.X8)(r,"systems")}if(!e&&1===(null==s?void 0:s.length)){var c=(0,a.Z)(s,1)[0];r=i.reduce((function(t,e){var i=e.id,a=e.attributes.rule,s=u(i,c);return null!=a&&a.rule_id&&(s.id="".concat(s.id,":").concat(a.rule_id)),[].concat((0,n.Z)(t),[s])}),[])}return!(!i.length||!s.length)&&{issues:r}}(e,i,s)},isDisabled:0===e.length||0===i.length,onRemediationCreated:function(t){return o(t.getNotification())}},r().createElement(d.ZP,{size:"sm",color:"var(--pf-global--BackgroundColor--100)"}),"Â ",r().createElement(y.Z,m.Z.remediateLabel))};p.propTypes={cves:u().oneOfType([u().array,u().string]),systems:u().oneOfType([u().array,u().string]),addNotification:u().func,manyRules:u().bool};const g=(0,f.$j)(null,(function(t){return{addNotification:function(e){return t((0,c.wN)(e))}}}))((0,v.Z)(p))}}]);