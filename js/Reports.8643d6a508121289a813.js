(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[322],{16565:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ge});var a=r(63038),n=r.n(a),l=r(25558),s=r.n(l),o=r(50693),c=r(16475),i=r(32203),u=r(70),m=r(62394),p=r(49734),f=r(86350),d=r(82442),v=r(87757),y=r.n(v),g=r(319),E=r.n(g),b=r(48926),Z=r.n(b),h=r(59458),x=r(58141),C=r(40287),S=r(60578),R=r(59713),_=r.n(R),M=r(45697),T=r.n(M),N=r(9470),D=r(62410),k=r(89736),w=r(23025),O=function(e){var t=e.counter,r=e.label;return s().createElement(k.G7,null,s().createElement(k.xv,{style:w.Z.counter},t),s().createElement(k.xv,{style:w.Z.counterLabel},r))};O.propTypes={counter:T().number,label:T().string};const j=O;var P=function(e){var t=e.data,r=e.intl,a=t.totalSystems,n=t.totalCves,o=t.totalRules;return s().createElement(l.Fragment,{key:"exec-first-page"},s().createElement(k.xv,{style:[w.Z.generated,w.Z.mb24]},r.formatMessage(S.Z.executiveReportGenerated,{date:(0,D.Z)({date:new Date,type:"exact"}).props.children})),s().createElement(k.xv,{style:w.Z.mb16},r.formatMessage(S.Z.executiveReportHeader)),s().createElement(k.xv,{style:w.Z.mb8},r.formatMessage(S.Z.executiveReportSubHeader,{systems:s().createElement(k.xv,{style:w.Z.bold},r.formatMessage(S.Z.executiveReportHeaderSystems,{systems:a})),cves:s().createElement(k.xv,{style:w.Z.bold},r.formatMessage(S.Z.executiveReportHeaderCVEs,{cves:n})),rules:s().createElement(k.xv,{style:w.Z.bold},r.formatMessage(S.Z.executiveReportHeaderRules,{rules:o}))})),s().createElement(x.$0,{withColumn:!1},s().createElement(x.s_,null,s().createElement(x.Lv,{style:w.Z.counterPanel},s().createElement(j,{counter:a,label:r.formatMessage(S.Z.executiveReportAnalyzedSystems,{systems:a})})),s().createElement(x.Lv,{style:w.Z.counterPanel},s().createElement(j,{counter:n,label:r.formatMessage(S.Z.executiveReportAnalyzedCVEs,{cves:n})})),s().createElement(x.Lv,{style:w.Z.counterPanel},s().createElement(j,{counter:o,label:r.formatMessage(S.Z.executiveReportAnalyzedRules,{rules:o})})))))};P.propTypes={data:T().exact({totalSystems:T().number,totalCves:T().number,totalRules:T().number}),intl:T().any};const H=P;var L=r(39138),I=r.n(L),F=r(17437),B=function(e){var t=e.data,r=e.intl,a=function(e){return s().createElement(k.xv,{style:w.Z.mb8}," ",I()(e,{length:400}))},o=t.recentCvesData,c=t.CVSSChart,i=t.CVSSData,u=t.CVSSHeader,m=t.topCves,p=n()(u,2),f=p[0],d=p[1];return s().createElement(l.Fragment,{key:"first-section"},s().createElement(k.xv,{style:w.Z.header},r.formatMessage(S.Z.cvesHeader)),s().createElement(x.$0,{titleProps:{style:w.Z.sectionTitle},title:r.formatMessage(S.Z.executiveReportCvesByCVSS)},s().createElement(x.sg,null,s().createElement(x.kL,{chartType:"pie",subTitle:"Cves",title:"100",data:c,colorSchema:"orange",legendHeader:f})),s().createElement(x.sg,null,s().createElement(x.iA,{withHeader:!0,rows:[[d]].concat(E()(i))}))),s().createElement(x.$0,{titleProps:{style:w.Z.sectionTitle},title:r.formatMessage(S.Z.executiveReportRecentlyPublishedCves)},s().createElement(x.s_,{style:{flex:1}},o.map((function(e){var t=n()(e,2),r=t[0],a=t[1];return s().createElement(l.Fragment,{key:r},s().createElement(x.Lv,{style:{flex:1},title:r},a))})))),s().createElement(x.$0,{titleProps:{style:w.Z.sectionTitle},title:r.formatMessage(S.Z.executiveReportTop3),withColumn:!1},m.map((function(e){var t=e.synopsis,n=e.known_exploit,l=e.security_rule,o=e.description,c=e.cvss3_score,i=e.systems_affected;return s().createElement(x.s_,{key:t,title:t,description:a(o),labels:s().createElement(F.Z,{hasExploit:n,hasRule:l,intl:r})},s().createElement(x.Lv,{title:r.formatMessage(S.Z.executiveReportPanelTitle)},Number.parseFloat(c).toFixed(1)),s().createElement(x.Lv,{title:r.formatMessage(S.Z.systemsExposed)},i.toString()))}))))};B.propTypes={data:T().exact({recentCvesData:T().array,CVSSChart:T().array,CVSSData:T().array,CVSSHeader:T().array,topCves:T().array}),intl:T().any};const V=B;var z=function(e){var t=e.data,r=e.intl,a=function(e,t){return s().createElement(l.Fragment,null,s().createElement(k.xv,{style:w.Z.mb8},"".concat(I()(e,{length:320}),"\n\n")),r.formatMessage(S.Z.associatedCves)," ",t.map((function(e){return e})).join(", "))},n=t.topRules,o=t.rulesHeader,c=t.rulesBySeverityMap,i=t.rulesChart;return s().createElement(l.Fragment,{key:"first-section"},s().createElement(k.xv,{style:w.Z.header},r.formatMessage(S.Z.rules)),s().createElement(x.$0,{titleProps:{style:w.Z.sectionTitle},title:r.formatMessage(S.Z.executiveReportRulesSection)},s().createElement(x.sg,null,s().createElement(x.iA,{withHeader:!0,rows:[o].concat(E()(c))})),s().createElement(x.sg,null,s().createElement(x.kL,{chartType:"bar",subTitle:"rules",title:"Rules",data:i,colorSchema:"orange",legend:!1}))),s().createElement(x.$0,{titleProps:{style:w.Z.sectionTitle},title:r.formatMessage(S.Z.executiveReportTop3Rules),withColumn:!1},n.map((function(e,t){return s().createElement(x.s_,{key:t,title:e.name,description:a(e.description,e.associated_cves)},s().createElement(x.Lv,{title:r.formatMessage(S.Z.executiveReportRulePanelTitle)},s().createElement(x.Uc,{variant:e.severity})),s().createElement(x.Lv,{title:r.formatMessage(S.Z.systemsExposed)},e.systems_affected.toString()))}))))};z.propTypes={data:T().exact({topRules:T().array,rulesHeader:T().array,rulesBySeverityMap:T().array,rulesChart:T().array}),intl:T().any};const W=z;function $(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(Object(r),!0).forEach((function(t){_()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var G=function(e){var t,r=e.data,a=e.intl,l=r.cves_by_severity,o=r.recent_cves,c=r.top_cves,i=r.cves_total,u=r.system_count,m=r.top_rules,p=r.rules_total,f=r.rules_by_severity;0===(null==l||null===(t=l.na)||void 0===t?void 0:t.count)&&(delete l.na,delete N.cL.na);var d=Object.keys(f).reverse().map((function(e){return[N.q[e]].concat(E()(Object.values(f[e]).map((function(e){return e.toString()}))))})),v=Object.values(l).map((function(e){var t=e.count,r=e.percentage;return[a.formatMessage(S.Z.executiveReportOfTotal,{count:t,percentage:r})]})),y=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=[];for(var n in e){var l=e[n],s=t[n],o=void 0!==s.count?s.count:s;r&&s.percentage&&(o=s.percentage),a.push([l,o.toString()])}return a},g=y(N.YM,A({},o)),b=y(N.cL,A({},l),!0).map((function(e){var t=n()(e,2),r=t[0],a=t[1];return{x:r,y:Number(a)}})),Z=d.map((function(e){var t=n()(e,3),r=t[0],a=t[2];return{name:r,x:r,y:Number(a)}})),h={totalSystems:u,totalCves:i,totalRules:p},x={recentCvesData:g,CVSSChart:b,CVSSData:v,CVSSHeader:N.rs,topCves:c},C={topRules:m,rulesHeader:N.$D,rulesBySeverityMap:d,rulesChart:Z};return[s().createElement(H,{key:"first-page",intl:a,data:h}),s().createElement(V,{key:"second-page-cves",intl:a,data:x}),s().createElement(W,{key:"third-page-rules",intl:a,data:C})]};G.propTypes={data:T().exact({cves_by_severity:T().object,recent_cves:T().object,top_cves:T().array,cves_total:T().number,system_count:T().number}),intl:T().any};const U=G;var X=r(276),q=r(83215),K=r(86738),Y=r(84402);const J=function(){var e=(0,h.Z)(),t=(0,l.useState)(!1),r=n()(t,2),a=r[0],o=r[1],c=(0,l.useState)(!1),i=n()(c,2),u=i[0],m=i[1],p=(0,l.useState)(!1),f=n()(p,2),d=f[0],v=f[1],g=(0,l.useState)(!1),b=n()(g,2),R=b[0],_=b[1],M=(0,K.l)(),T=(0,X.useDispatch)(),N=function(){var t=Z()(y().mark((function t(){var r,a;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o(!0),M({msg:e.formatMessage(S.Z.downloadExecutiveNotification)}),t.next=4,(0,C.nK)();case 4:return r=t.sent,a=U({data:r,intl:e}),v((function(){return r.top_cves.some((function(e){return!0===e.security_rule}))})),_((function(){return r.top_cves.some((function(e){return!0===e.known_exploit}))})),o(!1),t.abrupt("return",E()(a));case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),D=(new Date).toISOString().split("T"),k=n()(D,1)[0];return s().createElement(l.Fragment,null,s().createElement("a",{onClick:function(){m(!0)}},e.formatMessage(S.Z.executiveReportCardButton)),u&&s().createElement(x.o6,{type:e.formatMessage(S.Z.vulnerabilitiesHeader),fileName:"vulnerability_executive-report--".concat(k,".pdf"),buttonProps:{variant:"link",isInline:!0},groupName:"Red Hat Insights",asyncFunction:N,allPagesHaveTitle:!1,showButton:!1,footer:s().createElement(Y.Z,{intl:e,hasRule:d,hasExploit:R}),label:a?e.formatMessage(S.Z.loading):e.formatMessage(S.Z.executiveReportCardButton),onSuccess:function(){T((0,q.L1)()),m(!1)}}))};var Q=r(80236),ee=r(47173),te=r(83115),re=r(59775),ae=r(92607),ne=r(93149),le=r(45469),se=r(13115),oe=r(57980),ce=r(96928),ie=r(42132),ue=function(e){var t=e.isOpen,r=e.handleModalClose,a=e.filterData,o=e.setFilterData,c=e.handleDownloadButton,i=e.columnsToInclude,u=e.setColumnsToInclude,m=e.userNotes,p=e.setUserNotes,f=e.reportTitle,d=e.setReportTitle,v=(0,l.useState)("all"),y=n()(v,2),g=y[0],b=y[1],Z=["rule_presence","known_exploit","impact","cvss_filter","business_risk_id","status_id","publish_date"];return(0,l.useEffect)((function(){"all"===g&&u(Object.keys(N.jW))}),[g,u]),s().createElement(Q.u,{appendTo:document.querySelector(".vulnerability"),width:"50rem",title:ce.N.formatMessage(S.Z.configModalTitle),ouiaId:"custom-report-modal",isOpen:t,onClose:r,actions:[s().createElement(ee.zx,{key:"export",variant:"primary",onClick:c,isDisabled:!(0,ie.o)(a.cvss_filter.from,a.cvss_filter.to)||m.length>N.Z0},ce.N.formatMessage(S.Z.configModalExportReport)),s().createElement(ee.zx,{key:"cancel",variant:"secondary",onClick:r},ce.N.formatMessage(S.Z.cancel))]},s().createElement(te.l,null,s().createElement(re.c,{label:ce.N.formatMessage(S.Z.customReportTitleLabel),fieldId:"horizontal-form-name"},s().createElement(ae.oi,{value:f,onChange:function(e){return d(e)},type:"text",className:"report-text-input",id:"horizontal-form-name"})),s().createElement(re.c,{label:ce.N.formatMessage(S.Z.customReportFilterDataByLabel)},s().createElement("div",{className:"custom-report-filter-wrapper"},Z&&Z.map((function(e){var t;return null===(t=N.jW[e])||void 0===t?void 0:t.component({filterData:a,setFilterData:o,selectProps:{className:"pf-u-mr-sm pf-u-mb-sm"},options:N.jW[e].items,filterId:e,filterName:N.jW[e].title})})))),s().createElement(re.c,{label:ce.N.formatMessage(S.Z.customReportDataToIncludeLabel)},s().createElement(se.t,{"aria-label":"Default with single selectable"},s().createElement(oe.G,{text:ce.N.formatMessage(S.Z.customReportDataToggleAll),isSelected:"all"===g,onChange:function(){return b("all")}}),s().createElement(oe.G,{text:ce.N.formatMessage(S.Z.customReportDataToggleCustom),isSelected:"custom"===g,onChange:function(){return b("custom")}})),"custom"===g&&s().createElement("div",{style:w.Z.collumns},s().createElement(ne.X,{id:"cve_id",label:"CVE ID",isChecked:!0,isDisabled:!0,className:"pf-u-mb-md"}),Object.entries(N.jW).map((function(e){var t=n()(e,2),r=t[0],a=t[1];return s().createElement(ne.X,{id:r,key:r,label:a.title,isChecked:i.includes(r),onChange:function(e){return function(e,t){u(t?[].concat(E()(i),[e]):i.filter((function(t){return t!==e})))}(r,e)},className:"pf-u-mb-md"})})))),s().createElement(re.c,{label:ce.N.formatMessage(S.Z.customReportUserNotesLabel),fieldId:"user-notes-box",helperTextInvalid:ce.N.formatMessage(S.Z.customReportUserNoteTooLong),validated:m.length>N.Z0&&"error"},s().createElement(le.Kx,{value:m,onChange:function(e){return p(e)},type:"text",id:"user-notes-box",className:"report-text-input",resizeOrientation:"vertical",style:{minHeight:"4em"},validated:m.length>N.Z0&&"error"}))))};ue.propTypes={isOpen:T().bool,filterData:T().object,setFilterData:T().func,handleModalClose:T().func,handleDownloadButton:T().func,columnsToInclude:T().array,setColumnsToInclude:T().func,userNotes:T().string,setUserNotes:T().func,reportTitle:T().string,setReportTitle:T().func};const me=ue,pe=r.p+"fonts/chart-pie-solid.svg";var fe=function(e){var t=e.style;return s().createElement("img",{style:t,src:pe,alt:"Static pie solid"})};fe.propTypes={style:T().object};var de=r(86190),ve=r(17304),ye=r(43109);const ge=function(){var e=(0,l.useState)(!1),t=n()(e,2),r=t[0],a=t[1],v=(0,l.useState)(!1),y=n()(v,2),g=y[0],E=y[1],b=(0,l.useState)(ce.N.formatMessage(S.Z.customReportDefaultTitle)),Z=n()(b,2),h=Z[0],x=Z[1],C=(0,l.useState)(""),R=n()(C,2),_=R[0],M=R[1],T=(0,l.useState)(Object.keys(N.jW)),D=n()(T,2),k=D[0],O=D[1],j=(0,l.useState)(N.OX),P=n()(j,2),H=P[0],L=P[1],I=function(){x(ce.N.formatMessage(S.Z.customReportDefaultTitle)),M(""),O(Object.keys(N.jW)),L(N.OX),E(!1),a(!1)};return(0,l.useEffect)((function(){var e,t,r;null===(e=insights)||void 0===e||null===(t=e.chrome)||void 0===t||null===(r=t.hideGlobalFilter)||void 0===r||r.call(t)})),s().createElement(s().Fragment,null,s().createElement(de.Z,{title:ce.N.formatMessage(S.Z.reportsPageTitle),showBreadcrumb:!1}),s().createElement(f.Z,null,s().createElement(o.r,{hasGutter:!0,lg:3,md:4,sm:12},s().createElement(c.P,null,s().createElement(i.Z,{className:"report-card"},s().createElement(u.l,null,s().createElement(fe,{style:w.Z.pieChartIcon}),s().createElement("span",{className:"pf-u-ml-sm",style:w.Z.cardTitle},ce.N.formatMessage(S.Z.executiveReportCardTitle))),s().createElement(m.e,null,ce.N.formatMessage(S.Z.executiveReportCardDescription)),s().createElement(p.e,null,s().createElement(J,null)))),s().createElement(c.P,null,s().createElement(i.Z,{className:"report-card"},s().createElement(u.l,null,s().createElement(d.ZP,{size:"lg",color:"var(--pf-global--link--Color)"}),s().createElement("span",{className:"pf-u-ml-sm",style:w.Z.cardTitle},ce.N.formatMessage(S.Z.customReportCardTitle))),s().createElement(m.e,null,ce.N.formatMessage(S.Z.customReportCardDescription)),s().createElement(p.e,null,s().createElement("a",{className:"create-report",onClick:function(){return a(!0)}},ce.N.formatMessage(S.Z.customReportCardButton))))))),s().createElement(me,{isOpen:r,columnsToInclude:k,setColumnsToInclude:O,filterData:H,userNotes:_,reportTitle:h,setReportTitle:x,setUserNotes:M,setFilterData:L,handleModalClose:I,handleDownloadButton:function(){E(!0),a(!1)}}),g&&s().createElement(ve.Z,{key:"download",reportData:{header:k,reportTitle:h,userNotes:_},showButton:!1,onSuccess:I,params:(0,ye.pX)(H),filters:(0,ye._R)(H),isReportDynamic:!0,label:S.Z.configModalExportReport}))}}}]);