(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[774],{12456:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Me});var r=n(59713),o=n.n(r),i=n(34575),a=n.n(i),c=n(93913),s=n.n(c),u=n(2205),l=n.n(u),p=n(78585),f=n.n(p),d=n(29754),m=n.n(d),y=n(44510),v=n(83215),b=n(45697),O=n.n(b),g=n(25558),h=n.n(g),E=n(276),S=n(5977),j=n(57721),P=n(6479),_=n.n(P),D=n(63038),w=n.n(D),C=n(18623),Z=n(67154),k=n.n(Z),R=n(319),T=n.n(R),I=n(3351),x=n(22860),A=n(6934),L=n(73323),M=n(35585),F=n(52906),H=n(81815),N=n(27272),V=n(67006);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=function(e){var t,n=e.context,r=e.header,o=e.entity,i=n.cves,a=n.methods,c=n.selectedCves,s=n.openedCves,u=n.canEditStatus;(null==i||null===(t=i.meta)||void 0===t?void 0:t.patch_access)||(r=r.filter((function(e){return"advisory"!==e.key})));var l=!i.data||0===i.data.length,p=l?[]:i.data.map((function(e){return c.includes(e.id)&&B(B({},e),{},{selected:!0})||e})).map((function(e,t){var n=t%2==0?s.find((function(t){return t.id===e.id}))||!1:{isOpen:void 0};return B(B({},e),{},{isOpen:n&&n.isOpen})}));return h().createElement(g.Fragment,null,i.isLoading?h().createElement(L.c,{colSize:6,rowSize:20}):h().createElement(g.Fragment,null,h().createElement(I.i,{isStickyHeader:!0,canSelectAll:!1,"aria-label":"Vulnerability CVE table",cells:r,rows:l?function(){var e=n.cves;return[{heightAuto:!0,cells:[{props:{colSpan:8},title:0!==["filter","cvss_from","cvss_to","public_from","public_to","impact","status_id"].filter((function(t){return Object.prototype.hasOwnProperty.call(e.meta,t)&&e.meta[t]})).length?V.UA:o?V.dX:e.data&&0!==e.data.length?void 0:V.vb}]}]}():p,onSelect:l?void 0:function(e,t,r){var o=n.cves,i=n.methods,a=o.data[r]&&o.data[r].id;i.selectCves(t,a)},actionResolver:!l&&u&&function(e,t){return(0,F.k8)(a,o,t.rowIndex)},sortBy:l?void 0:(0,H.hO)([{key:"collapse"},{key:"checkbox"}].concat(T()(r)),i.meta.sort),onCollapse:l?void 0:function(e,t,r){return function(e,t,r){var o=n.cves,i=n.methods,a=n.expandCveDescription,c=o.data[t]&&o.data[t].id;i.openCves(r,[c],a)}(0,t,r)},onSort:l?void 0:function(e,t,n){return(0,H.L6)(t,n,[{key:"collapse"},{key:"checkbox"}].concat(T()(r)),i.meta.sort,a.apply)},gridBreakPoint:"grid-lg",ouiaId:"cves-table"},h().createElement(g.Fragment,null,h().createElement(A.x,null),h().createElement(x.R,null))),h().createElement(M.f,null,h().createElement(N.Z,{meta:i.meta,apply:a.apply}))))};K.propTypes={context:O().any,header:O().array,entity:O().string};const Y=function(e){return h().createElement(Ee.Consumer,null,(function(t){return h().createElement(K,k()({context:t},e))}))};var z=n(74806),X=n(29558),J=n(59912),W=n(67754),$=n(49739),q=n(83826),G=n(68340),Q=n(68774),ee=n(64739),te=n(39888),ne=n(1658),re=n(74268),oe=n(98060),ie=n(84589),ae=n(52663),ce=n(96184),se=n(16721),ue=n(58671),le=n(34970),pe=n(61369),fe=n(25032);function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ye=function(e){var t=e.entity,n=e.intl,r=e.context,o=r.cves,i=r.parameters,a=r.methods,c=r.selectedCves,s=r.expandCveDescription,u=r.canEditStatus,l=r.canRemediate,p=i.filter,f=i.advisory,d=l&&(c&&c.length||0),m=(0,g.useMemo)((function(){return(0,re.Z)({selectedItems:c,selectorHandler:a.selectCves,items:o,fetchResource:function(e){return a.fetchResource(me(me({},i),e))},multiRow:!0})}),[c,o,i,a]),y=[""].concat(T()(u?[{label:n.formatMessage(C.Z.editStatus),onClick:function(){return a.showStatusModal(T()(c).map((function(e){return me({id:e},o.data.filter((function(t){return e===t.id})).map((function(e){return{status_id:e.status_id,cve_status_id:e.cve_status_id,justification:e.status_justification,cve_justification:e.cve_status_justification}}))[0])})),[])},props:{isDisabled:!d}}]:[]),[{label:s?n.formatMessage(C.Z.kebabCollapseCves):n.formatMessage(C.Z.kebabExpandCves),onClick:function(){var e=r.cves,t=r.methods,n=r.expandCveDescription,o=!n,i=n?[]:e.data.filter((function(e){return e.id})).map((function(e){return e.id}));t.openCves(o,i,!n)},props:{isDisabled:0===o.meta.total_items}}]),v=c.flatMap((function(e){return o.data.filter((function(t){return e===t.id}))}));return h().createElement(h().Fragment,null,h().createElement(oe.U8,{pagination:{itemCount:o.meta.total_items||0,page:o.meta.page||1,perPage:o.meta.page_size||1,ouiaId:"pagination-top",onSetPage:function(e,t){return(0,fe.A6)(e,t,a.apply)},onPerPageSelect:function(e,t){return(0,fe.lO)(e,t,a.apply)}},dedicatedAction:l&&t&&h().createElement(ne.Z,{systems:t,cves:v}),actionsConfig:{actions:y,kebabToggleProps:{isDisabled:!d&&0===o.meta.total_items},dropdownProps:{ouiaId:"toolbar-actions"}},bulkSelect:{count:d,items:m.items,isDisabled:0===o.meta.total_items&&0===d,checked:Boolean(d),ouiaId:"bulk-select",onSelect:function(){return m.handleOnCheckboxChange()}},filterConfig:{items:[(0,se.Z)("filter",C.Z.cve,C.Z.searchFilterByCveID,p,a.apply),(0,ue.Z)(a.apply,i),(0,ce.Z)(a.apply,i),(0,ae.Z)(a.apply,i),(0,le.Z)(a.apply,i),(0,pe.Z)(a.apply,i),(0,ie.Z)(a.apply,i),(0,se.Z)("advisory",C.Z.advisory,C.Z.search,f,a.apply)]},activeFiltersConfig:{filters:(0,fe.DU)(i),onDelete:function(e,t){return(0,fe.vH)(t,a.apply)}},exportConfig:me({isDisabled:0===o.meta.total_items,ouiaId:"export"},(0,fe.HV)(a))}))};ye.defaultProps={totalNumber:0,apply:function(){},downloadReport:function(){}},ye.propTypes={entity:O().string,context:O().object,intl:O().any};const ve=(0,z.ZP)((function(e){return h().createElement(Ee.Consumer,null,(function(t){return h().createElement(ye,k()({context:t},e))}))}));var be=n(73727),Oe=n(55409);function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ee=(0,g.createContext)({}),Se=function(e){var t,n,r=e.entity,o=e.intl,i=e.allowedCveActions,a=e.showHeaderLabel,c=e.setPageTitle,s=(0,E.useDispatch)(),u=(0,g.useState)((function(){return function(){return null}})),l=w()(u,2),p=l[0],f=l[1],d=(0,g.useState)(!1),m=w()(d,2),y=m[0],b=m[1],O=(0,g.useState)(!0),S=w()(O,2),P=S[0],_=S[1],D=(0,E.useSelector)((function(e){return e.SystemCvesStore.cveList})),Z=(0,E.useSelector)((function(e){return e.SystemCvesStore.parameters})),k=(0,E.useSelector)((function(e){return e.SystemCvesStore.selectedCves})),R=(0,E.useSelector)((function(e){return e.SystemCvesStore.openedCves})),T=(0,E.useSelector)((function(e){return e.SystemCvesStore.expandCveDescription})),I=["REMEDIATE","EDIT_STATUS"].map((function(e){return i.includes(e)})),x=w()(I,2),A=x[0],L=x[1],M=(0,g.useMemo)((function(){return(0,W.l3)(r.id,D)}),[D]),F=(0,H.H1)(J.kO),N=w()(F,2),U=N[0],B=N[1],K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,H.pX)(e);s((0,j.KV)(t))};return(0,g.useEffect)((function(){c&&(document.title="".concat(r.display_name,"\n                - ").concat(o.formatMessage(C.Z.systemsHeader)," - ").concat(o.formatMessage(C.Z.pageTitleSuffix))),P?(K(he({sort:"-public_date"},U)),_(!1)):(s((0,j.E8)(he(he({},Z),{},{system:r.id}))),y&&B(he({},Z))||b(!0))}),[Z]),(0,g.useEffect)((function(){return function(){s((0,j.jS)()),s((0,v.L1)())}}),[]),D.payload.errors?(t=D.payload.errors.status,404===(n=parseInt(t))&&r.id?V.yE:h().createElement(Oe.Z,{code:n})):h().createElement(Ee.Provider,{value:{cves:M,parameters:Z,selectedCves:k,openedCves:R,expandCveDescription:T,canRemediate:A,canEditStatus:L,methods:{apply:K,downloadReport:function(e){var t=he(he({},Z),{},{system:r.id});ee.Z.exec(j.E8,t,e,"system-cves")},selectCves:function(e,t){s((0,j.TT)(t))},openCves:function(e,t,n){s((0,j.pJ)({isOpen:e,cves:t,expandCveDescription:n}))},showStatusModal:function(e){var t=Array.from(M.data.filter((function(t){return e.some((function(e){return e.id===t.id}))})));t=t.map((function(e){return{id:e.id,cve_status_id:e.cve_status_id,status_id:e.status_id,justification:e.status_justification,cve_justification:e.cve_status_justification}})),f((function(){return function(){return h().createElement(te.Z,{cveList:t,updateRef:function(){return(0,H.$)(M.meta,K)},inventoryList:[{id:r.id,display_name:r.display_name}],type:"systemDetail"})}}))},fetchResource:function(e){return(0,j.KX)(he(he({},e),{},{system:r.id}))}}}},h().createElement(p,null),h().createElement($.K,{hasGutter:!0},a&&h().createElement(q.v,null,h().createElement(Q.D,null,h().createElement(G.x,{component:G.q.h2},o.formatMessage(C.Z.cvesHeader)))),h().createElement(q.v,null,h().createElement(ve,{entity:r.id}))),h().createElement(Y,{header:J.Vm,entity:r.id}))};Se.defaultProps={allowedCveActions:[],showHeaderLabel:!1,setPageTitle:!1},Se.propTypes={entity:O().object,intl:O().any,allowedCveActions:O().array,showHeaderLabel:O().bool};var je=(0,S.EN)((0,z.ZP)(Se)),Pe=function(e){var t=e.customItnlProvider,n=e.customRouter,r=_()(e,["customItnlProvider","customRouter"]),o=n?be.BrowserRouter:g.Fragment,i=t?X.Z:g.Fragment;return h().createElement(i,t&&{locale:navigator.language.slice(0,2),messages:C.Z},h().createElement(o,n&&{basename:"".concat(window.location.pathname)},h().createElement(je,r)))};Pe.propTypes={customItnlProvider:O().bool,customRouter:O().bool},Pe.defaultProps={customItnlProvider:!1,customRouter:!1};var _e=function(e){l()(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=m()(t);if(n){var o=m()(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return f()(this,e)});function o(e){return a()(this,o),r.call(this,e)}return s()(o,[{key:"render",value:function(){var e=this.props,t=e.entity,n=e.isOptOut,r=e.optOutSystemHandler,o=e.loaded;return t&&o?n?h().createElement(h().Fragment,null,h().createElement(V.o0,{buttonAction:function(){return r(!1)}})):h().createElement(h().Fragment,null,h().createElement(je,{entity:{id:t.id,display_name:t.display_name},allowedCveActions:["EDIT_STATUS","REMEDIATE"],showHeaderLabel:!0,setPageTitle:!0})):null}}]),o}(h().Component);_e.propTypes={entity:O().object,isOptOut:O().bool,loaded:O().bool,optOutSystemHandler:O().func};const De=(0,S.EN)((0,E.connect)((function(e){var t=e.entityDetails;return{entity:t.entity,isOptOut:t.opt_out,loaded:t.loaded}}),null)(_e));var we=n(2545);function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ke={loaded:!1},Re=n(51937),Te=n(91067),Ie=n(58135);function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Le=function(e){l()(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=m()(t);if(n){var o=m()(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return f()(this,e)});function o(e){var t;return a()(this,o),(t=r.call(this,e)).optOutSystem=function(e){t.props.optOutSystem(t.state.inventoryId,e).then((function(){t.props.fetchSystemDetails(t.state.inventoryId),!0===e?t.props.addNotification({variant:"success",title:t.props.intl.formatMessage(C.Z.inventoryOptOutSuccess)}):t.props.addNotification({variant:"success",title:t.props.intl.formatMessage(C.Z.inventoryResumeAnalysisTitle),description:t.props.intl.formatMessage(C.Z.inventoryResumeAnalysisDescription)})}))},t.state={inventoryId:t.props.match.params.inventoryId},t}return s()(o,[{key:"componentDidMount",value:function(){this.props.fetchSystemDetails(this.state.inventoryId)}},{key:"render",value:function(){var e=this,t=this.props,n=t.systemDetails,r=void 0===n?{}:n,o=t.errors,i=r.opt_out,a=void 0!==i&&i,c=r.entity,s=r.loaded;return h().createElement(h().Fragment,null,h().createElement(Ie.c0,null,h().createElement(Te.Z,{title:"",breadcrumbs:[{title:J.yy.systemsPage.title,to:J.yy.systemsPage.to,loaded:!0},{title:(null==c?void 0:c.display_name)||this.props.intl.formatMessage(C.Z.invalidSystem),isActive:!0,loaded:s}]},!o&&h().createElement(Ie.$w,{onLoad:function(t){var n=t.mergeWithEntities,r=t.mergeWithDetail,o=t.INVENTORY_ACTION_TYPES;Re.Z.register(Ae(Ae({},n()),r(function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case we.up+"_FULFILLED":return Ze(Ze({},n),r.payload.data);case e.LOAD_ENTITY_FULFILLED:return Ze(Ze({},n),{},{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return h().createElement(De,{optOutSystemHandler:t})}}]});case e.LOAD_ENTITY_REJECTED:return Ze(Ze({},n),{},{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return h().createElement(De,null)}}]});default:return n}}}(o,e.optOutSystem))))},hideBack:!0,actions:c&&[a?{title:this.props.intl.formatMessage(C.Z.inventoryKebabOptionsResume),onClick:function(){return e.optOutSystem(!1)}}:{title:this.props.intl.formatMessage(C.Z.inventoryKebabOptionsExclude),onClick:function(){return e.optOutSystem(!0)}}]})),h().createElement(y.o,null,h().createElement(h().Fragment,null,h().createElement(Ie.my,{optOutSystemHandler:this.optOutSystem})))))}}]),o}(h().Component);Le.propTypes={fetchSystemDetails:O().func,systemDetails:O().object,optOutSystem:O().func,match:O().object,addNotification:O().func,intl:O().any,errors:O().object};const Me=(0,S.EN)((0,z.ZP)((0,E.connect)((function(e){return{errors:e.SystemCvesStore.cveList.payload.errors,systemDetails:e.entityDetails}}),(function(e){return{optOutSystem:function(t,n){return e((0,j.DP)(t,n))},fetchSystemDetails:function(t){return e((0,j.o0)(t))},addNotification:function(t){return e((0,v.wN)(t))}}}))(Le)))}}]);
//# sourceMappingURL=SystemDetailsPage.f6aafefdbc0f201c5cfe.js.map