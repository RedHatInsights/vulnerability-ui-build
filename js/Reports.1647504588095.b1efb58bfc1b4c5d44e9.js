(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[322],{52914:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ke});var n=r(4942),a=r(29439),s=r(22491),o=r.n(s),l=r(28216),c=r(50693),i=r(16475),u=r(32203),f=r(70),m=r(62394),p=r(49734),d=r(86350);const v=(0,r(40400).IU)({name:"FileAltIcon",height:512,width:384,svgPath:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 236c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-64c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-72v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm96-114.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z",yOffset:0,xOffset:0});var g=r(93433),y=r(15861),b=r(87757),h=r.n(b),Z=r(86896),E=r(3968),x=r(71478),O=r(30893),S=r(45697),D=r.n(S),T=r(78733),w=r(87462),j=r(35224),_=36e5,M=24*_,R=30*M,C=365*M,P=function(e,t){return"".concat(e," ").concat(e>1?"".concat(t,"s"):t," ago")},N=[{rightBound:1/0,description:function(e){return P(Math.round(e/C),"year")}},{rightBound:C,description:function(e){return P(Math.round(e/R),"month")}},{rightBound:R,description:function(e){return P(Math.round(e/M),"day")}},{rightBound:M,description:function(e){return P(Math.round(e/_),"hour")}},{rightBound:_,description:function(e){return P(Math.round(e/6e4),"minute")}},{rightBound:6e4,description:function(){return"Just now"}}],k=function(e){return e.toUTCString().split(",")[1].slice(0,-7).trim()},I=function(e){return{exact:function(e){return k(e)+" UTC"},onlyDate:function(e){return k(e).slice(0,-6)},relative:function(e){return N.reduce((function(t,r){return r.rightBound>Date.now()-e?r.description(Date.now()-e):t}),k(e))},invalid:function(){return"Invalid date"}}[e]};function F(e){var t=e.date,r=e.type,n=void 0===r?"relative":r,a=e.extraTitle,s=e.tooltipProps,l=void 0===s?{}:s,c=t instanceof Date?t:new Date(t),i=null==t||"Invalid Date"===c.toString()?"invalid":n;return o().createElement(o().Fragment,null,function(e,t,r){return{exact:function(t){return I(e)(t)},onlyDate:function(t){return I(e)(t)},relative:function(n){return function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return o().createElement(j.u,(0,w.Z)({},r,{content:o().createElement("div",null,n,e)}),t)}(I("exact")(n),o().createElement("span",null,I(e)(n)),t,r)},invalid:function(){return"Invalid date"}}[e]}(i,l,a)(c))}F.propTypes={date:D().oneOfType([D().instanceOf(Date),D().string,D().number]),type:D().oneOf(["exact","onlyDate","relative"]),extraTitle:D().node,tooltipProps:D().object};var H=r(74093),B=r(80167),L=function(e){var t=e.counter,r=e.label;return o().createElement(H.G7,null,o().createElement(H.xv,{style:B.Z.counter},t),o().createElement(H.xv,{style:B.Z.counterLabel},r))};L.propTypes={counter:D().number,label:D().string};const V=L;var z=function(e){var t=e.data,r=e.intl,n=t.totalSystems,a=t.totalCves,l=t.totalRules;return o().createElement(s.Fragment,{key:"exec-first-page"},o().createElement(H.xv,{style:[B.Z.generated,B.Z.mb24]},r.formatMessage(O.Z.executiveReportGenerated,{date:F({date:new Date,type:"exact"}).props.children})),o().createElement(H.xv,{style:B.Z.mb16},r.formatMessage(O.Z.executiveReportHeader)),o().createElement(H.xv,{style:B.Z.mb8},r.formatMessage(O.Z.executiveReportSubHeader,{systems:o().createElement(H.xv,{style:B.Z.bold},r.formatMessage(O.Z.executiveReportHeaderSystems,{systems:n})),cves:o().createElement(H.xv,{style:B.Z.bold},r.formatMessage(O.Z.executiveReportHeaderCVEs,{cves:a})),rules:o().createElement(H.xv,{style:B.Z.bold},r.formatMessage(O.Z.executiveReportHeaderRules,{rules:l}))})),o().createElement(E.$0,{withColumn:!1},o().createElement(E.s_,null,o().createElement(E.Lv,{style:B.Z.counterPanel},o().createElement(V,{counter:n,label:r.formatMessage(O.Z.executiveReportAnalyzedSystems,{systems:n})})),o().createElement(E.Lv,{style:B.Z.counterPanel},o().createElement(V,{counter:a,label:r.formatMessage(O.Z.executiveReportAnalyzedCVEs,{cves:a})})),o().createElement(E.Lv,{style:B.Z.counterPanel},o().createElement(V,{counter:l,label:r.formatMessage(O.Z.executiveReportAnalyzedRules,{rules:l})})))))};z.propTypes={data:D().exact({totalSystems:D().number,totalCves:D().number,totalRules:D().number}),intl:D().any};const G=z;var A=r(84506),W=r(39138),U=r.n(W),$=r(1809),X=function(e){var t=e.data,r=e.intl,n=function(e){return o().createElement(H.xv,{style:B.Z.mb8}," ",U()(e,{length:400}))},l=t.recentCvesData,c=t.CVSSChart,i=t.CVSSData,u=t.CVSSHeader,f=t.topCves,m=(0,A.Z)(u),p=m[0],d=m.slice(1);return o().createElement(s.Fragment,{key:"first-section"},o().createElement(H.xv,{style:B.Z.header},r.formatMessage(O.Z.cvesHeader)),o().createElement(E.$0,{titleProps:{style:B.Z.sectionTitle},title:r.formatMessage(O.Z.executiveReportCvesByCVSS)},o().createElement(E.sg,null,o().createElement(E.kL,{chartType:"pie",subTitle:"Cves",title:"100",data:c,colorSchema:"orange",legendHeader:p})),o().createElement(E.sg,null,o().createElement(E.iA,{withHeader:!0,rows:[d].concat((0,g.Z)(i))}))),o().createElement(E.$0,{titleProps:{style:B.Z.sectionTitle},title:r.formatMessage(O.Z.executiveReportRecentlyPublishedCves)},o().createElement(E.s_,{style:{flex:1}},l.map((function(e){var t=(0,a.Z)(e,2),r=t[0],n=t[1];return o().createElement(s.Fragment,{key:r},o().createElement(E.Lv,{style:{flex:1},title:r},n))})))),o().createElement(E.$0,{titleProps:{style:B.Z.sectionTitle},title:r.formatMessage(O.Z.executiveReportTop3),withColumn:!1},f.map((function(e){var t=e.synopsis,a=e.known_exploit,s=e.rule_presence,l=e.description,c=e.cvss3_score,i=e.systems_affected;return o().createElement(E.s_,{key:t,title:t,description:n(l),labels:o().createElement($.Z,{hasExploit:a,hasRule:s,intl:r})},o().createElement(E.Lv,{title:r.formatMessage(O.Z.executiveReportPanelTitle)},Number.parseFloat(c).toFixed(1)),o().createElement(E.Lv,{title:r.formatMessage(O.Z.systemsExposed)},i.toString()))}))))};X.propTypes={data:D().exact({recentCvesData:D().array,CVSSChart:D().array,CVSSData:D().array,CVSSHeader:D().array,topCves:D().array}),intl:D().any};const J=X;var Q=function(e){var t=e.data,r=e.intl,n=function(e,t){return o().createElement(s.Fragment,null,o().createElement(H.xv,{style:B.Z.mb8},"".concat(U()(e,{length:320}),"\n\n")),r.formatMessage(O.Z.associatedCves)," ",t.map((function(e){return e})).join(", "))},a=t.topRules,l=t.rulesHeader,c=t.rulesBySeverityMap,i=t.rulesChart;return o().createElement(s.Fragment,{key:"first-section"},o().createElement(H.xv,{style:B.Z.header},r.formatMessage(O.Z.rules)),o().createElement(E.$0,{titleProps:{style:B.Z.sectionTitle},title:r.formatMessage(O.Z.executiveReportRulesSection)},o().createElement(E.sg,null,o().createElement(E.iA,{withHeader:!0,rows:[l].concat((0,g.Z)(c))})),o().createElement(E.sg,null,o().createElement(E.kL,{chartType:"bar",subTitle:"rules",title:"Rules",data:i,colorSchema:"orange",legend:!1}))),o().createElement(E.$0,{titleProps:{style:B.Z.sectionTitle},title:r.formatMessage(O.Z.executiveReportTop3Rules),withColumn:!1},a.map((function(e,t){return o().createElement(E.s_,{key:t,title:e.name,description:n(e.description,e.associated_cves)},o().createElement(E.Lv,{title:r.formatMessage(O.Z.executiveReportRulePanelTitle)},o().createElement(E.Uc,{variant:e.severity})),o().createElement(E.Lv,{title:r.formatMessage(O.Z.systemsExposed)},e.systems_affected.toString()))}))))};Q.propTypes={data:D().exact({topRules:D().array,rulesHeader:D().array,rulesBySeverityMap:D().array,rulesChart:D().array}),intl:D().any};const K=Q;function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ee=function(e){var t,r=e.data,n=e.intl,s=r.cves_by_severity,l=r.recent_cves,c=r.top_cves,i=r.cves_total,u=r.system_count,f=r.top_rules,m=r.rules_total,p=r.rules_by_severity;0===(null==s||null===(t=s.na)||void 0===t?void 0:t.count)&&(delete s.na,delete T.cL.na);var d=Object.keys(p).reverse().map((function(e){return[T.q[e]].concat((0,g.Z)(Object.values(p[e]).map((function(e){return e.toString()}))))})),v=Object.values(s).reverse().map((function(e){var t=e.count,r=e.percentage,a=e.known_exploit_count;return[n.formatMessage(O.Z.executiveReportOfTotal,{count:t,percentage:r}),a.toString()]})),y=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[];for(var a in e){var s=e[a],o=t[a],l=void 0!==o.count?o.count:o;r&&o.percentage&&(l=o.percentage),n.push([s,l.toString()])}return n},b=y(T.YM,Y({},l)),h=y(T.cL,Y({},s),!0).map((function(e){var t=(0,a.Z)(e,2),r=t[0],n=t[1];return{x:r,y:Number(n)}})),Z=d.map((function(e){var t=(0,a.Z)(e,3),r=t[0],n=t[2];return{name:r,x:r,y:Number(n)}})),E={totalSystems:u,totalCves:i,totalRules:m},x={recentCvesData:b,CVSSChart:h,CVSSData:v,CVSSHeader:T.rs,topCves:c},S={topRules:f,rulesHeader:T.$D,rulesBySeverityMap:d,rulesChart:Z};return[o().createElement(G,{key:"first-page",intl:n,data:E}),o().createElement(J,{key:"second-page-cves",intl:n,data:x}),o().createElement(K,{key:"third-page-rules",intl:n,data:S})]};ee.propTypes={data:D().exact({cves_by_severity:D().object,recent_cves:D().object,top_cves:D().array,cves_total:D().number,system_count:D().number,rules_by_severity:D().object,rules_total:D().number,top_rules:D().array}),intl:D().any};const te=ee;var re=r(37450),ne=r(75201);const ae=function(){var e=(0,Z.Z)(),t=(0,s.useState)(!1),r=(0,a.Z)(t,2),n=r[0],l=r[1],c=(0,s.useState)(!1),i=(0,a.Z)(c,2),u=i[0],f=i[1],m=(0,s.useState)(!1),p=(0,a.Z)(m,2),d=p[0],v=p[1],b=(0,s.useState)(!1),S=(0,a.Z)(b,2),D=S[0],w=S[1],j=(0,re.lm)(),_=(0,a.Z)(j,2),M=_[0],R=_[1],C=function(){var t=(0,y.Z)(h().mark((function t(){var r,n;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,x.nK)();case 3:r=t.sent,t.next=12;break;case 6:return t.prev=6,t.t0=t.catch(0),R(),M("403"===t.t0.status?T._V:{variant:"danger",autoDismiss:!1,msg:e.formatMessage(O.Z.notificationReportDownloadFailureTitle),description:e.formatMessage(O.Z.notificationReportDownloadFailureBody)}),l(!1),t.abrupt("return",[]);case 12:return n=te({data:r,intl:e}),v((function(){return r.top_cves.some((function(e){return!0===e.rule_presence}))})),w((function(){return r.top_cves.some((function(e){return!0===e.known_exploit}))})),l(!1),R(),M({variant:"success",msg:e.formatMessage(O.Z.notificationReportDownloadSuccess)}),t.abrupt("return",(0,g.Z)(n));case 19:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(){return t.apply(this,arguments)}}(),P=(new Date).toISOString().split("T"),N=(0,a.Z)(P,1)[0];return o().createElement(s.Fragment,null,o().createElement("a",{onClick:function(){return f(!0),l(!0),void M({msg:e.formatMessage(O.Z.notificationReportDownloadStart)})}},n?e.formatMessage(O.Z.loading):e.formatMessage(O.Z.executiveReportCardButton)),u&&o().createElement(E.o6,{fallback:o().createElement("div",null),type:e.formatMessage(O.Z.vulnerabilitiesHeader),fileName:"vulnerability_executive-report--".concat(N,".pdf"),buttonProps:{variant:"link",isInline:!0},groupName:"Red Hat Insights",asyncFunction:C,allPagesHaveTitle:!1,showButton:!1,footer:o().createElement(ne.Z,{intl:e,hasRule:d,hasExploit:D}),onSuccess:function(){f(!1)}}))};var se=r(80236),oe=r(47173),le=r(83115),ce=r(59775),ie=r(92607),ue=r(93149),fe=r(23393),me=r(13115),pe=r(57980),de=r(32132),ve=r(27482),ge=r(54680),ye=r(92694),be=function(e){var t=e.sorterData,r=e.setSorterData,n=e.selectProps,l=e.options,c=(0,s.useState)(!1),i=(0,a.Z)(c,2),u=i[0],f=i[1];return o().createElement(ge.P,(0,w.Z)({variant:"single",direction:"up","aria-label":"Select Input",onToggle:function(){return f(!u)},isOpen:u,placeholderText:l.find((function(e){return e.value===t})).label,key:"custom-sorter",onSelect:function(e,t){!function(e){var t=l.find((function(t){return t.label===e})).value;r(t),f(!1)}(t)},width:"auto"},n),l.map((function(e){return o().createElement(ye.$,{width:"100%",key:e.label,value:e.label})})))};be.propTypes={sorterData:D().object,setSorterData:D().func,selectProps:D().object,options:D().array};const he=be;var Ze=r(95705);function Ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function xe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Oe=function(e){var t=e.isOpen,r=e.handleModalClose,n=e.filterData,l=e.sorterData,c=e.setFilterData,i=e.setSorterData,u=e.handleDownloadButton,f=e.columnsToInclude,m=e.setColumnsToInclude,p=e.userNotes,d=e.setUserNotes,v=e.reportTitle,y=e.setReportTitle,b=e.inheritGlobalTags,h=e.setInheritGlobalTags,Z=e.globalFilterTags,E=(0,s.useState)(!0),x=(0,a.Z)(E,2),S=x[0],D=x[1],w=["rule_presence","known_exploit","impact","cvss_filter","business_risk_id","status_id","publish_date","rhel_version"];return(0,s.useEffect)((function(){S&&m(Object.keys(T.jW))}),[S,m]),o().createElement(se.u,{width:"50rem",title:de.N.formatMessage(O.Z.configModalTitle),ouiaId:"custom-report-modal",isOpen:t,onClose:function(){r(),h(!0)},actions:[o().createElement(oe.zx,{key:"export",variant:"primary",onClick:u,isDisabled:!(0,ve.o)(n.cvss_filter.from,n.cvss_filter.to)||p.length>T.Z0},de.N.formatMessage(O.Z.configModalExportReport)),o().createElement(oe.zx,{key:"cancel",variant:"secondary",onClick:function(){r(),h(!0)}},de.N.formatMessage(O.Z.cancel))]},o().createElement(le.l,null,o().createElement(ce.c,{label:de.N.formatMessage(O.Z.customReportTitleLabel),fieldId:"horizontal-form-name"},o().createElement(ie.oi,{value:v,onChange:function(e){return y(e)},type:"text",className:"report-text-input",id:"horizontal-form-name"})),o().createElement(ce.c,{label:de.N.formatMessage(O.Z.customReportFilterDataByLabel)},o().createElement("div",{className:"custom-report-select-wrapper"},w&&w.map((function(e){var t;return null===(t=T.jW[e])||void 0===t?void 0:t.component(xe(xe({},T.jW[e]),{},{filterData:n,setFilterData:c,selectProps:xe({className:"pf-u-mr-sm pf-u-mb-sm"},T.jW[e].selectProps),options:T.jW[e].items,filterId:e,filterName:T.jW[e].title}))})))),o().createElement(ce.c,{label:de.N.formatMessage(O.Z.tagFilterTitle)},o().createElement(Ze.Z,{onEdit:function(){return h(!1)},selectedTags:n.tags,setSelectedTags:function(e){return c(xe(xe({},n),{},{tags:e}))},globalTags:Z,inheritGlobalTags:b}),(null==Z?void 0:Z.length)>0&&b&&o().createElement("div",{className:"pf-u-font-size-sm pf-u-mt-sm"},de.N.formatMessage(O.Z.tagFilterGlobal),o().createElement("a",{className:"pf-u-ml-md",onClick:function(){h(!1),n.tags=[]}},de.N.formatMessage(O.Z.tagFilterClear)))),o().createElement(ce.c,{label:de.N.formatMessage(O.Z.customReportDataToIncludeLabel)},o().createElement(me.t,{"aria-label":"Default with single selectable"},o().createElement(pe.G,{text:de.N.formatMessage(O.Z.customReportDataToggleAll),isSelected:S,onChange:function(){return D(!0)}}),o().createElement(pe.G,{text:de.N.formatMessage(O.Z.customReportDataToggleCustom),isSelected:!S,onChange:function(){return D(!1)}})),S||o().createElement("div",{style:B.Z.columns},o().createElement(ue.X,{id:"cve_id",label:"CVE ID",isChecked:!0,isDisabled:!0,className:"pf-u-mb-md"}),Object.entries(T.jW).filter((function(e){return!1!==(0,a.Z)(e,2)[1].hasColumn})).map((function(e){var t=(0,a.Z)(e,2),r=t[0],n=t[1];return o().createElement(ue.X,{id:r,key:r,label:n.title,isChecked:f.includes(r),onChange:function(e){return function(e,t){m(t?[].concat((0,g.Z)(f),[e]):f.filter((function(t){return t!==e})))}(r,e)},className:"pf-u-mb-md"})})))),o().createElement(ce.c,{label:de.N.formatMessage(O.Z.customReportSortDataByLabel)},o().createElement("div",{className:"custom-report-select-wrapper"},o().createElement(he,{sorterData:l,setSorterData:i,selectProps:{className:"pf-u-mr-sm pf-u-mb-sm"},options:T.AH}))),o().createElement(ce.c,{label:de.N.formatMessage(O.Z.customReportUserNotesLabel),fieldId:"user-notes-box",helperTextInvalid:de.N.formatMessage(O.Z.customReportUserNoteTooLong),validated:p.length>T.Z0&&"error"},o().createElement(fe.Kx,{value:p,onChange:function(e){return d(e)},type:"text",id:"user-notes-box",className:"report-text-input",resizeOrientation:"vertical",style:{minHeight:"4em"},validated:p.length>T.Z0&&"error"}))))};Oe.propTypes={isOpen:D().bool,filterData:D().object,sorterData:D().object,setFilterData:D().func,setSorterData:D().func,handleModalClose:D().func,handleDownloadButton:D().func,columnsToInclude:D().array,setColumnsToInclude:D().func,userNotes:D().string,setUserNotes:D().func,reportTitle:D().string,setReportTitle:D().func,inheritGlobalTags:D().bool,setInheritGlobalTags:D().func,globalFilterTags:D().array};const Se=Oe;var De=r(53279),Te=function(e){var t=e.style;return o().createElement("img",{style:t,src:De,alt:"Static pie solid"})};Te.propTypes={style:D().object};var we=r(75115),je=r(33084),_e=r(22408),Me=r(83215),Re=r(94909),Ce=r(6023);function Pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const ke=function(){var e,t=(0,re.Wu)([T._I.advancedReporting,T._I.readVulnerabilityResults,T._I.readHosts],""),r=(0,a.Z)(t,2),n=(0,a.Z)(r[0],3),g=n[0],y=n[1],b=n[2],h=r[1],Z=(0,s.useState)(!1),E=(0,a.Z)(Z,2),x=E[0],S=E[1],D=(0,s.useState)(!1),w=(0,a.Z)(D,2),j=w[0],_=w[1],M=(0,s.useState)(de.N.formatMessage(O.Z.customReportDefaultTitle)),R=(0,a.Z)(M,2),C=R[0],P=R[1],N=(0,s.useState)(""),k=(0,a.Z)(N,2),I=k[0],F=k[1],H=(0,s.useState)(Object.keys(T.jW)),L=(0,a.Z)(H,2),V=L[0],z=L[1],G=(0,s.useState)(T.OX),A=(0,a.Z)(G,2),W=A[0],U=A[1],$=(0,s.useState)(T.JQ),X=(0,a.Z)($,2),J=X[0],Q=X[1],K=(0,s.useState)(!0),q=(0,a.Z)(K,2),Y=q[0],ee=q[1],te=null!==(e=(0,l.v9)((function(e){return e.ReportsPageStore.parameters.tags})))&&void 0!==e?e:[],ne=(0,l.I0)();(0,s.useEffect)((function(){return function(){ne((0,Me.L1)())}}),[ne]);var se=function(){P(de.N.formatMessage(O.Z.customReportDefaultTitle)),F(""),z(Object.keys(T.jW)),U(T.OX),Q(T.JQ),_(!1),S(!1)},oe=function(e){var t=e.split("/"),r=(0,a.Z)(t,2),n=r[0],s=r[1].split("="),o=(0,a.Z)(s,2);return{string:e,namespace:n,key:o[0],value:o[1]}};return h?o().createElement(Ce.Z,{centered:!0}):g&&b?o().createElement(o().Fragment,null,o().createElement(we.Z,{title:de.N.formatMessage(O.Z.reportsPageTitle),showBreadcrumb:!1}),o().createElement(d.Z,null,o().createElement(c.r,{hasGutter:!0,lg:3,md:4,sm:12},o().createElement(i.P,null,o().createElement(u.Z,{className:"report-card"},o().createElement(f.l,null,o().createElement(Te,{style:B.Z.pieChartIcon}),o().createElement("span",{className:"pf-u-ml-sm",style:B.Z.cardTitle},de.N.formatMessage(O.Z.executiveReportCardTitle))),o().createElement(m.e,null,de.N.formatMessage(O.Z.executiveReportCardDescription)),o().createElement(p.e,null,o().createElement(ae,null)))),y&&o().createElement(i.P,null,o().createElement(u.Z,{className:"report-card"},o().createElement(f.l,null,o().createElement(v,{size:"lg",color:"var(--pf-global--link--Color)"}),o().createElement("span",{className:"pf-u-ml-sm",style:B.Z.cardTitle},de.N.formatMessage(O.Z.customReportCardTitle))),o().createElement(m.e,null,de.N.formatMessage(O.Z.customReportCardDescription)),o().createElement(p.e,null,o().createElement("a",{className:"create-report",onClick:function(){return S(!0)}},de.N.formatMessage(O.Z.customReportCardButton))))))),o().createElement(Se,{isOpen:x,columnsToInclude:V,setColumnsToInclude:z,filterData:W,sorterData:J,userNotes:I,reportTitle:C,setReportTitle:P,setUserNotes:F,setFilterData:U,setSorterData:Q,handleModalClose:se,handleDownloadButton:function(){_(!0),S(!1)},inheritGlobalTags:Y,setInheritGlobalTags:ee,globalFilterTags:te}),j&&o().createElement(je.Z,{key:"download",reportData:{header:V,reportTitle:C,userNotes:I},showButton:!1,onSuccess:se,params:(0,_e.QT)(Ne(Ne({},W),{},{tags:Y?null==te?void 0:te.map(oe):W.tags}),J),filters:(0,_e._R)(Ne(Ne({},W),{},{tags:Y?null==te?void 0:te.map(oe):W.tags})),isReportDynamic:!0,label:O.Z.configModalExportReport})):o().createElement(Re.Z,{title:de.N.formatMessage(O.Z.reportsPageTitle),emptyStateTitle:de.N.formatMessage(O.Z.emptyStateNoAccessReportsPage)})}},62215:(e,t,r)=>{"use strict";r.d(t,{Z:()=>g});var n=r(4942),a=r(15861),s=r(71002),o=r(43144),l=r(15671),c=r(87757),i=r.n(c),u=r(35240),f=r(32132),m=r(30893),p=r(78733);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const g=new((0,o.Z)((function e(){var t=this;(0,l.Z)(this,e),this.filename=function(e){switch(e){case"reports":return"vulnerability_cves-report--".concat((new Date).toISOString().split("T")[0]);case"systems-exposed":return"vulnerability_systems-exposed-".concat(t.params.cve,"--").concat(t.defaultParams.date);case"system-list":return"vulnerability_systems--".concat(t.defaultParams.date);default:return"vulnerability_cves--".concat(t.defaultParams.date)}},this.checkTypes=function(e,r,n){if("function"!=typeof e)throw"exec expects the 1st param to be funtion. Received ".concat((0,s.Z)(e));if(!t.pages.includes(r))throw"Page ".concat(r," does not exist");if(!t.formats.includes(n))throw"Format ".concat(n," is not supported")},this.exec=function(){var e=(0,a.Z)(i().mark((function e(r,n,a,s,o,l){var c,f,m,d,g;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(t.notifications.start),t.checkTypes(r,s,a),t.params.cve=(null==n?void 0:n.id)||null,e.prev=3,e.next=6,r(v(v(v(v({},n.id&&{id:n.id}),n),t.defaultParams),{},{data_format:a,report:"true"}));case 6:return c=e.sent,f=c.payload,e.next=10,f;case 10:m=e.sent,d=m.data,g="json"===a?JSON.stringify(d):d,(0,u.Sv)(g,t.filename(s),a),l(),o(t.notifications.success),e.next=23;break;case 18:throw e.prev=18,e.t0=e.catch(3),l(),o("403"===e.t0.status?p._V:t.notifications.failure),"".concat(e.t0);case 23:case"end":return e.stop()}}),e,null,[[3,18]])})));return function(t,r,n,a,s,o){return e.apply(this,arguments)}}(),this.defaultParams={page:1,page_size:Math.min(Number.MAX_SAFE_INTEGER,9007199254740991),date:(new Date).toISOString().replace(/[T:]/g,"-").split(".")[0]+"-utc"},this.params={cve:null},this.pages=["systems-exposed","system-cves","cves","system-list"],this.formats=["csv","json"],this.notifications={start:{variant:"info",title:f.N.formatMessage(m.Z.notificationReportDownloadStart)},success:{variant:"success",title:f.N.formatMessage(m.Z.notificationReportDownloadSuccess)},failure:{variant:"danger",autoDismiss:!1,title:f.N.formatMessage(m.Z.notificationReportDownloadFailureTitle),description:f.N.formatMessage(m.Z.notificationReportDownloadFailureBody)}}})))},48983:(e,t,r)=>{var n=r(40371)("length");e.exports=n},44286:e=>{e.exports=function(e){return e.split("")}},14259:e=>{e.exports=function(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(r=r>a?a:r)<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(a);++n<a;)s[n]=e[n+t];return s}},40180:(e,t,r)=>{var n=r(14259);e.exports=function(e,t,r){var a=e.length;return r=void 0===r?a:r,!t&&r>=a?e:n(e,t,r)}},62689:e=>{var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},88016:(e,t,r)=>{var n=r(48983),a=r(62689),s=r(21903);e.exports=function(e){return a(e)?s(e):n(e)}},83140:(e,t,r)=>{var n=r(44286),a=r(62689),s=r(676);e.exports=function(e){return a(e)?s(e):n(e)}},21903:e=>{var t="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",r="\\ud83c[\\udffb-\\udfff]",n="[^\\ud800-\\udfff]",a="(?:\\ud83c[\\udde6-\\uddff]){2}",s="[\\ud800-\\udbff][\\udc00-\\udfff]",o="(?:"+t+"|"+r+")?",l="[\\ufe0e\\ufe0f]?",c=l+o+"(?:\\u200d(?:"+[n,a,s].join("|")+")"+l+o+")*",i="(?:"+[n+t+"?",t,a,s,"[\\ud800-\\udfff]"].join("|")+")",u=RegExp(r+"(?="+r+")|"+i+c,"g");e.exports=function(e){for(var t=u.lastIndex=0;u.test(e);)++t;return t}},676:e=>{var t="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",r="\\ud83c[\\udffb-\\udfff]",n="[^\\ud800-\\udfff]",a="(?:\\ud83c[\\udde6-\\uddff]){2}",s="[\\ud800-\\udbff][\\udc00-\\udfff]",o="(?:"+t+"|"+r+")?",l="[\\ufe0e\\ufe0f]?",c=l+o+"(?:\\u200d(?:"+[n,a,s].join("|")+")"+l+o+")*",i="(?:"+[n+t+"?",t,a,s,"[\\ud800-\\udfff]"].join("|")+")",u=RegExp(r+"(?="+r+")|"+i+c,"g");e.exports=function(e){return e.match(u)||[]}},39138:(e,t,r)=>{var n=r(80531),a=r(40180),s=r(62689),o=r(13218),l=r(96347),c=r(88016),i=r(83140),u=r(40554),f=r(79833),m=/\w*$/;e.exports=function(e,t){var r=30,p="...";if(o(t)){var d="separator"in t?t.separator:d;r="length"in t?u(t.length):r,p="omission"in t?n(t.omission):p}var v=(e=f(e)).length;if(s(e)){var g=i(e);v=g.length}if(r>=v)return e;var y=r-c(p);if(y<1)return p;var b=g?a(g,0,y).join(""):e.slice(0,y);if(void 0===d)return b+p;if(g&&(y+=b.length-y),l(d)){if(e.slice(y).search(d)){var h,Z=b;for(d.global||(d=RegExp(d.source,f(m.exec(d))+"g")),d.lastIndex=0;h=d.exec(Z);)var E=h.index;b=b.slice(0,void 0===E?y:E)}}else if(e.indexOf(n(d),y)!=y){var x=b.lastIndexOf(d);x>-1&&(b=b.slice(0,x))}return b+p}},53279:(e,t,r)=>{"use strict";e.exports=r.p+"fonts/chart-pie-solid.svg"}}]);
//# sourceMappingURL=../sourcemaps/Reports.c470aee98356c9303eef86a7994f125f.js.map