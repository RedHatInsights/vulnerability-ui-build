(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[743],{75584:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ae});var n=r(81253),o=r(92137),a=r(96156),s=r(28481),c=r(87757),i=r.n(c),l=r(77865),u=r.n(l),f=r(86896),p=r(30893),d=r(14494),m=r(85061),b=r(45697),g=r.n(b),y=r(74806),v=r(5977),h=r(29648),O=r(9048),P=r(83296),Z=r(93400),j=r(49629),w=r(95351),E=r(15248),S=r(62215),D=r(22122),_=r(3968),k=r(71478),x=r(43198),C=r(62598),N=r(6208),M=r(37450),F=["filters","params","reportData","buttonProps","label"];function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var B=function(e){var t=e.filters,r=e.params,a=e.reportData,c=void 0===a?{}:a,d=e.buttonProps,b=e.label,g=(0,n.Z)(e,F),y=(0,f.Z)(),v=(0,l.useState)(!1),O=(0,s.Z)(v,2),P=O[0],Z=O[1],j=(0,M.l)(),w=function(e){return(0,h.F3)(e,N.tp.systemsReportRestPages)},E=function(){var e=(0,o.Z)(i().mark((function e(){var n,o,a,s,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Z(!0),j({msg:y.formatMessage(p.Z.customReportNotificationSystem)}),e.next=4,(0,k.vk)(T(T({},r),S.Z.defaultParams));case 4:return n=e.sent,o=n.data,a=n.meta,s=(0,x.Z)({data:o.splice(0,N.tp.systemsReportFirstPage),meta:a,filters:t,intl:y}),l=w(o),Z(!1),e.abrupt("return",[s].concat((0,m.Z)(l.map((function(e,t){return(0,C.Z)({data:e,page:t,intl:y,header:c&&c.header})})))));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return u().createElement("div",null,u().createElement(_.o6,(0,D.Z)({},g,{label:P?y.formatMessage(p.Z.loading):y.formatMessage(b),asyncFunction:E,buttonProps:T({component:"button"},d),reportName:y.formatMessage(p.Z.systemPDFReportName),type:"",fileName:"".concat(S.Z.filename("system-list"),".pdf"),allPagesHaveTitle:!1,size:"A4",orientation:"landscape"})))};B.defaultProps={label:p.Z.kebabExportAsPDF},B.propTypes={filters:g().oneOfType([g().array,g().object]),params:g().object,reportData:g().object,buttonProps:g().object,label:g().oneOfType([g().array,g().object])};const I=B;var H=r(19281),A=r(89421),z=r(32132);const V=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.excluded,n=function(t){var r=[!1,!1];t.forEach((function(e){r[e]=!0}));var n=r.join(",");e({excluded:"false,false"===n?"":n,page:1})};return{label:z.N.formatMessage(p.Z.filterSystemsIncludedInAnalysis),type:A.Yu.checkbox,urlParam:"excluded",filterValues:{onChange:function(e,t){n(t)},items:N._9.map((function(e){return{label:e.label,value:e.value}})),value:null==r?void 0:r.split(",").flatMap((function(e,t){return"true"===(null==e?void 0:e.toLowerCase())?t.toString():[]}))}}};function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Y=function(e){var t=e.selectedHosts,r=e.intl,n=e.parameters,o=e.systems,a=e.methods,c=(0,l.useState)(!1),i=(0,s.Z)(c,2),f=i[0],d=i[1],b=a.apply,g=a.handleSelect,y=a.doOptOut;P.N.addNew({on:"SELECT_ENTITY",callback:function(e){return function(e){var r=e.data.selected?[e.data.id].concat((0,m.Z)(t)):t.filter((function(t){return t!==e.data.id}));g(!1,r)}(e)}});var v=(0,l.useMemo)((function(){var e=null==o?void 0:o.data.filter((function(e){return t.includes(e.id)}));return{selectedExcluded:e.some((function(e){return!0===e.attributes.opt_out})),selectedIncluded:e.some((function(e){return!1===e.attributes.opt_out}))}}),[t,o]),h=["",{label:r.formatMessage(p.Z.systemKebabExcludeAnalysis,{count:t.length||0}),onClick:function(){return y(null,!0)},props:{isDisabled:!t.length||!v.selectedIncluded}},{label:r.formatMessage(p.Z.systemKebabIncludeAnalysis,{count:t.length||0}),onClick:function(){return y(null,!1)},props:{isDisabled:!t.length||!v.selectedExcluded}}],D=(0,Z.Z)({selectedItems:t,selectorHandler:g,items:o,fetchResource:function(e){return(0,O.ip)(L(L({},n),e))}});return u().createElement(l.Fragment,null,u().createElement(j.Z,{className:"vuln-systems-primary-toolbar",bulkSelect:{count:t.length,items:D.items,isDisabled:0===o.meta.total_items&&0===t.length,checked:Boolean(t.length),ouiaId:"bulk-select",onSelect:function(){return D.handleOnCheckboxChange()}},actionsConfig:{actions:h,kebabToggleProps:{isDisabled:!t.length||0===o.meta.total_items},dropdownProps:{ouiaId:"toolbar-actions"}},filterConfig:{items:[(0,w.Z)("filter",p.Z.systemsSearchName,p.Z.searchFilterByName,n.filter,b),V(b,n)]},activeFiltersConfig:{filters:(0,E.DU)(n),onDelete:function(e,t,r){return(0,E.vH)(t,a.apply,r,N.Sy)},deleteTitle:r.formatMessage(p.Z.resetFilters),showDeleteButton:!(0,E.Yy)(n,N.Sy,N.D2)},exportConfig:L({isDisabled:0===o.meta.total_items,extraItems:[(0,H.Ec)(f,d)],ouiaId:"export"},(0,E.HV)({downloadReport:function(e){var t=L({},n);S.Z.exec(O.lc,t,e,"system-list")}}))}),f&&u().createElement(I,{showButton:!1,params:n,filters:(0,E.DU)(n),onSuccess:function(){return d(!1)}}))};Y.propTypes={systems:h.nE,parameters:g().object,selectedHosts:g().array,methods:g().shape({doOptOut:g().func,apply:g().func,handleSelect:g().func}),intl:g().any};const q=(0,v.EN)((0,y.ZP)(Y));var U=r(86350),W=r(99385),$=r(23320),G=r(15768),J=r(33739),Q=r(66123),X=r(14112),ee=r(75863),te=r(12140),re=["vulnerabilityParams","orderBy","orderDirection"];function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const ae=function(){var e=(0,f.Z)(),t=(0,l.useState)(void 0),r=(0,s.Z)(t,2),a=r[0],c=r[1],m=(0,h.H1)(N.IV),b=(0,s.Z)(m,2),g=b[0],y=b[1],v=(0,l.useState)(!0),Z=(0,s.Z)(v,2),j=Z[0],w=Z[1],E=(0,M.l)({variant:"success"}),S=u().createRef(),D=(0,d.useDispatch)(),_=(0,d.useSelector)((function(e){var t=e.entities;return(null==t?void 0:t.rows)||[]}),d.shallowEqual),x=(0,d.useSelector)((function(e){var t=e.entities;return null==t?void 0:t.total})),C=(0,d.useSelector)((function(e){return e.SystemsPageStore.params}),d.shallowEqual),F=(0,d.useSelector)((function(e){return e.SystemsPageStore.error})),R=F.hasError,T=F.errorCode,B=(0,d.useSelector)((function(e){var t,r=e.entities;return null==r||null===(t=r.rows)||void 0===t?void 0:t.some((function(e){return e.patchAccess}))}));(0,l.useEffect)((function(){return function(){D((0,O.re)()),D((0,O.r5)())}}),[D]),(0,l.useEffect)((function(){a&&D((0,O.lA)(a))}),[a,D]);var I=function(e){D((0,O.SF)(e))};(0,l.useEffect)((function(){I(g),w(!1)}),[]),(0,te.Z)((function(){j||y(oe({},C))}),[C,j]);var H=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0;(a&&a.length>0||t)&&D((0,O.R0)(t||a,r)).then((function(){S.current.onRefreshData({page:1});var n=t?1:a.length||0;E(r?{msg:e.formatMessage(p.Z.systemsExcludedNotification,{count:n})}:{msg:e.formatMessage(p.Z.systemsResumedNotificationTitle,{count:n}),description:e.formatMessage(p.Z.systemsResumedNotificationBody)}),c([])}))},A=(0,l.useMemo)((function(){return A?A++:0}),[B]);return u().createElement(l.Fragment,null,u().createElement($.Z,{title:e.formatMessage(p.Z.systemsHeader),showBreadcrumb:!1}),u().createElement(U.Z,null,u().createElement(l.Fragment,null,R?u().createElement(Q.Z,{code:T}):u().createElement(J.Z,{disableDefaultColumns:!0,onLoad:function(e){var t=e.mergeWithEntities,r=e.mergeWithDetail;P.Z.register(oe(oe({},t((0,G.K)(N.Bi),oe({page:Number(C.page||1),perPage:Number(C.page_size||20)},C.sort&&{sortBy:{key:C.sort.replace(/^-/,""),direction:C.sort.match(/^-/)?"desc":"asc"}}))),r()))},tableProps:{isStickyHeader:!0,canSelectAll:!1,actionResolver:function(e){return(0,W.zs)(e,H)},variant:ee.B.compact},showTagModal:!0,isFullView:!0,ref:S,autoRefresh:!0,customFilters:{vulnerabilityParams:oe({},C)},hasCheckbox:0!==(null==_?void 0:_.length),columnCounter:A,columns:function(e){return function(e,t){var r=(0,s.Z)(N.Bi,2),n=r[0],o=r[1],a=e.filter((function(e){return"updated"===e.key})),c=e.filter((function(e){return"tags"===e.key})),i=[n,c=oe(oe({},c[0]),{},{props:{width:20,isStatic:!0}}),o,a=oe(oe({},a[0]),{},{cellTransforms:[X.P8],props:{width:20}})];return t&&i.splice(2,0,N.$A),i}(e,B)},getEntities:function(){var e=(0,o.Z)(i().mark((function e(t,r){var o,a,s,c,l,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.vulnerabilityParams,a=r.orderBy,s=r.orderDirection,c=(0,n.Z)(r,re),l="".concat("ASC"===s?"":"-").concat(a),I({page:c.page,page_size:c.per_page,sort:l}),e.next=5,k.vk(oe(oe({},o),{},{page:c.page,page_size:c.per_page,sort:l}));case 5:return u=e.sent,e.abrupt("return",Promise.resolve({results:u.data.map((function(e){return oe(oe(oe({},e),e.attributes),{},{insights_id:e.attributes.insights_id})})),total:u.meta.total_items}));case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),hideFilters:{all:!0}},u().createElement(q,{parameters:C,systems:{data:_,meta:{total_items:x}},selectedHosts:a||[],methods:{doOptOut:H,apply:I,handleSelect:function(e,t){t||(t=[]),c(t)},setSelectedHosts:c},actions:!0})))))}}}]);
//# sourceMappingURL=../sourcemaps/Systems.5681fd8c26c7c1baef22.js.map