"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[226],{73642:(e,t,a)=>{a.r(t),a.d(t,{CVEPageContext:()=>Ke,default:()=>Ue});var r=a(42646),s=a(86350),n=a(45697),l=a.n(n),c=a(77865),o=a.n(c),i=a(99385),u=a(14494),m=a(83594),f=a(5977),v=a(6208),d=a(50693),g=a(16475),p=a(49739),E=a(83826),Z=a(68340),N=a(68774),y=a(74806),h=a(30893),b=function(e){var t=e.cveAttributes,a=e.intl,r=t.public_date,s=t.description,n=t.rh_link;return o().createElement(p.K,{hasGutter:!0},o().createElement(E.v,{className:"pf-u-mt-sm"},o().createElement("div",null,a.formatMessage(h.Z.publishDate),": ",r)),o().createElement(E.v,null,o().createElement(N.D,null,o().createElement(Z.x,{component:Z.q.p},s))),o().createElement(E.v,{className:"pf-u-mt-sm pf-u-mb-md"},n))};b.propTypes={cveAttributes:l().any,intl:l().any};const M=(0,y.ZP)(b);var V=a(79851),_=a(34512),x=a(90496),S=a(29648),C=a(45987),P=a(22210),k=a(91290),w=a(3351),D=a(22860),L=a(6934),A=a(75863),j=a(56455),O=a(6023),R=a(24561),T=function(e){if(void 0===e||!1!==e.loading)switch(e.variant){case"spinner":return o().createElement(O.Z,{centered:!0});case"cvePageOverviewItem":return o().createElement(I,null);case"list":return o().createElement(R.aV,null);case"bulletList":return o().createElement(R.DY,null);case"trendBox":return o().createElement(H,null);case"currentVulnerabilitiesItem":return o().createElement(q,null);default:return o().createElement(j.Z,{size:j.i.lg})}return e.children},I=function(){return o().createElement(R.ZP,{height:61,width:120},o().createElement("rect",{x:"35",y:"0",rx:"0",ry:"0",width:"50",height:"35"}),o().createElement("rect",{x:"0",y:"45",rx:"0",ry:"0",width:"120",height:"16"}))},H=function(){return o().createElement(R.ZP,{height:100,width:300},o().createElement("rect",{x:"388.58",y:"109.13",rx:"0",ry:"0",width:"0",height:"0"}),o().createElement("rect",{x:"11.58",y:"16.13",rx:"0",ry:"0",width:"37",height:"62"}),o().createElement("rect",{x:"52.58",y:"52.13",rx:"0",ry:"0",width:"17",height:"26"}),o().createElement("rect",{x:"76.58",y:"52.13",rx:"0",ry:"0",width:"17",height:"26"}),o().createElement("rect",{x:"4.58",y:"82.13",rx:"0",ry:"0",width:"154",height:"22"}))},q=function(){return o().createElement(R.ZP,{height:50,width:200,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},o().createElement("rect",{x:"82.58",y:"15.13",rx:"0",ry:"0",width:"110.88",height:"21.42"}),o().createElement("circle",{cx:"25",cy:"25",r:"25"}))};T.propTypes={loading:l().bool,variant:l().string};const B=T;var J=a(32132),F={AV:{name:J.N.formatMessage(h.Z.vectorNamesV3AV),values:{N:J.N.formatMessage(h.Z.vectorValuesNetwork),A:J.N.formatMessage(h.Z.vectorValuesAdjacent),L:J.N.formatMessage(h.Z.vectorValuesLocal),P:J.N.formatMessage(h.Z.vectorValuesPhysical)}},AC:{name:J.N.formatMessage(h.Z.vectorNamesV3AC),values:{L:J.N.formatMessage(h.Z.vectorValuesLow),H:J.N.formatMessage(h.Z.vectorValuesHigh)}},PR:{name:J.N.formatMessage(h.Z.vectorNamesV3PR),values:{N:J.N.formatMessage(h.Z.vectorValuesNone),L:J.N.formatMessage(h.Z.vectorValuesLow),H:J.N.formatMessage(h.Z.vectorValuesHigh)}},UI:{name:J.N.formatMessage(h.Z.vectorNamesV3UI),values:{N:J.N.formatMessage(h.Z.vectorValuesNone),R:J.N.formatMessage(h.Z.vectorValuesRequired)}},S:{name:J.N.formatMessage(h.Z.vectorNamesV3S),values:{U:J.N.formatMessage(h.Z.vectorValuesUnchanged),C:J.N.formatMessage(h.Z.vectorValuesChanged)}},C:{name:J.N.formatMessage(h.Z.vectorNamesV3C),values:{N:J.N.formatMessage(h.Z.vectorValuesNone),L:J.N.formatMessage(h.Z.vectorValuesLow),H:J.N.formatMessage(h.Z.vectorValuesHigh)}},I:{name:J.N.formatMessage(h.Z.vectorNamesV3I),values:{N:J.N.formatMessage(h.Z.vectorValuesNone),L:J.N.formatMessage(h.Z.vectorValuesLow),H:J.N.formatMessage(h.Z.vectorValuesHigh)}},A:{name:J.N.formatMessage(h.Z.vectorNamesV3A),values:{N:J.N.formatMessage(h.Z.vectorValuesNone),L:J.N.formatMessage(h.Z.vectorValuesLow),H:J.N.formatMessage(h.Z.vectorValuesHigh)}},CVSS:{name:J.N.formatMessage(h.Z.vectorNamesCvssVersion),values:{"3.0":3}}},K={AV:{name:J.N.formatMessage(h.Z.vectorNamesV2AV),values:{N:J.N.formatMessage(h.Z.vectorValuesNetwork),A:J.N.formatMessage(h.Z.vectorValuesAdjacentNetwork),L:J.N.formatMessage(h.Z.vectorValuesLocal)}},AC:{name:J.N.formatMessage(h.Z.vectorNamesV2AC),values:{N:J.N.formatMessage(h.Z.vectorValuesNone),L:J.N.formatMessage(h.Z.vectorValuesLow),H:J.N.formatMessage(h.Z.vectorValuesHigh)}},Au:{name:J.N.formatMessage(h.Z.vectorNamesV2AU),values:{M:J.N.formatMessage(h.Z.vectorValuesMultiple),S:J.N.formatMessage(h.Z.vectorValuesSingle),N:J.N.formatMessage(h.Z.vectorValuesNone)}},C:{name:J.N.formatMessage(h.Z.vectorNamesV2C),values:{C:J.N.formatMessage(h.Z.vectorValuesComplete),P:J.N.formatMessage(h.Z.vectorValuesPartial),N:J.N.formatMessage(h.Z.vectorValuesNone)}},I:{name:J.N.formatMessage(h.Z.vectorNamesV2I),values:{C:J.N.formatMessage(h.Z.vectorValuesComplete),P:J.N.formatMessage(h.Z.vectorValuesPartial),N:J.N.formatMessage(h.Z.vectorValuesNone)}},A:{name:J.N.formatMessage(h.Z.vectorNamesV2A),values:{C:J.N.formatMessage(h.Z.vectorValuesComplete),P:J.N.formatMessage(h.Z.vectorValuesPartial),N:J.N.formatMessage(h.Z.vectorValuesNone)}}},G=a(60329),U=["cvssVersion"],W=function(e){var t,a,s,n=e.cvss2_metrics,l=e.cvss3_metrics,c=e.intl,i=(l?"CVSS 3.0":n&&"CVSS 2.0")||"CVSS 3.0",u=l||n,m=(a=l&&F||n&&K,s={},(t=u)&&t.split("/").forEach((function(e){var t=e.split(":"),n=(0,r.Z)(t,2),l=n[0],c=n[1],o=a[l]&&a[l].name,i=a[l]&&a[l].values[c]||"N/A";o&&(s[o]=i)})),s),f=(m.cvssVersion,(0,C.Z)(m,U));return o().createElement(Ke.Consumer,null,(function(t){return o().createElement(N.D,null,o().createElement(B,{loading:t.isLoading},o().createElement(P.J,{id:"popover-cvss",position:"bottom",maxWidth:"100%",enableFlip:!0,headerContent:"".concat(i," ").concat(c.formatMessage(h.Z.cvssVectorPopoverTitle)),bodyContent:u?o().createElement(w.i,{"aria-label":"Metric breakdown",variant:A.B.compact,gridBreakPoint:"",cells:[c.formatMessage(h.Z.cvssVectorMetric),c.formatMessage(h.Z.cvssVectorValue)],rows:Object.entries(f)},o().createElement(L.x,null),o().createElement(D.R,null)):"N/A"},o().createElement(o().Fragment,null,o().createElement(G.Z,{isLarge:!0,className:"pf-u-mb-xs pointer"},i," ",c.formatMessage(h.Z.cvssVectorVectorString),o().createElement(k.ZP,{color:"var(--pf-global--secondary-color--100)",className:"pf-u-ml-xs"}))))),o().createElement(B,{loading:t.isLoading},o().createElement("span",{className:"pf-u-mr-md"},e.score),o().createElement("span",{id:"cvss-vector-content"},c.formatMessage(h.Z.vector)+": ",(null==u?void 0:u.substring(u.indexOf("/")+1))||"N/A")))}))};W.propTypes={cvss2_metrics:l().string,cvss3_metrics:l().string,score:l().any,intl:l().any};const z=(0,y.ZP)(W);var Y=function(e){var t=e.title,a=e.value,r=e.content;return o().createElement(P.J,{id:"popover",bodyContent:r,headerContent:"",position:"bottom",appendTo:document.querySelector(".vulnerability")},o().createElement(p.K,{className:"popover-content"},o().createElement(E.v,null,o().createElement(G.Z,{isLarge:!0},t)),o().createElement(E.v,null,o().createElement("a",null,a))))};Y.propTypes={title:l().any,value:l().any,content:l().any};const Q=Y;var X=a(69957),$=a(89687),ee=function(e){var t=e.cveAttributes,a=e.intl,r=(0,S.nJ)(t.impact||"Unknown"),s=t.business_risk,n=t.business_risk_justification,l=t.status,c=t.status_justification,i=t.systems_status_detail,u=t.systems_status_divergent,m=i&&Object.keys(i).map((function(e){return[v.Em.find((function(t){return t.value===e.toString()})).label,i[e].toString()]})),f=o().createElement(p.K,{className:"pf-u-p-xs"},o().createElement(E.v,null,o().createElement(G.Z,{className:"pf-u-mb-xs"},a.formatMessage(h.Z.justificationNote))),o().createElement(E.v,null,n||"--")),d=o().createElement(p.K,{className:"pf-u-p-xs"},o().createElement(E.v,null,o().createElement(G.Z,{className:"pf-u-mb-xs"},a.formatMessage(h.Z.cveStatus)),l||"--",o().createElement(G.Z,{className:"pf-u-mb-xs pf-u-mt-sm"},a.formatMessage(h.Z.justificationNote)),c||"--"),u>0&&o().createElement(E.v,null,o().createElement(N.D,null,o().createElement("hr",{className:"pf-u-mt-sm pf-u-mb-sm"})),o().createElement(G.Z,{isLarge:!0},a.formatMessage(h.Z.cveDetailsPageSystemsWTCves)),o().createElement(w.i,{"aria-label":"Status details",gridBreakPoint:"",cells:[a.formatMessage(h.Z.statusLabel),a.formatMessage(h.Z.count)],rows:m,className:"status-breakdown-table",variant:"compact"},o().createElement(L.x,null),o().createElement(D.R,null))));return o().createElement(p.K,{hasGutter:!0},o().createElement(E.v,null,o().createElement(V.P,{hasGutter:!0},o().createElement(_.J,null,o().createElement(Q,{title:a.formatMessage(h.Z.businessRiskLabel),value:s,content:f})),o().createElement(_.J,{className:"pf-u-ml-lg"},o().createElement(Q,{title:a.formatMessage(h.Z.statusLabel),content:d,value:o().createElement("span",null,u>0&&o().createElement(X.ZP,{color:"var(--pf-global--primary-color--100)"})," ",l)})))),o().createElement(E.v,null,o().createElement(G.Z,{className:"pf-u-mb-xs",isLarge:!0},a.formatMessage(h.Z.impact)),o().createElement("span",{id:"severity-shield",style:{color:r.color}},o().createElement($.Z,{impact:r.title,hasLabel:!0}))),o().createElement(E.v,null,o().createElement(z,{cvss2_metrics:t.cvss2_metrics,cvss3_metrics:t.cvss3_metrics,score:(0,x.Z)(t.cvss2_score,t.cvss3_score)})))};ee.propTypes={cveAttributes:l().any,intl:l().any};const te=(0,y.ZP)(ee);var ae=a(44479),re=a(32203),se=a(62394),ne=a(61932),le=a(73727),ce=a(78216),oe=a(68778),ie=a(15265),ue=a(26076),me=a(53411),fe=a(38463),ve=function(e){var t=e.rules,a=e.synopsis,r=e.changeExposedSystemsParameters,s=e.intl,n=(0,u.useDispatch)(),l=[].concat(t).sort((function(e,t){return t.systems_affected-e.systems_affected}));return o().createElement(c.Fragment,null,l&&l.map((function(e,t){var l;return e.summary&&o().createElement(re.Z,{className:"card-box",key:e.rule_id,ouiaId:"security-rule-card-"+t},o().createElement(ne.L,{toggleText:o().createElement(V.P,null,o().createElement(_.J,{className:"pf-u-mr-xl"},o().createElement(N.D,null,o().createElement(Z.x,{component:Z.q.h4},o().createElement(me.Z,{className:"pf-u-mr-sm"}),e.description))),o().createElement(_.J,{id:"filter-affected-systems-split"},e.rule_id&&o().createElement(N.D,null,o().createElement(Z.x,{id:"filter-affected-systems",onClick:function(){return t=e.rule_id,void n(r({rule:t}));var t},component:Z.q.small},o().createElement(le.Link,{key:e.rule_id,to:"/cves/".concat(a,"/?rule=").concat(e.rule_id)},s.formatMessage(h.Z.filterByAffectedSystems,{count:null!==(l=e.systems_affected)&&void 0!==l?l:-1}))))))},o().createElement(se.e,{className:"rule-card-body"},o().createElement(d.r,{hasGutter:!0},o().createElement(g.P,{md:9,sm:12},o().createElement(p.K,{hasGutter:!0},o().createElement(E.v,null,o().createElement(fe.Z,{text:e.summary})),o().createElement(E.v,null,o().createElement(N.D,null,o().createElement(V.P,null,e.rule_impact&&o().createElement(_.J,null,o().createElement(G.Z,{className:"label pf-u-mb-xs"},s.formatMessage(h.Z.impact)),o().createElement(ae.u,{content:Object.values(v.l8)[e.rule_impact-1]},o().createElement(ce.Z,{value:e.rule_impact,className:"severity-label"}))),o().createElement(_.J,null,o().createElement(G.Z,{className:"label pf-u-mb-xs"},s.formatMessage(h.Z.riskOfChange)),o().createElement(ae.u,{content:v.p3[e.change_risk]},v.MS[e.change_risk])),o().createElement(_.J,null,o().createElement(G.Z,{className:"label pf-u-mb-xs"},s.formatMessage(h.Z.remediationLabel)),o().createElement(V.P,null,o().createElement(_.J,null,e.playbook_count?o().createElement(c.Fragment,null,o().createElement(oe.ZP,{className:"checkCircleIcon pf-u-mr-xs"}),s.formatMessage(h.Z.yes),o().createElement(ae.u,{content:s.formatMessage(h.Z.ansibleRemediationTooltip)},o().createElement(k.ZP,{className:"l-sm-spacer outlinedQuestionCircleIcon"}))):s.formatMessage(h.Z.no)),o().createElement(_.J,{className:"pf-u-ml-md"},e.reboot_required&&o().createElement(Z.x,null,o().createElement(ue.ZP,{className:"pf-u-mr-xs powerOffIcon"}),s.formatMessage(h.Z.rebootRequired)))))))),e.kbase_node_id&&o().createElement(E.v,null,o().createElement(N.D,null,o().createElement(Z.x,{className:"pf-u-mt-xs",component:Z.q.p},o().createElement("a",{className:"kb-link",href:"".concat(v.E7,"/").concat(e.kbase_node_id),target:"_blank",rel:"noopener noreferrer"},s.formatMessage(h.Z.knowledgebaseArticle),o().createElement(ie.ZP,{className:"l-sm-spacer"}))))))),o().createElement(g.P,{md:3,sm:12},o().createElement(N.D,null,o().createElement(G.Z,null,s.formatMessage(h.Z.associatedCves)),o().createElement(Z.x,{component:Z.q.p,className:"pf-u-mt-xs associated-cves"},a," (",s.formatMessage(h.Z.current),")",e.associated_cves.filter((function(e){return e!==a})).map((function(e,t){return o().createElement("a",{className:"associated-cve-link",key:t,href:"".concat(v.OF,"/").concat(e)},e)})).reduce((function(e,t){return[e,", ",t]}),[""]))))))))})))};ve.defaultProps={rules:[]},ve.propTypes={intl:l().any,rules:l().array,synopsis:l().string,changeExposedSystemsParameters:l().func};const de=(0,y.ZP)(ve);var ge=a(86896),pe=a(86135),Ee=function(){var e=(0,ge.Z)();return o().createElement(re.Z,{className:"card-box",ouiaId:"known-exploit-card"},o().createElement(ne.L,{toggleText:o().createElement(N.D,null,o().createElement(Z.x,{component:Z.q.h4},o().createElement(pe.Z,{className:"pf-u-mr-sm"}),e.formatMessage(h.Z.knownExploitHeader)))},o().createElement(se.e,null,e.formatMessage(h.Z.knownExploitDescription))))},Ze=function(e){var t=e.data,a=e.changeExposedSystemsParameters;return o().createElement(Ke.Consumer,null,(function(e){return o().createElement(d.r,{hasGutter:!0},o().createElement(g.P,{md:8,sm:12},o().createElement(B,{loading:e.isLoading,variant:"spinner"},o().createElement(M,{cveAttributes:t.data}))),o().createElement(g.P,{md:4,sm:12,className:"pf-u-mt-sm pf-u-ml-sm"},o().createElement(te,{cveAttributes:t.data})),t.data.known_exploit&&o().createElement(Ee,null),o().createElement(de,{changeExposedSystemsParameters:a,synopsis:t.data.synopsis,rules:t.data.rules}))}))};Ze.propTypes={data:l().object,changeExposedSystemsParameters:l().func};const Ne=Ze;var ye=a(19281),he=a(74372),be=a(19738),Me=a(8281),Ve=a(4942),_e=a(66516),xe=a(83296),Se=a(93400),Ce=a(57998),Pe=a(62215),ke=a(16493),we=a(95351),De=a(16369),Le=a(1792),Ae=a(15248),je=a(33739),Oe=a(12140),Re=a(49629),Te=a(66123);function Ie(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function He(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(a),!0).forEach((function(t){(0,Ve.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ie(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var qe=function(e){var t,a=(0,c.useState)((function(){return function(){return null}})),s=(0,r.Z)(a,2),n=s[0],l=s[1],f=(0,c.useState)(void 0),d=(0,r.Z)(f,2),g=d[0],y=d[1],b=o().createRef(),M=(0,u.useDispatch)(),V=(0,S.H1)(v.qB),_=(0,r.Z)(V,2),x=_[0],C=_[1],P=(0,c.useState)(!0),k=(0,r.Z)(P,2),w=k[0],D=k[1],L=(0,u.useSelector)((function(e){return e.CVEDetailsPageStore.affectedSystemsByCVE})),j=(0,u.useSelector)((function(e){return e.CVEDetailsPageStore.affectedSystemsByCVE.isLoading})),O=(0,u.useSelector)((function(e){return e.CVEDetailsPageStore.parameters}),u.shallowEqual),R=(0,u.useSelector)((function(e){return e.CVEDetailsPageStore.affectedSystemsByCVE.payload.meta})),T=(0,c.useMemo)((function(){return(0,i.q6)(He({},L),e.cve)}),[L,e.cve]),I=(0,u.useSelector)((function(e){return e.CVEDetailsPageStore.affectedSystemsByCVE})).error,H=function(e){return M((0,m.vv)(e))},q=function(e,t){y(t||[])};xe.N.addNew({on:"SELECT_ENTITY",callback:function(e){return function(e){var t=e.data.selected?[e.data.id].concat((0,Me.Z)(g||[])):g&&g.filter((function(t){return t!==e.data.id}));q(0,t)}(e)}}),(0,c.useEffect)((function(){H(x),D(!1)}),[]),(0,Oe.Z)((function(){w||(C(He({},O)),M((0,m.TA)(e.cve,He({},O))))}),[O,w]),(0,c.useEffect)((function(){g&&M((0,m.selectMultipleEntities)(g))}),[g,M]),(0,c.useEffect)((function(){return function(){M((0,m.r5)())}}),[M]);var B=function(t,a){l((function(){return function(){return o().createElement(_e.Z,{cveList:t,updateRef:function(){1===T.meta.page?M((0,m.TA)(e.cve,He({},O))):H({page:1}),M((0,m.ZO)(e.cve))},inventoryList:a,type:"systemsExposed"})}}))},J=["",{label:e.intl.formatMessage(h.Z.editStatus),onClick:function(){return B([e.cveStatusDetails],(null===(t=T.data)||void 0===t?void 0:t.filter((function(e){return g.includes(e.inventory_id)}))).map((function(e){return{inventory_id:e.inventory_id,display_name:e.display_name,status_id:e.status_id,justification:e.status_text}})));var t},props:{isDisabled:!g||0===g.length}}],F=(0,c.useMemo)((function(){return(0,Se.Z)({selectedItems:g||[],selectorHandler:q,items:T.data&&T||{data:[],meta:{total_items:0}},fetchResource:function(t){return(0,m.Wf)(e.cve,He(He({},O),t))}})}),[T,g,O,e.cve]),K=(0,c.useMemo)((function(){var e;return null==T||null===(e=T.data)||void 0===e?void 0:e.filter((function(e){return null==g?void 0:g.includes(e.id)}))}),[g,T]),G=null!=T&&null!==(t=T.meta)&&void 0!==t&&t.patch_access?v.RD:v.RD.filter((function(e){return"advisory"!==e.key})),U=(0,we.Z)("filter",h.Z.systemsSearchName,h.Z.searchFilterByName,O.filter,H),W=(0,we.Z)("advisory",h.Z.advisory,h.Z.search,O.advisory,H);return o().createElement(o().Fragment,null,o().createElement(p.K,{hasGutter:!0},o().createElement(E.v,null,o().createElement(N.D,null,o().createElement(Z.x,{component:Z.q.h2},e.intl.formatMessage(h.Z.affectsSystems)))),o().createElement(E.v,null,null!=I&&I.hasError?o().createElement(Te.Z,{code:null==I?void 0:I.errorCode}):o().createElement(je.Z,{disableDefaultColumns:!0,onLoad:function(e){var t=e.mergeWithEntities,a=e.mergeWithDetail;xe.Z.register(He(He({},t((0,Ce.K)(v.jp))),a()))},tableProps:{isStickyHeader:!0,canSelectAll:!1,onSort:T.data.length>0&&function(e,t,a){return(0,S.L6)(t,a,G,x.sort,H)},sortBy:T.data.length>0&&(0,S.hO)(G,R.sort),actionResolver:function(t,a){return T.data.length>0&&(0,i.ji)(B,e.cveStatusDetails,a.rowIndex)},variant:A.B.compact},showTags:!0,key:"inventory",expandable:!0,ref:b,items:T.data,page:R&&R.page||1,perPage:R&&R.page_size||20,total:R&&R.total_items||0,isLoaded:!j,onRefresh:function(e){var t=e.page,a=e.per_page;!b.current||R.page===t&&R.limit===a||H({page:t,page_size:a}),R&&R.total_items<=a&&b.current&&b.current.onRefreshData({page:t,page_size:a})},hasCheckbox:T&&0!==T.length,showActions:T&&0!==T.length,onExpandClick:function(e,t,a,r){var s=r.id;return M((0,m.yw)(s,a))}},o().createElement(Re.Z,{className:"vuln-systems-primary-toolbar",exportConfig:He({isDisabled:0===T.meta.total_items&&(!g||0===g.length),ouiaId:"export"},(0,Ae.HV)({downloadReport:function(t){var a=[e.cve,He({},O)];Pe.Z.exec(m.TA,a,t,"systems-exposed")}})),dedicatedAction:!j&&o().createElement(ke.Z,{manyRules:!0,systems:K,cves:{id:e.cve,rules:e.filterRuleValues}}),actionsConfig:{actions:J,kebabToggleProps:{isDisabled:!g||0===g.length},dropdownProps:{ouiaId:"toolbar-actions"}},activeFiltersConfig:{filters:(0,Ae.DU)(He({},O),e.filterRuleValues),onDelete:function(e,t){return(0,Ae.vH)(t,H)},deleteTitle:e.intl.formatMessage(h.Z.resetFilters)},bulkSelect:F&&{count:g&&g.length,items:F.items,isDisabled:0===T.meta.total_items&&(!g||0===g.length),checked:Boolean(g&&g.length),ouiaId:"bulk-select",onSelect:function(){return F.handleOnCheckboxChange()}},filterConfig:{items:[U,(0,De.Z)(H,O,e.filterRuleValues,{isDynamic:!0,dropdownItems:v.qE}),(0,Le.Z)(H,O),W]}}),n&&o().createElement(n,null)))))};qe.propTypes={intl:l().object,cve:l().string,cveStatusDetails:l().object,filterRuleValues:l().array};const Be=(0,y.ZP)((0,f.EN)(qe));var Je=a(23320),Fe=a(61790),Ke=o().createContext({isLoading:!0}),Ge=function(e){var t,a,n=(0,u.useDispatch)(),l=(0,c.useState)(e.match.params.cve),f=(0,r.Z)(l,1)[0],d=(0,c.useState)((function(){return function(){return null}})),g=(0,r.Z)(d,2),p=g[0],E=g[1],Z=(0,c.useState)((function(){return function(){return null}})),N=(0,r.Z)(Z,2),y=N[0],h=N[1],b=(0,u.useSelector)((function(e){return e.CVEDetailsPageStore.cveDetails})),M=(0,c.useMemo)((function(){return(0,i.m4)(b)}),[b]),V=(0,u.useSelector)((function(e){return e.CVEDetailsPageStore.affectedSystemsByCVE}));(0,c.useEffect)((function(){n((0,m.ZO)(f))}),[n,f]);var _=function(e){h((function(){return function(){return o().createElement(be.Z,{cves:e,updateRef:function(){n((0,m.ZO)(f)),n((0,m.TA)(f))}})}}))};(0,c.useEffect)((function(){return function(){n((0,m.ds)())}}),[n]);var x,S,C=M.error,P=M.data,k={id:f,status_id:M.data.status_id,justification:M.data.status_justification,exposed_systems_count:(null==V||null===(t=V.payload)||void 0===t||null===(a=t.meta)||void 0===a?void 0:a.total_items)||0},w=[(0,ye.Eh)((function(e){E((function(){return function(){return o().createElement(he.Z,{open:!0,cves:e,updateRef:function(){return n((0,m.ZO)(f))}})}}))}),[{business_risk_id:M.data.business_risk_id,id:f,justification:M.data.business_risk_justification}]),(0,ye.bp)(_,[k])],D=P.rules,L=D&&D.map((function(e){return{value:e.rule_id,label:e.description}}));return null!=C&&C.hasError?o().createElement(o().Fragment,null,o().createElement(Je.Z,{title:f}),o().createElement(Te.Z,{code:null==C?void 0:C.errorCode})):o().createElement(o().Fragment,null,o().createElement(Ke.Provider,{value:M&&{isLoading:M.isLoading}},o().createElement(Je.Z,{title:P.celebrity_name?f+" - "+P.celebrity_name:f,actions:w,actionsOuiaId:"cve-actions",breadcrumbs:[{title:v.yy.cvesPage.title,to:v.yy.cvesPage.to,loaded:!0},{title:f,isActive:!0,loaded:!0}],labels:[o().createElement(Fe.Z,{key:"labels",hasExploit:!(null===(x=b.payload.data)||void 0===x||!x.attributes.known_exploit),hasRule:(null===(S=b.payload.data)||void 0===S?void 0:S.attributes.rules.length)>0})]},o().createElement(Ne,{changeExposedSystemsParameters:m.vv,data:M}),o().createElement(y,null),o().createElement(p,null)),o().createElement(s.Z,null,o().createElement(Be,{cve:f,filterRuleValues:L,cveStatusDetails:k,methods:{showStatusModal:_}}))))};Ge.propTypes={match:l().object,cveDetails:l().object,fetchCveDetails:l().func,handleCveDetailsError:l().func};const Ue=(0,f.EN)(Ge)}}]);
//# sourceMappingURL=../sourcemaps/CVEDetailsPage.9028e721e382c1ee7a9b.js.map