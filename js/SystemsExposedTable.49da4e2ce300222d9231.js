"use strict";(self.webpackChunkvulnerability=self.webpackChunkvulnerability||[]).push([[794],{67463:(e,t,n)=>{t.S3=void 0;const i=n(65353);i.__importStar(n(77865)),i.__importDefault(n(62698)),n(38296);var r;(r=t.S3||(t.S3={})).sm="sm",r.md="md",r.lg="lg",r.xl="xl"},63368:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(83237),r=n(78733),a=n(32132),o=n(30893);const s=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).remediation;return{label:a.N.formatMessage(o.Z.filterRemediation),type:i.Y.checkbox,urlParam:"remediation",key:"remediation",filterValues:{onChange:function(t,n){var i;e({remediation:(i=n).length>"0"&&i.filter((function(e){return","!==e})).join(",")||"",page:1})},items:r.Iv.map((function(e){return{label:e.label,value:e.value}})),value:t?t.split(","):[]}}}},66516:(e,t,n)=>{n.d(t,{Z:()=>S});var i=n(29439),r=n(93149),a=n(83115),o=n(59775),s=n(49739),u=n(83826),l=n(41448),c=n(79851),d=n(75824),v=n(34512),f=n(91290),m=n(45697),y=n.n(m),p=n(77865),g=n.n(p),h=n(71478),b=n(91709),_=n(74806),Z=n(30893),E=function(e){var t,n=e.cveList,m=e.updateRef,y=e.inventoryList,_=e.intl,E=e.type,S=(0,b.fj)(B()),w=S.JustificationInput,P=S.justification,j=S.setJustification,D=S.setProps,x=(0,p.useState)(function(){switch(E){case"systemsExposed":if(y.every((function(e){var t,i;return e.status_id===(null===(t=n[0])||void 0===t?void 0:t.status_id)&&e.justification===(null===(i=n[0])||void 0===i?void 0:i.justification)})))return!0;break;case"systemDetail":var e=n.every((function(e,t,n){var i,r;return e.status_id===(null===(i=n[0])||void 0===i?void 0:i.status_id)&&e.justification===(null===(r=n[0])||void 0===r?void 0:r.justification)})),t=n.every((function(e){return e.status_id===e.cve_status_id&&e.justification===e.cve_justification}));if(e&&t)return!0}return!1}()),C=(0,i.Z)(x,2),k=C[0],O=C[1],R=(0,b.Hb)(U()),M=R.StatusSelect,I=R.statusId,F=R.setStatusId,N=R.setProps,T=y.map((function(e){return e.id||e.inventory_id})),L=y.map((function(e){return e.display_name}));function U(){switch(E){case"systemsExposed":return k?n[0].status_id:y.every((function(e,t,n){return e.status_id===n[0].status_id}))?null===(e=y[0])||void 0===e?void 0:e.status_id:"0";var e;case"systemDetail":var t,i;return k?n.every((function(e,t,n){return e.cve_status_id===n[0].cve_status_id}))?null===(t=n[0])||void 0===t?void 0:t.cve_status_id:"0":n.every((function(e,t,n){return e.status_id===n[0].status_id}))?null===(i=n[0])||void 0===i?void 0:i.status_id:"0"}}function B(){switch(E){case"systemsExposed":return k?n[0].justification:y.every((function(e,t,n){var i;return e.justification===(null===(i=n[0])||void 0===i?void 0:i.justification)}))&&(null===(e=y[0])||void 0===e?void 0:e.justification)||"";var e;case"systemDetail":var t,i;return k?n.every((function(e,t,n){var i;return e.cve_status_text===(null===(i=n[0])||void 0===i?void 0:i.cve_status_text)}))&&(null===(t=n[0])||void 0===t?void 0:t.cve_status_text)||"":n.every((function(e,t,n){var i;return e.status_text===(null===(i=n[0])||void 0===i?void 0:i.status_text)}))&&(null===(i=n[0])||void 0===i?void 0:i.status_text)||""}}(0,p.useEffect)((function(){N({isDisabled:k,ouiaId:"status-select"}),D({disabled:k}),F(U()),j(B())}),[k,N,D]);var A={variant:"success",title:"systemsExposed"===E?_.formatMessage(Z.Z.notificationSystemStatusUpdateSuccessful,{count:y.length||0,systemName:L[0]}):_.formatMessage(Z.Z.notificationStatusUpdateSuccessful,{count:n.length||0})},V={variant:"danger",autoDismiss:!1,title:_.formatMessage(Z.Z.notificationStatusUpdateFailureTitle),description:_.formatMessage(Z.Z.notificationStatusUpdateFailureBody)},H=_.formatMessage(Z.Z.cvePairStatusModalTitle,{count:T.length*n.length});return g().createElement(b.ZP,{items:n,onSave:function(){var e=n.map((function(e){return e.id})),t=k?{cve:e,inventory_id:T}:{status_id:parseInt(I),cve:e,status_text:P,inventory_id:T};return(0,h.cr)(t).then(m)},onSuccessNotification:A,onFailureNotification:V,title:H,ouiaId:"status-modal"},g().createElement(s.K,{hasGutter:!0},function(){switch(E){case"systemsExposed":return y.some((function(e,t,n){var i;return e.status_id!==(null===(i=n[0])||void 0===i?void 0:i.status_id)}));case"systemDetail":return n.some((function(e,t,n){var i;return e.status_id!==(null===(i=n[0])||void 0===i?void 0:i.status_id)}))}}()&&g().createElement(u.v,null,g().createElement(l.b,{variant:"warning",isInline:!0,title:_.formatMessage(Z.Z.cvePairStatusModalAlert)})),g().createElement(u.v,null,_.formatMessage(Z.Z.cvePairStatusModalSelected,{cveCount:n.length||0,cveId:null===(t=n[0])||void 0===t?void 0:t.id,systemCount:y.length||0,systemName:L[0],b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return g().createElement("b",null,t)}})),g().createElement(u.v,null,g().createElement(a.l,{key:"key"},g().createElement(o.c,{fieldId:"overall"},g().createElement(c.P,null,g().createElement(v.J,null,g().createElement(r.X,{label:_.formatMessage(Z.Z.cvePairStatusModalUseOverallCheckbox),id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:k,onChange:function(e){return O(e)}})),g().createElement(v.J,null,g().createElement(d.u,{content:_.formatMessage(Z.Z.cvePairStatusModalUseOverallTooltip)},g().createElement(f.ZP,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)",style:{verticalAlign:"0"}}))))),M,w))))};E.propTypes={cveList:y().array,updateRef:y().func,inventoryList:y().array,intl:y().any,type:y().oneOf(["systemsExposed","systemDetail"])};const S=(0,_.ZP)(E)},16493:(e,t,n)=>{n.d(t,{Z:()=>h});var i=n(93433),r=n(29439),a=n(77865),o=n.n(a),s=n(45697),u=n.n(s),l=n(83215),c=n(93942),d=n(30893),v=n(44012),f=n(29648),m=n(2372),y=n(67463),p=n(22663),g=function(e){var t=e.cves,n=e.systems,a=e.manyRules,s=e.isDisabled,u=(0,c.I0)(),g=function(e,t){return{id:"vulnerabilities:".concat(e),description:e,systems:[t]}};return o().createElement(p.Z,{appName:"remediations",module:"./RemediationButton",fallback:o().createElement(m.$,{size:y.S3.lg}),isDisabled:s,dataProvider:function(){return function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[].concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]),a=[].concat(e),o=[];if(t&&1===n.length){var s=(0,r.Z)(n,1)[0];o=a.reduce((function(e,t){var n,r=t.id,a=t.rule,o=g(s.id,r);return a&&(o.id="".concat(o.id,":").concat(null==a||null===(n=a.rule)||void 0===n?void 0:n.rule_id)),[].concat((0,i.Z)(e),[o])}),[]),o=(0,f.X8)(o,"systems")}if(!t&&1===(null==a?void 0:a.length)){var u=(0,r.Z)(a,1)[0];o=n.reduce((function(e,t){var n=t.id,r=t.rule,a=t.rule_id,o=g(n,u);return null!=r&&r.rule_id?o.id="".concat(o.id,":").concat(r.rule_id):a&&(o.id="".concat(o.id,":").concat(a)),[].concat((0,i.Z)(e),[o])}),[])}return!(!n.length||!a.length)&&{issues:o}}(t,n,a)},onRemediationCreated:function(e){return u((0,l.wN)(e.getNotification()))}},o().createElement(v.Z,d.Z.remediateLabel))};g.propTypes={cves:u().oneOfType([u().array,u().string,u().shape({id:u().string,rules:u().array})]),systems:u().oneOfType([u().array,u().string]),manyRules:u().bool,isDisabled:u().bool};const h=g},55216:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var i=n(93433),r=n(4942),a=n(29439),o=n(45697),s=n.n(o),u=n(74806),l=n(30893),c=n(29648),d=n(93942),v=n(77865),f=n.n(v),m=n(66516),y=n(83296),p=n(22167),g=n(57998),h=n(62215),b=n(64091),_=n(78733),Z=n(75863),E=n(33739),S=n(66123),w=n(83215),P=n(24788),j=n(37450),D=n(71478),x=n(97481),C=n(15248),k=n(16493),O=n(16369),R=n(1792),M=n(95351),I=n(92162),F=n(63368),N=n(31863),T=n(79161);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var B=function(e){var t=e.intl,n=e.cveName,r=e.cveStatusDetails,o=e.filterRuleValues,s=e.hasSecurityRule,u=e.canEditPairStatus,L=e.canExport,B=e.inventoryRef,A=e.refreshInventory,V=e.headerFilters,H=(0,j.Wu)([_._I.readHosts],"inventory"),J=(0,a.Z)(H,2),G=(0,a.Z)(J[0],1)[0],K=J[1],W=(0,d.I0)(),X=(0,v.useState)(!1),Y=(0,a.Z)(X,2),q=Y[0],z=Y[1],$=(0,v.useState)((function(){return function(){return null}})),Q=(0,a.Z)($,2),ee=Q[0],te=Q[1],ne=(0,c.H1)(_.qB),ie=(0,a.Z)(ne,2),re=ie[0],ae=ie[1],oe=(0,T.Z)("hbi.ui.inventory-groups"),se=(0,d.v9)((function(e){var t=e.entities;return(null==t?void 0:t.rows)||[]}),d.wU),ue=(0,d.v9)((function(e){var t=e.entities;return null==t?void 0:t.total})),le=(0,d.v9)((function(e){var t=e.entities;return null==t?void 0:t.meta})),ce=(0,d.v9)((function(e){var t=e.entities;return(null==t?void 0:t.error)||{}})),de=(0,d.v9)((function(e){var t=e.entities;return(null==t?void 0:t.selectedRows)||[]})),ve=(0,d.v9)((function(e){var t,n=e.entities;return null!==(t=null==n?void 0:n.selectedRowsCount)&&void 0!==t?t:0})),fe=(0,d.v9)((function(e){var t=e.entities;return(null==t?void 0:t.loaded)||!1})),me=(0,d.v9)((function(e){return e.CVEDetailsPageStore.parameters}),d.wU),ye=(0,d.v9)((function(e){return e.CVEDetailsPageStore.columns})),pe=ye.filter((function(e){return!e.inventoryGroupsFeatureFlag||oe})),ge=function(e){return W((0,b.vv)(e))},he=(0,j.lg)(pe,(function(e){return W((0,b.w8)(e))})),be=(0,a.Z)(he,2),_e=be[0],Ze=be[1];(0,v.useEffect)((function(){return ge(re)}),[]),(0,v.useEffect)((function(){return ae(U({},me))}),[me]),(0,v.useEffect)((function(){return function(){W((0,b.r5)())}}),[W]),(0,v.useEffect)((function(){ge(V)}),[V]),(0,v.useEffect)((function(){!0===(null==le?void 0:le.cves_without_errata)&&(me.advisory_available||me.ignore_default_params||ge({advisory_available:"true"}))}),[null==le?void 0:le.cves_without_errata]);var Ee=function(e,t){te((function(){return function(){return f().createElement(m.Z,{cveList:e,updateRef:function(){A(),W((0,b.ZO)(n))},inventoryList:t,type:"systemsExposed"})}}))},Se=function(e,t){e.data.forEach((function(e){W((0,b.yw)(e.id,!t))})),z(!t)},we=(0,j.U)(D.ip,{id:n,createRows:p.JF}),Pe=(0,v.useState)(0),je=(0,a.Z)(Pe,2),De=je[0],xe=je[1];(0,v.useEffect)((function(){return xe(De+1)}),[ye]);var Ce={data:se,meta:{totalItems:ue},isLoaded:fe},ke=de.filter((function(e){return e.remediation===_.sF})),Oe=[].concat((0,i.Z)(fe?[f().createElement(k.Z,{manyRules:!0,isDisabled:0===de.length,systems:ke,cves:{id:n,rules:o},key:"remediation"})]:[]),(0,i.Z)(u?[{label:t.formatMessage(l.Z.editStatus),onClick:function(){return Ee([r],de)},props:{isDisabled:!ve}}]:[]),[{label:t.formatMessage(l.Z.columnManagementModalTitle),onClick:function(){return Ze(!0)}}]),Re=(0,M.Z)("filter",l.Z.systemsSearchName,l.Z.searchFilterByName,me.filter,ge),Me=(0,M.Z)("advisory",l.Z.advisoryName,l.Z.searchFilterByAdvisoryName,me.advisory,ge),Ie=(0,I.Z)(me.rhel_version,ge),Fe=(0,j.ZS)({rawData:Ce,selectedRows:de,selectedRowsCount:ve,handleSelect:function(e,t){return W((0,b.hd)(e,t))},fetchResource:function(e){return(0,b.I3)(U(U({id:n},me),e))}});q&&Ce.data.filter((function(e){return void 0===e.isOpen})).length>0&&Se(Ce,!1);var Ne=u,Te=U({},null!=le&&le.cves_without_errata?{advisory_available:"true"}:{});return f().createElement(v.Fragment,null,ee&&f().createElement(ee,null),_e,K?f().createElement(x.Z,{centered:!0}):null!=ce&&ce.hasError&&!G?f().createElement(S.Z,{code:null==ce?void 0:ce.errorCode}):f().createElement(E.Z,{disableDefaultColumns:!0,onLoad:function(e){var t=e.mergeWithEntities;y.Z.register(U({},t((0,g.K)(_.jp),U({page:Number(me.page||1),perPage:_.L8},me.sort&&{sortBy:{key:me.sort.replace(/^-/,""),direction:me.sort.match(/^-/)?"desc":"asc"}}))))},tableProps:U(U({isStickyHeader:!0,canSelectAll:!1},s&&{canCollapseAll:!0,onCollapse:function(e,t,n,i){void 0===t?Se(Ce,q):W((0,b.yw)(i.id,n))}}),{},{actionResolver:function(){return u&&ue&&(0,p.ji)(Ee,r)},variant:Z.B.compact}),paginationProps:{isDisabled:!ue},showTagModal:!0,isFullView:!0,ref:B,autoRefresh:!0,key:"conventionalSystems",customFilters:{vulnerabilityParams:U(U({},me),{},{host_type:"rpmdnf"})},columnsCounter:De,columns:function(e){return t=e,pe.filter((function(e){var t;return null!==(t=e.isShown)&&void 0!==t?t:e.isShownByDefault})).map((function(e){return U(U({},t.find((function(t){var n=t.key;return e.key===n}))),e)}));var t},getEntities:we,hasCheckbox:Ne&&0!==ue,showActions:0!==ue,hideFilters:{all:!0,hostGroupFilter:!1},noSystemsTable:f().createElement(P.UE,null),actionsConfig:{actions:Oe,dropdownProps:{ouiaId:"toolbar-actions"}},expandable:s,exportConfig:L&&U({isDisabled:0===ue,ouiaId:"export"},(0,C.HV)({downloadReport:function(e){h.Z.exec(b.TA,U({id:n},me),e,"systems-exposed",(function(e){return W((0,w.wN)(e))}),(function(){return W((0,w.L1)())}))}})),activeFiltersConfig:{filters:(0,C.DU)(U({},me),o),onDelete:function(e,t,n){return(0,C.vH)(t,ge,n,Te)},deleteTitle:t.formatMessage(l.Z.resetFilters),showDeleteButton:!(0,C.Yy)(me,Te,_.de)},bulkSelect:Ne?Fe:void 0,filterConfig:{items:[Re,(0,O.Z)(ge,me,o,{isDynamic:!0,dropdownItems:_.rM.filter((function(e){return"true"!==e.value}))}),(0,R.Z)(ge,me)].concat((0,i.Z)(null!=le&&le.cves_without_errata?[(0,N.Z)(ge,me)]:[]),[Me],(0,i.Z)(Ie),[(0,F.Z)(ge,me)])}}))};B.propTypes={intl:s().object,cveName:s().string,cveStatusDetails:s().object,filterRuleValues:s().array,hasSecurityRule:s().bool,canEditPairStatus:s().bool,canExport:s().bool,inventoryRef:s().object,refreshInventory:s().func,headerFilters:s().object};const A=(0,u.ZP)(B)}}]);
//# sourceMappingURL=../sourcemaps/SystemsExposedTable.b881b378219ddbc7f8025abb483a6ade.js.map