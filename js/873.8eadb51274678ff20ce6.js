"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[873],{63368:(t,e,n)=>{n.d(e,{Z:()=>o});var i=n(44612),a=n(6208),s=n(32132),r=n(30893);const o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.remediation,o=function(e){t({remediation:e.length>"0"&&e.filter((function(t){return","!==t})).join(",")||"",page:1})};return{label:s.N.formatMessage(r.Z.filterRemediation),type:i.Y.checkbox,urlParam:"remediation",filterValues:{onChange:function(t,e){o(e)},items:a.Iv.map((function(t){return{label:t.label,value:t.value}})),value:n?n.split(","):[]}}}},66516:(t,e,n)=>{n.d(e,{Z:()=>j});var i=n(29439),a=n(93149),s=n(83115),r=n(59775),o=n(49739),u=n(83826),l=n(87116),c=n(79851),d=n(35224),v=n(34512),f=n(91290),m=n(45697),y=n.n(m),_=n(77865),p=n.n(_),g=n(71478),h=n(91709),b=n(74806),Z=n(30893),E=function(t){var e,n=t.cveList,m=t.updateRef,y=t.inventoryList,b=t.intl,E=t.type,j=(0,h.fj)(A()),S=j.JustificationInput,M=j.justification,k=j.setJustification,P=j.setProps,x=(0,_.useState)(function(){switch(E){case"systemsExposed":if(y.every((function(t){var e,i;return t.status_id===(null===(e=n[0])||void 0===e?void 0:e.status_id)&&t.justification===(null===(i=n[0])||void 0===i?void 0:i.justification)})))return!0;break;case"systemDetail":var t=n.every((function(t,e,n){var i,a;return t.status_id===(null===(i=n[0])||void 0===i?void 0:i.status_id)&&t.justification===(null===(a=n[0])||void 0===a?void 0:a.justification)})),e=n.every((function(t){return t.status_id===t.cve_status_id&&t.justification===t.cve_justification}));if(t&&e)return!0}return!1}()),C=(0,i.Z)(x,2),N=C[0],I=C[1],w=(0,h.Hb)(J()),D=w.StatusSelect,T=w.statusId,R=w.setStatusId,U=w.setProps,L=y.map((function(t){return t.id||t.inventory_id})),O=y.map((function(t){return t.display_name}));function J(){switch(E){case"systemsExposed":return N?n[0].status_id:y.every((function(t,e,n){return t.status_id===n[0].status_id}))?null===(t=y[0])||void 0===t?void 0:t.status_id:"0";var t;case"systemDetail":var e,i;return N?n.every((function(t,e,n){return t.cve_status_id===n[0].cve_status_id}))?null===(e=n[0])||void 0===e?void 0:e.cve_status_id:"0":n.every((function(t,e,n){return t.status_id===n[0].status_id}))?null===(i=n[0])||void 0===i?void 0:i.status_id:"0"}}function A(){switch(E){case"systemsExposed":return N?n[0].justification:y.every((function(t,e,n){var i;return t.justification===(null===(i=n[0])||void 0===i?void 0:i.justification)}))&&(null===(t=y[0])||void 0===t?void 0:t.justification)||"";var t;case"systemDetail":var e,i;return N?n.every((function(t,e,n){var i;return t.cve_justification===(null===(i=n[0])||void 0===i?void 0:i.cve_justification)}))&&(null===(e=n[0])||void 0===e?void 0:e.cve_justification)||"":n.every((function(t,e,n){var i;return t.justification===(null===(i=n[0])||void 0===i?void 0:i.justification)}))&&(null===(i=n[0])||void 0===i?void 0:i.justification)||""}}(0,_.useEffect)((function(){U({isDisabled:N,ouiaId:"status-select"}),P({disabled:N}),R(J()),k(A())}),[N,U,P]);var F={variant:"success",title:"systemsExposed"===E?b.formatMessage(Z.Z.notificationSystemStatusUpdateSuccessful,{count:y.length||0,systemName:O[0]}):b.formatMessage(Z.Z.notificationStatusUpdateSuccessful,{count:n.length||0})},B={variant:"danger",autoDismiss:!1,title:b.formatMessage(Z.Z.notificationStatusUpdateFailureTitle),description:b.formatMessage(Z.Z.notificationStatusUpdateFailureBody)},X=b.formatMessage(Z.Z.cvePairStatusModalTitle,{count:L.length*n.length});return p().createElement(h.ZP,{items:n,onSave:function(){var t=n.map((function(t){return t.id})),e=N?{cve:t,inventory_id:L}:{status_id:parseInt(T),cve:t,status_text:M,inventory_id:L};return(0,g.cr)(e).then(m)},onSuccessNotification:F,onFailureNotification:B,title:X,ouiaId:"status-modal"},p().createElement(o.K,{hasGutter:!0},function(){switch(E){case"systemsExposed":return y.some((function(t,e,n){var i;return t.status_id!==(null===(i=n[0])||void 0===i?void 0:i.status_id)}));case"systemDetail":return n.some((function(t,e,n){var i;return t.status_id!==(null===(i=n[0])||void 0===i?void 0:i.status_id)}))}}()&&p().createElement(u.v,null,p().createElement(l.b,{variant:"warning",isInline:!0,title:b.formatMessage(Z.Z.cvePairStatusModalAlert)})),p().createElement(u.v,null,b.formatMessage(Z.Z.cvePairStatusModalSelected,{cveCount:n.length||0,cveId:null===(e=n[0])||void 0===e?void 0:e.id,systemCount:y.length||0,systemName:O[0],b:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return p().createElement("b",null,e)}})),p().createElement(u.v,null,p().createElement(s.l,{key:"key"},p().createElement(r.c,{fieldId:"overall"},p().createElement(c.P,null,p().createElement(v.J,null,p().createElement(a.X,{label:b.formatMessage(Z.Z.cvePairStatusModalUseOverallCheckbox),id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:N,onChange:function(t){return I(t)}})),p().createElement(v.J,null,p().createElement(d.u,{content:b.formatMessage(Z.Z.cvePairStatusModalUseOverallTooltip)},p().createElement(f.ZP,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)",style:{verticalAlign:"0"}}))))),D,S))))};E.propTypes={cveList:y().array,updateRef:y().func,inventoryList:y().array,intl:y().any,type:y().oneOf(["systemsExposed","systemDetail"])};const j=(0,b.ZP)(E)},16493:(t,e,n)=>{n.d(e,{Z:()=>g});var i=n(93433),a=n(29439),s=n(77865),r=n.n(s),o=n(45697),u=n.n(o),l=n(83215),c=n(98132),d=n(16712),v=n(36873),f=n(28216),m=n(30893),y=n(44012),_=n(29648),p=function(t){var e=t.cves,n=t.systems,s=t.manyRules,o=t.addNotification,u=function(t,e){return{id:"vulnerabilities:".concat(t),description:t,systems:[e]}};return r().createElement(c.Z,{fallback:null,dataProvider:function(){return function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[].concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]),s=[].concat(t),r=[];if(e&&1===n.length){var o=(0,a.Z)(n,1)[0];r=s.reduce((function(t,e){var n,a=e.id,s=e.rule,r=u(o.id,a);return s&&(r.id="".concat(r.id,":").concat(null==s||null===(n=s.rule)||void 0===n?void 0:n.rule_id)),[].concat((0,i.Z)(t),[r])}),[]),r=(0,_.X8)(r,"systems")}if(!e&&1===(null==s?void 0:s.length)){var l=(0,a.Z)(s,1)[0];r=n.reduce((function(t,e){var n=e.id,a=e.attributes.rule,s=u(n,l);return null!=a&&a.rule_id&&(s.id="".concat(s.id,":").concat(a.rule_id)),[].concat((0,i.Z)(t),[s])}),[])}return!(!n.length||!s.length)&&{issues:r}}(e,n,s)},isDisabled:0===e.length||0===n.length,onRemediationCreated:function(t){return o(t.getNotification())}},r().createElement(d.ZP,{size:"sm",color:"var(--pf-global--BackgroundColor--100)"}),"Â ",r().createElement(y.Z,m.Z.remediateLabel))};p.propTypes={cves:u().oneOfType([u().array,u().string]),systems:u().oneOfType([u().array,u().string]),addNotification:u().func,manyRules:u().bool};const g=(0,f.$j)(null,(function(t){return{addNotification:function(e){return t((0,l.wN)(e))}}}))((0,v.Z)(p))}}]);
//# sourceMappingURL=../sourcemaps/873.1536dd3b3a6a70ca093b8a04496a8076.js.map