"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[783],{35938:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(44612),s=a(6208),r=a(32132),i=a(30893);const l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.business_risk_id,l=function(t){e({business_risk_id:t.length>"0"&&t.filter((function(e){return","!==e})).join(",")||"",page:1})};return{label:r.N.formatMessage(i.Z.filterBusinessRisk),type:n.Y.checkbox,urlParam:"business_risk_id",filterValues:{onChange:function(e,t){l(t)},items:s.eF.map((function(e){return{label:e.label,value:e.value}})),value:a?a.split(","):[]}}}},9088:(e,t,a)=>{a.d(t,{Z:()=>p});var n=a(29439),s=a(44612),r=a(32132),i=a(30893),l=a(27482),u=a(77865),c=a.n(u),o=a(23279),m=a.n(o);const p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=c().useState(),u=(0,n.Z)(a,2),o=u[0],p=u[1],d=c().useState((function(){return m()((function(t){var a=t.cvss_filter;a.from>=0&&a.to<=10&&a.from<=a.to&&e({cvss_from:a.from,cvss_to:a.to,page:1})}),600)})),f=(0,n.Z)(d,1),v=f[0];c().useEffect((function(){return p({from:t.cvss_from||0,to:t.cvss_to||10})}),[t]);var b=function(e){p({from:e.cvss_filter.from,to:e.cvss_filter.to}),v(e)};return{label:r.N.formatMessage(i.Z.cvssBaseScore),type:s.Y.custom,urlParam:"cvss_filter",filterValues:{children:c().createElement(l.Z,{key:"cvss_filter",filterId:"cvss_filter",filterData:{cvss_filter:o},setFilterData:b,className:"pf-u-mb-0",selectProps:{placeholderText:r.N.formatMessage(i.Z.searchFilterCvssRange)}})}}}},90960:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(77865),s=a.n(n),r=a(44612),i=a(6208),l=a(32132),u=a(30893),c=a(27578);const o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.impact,n=function(t){e({impact:t.length>"0"&&t.filter((function(e){return","!==e})).join(",")||"",page:1})};return{label:l.N.formatMessage(u.Z.filterSeverity),type:r.Y.checkbox,urlParam:"impact",filterValues:{onChange:function(e,t){n(t)},items:i.XY.map((function(e){return{label:s().createElement(s().Fragment,null,e.hasIcon&&s().createElement(c.ZP,{className:"pf-u-mr-xs",color:e.iconColor}),e.label),value:e.value}})),value:a?a.split(","):[]}}}},54534:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(44612),s=a(6208),r=a(32132),i=a(30893);const l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.known_exploit,l=function(t){e({known_exploit:t.length>0?null==t?void 0:t.join(","):void 0,page:1})};return{label:r.N.formatMessage(i.Z.filterKnownExploit),type:n.Y.checkbox,filterValues:{onChange:function(e,t){l(t)},items:s.xv.map((function(e){return{label:e.label,value:e.value}})),value:null==a?void 0:a.split(",")}}}},95859:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(44612),s=a(6208),r=a(32132),i=a(30893);const l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.publish_date;""!==a&&a||(a="0");var l=function(t){e({publish_date:"0"!==t&&t||"",page:1})};return{label:r.N.formatMessage(i.Z.filterPublishDate),type:n.Y.radio,urlParam:"publish_date",filterValues:{onChange:function(e,t){l(t)},items:s.GZ.map((function(e){return{label:e.label,value:e.value}})),value:a}}}},5938:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(71070),s=a(45697),r=a.n(s),i=a(77865),l=a.n(i),u=a(6208),c=function(e){var t=e.apply,a=e.meta,s=e.variant,r=a.page,i=a.total_items,c=a.page_size;return l().createElement(n.t,{page:r||1,itemCount:i||0,perPage:c||u.L8,onSetPage:function(e,a){return t({page:a})},onPerPageSelect:function(e,a){return t({page_size:a,page:1})},variant:n.a[s],ouiaId:"pagination-".concat(n.a[s])})};c.defaultProps={variant:"bottom"},c.propTypes={apply:r().func.isRequired,meta:r().object.isRequired,variant:r().string};const o=c},52064:(e,t,a)=>{a.d(t,{c_:()=>B,l3:()=>I,Ek:()=>V});var n=a(87462),s=a(4942),r=a(94654),i=a.n(r),l=a(35224),u=a(69957),c=a(89687),o=a(90496),m=a(35240),p=a(77865),d=a.n(p),f=a(73727),v=a(6208),b=a(37377),_=a(49739),y=a(83826),g=a(68774),E=a(47173),h=a(12908),k=a(45697),Z=a.n(k),x=a(30893),N=a(44012),P=a(60329),j=function(e){var t=e.type,a=e.row.attributes,n=a.business_risk_text,s=a.cve_status_id,r=a.status_text,i=a.status_id,u=0===i&&0===s&&null===r,c=d().createElement(y.v,null,d().createElement(P.Z,null,d().createElement(N.Z,x.Z.justificationNote)),n||"--"),o=v.Em.find((function(e){return e.value===i.toString()})),m=d().createElement(y.v,null,d().createElement(P.Z,null,d().createElement(N.Z,x.Z.cveSystemPairStatus)),(null==o?void 0:o.label)||"--",d().createElement(P.Z,{className:"pf-u-mt-sm"},d().createElement(N.Z,x.Z.justificationNote)),r||"--"),p=v.Em.find((function(e){return e.value===s.toString()})),f=d().createElement(_.K,null,0===t?c:m,d().createElement(y.v,null,d().createElement(g.D,null,d().createElement("hr",{className:"splitter pf-u-mb-md pf-u-mt-md"})),d().createElement(P.Z,{className:"pf-u-mt-sm"},d().createElement(N.Z,x.Z.cveStatus))),d().createElement(y.v,null,(null==p?void 0:p.label)||"--")),k={wordBreak:"normal",color:u?"black":"",whiteSpace:"unset",maxWidth:"131px",textAlign:"left",padding:"0px"};return d().createElement(b.J,{bodyContent:f,id:"popover","aria-label":"Business risk popover",position:"left",appendTo:document.querySelector(".vulnerability")},d().createElement(E.zx,{variant:"link",isSmall:!0,isDisabled:u,style:k},s!==i?d().createElement(l.u,{content:d().createElement(N.Z,x.Z.onlyThisSystemCvePair)},d().createElement(h.ZP,{className:"pf-u-m-l"})):""," ",(null==o?void 0:o.label)||"--"))};j.propTypes={type:Z().number,row:Z().object};const w=j;var S=a(32132),O=a(68340),C=a(53411),L=a(38463),M=function(e){var t=e.description,a=e.rules,n=e.cve;return d().createElement(g.D,{className:"expanded-cell"},d().createElement(P.Z,{className:"pf-u-mb-sm"},d().createElement(N.Z,x.Z.description)),d().createElement(O.x,{component:O.q.p},t),d().createElement(_.K,{hasGutter:!0},a&&a.map((function(e,t){return e&&d().createElement("div",{key:t,className:"rule"},d().createElement(C.Z,{className:"pf-u-mr-sm"}),d().createElement(P.Z,{isInline:!0},d().createElement("span",{className:"rule-name"},e.description||e.rule_id)),d().createElement(L.Z,{text:e.summary,truncate:!1,className:"pf-u-mt-xs"}))})),d().createElement(y.v,{className:"rule-link"},V(n,S.N.formatMessage(x.Z.viewMoreAboutThisCve)))))};M.propTypes={description:Z().string,rules:Z().array,cve:Z().string};const D=M;var R=a(70630),T=a(61790),A=a(72757);function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(Object(a),!0).forEach((function(t){(0,s.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function B(e,t){var a=e&&e.isLoading;if(!a){var n=e.payload,s=n.data,r=n.meta,p=n.errors,b=s&&s.length,_=t.reduce((function(e,t){return t.isShown?e.concat(t.key):e}),[]),y=function(e){var t,a;return{synopsis:d().createElement("span",{key:e.id},d().createElement(f.rU,{to:"/cves/"+e.attributes.synopsis,className:"pf-u-mr-sm cve-synopsis"},e.attributes.synopsis),d().createElement(T.Z,{hasExploit:e.attributes.known_exploit,hasRule:(null===(t=e.attributes)||void 0===t||null===(a=t.rules)||void 0===a?void 0:a.length)>0})),public_date:d().createElement("span",{key:e.id},(0,m.Un)(e.attributes.public_date)),impact:d().createElement("span",{key:e.id},d().createElement(c.Z,{impact:e.attributes.impact,hasLabel:!0})),cvss_score:d().createElement("span",{key:e.id},(0,o.Z)(e.attributes.cvss2_score,e.attributes.cvss3_score,!0)),systems_affected:d().createElement("span",{key:e.id},V(e.attributes.synopsis,e.attributes.systems_affected.toString())),business_risk:d().createElement("span",{key:e.id},v.eF.find((function(t){return t.value===e.attributes.business_risk_id.toString()})).label),status:d().createElement("span",{key:e.id},e.attributes.systems_status_divergent>0?d().createElement(l.u,{content:d().createElement(N.Z,x.Z.createCveListByAccountTooltip)},d().createElement(u.ZP,{color:"var(--pf-global--warning-color--100)"})):""," ",v.Em.find((function(t){return t.value===e.attributes.status_id.toString()})).label)}};return{data:s=s&&i()(s,(function(e,t){return[{id:e.id,business_risk_id:e.attributes.business_risk_id,business_risk_justification:e.attributes.business_risk_text,status_id:e.attributes.status_id,status_justification:e.attributes.status_text,rules:e.attributes.rules,exposed_systems_count:e.attributes.systems_affected,cells:_.map((function(t){return{title:y(e)[t]}})),isOpen:!1,selected:!1},{cells:[{title:d().createElement(D,{description:e.attributes.description,rules:e.attributes.rules,cve:e.attributes.synopsis})}],fullWidth:!0,parent:2*t}]})),meta:Y(Y({},r),{},{cvesCount:b}),isLoading:a,errors:p}}return{data:[],meta:e.payload&&e.payload.meta||{},isLoading:a}}function I(e,t,a){var n=t&&t.isLoading;if(!n){var s,r=t.payload,l=r.data,u=r.meta,p=r.errors,f=l&&l.length,b=a.reduce((function(e,t){return t.isShown?e.concat(t.key):e}),[]),_=function(e){var t;return{synopsis:d().createElement("span",{key:e.id},V(e.attributes.synopsis,void 0,{className:"pf-u-mr-sm",style:{display:"block"}}),d().createElement(T.Z,{hasExploit:e.attributes.known_exploit,hasRule:!!e.attributes.rule})),public_date:d().createElement("span",{key:e.id},(0,m.Un)(e.attributes.public_date)),impact:d().createElement("span",{key:e.id},d().createElement(c.Z,{impact:e.attributes.impact,hasLabel:!0})),cvss_score:d().createElement("span",{key:e.id},(0,o.Z)(e.attributes.cvss2_score,e.attributes.cvss3_score,!0)),advisory:d().createElement("span",{key:"advisory"},d().createElement(R.Z,{cve:null==e?void 0:e.id,advisoriesList:null==e||null===(t=e.attributes)||void 0===t?void 0:t.advisories_list})),business_risk:d().createElement("span",{key:e.id},v.eF.find((function(t){return t.value===e.attributes.business_risk_id.toString()})).label),status:d().createElement("span",{key:e.id},d().createElement(w,{row:e,type:1})),advisory_available:d().createElement("span",{key:"remediation-column"},d().createElement(A.Z,{fixable:e.attributes.advisory_available}))}},y=l&&i()(l,(function(e,t){return[{id:e.id,business_risk_id:e.attributes.business_risk_id,business_risk_justification:e.attributes.business_risk_text,status_id:e.attributes.status_id,rules:e.attributes.rule,cve_status_id:e.attributes.cve_status_id,status_justification:e.attributes.status_text,cve_status_justification:e.attributes.cve_status_text,cells:b.map((function(t){return{title:_(e)[t]}})),isOpen:!1,selected:!1},{cells:[{title:d().createElement(D,{description:e.attributes.description,rules:[e.attributes.rule],cve:e.attributes.synopsis})}],fullWidth:!0,parent:2*t}]}));return null!=u&&u.patch_access||(y=null===(s=y)||void 0===s?void 0:s.map((function(e){return Y(Y({},e),{},{cells:e.cells.filter((function(e){var t;return"advisory"!==(null==e||null===(t=e.title)||void 0===t?void 0:t.key)}))})}))),{data:y,meta:Y(Y({},u),{},{cvesCount:f}),errors:p,isLoading:n}}return{data:[],meta:t.payload&&t.payload.meta||{},isLoading:n}}function V(e,t,a){return-1!==location.href.indexOf("vulnerability")?d().createElement(f.rU,(0,n.Z)({to:"/cves/"+e},a),t||e):d().createElement("a",(0,n.Z)({href:"".concat(v.OF,"/").concat(e)},a),t||e)}},93400:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(93386),s=a.n(n),r=a(30893),i=a(32132);const l=function(e){var t=e.selectedItems,a=e.selectorHandler,n=e.items,l=e.fetchResource,u=e.multiRow,c=void 0!==u&&u,o=Array.from(t),m=o&&o.length,p=n.meta,d=n.data,f=d&&(Array.isArray(d)&&d.length&&c?d.length/2:d.length),v=function(){a(!1,[])},b=function(){var e=(l&&l({page_size:p.total_items,page:1})).payload;e&&e.then((function(e){var t=e.data.map((function(e){return e.id&&e.id||e}));a(!0,t)}))};return{handleOnCheckboxChange:function(){0===m?b():v()},items:[{title:i.N.formatMessage(r.Z.selectNone),onClick:v},{title:"".concat(i.N.formatMessage(r.Z.selectPage,{count:f})),onClick:function(){var e=n.data,t=s()(e.filter((function(e){return e.id})).map((function(e){return e.id})),o);a(!0,t)}},{title:"".concat(i.N.formatMessage(r.Z.selectAll,{count:p.total_items?p.total_items:0})),onClick:b}]}}}}]);
//# sourceMappingURL=../sourcemaps/783.50485e233f852d1e486e3b7ef6bcecf7.js.map