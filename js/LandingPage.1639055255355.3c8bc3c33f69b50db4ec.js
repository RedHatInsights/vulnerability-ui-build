"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[1013],{41489:(e,t,n)=>{n.d(t,{Ec:()=>c,Eh:()=>u,bp:()=>f});var r=n(87462),a=n(84457),o=n(77865),i=n.n(o),s=n(30893),l=n(44012),c=function(e,t,n){var o=(0,r.Z)({},n);return i().createElement(a.h,(0,r.Z)({key:"pdf",component:"button",onClick:function(){return t(!0)}},o),e?i().createElement(l.Z,s.Z.loading):i().createElement(l.Z,s.Z.kebabExportAsPDF))},u=function(e,t,n){var o=(0,r.Z)({},n);return i().createElement(a.h,(0,r.Z)({key:"editBusinessRisk",component:"button",onClick:function(){return e(t)}},o),i().createElement(l.Z,s.Z.kebabEditBusinessRisk))},f=function(e,t,n,o){var c=(0,r.Z)({},o);return i().createElement(a.h,(0,r.Z)({key:"editStatus",component:"button",onClick:function(){return e(t,n)}},c),i().createElement(l.Z,s.Z.kebabEditStatus))}},74738:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Ee});var r=n(77865),a=n.n(r),o=n(44012),i=n(79706),s=n(91290),l=n(15265),c=n(30893),u=n(86350),f=n(75115),p=n(4942),d=n(93433),m=n(29439),v=n(28216),b=n(49739),g=n(83826),y=n(78733),E=n(52064),h=n(29648),Z=n(74372),S=n(19738),k=n(87462),O=n(45697),_=n.n(O),C=n(3351),w=n(22860),j=n(6934),P=n(75863),x=n(75959),M=n(43003),R=n(5938),I=n(24788);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=function(e){var t=e.context,n=e.header,o=e.canEditStatusOrBusinessRisk,i=t.cves,s=t.methods,l=t.selectedCves,u=t.expandedRows,f=0===i.data.length,p=i.data&&i.data.map((function(e){return l.includes(e.id)&&B(B({},e),{},{selected:!0})||e})).map((function(e,t){var n=t%2==0?u.includes(e.id):void 0;return B(B({},e),{},{isOpen:n})}));return i.isLoading?a().createElement(x.Z,{colSize:null==n?void 0:n.length,rowSize:20,variant:P.B.compact}):a().createElement(r.Fragment,null,a().createElement(C.i,{canSelectAll:!1,"aria-label":"Vulnerability CVE table",cells:n,rows:f?[{heightAuto:!0,cells:[{props:{colSpan:null==n?void 0:n.length},title:a().createElement(I.lP,{secondParagraph:"true"===t.params.affecting?c.Z.emptyStateYourSystemsShouldHaveCVEs:c.Z.emptyStateThereShouldBeCVEs})}]}]:p,onSelect:f?void 0:function(e,n,r){var a=t.cves,o=t.methods,i=a.data[r]&&a.data[r].id;o.selectCves(n,i)},onCollapse:f?void 0:function(e,t){return s.openCves(t)},actionResolver:o&&i.data.length>0?function(e,t){return(0,M.hA)(s,t.rowIndex)}:void 0,sortBy:f?void 0:(0,h.hO)([{key:"collapse"},{key:"checkbox"}].concat((0,d.Z)(n)),i.meta.sort),onSort:f?void 0:function(e,t,r){return(0,h.L6)(t,r,[{key:"collapse"},{key:"checkbox"}].concat((0,d.Z)(n)),i.meta.sort,s.apply)},ouiaId:"cves-table",isStickyHeader:!0,variant:P.B.compact},a().createElement(j.x,null),a().createElement(w.R,null)),a().createElement(R.Z,{meta:i.meta,apply:s.apply}))};A.propTypes={context:_().any,header:_().array,canEditStatusOrBusinessRisk:_().bool};const F=function(e){return a().createElement(ge.Consumer,null,(function(t){return a().createElement(A,(0,k.Z)({context:t},e))}))};var T=n(74806),V=n(83594),N=n(93400),L=n(98621),U=n(44612),z=n(32132);const H=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.affecting,r=function(t){e({affecting:t.length>0?null==t?void 0:t.join(","):void 0,page:1})};return{label:z.N.formatMessage(c.Z.filterSystemsExposed),type:U.Y.checkbox,urlParam:"affecting",filterValues:{onChange:function(e,t){r(t)},items:y.qr.map((function(e){return{label:e.label,value:e.value}})),value:null==n?void 0:n.split(",")}}};var Y=n(95859),J=n(9088),K=n(90960),q=n(95351),G=n(16369),W=n(35938),X=n(54534),$=n(1792),Q=n(41489),ee=n(33084),te=n(15248);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae=function(e){var t=(0,r.useState)(!1),n=(0,m.Z)(t,2),o=n[0],i=n[1],s=e.context,l=e.canEditStatusOrBusinessRisk,u=e.canExport,f=s.cves,p=s.params,v=s.methods,b=s.selectedCves,g=s.isAllExpanded,E=s.selectedRowsRawData,h=p.filter,Z=b&&b.length,S=(0,N.Z)({selectedItems:b,selectorHandler:v.selectCves,items:f,fetchResource:function(e){return(0,V.cW)(re(re({},p),e))},multiRow:!0}),k=[""].concat((0,d.Z)(l?[{label:e.intl.formatMessage(c.Z.editBusinessRisk),onClick:function(){return v.showBusinessRiskModal(E.map((function(e){var t=e.id,n=e.attributes;return{id:t,business_risk_id:n.business_risk_id,justification:n.business_risk_text}})),!0)},props:{isDisabled:!Z}},{label:e.intl.formatMessage(c.Z.editStatus),onClick:function(){return v.showStatusModal(E.map((function(e){var t=e.id,n=e.attributes;return{id:t,exposed_systems_count:n.systems_affected,justification:n.status_text,status_id:n.status_id}}),[]),!0)},props:{isDisabled:!Z}}]:[]),[{label:e.intl.formatMessage(c.Z.columnManagementModalTitle),onClick:function(){return v.setColumnModalOpen(!0)}}]);return a().createElement(a().Fragment,null,a().createElement(L.Z,{pagination:{isDisabled:0===f.meta.total_items,itemCount:f.meta.total_items||0,page:f.meta.page||1,perPage:f.meta.page_size||1,ouiaId:"pagination-top",onSetPage:function(e,t){return(0,te.A6)(e,t,v.apply)},onPerPageSelect:function(e,t){return(0,te.lO)(e,t,v.apply)}},actionsConfig:{actions:k,dropdownProps:{ouiaId:"toolbar-actions"}},bulkSelect:{count:Z,items:S.items,isDisabled:0===f.meta.total_items&&0===Z,checked:Boolean(Z),ouiaId:"bulk-select",onSelect:function(){return S.handleOnCheckboxChange()}},filterConfig:{items:[(0,q.Z)("filter",c.Z.cve,c.Z.searchFilterByCveID,h,v.apply),(0,G.Z)(v.apply,p),(0,X.Z)(v.apply,p),(0,K.Z)(v.apply,p),(0,J.Z)(v.apply,p),(0,W.Z)(v.apply,p),H(v.apply,p),(0,Y.Z)(v.apply,p),(0,$.Z)(v.apply,p)]},activeFiltersConfig:{filters:(0,te.DU)(p),onDelete:function(e,t,n){return(0,te.vH)(t,v.apply,n,y.MM)},deleteTitle:e.intl.formatMessage(c.Z.resetFilters),showDeleteButton:!(0,te.Yy)(p,y.MM,y.fU)},exportConfig:u&&re({isDisabled:0===f.meta.total_items,extraItems:[(0,Q.Ec)(o,i)],ouiaId:"export"},(0,te.HV)(v)),expandAll:{isAllExpanded:g,onClick:function(){var t=e.context,n=t.cves,r=t.methods,a=t.isAllExpanded?[]:n.data.filter((function(e){return e.id})).map((function(e){return e.id}));r.openCves(a)}}}),o&&a().createElement(ee.Z,{showButton:!1,params:p,filters:(0,te.DU)(p),onSuccess:function(){return i(!1)}}))};ae.propTypes={context:_().object,intl:_().object,canEditStatusOrBusinessRisk:_().bool,canExport:_().bool},ae.defaultProps={totalNumber:0,apply:function(){},downloadReport:function(){}};const oe=(0,T.ZP)((function(e){return a().createElement(ge.Consumer,null,(function(t){return a().createElement(ae,(0,k.Z)({context:t},e))}))}));var ie=n(62215),se=n(83215),le=n(66123),ce=n(66761),ue=Object.prototype.hasOwnProperty;function fe(e,t,n){for(n of e.keys())if(pe(n,t))return n}function pe(e,t){var n,r,a;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((r=e.length)===t.length)for(;r--&&pe(e[r],t[r]););return-1===r}if(n===Set){if(e.size!==t.size)return!1;for(r of e){if((a=r)&&"object"==typeof a&&!(a=fe(t,a)))return!1;if(!t.has(a))return!1}return!0}if(n===Map){if(e.size!==t.size)return!1;for(r of e){if((a=r[0])&&"object"==typeof a&&!(a=fe(t,a)))return!1;if(!pe(r[1],t.get(a)))return!1}return!0}if(n===ArrayBuffer)e=new Uint8Array(e),t=new Uint8Array(t);else if(n===DataView){if((r=e.byteLength)===t.byteLength)for(;r--&&e.getInt8(r)===t.getInt8(r););return-1===r}if(ArrayBuffer.isView(e)){if((r=e.byteLength)===t.byteLength)for(;r--&&e[r]===t[r];);return-1===r}if(!n||"object"==typeof e){for(n in r=0,e){if(ue.call(e,n)&&++r&&!ue.call(t,n))return!1;if(!(n in t)||!pe(e[n],t[n]))return!1}return Object.keys(t).length===r}}return e!=e&&t!=t}var de=n(6023),me=n(37450);function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ge=a().createContext({});const ye=function(){var e,t,n,o,i,s=(0,v.I0)(),l=(0,r.useState)((function(){return function(){return null}})),c=(0,m.Z)(l,2),u=c[0],f=c[1],p=(0,r.useState)((function(){return function(){return null}})),k=(0,m.Z)(p,2),O=k[0],_=k[1],C=(0,r.useState)(!1),w=(0,m.Z)(C,2),j=w[0],P=w[1],x=(0,r.useState)(!1),M=(0,m.Z)(x,2),R=M[0],D=M[1],B=(0,me.Wu)([y._I.setCveStatusAndBusinessRisk,y._I.basicReporting,y._I.readVulnerabilityResults]),A=(0,m.Z)(B,2),T=(0,m.Z)(A[0],3),N=T[0],L=T[1],U=T[2],z=A[1],H=(0,v.v9)((function(e){return e.CVEsStore.cveList})),Y=(0,v.v9)((function(e){return e.CVEsStore.parameters})),J=(0,v.v9)((function(e){return e.CVEsStore.columns})),K=(0,v.v9)((function(e){return e.CVEsStore.selectedCves})),q=(0,v.v9)((function(e){return e.CVEsStore.selectedRowsRawData})),G=(0,v.v9)((function(e){return e.CVEsStore.expandedRows})),W=(0,v.v9)((function(e){return e.CVEsStore.isAllExpanded})),X=(0,r.useMemo)((function(){return(0,E.c_)(H,J)}),[H,J]),$=(0,h.H1)(["show_irrelevant"].concat((0,d.Z)(y.kO))),Q=(0,m.Z)($,2),ee=Q[0],te=Q[1],ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,h.pX)(e);s((0,V.yM)(t))};return(0,r.useEffect)((function(){ne(ee)}),[]),e=function(){s((0,V.jh)(Y)),j?te(be({},Y)):P(!0)},t=[Y],r.useEffect(e,(n=t,o=r.useRef(n),i=r.useRef(0),pe(n,o.current)||(o.current=n,i.current+=1),r.useMemo((function(){return o.current}),[i.current]))),(0,r.useEffect)((function(){return function(){s((0,V.Ss)()),s((0,se.L1)())}}),[s]),X.errors?a().createElement(le.Z,{code:parseInt(X.errors.status)}):z?a().createElement(de.Z,{centered:!0}):U?a().createElement(ge.Provider,{value:{cves:X,selectedRowsRawData:q,params:Y,selectedCves:K,expandedRows:G,isAllExpanded:W,methods:{apply:ne,downloadReport:function(e){ie.Z.exec(V.jh,Y,e,"cves",(function(e){return s((0,se.wN)(e))}),(function(){return s((0,se.L1)())}))},selectCves:function(e,t){s((0,V.EY)(t||[]))},showBusinessRiskModal:function(e,t){var n=X.meta;_((function(){return function(){return a().createElement(Z.Z,{cves:e,updateRef:function(){s((0,V.Ss)()),(0,h.$)(t?be(be({},n),{},{page:1}):n,Y,ne)}})}}))},showStatusModal:function(e,t){var n=X.meta;f((function(){return function(){return a().createElement(S.Z,{cves:e,updateRef:function(){s((0,V.Ss)()),(0,h.$)(t?be(be({},n),{},{page:1}):n,Y,ne)}})}}))},openCves:function(e){s((0,V.Rk)(e))},setColumnModalOpen:D}}},a().createElement(O,null),a().createElement(u,null),a().createElement(ce.Z,{appliedColumns:J,applyColumns:function(e){return s((0,V.vP)(e))},isModalOpen:R,setModalOpen:D}),a().createElement(b.K,null,a().createElement(g.v,null,a().createElement(oe,{canEditStatusOrBusinessRisk:N,canExport:L})),a().createElement(g.v,null,a().createElement(F,{header:J.filter((function(e){var t;return null!==(t=e.isShown)&&void 0!==t?t:e.isShownByDefault})),canEditStatusOrBusinessRisk:N})))):a().createElement(I.bY,null)},Ee=function(){var e=a().createElement(i.J,{enableFlip:!0,position:"right",headerContent:a().createElement(o.Z,c.Z.ovalPopoverHeader),bodyContent:a().createElement(o.Z,c.Z.ovalPopoverBody),footerContent:a().createElement("a",{href:"https://access.redhat.com/documentation/en-us/red_hat_insights/2021/html/assessing_and_monitoring_security_vulnerabilities_on_rhel_systems/index",target:"__blank",rel:"noopener noreferrer"},a().createElement(o.Z,c.Z.learnMore)," ",a().createElement(l.ZP,null))},a().createElement("span",null,a().createElement(o.Z,c.Z.cvesHeader),a().createElement(s.ZP,{color:"var(--pf-global--secondary-color--100)",className:"pf-u-ml-sm pointer cves-header-questionmark",style:{verticalAlign:"0"}})));return a().createElement(r.Fragment,null,a().createElement(f.Z,{title:e,showBreadcrumb:!1}),a().createElement(u.Z,null,a().createElement(ye,null)))}},74372:(e,t,n)=>{n.d(t,{Z:()=>h});var r=n(29439),a=n(83115),o=n(59775),i=n(92504),s=n(49739),l=n(83826),c=n(23393),u=n(45697),f=n.n(u),p=n(77865),d=n.n(p),m=n(71478),v=n(78733),b=n(91709),g=n(74806),y=n(30893),E=function(e){var t=e.cves,n=e.updateRef,u=e.intl,f=(0,p.useState)(t),g=(0,r.Z)(f,1)[0],E=(0,p.useState)("0"),h=(0,r.Z)(E,2),Z=h[0],S=h[1],k=(0,p.useState)(),O=(0,r.Z)(k,2),_=O[0],C=O[1],w=(0,p.useCallback)((function(){C(g&&1===g.length&&g[0].justification||"")}),[g]);(0,p.useEffect)((function(){S(g&&1===g.length&&g[0].business_risk_id.toString()||"0"),w()}),[t,w,g]),(0,p.useEffect)(w,[w]);var j=function(e,t){var n=t.currentTarget.value;S(n)},P={variant:"success",title:u.formatMessage(y.Z.notificationBusinessRiskUpdateSuccessful,{count:g.length||0})},x={variant:"danger",autoDismiss:!1,title:u.formatMessage(y.Z.notificationBusinessRiskUpdateFailureTitle),description:u.formatMessage(y.Z.notificationBusinessRiskUpdateFailureBody)};return d().createElement(b.ZP,{items:g,onSave:function(){return(0,m.le)({business_risk_id:parseInt(Z),cve:g.map((function(e){return e.id})),business_risk_text:_}).then(n).catch((function(e){throw e}))},onSuccessNotification:P,onFailureNotification:x,title:u.formatMessage(y.Z.businessRiskModalTitle),ouiaId:"business-risk-modal"},d().createElement(s.K,{hasGutter:!0},d().createElement(l.v,null,u.formatMessage(y.Z.businessRiskModalInfo)),d().createElement(l.v,null,d().createElement(a.l,null,d().createElement(o.c,{label:u.formatMessage(y.Z.businessRiskLabel),fieldId:"businessRiskId"},v.eF.map((function(e){return d().createElement(i.Y,{className:"business-risk-radio",value:e.value,isChecked:Z===e.value,onChange:j,label:e.label,key:e.value,id:e.value,name:e.label,"aria-label":e.label,ouiaId:"business-risk-radio"})}))),d().createElement(o.c,{label:u.formatMessage(y.Z.justificationLabel),fieldId:"label"},d().createElement(c.Kx,{type:"text",onChange:function(e){C(e)},value:_,resizeOrientation:"vertical","aria-label":"justification",style:{minHeight:"2.25rem"}}))))))};E.propTypes={cves:f().array,updateRef:f().func,intl:f().any};const h=(0,g.ZP)(E)},19738:(e,t,n)=>{n.d(t,{Z:()=>k});var r=n(29439),a=n(93149),o=n(83115),i=n(59775),s=n(79851),l=n(34512),c=n(49739),u=n(83826),f=n(35224),p=n(53688),d=n(91290),m=n(45697),v=n.n(m),b=n(77865),g=n.n(b),y=n(71478),E=n(91709),h=n(74806),Z=n(30893),S=function(e){var t=e.cves,n=e.updateRef,m=e.intl,v=(0,b.useState)(t),h=(0,r.Z)(v,1)[0],S=(0,E.Hb)(h&&h.every((function(e){return e.status_id===h[0].status_id}))&&h[0].status_id.toString()||"0"),k=S.StatusSelect,O=S.statusId,_=S.setProps,C=(0,E.fj)(h&&h.every((function(e){return e.justification===h[0].justification}))&&h[0].justification||""),w=C.JustificationInput,j=C.justification,P=(0,b.useState)(!1),x=(0,r.Z)(P,2),M=x[0],R=x[1],I=h.filter((function(e){return e.exposed_systems_count>0})).map((function(e){return e.id}));(0,b.useEffect)((function(){_({ouiaId:"status-select"})}),[_]);var D={variant:"success",title:m.formatMessage(Z.Z.notificationStatusUpdateSuccessful,{count:h.length||0})},B={variant:"danger",autoDismiss:!1,title:m.formatMessage(Z.Z.notificationStatusUpdateFailureTitle),description:m.formatMessage(Z.Z.notificationStatusUpdateFailureBody)},A=m.formatMessage(Z.Z.cveStatusModalTitle,{count:h.length||0});return g().createElement(E.ZP,{items:h,onSave:function(){return Promise.all([(0,y.xn)({cve:h.map((function(e){return e.id})),status_id:parseInt(O),status_text:j})].concat([!M&&I.length>0&&(0,y.cr)({cve:I,status_id:parseInt(O),status_text:j})])).then((function(){return n(!M)})).catch((function(e){throw e}))},onSuccessNotification:D,onFailureNotification:B,title:A,ouiaId:"status-modal"},g().createElement(c.K,{hasGutter:!0},g().createElement(u.v,null,m.formatMessage(Z.Z.cveStatusModalSelected,{count:h.length||0,cveId:h[0].id,b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return g().createElement("b",null,t)}})),g().createElement(u.v,null,g().createElement(p.ZP,{className:"pf-u-mr-xs",fontSize:"var(--pf-global--FontSize--md)",color:"var(--pf-global--active-color--300)"}),m.formatMessage(Z.Z.cveStatusModalInfo,{count:h.length||0}),g().createElement(f.u,{content:m.formatMessage(Z.Z.cveStatusModalInfoTooltip)},g().createElement(d.ZP,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)"}))),g().createElement(u.v,null,g().createElement(o.l,{key:"key"},k,w,I.length>0&&g().createElement(i.c,{fieldId:"overwrite"},g().createElement(s.P,null,g().createElement(l.J,null,g().createElement(a.X,{label:m.formatMessage(Z.Z.cveStatusModalOverwriteCheckbox),id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:M,onChange:function(e){return R(e)}})),g().createElement(l.J,null,g().createElement(f.u,{content:m.formatMessage(Z.Z.cveStatusModalOverwriteTooltip)},g().createElement(d.ZP,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)",style:{verticalAlign:"0"}})))))))))};S.propTypes={cves:v().array,updateRef:v().func,intl:v().any};const k=(0,h.ZP)(S)}}]);
//# sourceMappingURL=../sourcemaps/LandingPage.0e0604bcab614da986735ec60151e9ee.js.map