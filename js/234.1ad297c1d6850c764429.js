(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[234],{66780:(e,t,r)=>{"use strict";r.d(t,{Z:()=>B});var s=r(67154),a=r.n(s),n=r(87757),o=r.n(n),i=r(319),l=r.n(i),c=r(59713),u=r.n(c),p=r(48926),m=r.n(p),f=r(63038),v=r.n(f),y=r(6479),d=r.n(y),b=r(25558),h=r.n(b),g=r(45697),Z=r.n(g),_=r(86896),E=r(58141),O=r(92339),P=r(18623),j=r(89736),C=r(68738),D=r(73966),k=r(94949),x=r(81815);function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var F=function(e){var t=e.data,r=e.page,s=e.intl,a=e.header,n=e.type,o=[{name:"publish_date",header:{value:s.formatMessage(P.Z.publishDate)}},{name:"cvss_filter",header:{value:s.formatMessage(P.Z.cvssBaseScore)},hit:"cvss_score"},{name:"impact",header:{value:s.formatMessage(P.Z.impact)},hit:"impact"},{name:"affecting",header:{value:s.formatMessage(P.Z.systemsExposed)},hit:"systems_affected"},{name:"business_risk_id",header:{value:s.formatMessage(P.Z.businessRisk)},hit:"business_risk"},{name:"status_id",header:{value:s.formatMessage(P.Z.status)},hit:"status"}],i=function(e){var t=e.value,r=e.style;return h().createElement(j.xv,{key:t,style:r},t)},c=["cvss_score","impact","systems_affected","business_risk","status"],u=[];a?(u.push({value:s.formatMessage(P.Z.cveId)}),c=[],o.forEach((function(e){a.includes(e.name)&&(u.push(e.header),e.hit&&c.push(e.hit))}))):"cves"===n?u=[{value:s.formatMessage(P.Z.cveId)}].concat(o.map((function(e){return e.header}))):(c=["display_name","cve_count","updated"],u=[{value:"Name"},{value:"Applicable CVEs"},{value:"Last seen"}]);var p=l()(t.map((function(e){var t=e.attributes,r=t.rules&&t.rules.length>0?[k.Z.cveCellAlign,k.Z.bodyCell,k.Z.cveCell]:[k.Z.bodyCell,k.Z.cveCell];return[h().createElement(j.G7,{key:t.synopsis},t.rules&&t.rules.length>0&&h().createElement(E.vB,{style:N(N({},k.Z.bodyCell),k.Z.cveCell)}),h().createElement(j.xv,{style:r},h().createElement(j.rU,{style:k.Z.link,src:"".concat(D.OF,"/").concat(t.synopsis)},t.synopsis))),(!a||a.includes("publish_date"))&&h().createElement(j.xv,{key:t.public_date,style:[k.Z.bodyCell,k.Z.cveCell]},(0,C.h3)(t.public_date))].concat(l()(c.map((function(e){return i({value:t[e],style:[k.Z.bodyCell,k.Z.cveCell]})}))))}))),m=l()(t.map((function(e){var t=e.attributes;return[i({value:t.display_name,style:[k.Z.bodyCell,k.Z.systemNameCell]}),i({value:t.opt_out?s.formatMessage(P.Z.systemsTableExcluded):t.cve_count,style:[k.Z.bodyCell,k.Z.systemCell]}),i({value:(0,x.p6)(t.updated,!0),style:[k.Z.bodyCell,k.Z.systemCell]})]})));return h().createElement(b.Fragment,{key:r},h().createElement(E.iA,{withHeader:!0,rows:[u.map((function(e){return i(N(N({},e),{},{style:[k.Z.headerCell,"cves"===n?k.Z.cveCell:"Name"===e.value?k.Z.systemNameCell:k.Z.systemCell]}))}))].concat(l()("cves"===n?p:m))}),0===t.length&&h().createElement(j.xv,null,s.formatMessage(P.Z.customReportNoCves)))};F.propTypes={data:Z().object,intl:Z().any,page:Z().number,header:Z().array,type:Z().string};const M=F;var R=r(37330),S=function(e){for(var t=e.data,r=e.meta,s=e.filters,a=e.intl,n=e.isReportDynamic,o=e.reportData,i=e.user,l=e.type,c=n?s:s.reduce((function(e,t){return e[t.key]={filter:t.category,values:"publish_date"===t.key?D.GZ.find((function(e){return e.value===t.chips[0].value})).timespan_label:t.chips.map((function(e){return e.name})).join(", ")},e}),{}),u=[{name:"impact",msg:P.Z.CVEsPDFreportFiltersSeverity},{name:"business_risk_id",msg:P.Z.CVEsPDFreportFiltersBusinessRisk},{name:"status_id",msg:P.Z.CVEsPDFreportFiltersStatus},{name:"security_rule",msg:P.Z.CVEsPDFreportFiltersSecurityRule}],p=u.length-1;p>=0;p--)if(c.hasOwnProperty(u[p].name)){u[p].isLast=!0;break}return h().createElement(b.Fragment,{key:"first-section"},n&&h().createElement(E.nv,null,(0,R.Jo)(P.Z.customReportIntroductionText)),"cves"===l?h().createElement(E.nv,null,(0,R.Jo)(P.Z.customReportSearchTermCvssAndPublishDate,{hasSearchTerm:c.hasOwnProperty("filter")?"yes":"no",searchTerm:c.filter&&c.filter.values,score:c.cvss_filter&&c.cvss_filter.values||D.OX.cvss_filter.min.toFixed(1)+" - "+D.OX.cvss_filter.max.toFixed(1),published:c.publish_date&&c.publish_date.values||(0,R.Jo)(P.Z.customReportTimespanAnytime)}),u.map((function(e){return c.hasOwnProperty(e.name)&&(0,R.Jo)(e.msg,{values:c[e.name].values.toLowerCase(),prefix:e.isLast?a.formatMessage(P.Z.customReportAnd):";"})})),h().createElement(j.xv,null,"."),"\n\n"):h().createElement(E.nv,null,c.filter?(0,R.Jo)(P.Z.systemsPDFreportFiltersSearchTerm,{searchTerm:c.filter.values}):""),"cves"===l&&h().createElement(E.nv,null,(0,R.Jo)(P.Z.CVEsPDFreportSubHeader,{cve_count:r.total_items.toString(),system_count:r.system_count.toString()})),o&&o.userNotes?h().createElement(j.G7,{style:k.Z.userNotes},h().createElement(E.nv,{style:k.Z.userNotesTitle},h().createElement(j.xv,{style:k.Z.bold},a.formatMessage(P.Z.customReportUserNoteLabel))),h().createElement(E.nv,null,h().createElement(j.xv,null,o.userNotes)),h().createElement(E.nv,null,i&&i.identity&&h().createElement(j.xv,{style:k.Z.italic},a.formatMessage(P.Z.customReportUserNotesGenerated,{name:"".concat(i.identity.user.first_name," ").concat(i.identity.user.last_name)})))):null,M({data:t,intl:a,header:o&&o.header,type:l}))};S.defaultProps={user:void 0},S.propTypes={intl:Z().any,filters:Z().array,data:Z().object,meta:Z().object,reportData:Z().object,isReportDynamic:Z().bool,user:Z().object,type:Z().string};const T=S;var A=r(64739),J=r(44981),L=r(90017);function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var U=function(e){var t=e.filters,r=e.params,s=e.reportData,n=void 0===s?{}:s,i=e.buttonProps,c=e.isReportDynamic,u=void 0!==c&&c,p=e.type,f=e.label,y=d()(e,["filters","params","reportData","buttonProps","isReportDynamic","type","label"]),g=(0,_.Z)(),Z=(0,b.useState)(!1),C=v()(Z,2),x=C[0],w=C[1],N=(0,b.useState)(!1),F=v()(N,2),R=F[0],S=F[1],V=(0,J.useDispatch)();(0,b.useEffect)((function(){return function(){V((0,L.clearNotifications)())}}),[V]);var U=function(e){return e.reduce((function(e,t,r){var s=Math.floor(r/D.tp.otherPages);return!e[s]&&(e[s]=[]),e[s].push(t),e}),[])},B=function(){var e=m()(o().mark((function e(){var s,a,i,c,m,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(!0),V((0,L.addNotification)({dismissable:!0,variant:"info",title:g.formatMessage(P.Z.customReportNotificationCve)})),e.next=4,(0,O.dH)(G(G(G({},r),A.Z.defaultParams),{},{sort:r.sort||"-cvss_score",affecting:"true,false"}));case 4:if(s=e.sent,a=s.data,i=s.meta,!n||!n.userNotes){e.next=11;break}return e.next=10,insights.chrome.auth.getUser();case 10:c=e.sent;case 11:return a=a.map((function(e){var t;return G(G({},e),{},{attributes:G(G({},e.attributes),{},{status:D.Em.find((function(t){return t.value===e.attributes.status_id.toString()})).label,business_risk:D.eF.find((function(t){return t.value===e.attributes.business_risk_id.toString()})).label,impact:(null===(t=D.cv[e.attributes.impact])||void 0===t?void 0:t.title)||g.formatMessage(P.Z.impactListUnknown),cvss_score:parseFloat(e.attributes.cvss3_score||e.attributes.cvss2_score).toFixed(1)})})})),S(a.some((function(e){return e.attributes.rules.length>0}))),m=T({data:a.splice(0,n.userNotes?D.tp.firstPageWithNote:D.tp.firstPageWithoutNote),meta:i,filters:t,intl:g,isReportDynamic:u,reportData:n,user:c,type:p}),f=U(a),w(!1),e.abrupt("return",[m].concat(l()(f.map((function(e,t){return M({data:e,page:t,intl:g,header:n&&n.header,type:p})})))));case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=m()(o().mark((function e(){var s,a,i,c,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(!0),V((0,L.addNotification)({dismissable:!0,variant:"info",title:g.formatMessage(P.Z.customReportNotificationSystem)})),e.next=4,(0,O.vk)(G(G({},r),A.Z.defaultParams));case 4:return s=e.sent,a=s.data,i=s.meta,c=T({data:a.splice(0,D.tp.firstPageWithoutNote),meta:i,filters:t,intl:g}),u=U(a),w(!1),e.abrupt("return",[c].concat(l()(u.map((function(e,t){return M({data:e,page:t,intl:g,header:n&&n.header})})))));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return h().createElement("div",null,h().createElement(E.o6,a()({},y,{label:x?g.formatMessage(P.Z.loading):g.formatMessage(f),asyncFunction:"cves"===p?B:H,buttonProps:G({component:"button"},i),reportName:u?n.reportTitle:"cves"===p?g.formatMessage(P.Z.cvePDFReportName):g.formatMessage(P.Z.systemPDFReportName),type:"",fileName:"".concat(A.Z.filename("cves"===p?u?"reports":"":"system-list"),".pdf"),allPagesHaveTitle:!1,size:"A4",orientation:"landscape",footer:R&&h().createElement(j.G7,{style:k.Z.footer},h().createElement(j.xv,null,"*"),h().createElement(E.vB,{style:k.Z.footerIcon}),h().createElement(j.xv,{style:k.Z.footerText},g.formatMessage(P.Z.customReportFooter)))})))};U.defaultProps={label:P.Z.kebabExportAsPDF},U.propTypes={filters:Z().oneOfType([Z().array,Z().object]),params:Z().object,reportData:Z().object,buttonProps:Z().object,label:Z().oneOfType([Z().array,Z().object]),isReportDynamic:Z().bool,type:Z().string};const B=U}}]);
//# sourceMappingURL=234.1ad297c1d6850c764429.js.map