(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[743],{35104:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>J});var r=n(63038),o=n.n(r),s=n(59713),a=n.n(s),c=n(6479),i=n.n(c),l=n(25558),u=n.n(l),f=n(45697),d=n.n(f),p=n(74806),m=n(18623),g=n(44981),y=n(319),b=n.n(y),h=n(5977),v=n(81815),O=n(65159),S=n(51937),E=n(74268),_=n(47835),P=n(16721),j=n(25032),w=n(64739),D=n(66780),Z=n(16343),k=n(9038),C=n(11550),x=n(73966);const N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.excluded,r=function(t){var n=[!1,!1];t.forEach((function(e){n[e]=!0}));var r=n.join(",");e({excluded:"false,false"===r?"":r,page:1})};return{label:C.N.formatMessage(m.Z.systemsIncludedInAnalysis),type:k.conditionalFilterType.checkbox,urlParam:"excluded",filterValues:{onChange:function(e,t){r(t)},items:x._9.map((function(e){return{label:e.label,value:e.value}})),value:null==n?void 0:n.split(",").flatMap((function(e,t){return"true"===(null==e?void 0:e.toLowerCase())?t.toString():[]}))}}};function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=function(e){var t=e.selectedHosts,n=e.intl,r=e.parameters,s=e.systems,a=e.methods,c=(0,l.useState)(!1),i=o()(c,2),f=i[0],d=i[1],p=a.apply,g=a.handleSelect,y=a.doOptOut;S.N.addNew({on:"SELECT_ENTITY",callback:function(e){return function(e){var n=e.data.selected?[e.data.id].concat(b()(t)):t.filter((function(t){return t!==e.data.id}));g(!1,n)}(e)}});var h=(0,l.useMemo)((function(){var e=null==s?void 0:s.data.filter((function(e){return t.includes(e.id)}));return{selectedExcluded:e.some((function(e){return!0===e.attributes.opt_out})),selectedIncluded:e.some((function(e){return!1===e.attributes.opt_out}))}}),[t,s]),v=["",{label:n.formatMessage(m.Z.systemKebabExcludeAnalysis,{count:t.length||0}),onClick:function(){return y(null,!0)},props:{isDisabled:!t.length||!h.selectedIncluded}},{label:n.formatMessage(m.Z.systemKebabIncludeAnalysis,{count:t.length||0}),onClick:function(){return y(null,!1)},props:{isDisabled:!t.length||!h.selectedExcluded}}],k=(0,E.Z)({selectedItems:t,selectorHandler:g,items:s,fetchResource:function(e){return(0,O.ip)(M(M({},r),e))}});return u().createElement(l.Fragment,null,u().createElement(_.U,{bulkSelect:{count:t.length,items:k.items,isDisabled:0===s.meta.total_items&&0===t.length,checked:Boolean(t.length),ouiaId:"bulk-select",onSelect:function(){return k.handleOnCheckboxChange()}},actionsConfig:{actions:v,dropdownProps:{ouiaId:"toolbar-actions"}},filterConfig:{items:[(0,P.Z)("filter",m.Z.systemsSearchName,m.Z.searchFilterByName,r.filter,p),N(p,r)]},activeFiltersConfig:{filters:(0,j.DU)(r),onDelete:function(e,t){return(0,j.vH)(t,p)}},exportConfig:M({isDisabled:0===s.meta.total_items,extraItems:[(0,Z.Ec)(f,d)],ouiaId:"export"},(0,j.HV)({downloadReport:function(e){var t=M({},r);w.Z.exec(O.lc,t,e,"system-list")}}))}),f&&u().createElement(D.Z,{type:"systems",showButton:!1,params:r,filters:(0,j.DU)(r),onSuccess:function(){return d(!1)}}))};T.propTypes={systems:v.nE,parameters:d().object,selectedHosts:d().array,methods:d().shape({doOptOut:d().func,apply:d().func,handleSelect:d().func}),intl:d().any};const F=(0,h.EN)((0,p.ZP)(T));var H=n(89583),R=n(52906),B=n(91067),L=n(90017),A=n(25413),z=n(58135),V=n(21382),K=n(99068),U=n(99025),W=function(e){switch(e.code){case 500:case 503:return u().createElement(K.F,null);case 404:return u().createElement(V.D,null);case 400:default:return u().createElement(U.T,null)}};W.propTypes={code:d().number};const $=W;function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G=function(e){var t=e.intl,n=(0,l.useState)(void 0),r=o()(n,2),s=r[0],a=r[1],c=(0,v._W)(x.IV),f=o()(c,2),d=f[0],p=f[1],y=u().createRef(),b=(0,g.useDispatch)(),h=(0,g.useSelector)((function(e){return e.SystemsPageStore.payload})),E=(0,g.useSelector)((function(e){return e.SystemsPageStore.params})),_=(0,g.useSelector)((function(e){return e.SystemsPageStore.metadata})),P=(0,g.useSelector)((function(e){return e.SystemsPageStore.error})),j=P.hasError,w=P.errorCode,D=(0,g.useSelector)((function(e){return e.SystemsPageStore.isLoading})),Z=(0,l.useMemo)((function(){return(null==(e=h.data)?void 0:e.map((function(e){var t=e.attributes,n=t.cve_count,r=i()(t,["cve_count"]);return q({cve_count:n,id:e.attributes.inventory_id},r)})))||[];var e}),[h]);(0,l.useEffect)((function(){return function(){b((0,O.re)()),b((0,O.r5)())}}),[b]),(0,l.useEffect)((function(){s&&b((0,O.lA)(s))}),[s,b]);var k=function(e){b((0,O.SF)(e))};(0,l.useEffect)((function(){b((0,L.clearNotifications)())}),[j,b]),(0,l.useEffect)((function(){y.current?(b((0,O.lc)(E)),d(q({},E))):k(p)}),[E]);var C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;(s&&s.length>0||e)&&b((0,O.R0)(e||s,n)).then((function(){b((0,O.lc)(q(q({},E),{},{page:1}))),!1===E.opt_out?b((0,L.addNotification)({variant:"success",title:t.formatMessage(m.Z.systemsExcludedNotification,{count:e?1:s.length||0})})):b((0,L.addNotification)({variant:"success",title:t.formatMessage(m.Z.systemsResumedNotificationTitle,{count:e?1:s.length||0}),description:t.formatMessage(m.Z.systemsResumedNotificationBody)})),a([])}))};return u().createElement(l.Fragment,null,u().createElement(B.Z,{title:t.formatMessage(m.Z.systemsHeader),showBreadcrumb:!1}),u().createElement(H.o,null,u().createElement(l.Fragment,null,j&&u().createElement($,{code:w}),!j&&u().createElement(z.e_,{onLoad:function(e){var t=e.mergeWithEntities,n=e.mergeWithDetail;S.Z.register(q(q({},t((0,A.K)(x.Bi))),n()))},tableProps:{isStickyHeader:!0,canSelectAll:!1,onSort:Z.length>0&&function(e,t,n){return(0,v.L6)(t,n,x.d$,p.sort,k)},sortBy:Z.length>0&&(0,v.hO)(x.d$,_.sort),actionResolver:function(e){return(0,R.zs)(e,C)}},showTags:!0,isFullView:!0,ref:y,items:Z,page:_&&_.page||1,perPage:_&&_.page_size||20,total:_&&_.total_items||0,onRefresh:function(e){var t=e.page,n=e.per_page;_.page===t&&_.limit===n||k({page:t,page_size:n}),_&&_.total_items<=n&&y.current&&y.current.onRefreshData({page:t,page_size:n})},isLoaded:!D,hasCheckbox:0!==h.length},h.data&&u().createElement(F,{parameters:E,systems:h,selectedHosts:s||[],methods:{doOptOut:C,apply:k,handleSelect:function(e,t){t||(t=[]),a(t)},setSelectedHosts:a},actions:!0})))))};G.propTypes={intl:d().any};const J=(0,p.ZP)(G)}}]);
//# sourceMappingURL=Systems.ce662cdd2f951e9a0cf4.js.map