{"version":3,"sources":["webpack://@redhat-cloud-services/frontend-components-inventory-vulnerabilities/./src/Components/PresentationalComponents/Filters/PrimaryToolbarFilters/SearchFilter.js","webpack://@redhat-cloud-services/frontend-components-inventory-vulnerabilities/./src/Helpers/TableToolbarHelper.js","webpack://@redhat-cloud-services/frontend-components-inventory-vulnerabilities/./src/Helpers/selectAllCheckboxHelper.js"],"names":["urlParam","label","placeholder","search","apply","React","searchValue","setSearchValue","debounce","newValue","undefined","handleSearch","type","conditionalFilterType","intl","filterValues","id","onChange","event","value","handleChangePage","_event","page","handleSetPageSize","perPage","page_size","exportConfig","methods","onSelect","fileType","downloadReport","buildActiveFilters","currentFilters","filterRuleValues","nameFilter","filter","advisoryFilter","advisory","buildChip","key","parameter","FILTERS","items","reduce","object","item","name","filteredRule","find","includes","e","buildChips","paramValues","values","push","filterChips","Object","keys","array","rule_presence","rule_key","affecting","multiValue","concat","split","flatMap","index","toLowerCase","toString","category","title","chips","excluded","filteredValues","length","messages","MULTI_FILTERS","removeFilters","obj","remainingValues","some","chip","join","defaultValues","forEach","selectedItems","selectorHandler","fetchResource","multiRow","selectedItemsArray","Array","from","selectedItemsCount","meta","data","selectPageNumber","isArray","handleUnselectAll","handleSelectAll","payload","total_items","then","map","handleOnCheckboxChange","onClick","count","collectedItems","union"],"mappings":"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","file":"js/545.bcce79f8d75c3a83aa79.js","sourcesContent":["import { conditionalFilterType } from '@redhat-cloud-services/frontend-components';\nimport { intl } from '../../../../Utilities/IntlProvider';\n\nimport debounce from 'lodash/debounce';\nimport React from 'react';\n\nconst SearchFilter = (urlParam, label, placeholder, search, apply) => {\n    const [searchValue, setSearchValue] = React.useState();\n    const [handleSearch] = React.useState(() =>\n        debounce(newValue =>  {if (newValue !== undefined) { apply({ [urlParam]: newValue, page: 1 }); }}, 400)\n    );\n\n    React.useEffect(() => setSearchValue(search), [search]);\n\n    return {\n        type: conditionalFilterType.text,\n        label: intl.formatMessage(label),\n        filterValues: {\n            'aria-label': 'search-field',\n            id: `search-${label.id}`,\n            onChange: (event, value) => {\n                setSearchValue(value);\n                handleSearch(value);\n            },\n            placeholder: intl.formatMessage(placeholder),\n            value: searchValue\n        }\n    };\n};\n\nexport default SearchFilter;\n","import messages from '../Messages';\nimport { FILTERS } from './constants';\nimport { intl } from '../Utilities/IntlProvider';\n\nexport const handleChangePage = (_event, page, apply) => apply({ page });\n\nexport const handleSetPageSize = (_event, perPage, apply) => apply({ page_size: perPage, page: 1 });\n\nexport const exportConfig = (methods) => (\n    { onSelect: (_event, fileType) => methods.downloadReport(fileType) }\n);\n\nexport const buildActiveFilters = (currentFilters, filterRuleValues = []) => {\n    const { filter: nameFilter, advisory: advisoryFilter } = currentFilters;\n\n    const buildChip = (key, parameter) => (\n        FILTERS[key].items.reduce((object, item) => {\n            if (parameter === item.value) {\n                object.name = item.label;\n                object.value = item.value;\n            }\n            else if (key === 'security_rule')\n            {\n                const filteredRule = filterRuleValues.find(({ value }) => value === parameter);\n\n                ['true', 'false'].includes(parameter)\n                    ? object.name = FILTERS.security_rule.items.find(e => e.value === parameter).label\n                    : object.name = filteredRule && filteredRule.label || parameter;\n\n                object.value = parameter;\n            }\n\n            return object;\n        }, {})\n    );\n\n    const buildChips = (paramValues, key) => {\n        return paramValues.reduce((values, parameter) => {\n            values.push(buildChip(key, parameter));\n            return values;\n        }, []);\n    };\n\n    const filterChips = Object.keys(FILTERS).reduce((array, key) => {\n        if (key === 'security_rule'\n            && (!['', undefined].includes(currentFilters.rule_presence) || !['', undefined].includes(currentFilters.rule_key))) {\n            const multiValue = [].concat(\n                currentFilters.rule_presence ? currentFilters.rule_presence.split(',') : [],\n                currentFilters.rule_key ? currentFilters.rule_key.split(',') : []);\n            array.push({ key, multiValue, category: FILTERS[key].title, chips: buildChips(multiValue, key) });\n        }\n        else if (key === 'affecting'  && Object.keys(currentFilters).includes('affecting')\n            && !['', undefined].includes(currentFilters.affecting)) {\n            const multiValue = [].concat(currentFilters.affecting?.split(',').flatMap(\n                (value, index) => value?.toLowerCase() === 'true' ? index.toString() : []));\n            array.push({ key, multiValue, category: FILTERS[key].title, chips: buildChips(multiValue, key) });\n        }\n        else if (key === 'excluded'  && Object.keys(currentFilters).includes('excluded')\n        && !['', undefined].includes(currentFilters.excluded)) {\n            const multiValue = [].concat(currentFilters.excluded?.split(',').flatMap(\n                (value, index) => value?.toLowerCase() === 'true' ? index.toString() : []));\n            array.push({ key, multiValue, category: FILTERS[key].title, chips: buildChips(multiValue, key) });\n        }\n        else if (Object.keys(currentFilters).includes(key)\n            && !['', undefined].includes(currentFilters[key])) {\n            const multiValue = typeof currentFilters[key] === 'string' && currentFilters[key].split(',');\n            const filteredValues = (multiValue && multiValue.length > 1)\n                && buildChips(multiValue, key)\n                || [buildChip(key, currentFilters[key])];\n\n            array.push({ key, multiValue, category: FILTERS[key].title, chips: filteredValues });\n        }\n\n        return array;\n    }, []);\n\n    nameFilter && filterChips.push(\n        { key: 'filter',\n            category: intl.formatMessage(messages.searchLabel),\n            chips: [{ name: nameFilter }]\n        }\n    );\n\n    advisoryFilter && filterChips.push(\n        { key: 'advisory',\n            category: intl.formatMessage(messages.advisory),\n            chips: [{ name: advisoryFilter }]\n        }\n    );\n\n    return filterChips;\n};\n\nconst MULTI_FILTERS = ['affecting', 'excluded'];\n\nexport const removeFilters = (chips, apply) => {\n    const emptyFilter = chips.reduce((obj, item) => {\n        if (item.key === 'security_rule') {\n            const remainingValues = item.multiValue.filter(value => !item.chips.some(chip => chip.value === value));\n            obj.rule_presence = remainingValues.filter(value => ['true', 'false'].includes(value)).join(',') || '';\n            obj.rule_key = remainingValues.filter(value => !['true', 'false'].includes(value)).join(',') || '';\n        }\n        else if (MULTI_FILTERS.includes(item.key)) {\n            const remainingValues = item.multiValue.filter(value => !item.chips.some(chip => chip.value === value));\n            const defaultValues = [false, false];\n            remainingValues.forEach(item => { defaultValues[item] = true; });\n            const value = defaultValues.join(',');\n            obj[item.key] = value === 'false,false' ? '' : defaultValues.join(',');\n        }\n        else if (item.key === 'filter' || item.key === 'advisory' || (item.multiValue && item.multiValue.length === 1)) {\n            obj[item.key] = '';\n        }\n        else {\n            obj[item.key] = item.multiValue.filter(value => !item.chips.some(chip => chip.value === value)).join(',');\n        }\n\n        return obj;\n    }, {});\n    apply({ ...emptyFilter, page: 1 });\n};\n","import union from 'lodash/union';\nimport messages from '../Messages';\nimport { intl } from '../Utilities/IntlProvider';\n\nconst selectAllCheckbox = ({ selectedItems, selectorHandler, items, fetchResource, multiRow = false }) => {\n\n    const selectedItemsArray = Array.from(selectedItems); // we might get array or set and there's no common method for size\n    const selectedItemsCount = selectedItemsArray && selectedItemsArray.length;\n    const { meta, data } = items;\n    const selectPageNumber = data && (((Array.isArray(data) && data.length) && multiRow) ? data.length / 2 : data.length);\n\n    const handleSelectPage = () => {\n        const { data } = items;\n        const collectedItems = union(data.filter(item => item.id).map(item => item.id), selectedItemsArray);\n        selectorHandler(true, collectedItems);\n    };\n\n    const handleUnselectAll = () => {\n        selectorHandler(false, []);\n    };\n\n    const handleSelectAll = () => {\n\n        let { payload } = fetchResource && fetchResource({ page_size: meta.total_items, page: 1 });\n        payload &&\n            payload.then(({ data: response }) => {\n                //TODO: current only one new endpoint is introduced. Once, we have all new endpoints,  get rid of this map\n                const items = response.map(item => item.id && item.id || item);\n                selectorHandler(true, items);\n            });\n    };\n\n    const handleOnCheckboxChange = () => {\n        if (selectedItemsCount === 0) {\n            handleSelectAll();\n        } else {\n            handleUnselectAll();\n        }\n    };\n\n    return ({\n        handleOnCheckboxChange,\n        items: [\n            {\n                title: intl.formatMessage(messages.selectNone),\n                onClick: handleUnselectAll\n            },\n            {\n                title: `${intl.formatMessage(messages.selectPage, { count: selectPageNumber })}`,\n                onClick: handleSelectPage\n            },\n            {\n                title: `${intl.formatMessage(messages.selectAll, { count: meta.total_items ? meta.total_items : 0 })}`,\n                onClick: handleSelectAll\n            }\n        ]\n    }\n\n    );\n};\n\nexport default selectAllCheckbox;\n"],"sourceRoot":""}