(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[6743],{75584:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ne});var n=r(81253),o=r(92137),a=r(96156),s=r(28481),i=r(87757),c=r.n(i),l=r(77865),u=r.n(l),f=r(86896),p=r(30893),d=r(14494),m=r(85061),b=r(45697),g=r.n(b),y=r(74806),v=r(5977),h=r(29648),O=r(9048),P=r(83296),Z=r(93400),j=r(49629),w=r(95351),E=r(15248),S=r(62215),D=r(22122),_=r(58141),k=r(71478),x=r(43198),C=r(62598),N=r(6208),M=r(37450);function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var I=function(e){var t=e.filters,r=e.params,a=e.reportData,i=void 0===a?{}:a,d=e.buttonProps,b=e.label,g=(0,n.Z)(e,["filters","params","reportData","buttonProps","label"]),y=(0,f.Z)(),v=(0,l.useState)(!1),O=(0,s.Z)(v,2),P=O[0],Z=O[1],j=(0,M.l)(),w=function(e){return(0,h.F3)(e,N.tp.systemsReportRestPages)},E=function(){var e=(0,o.Z)(c().mark((function e(){var n,o,a,s,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Z(!0),j({msg:y.formatMessage(p.Z.customReportNotificationSystem)}),e.next=4,(0,k.vk)(R(R({},r),S.Z.defaultParams));case 4:return n=e.sent,o=n.data,a=n.meta,s=(0,x.Z)({data:o.splice(0,N.tp.systemsReportFirstPage),meta:a,filters:t,intl:y}),l=w(o),Z(!1),e.abrupt("return",[s].concat((0,m.Z)(l.map((function(e,t){return(0,C.Z)({data:e,page:t,intl:y,header:i&&i.header})})))));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return u().createElement("div",null,u().createElement(_.o6,(0,D.Z)({},g,{label:P?y.formatMessage(p.Z.loading):y.formatMessage(b),asyncFunction:E,buttonProps:R({component:"button"},d),reportName:y.formatMessage(p.Z.systemPDFReportName),type:"",fileName:"".concat(S.Z.filename("system-list"),".pdf"),allPagesHaveTitle:!1,size:"A4",orientation:"landscape"})))};I.defaultProps={label:p.Z.kebabExportAsPDF},I.propTypes={filters:g().oneOfType([g().array,g().object]),params:g().object,reportData:g().object,buttonProps:g().object,label:g().oneOfType([g().array,g().object])};const T=I;var B=r(65538),H=r(89421),A=r(32132);const z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.excluded,n=function(t){var r=[!1,!1];t.forEach((function(e){r[e]=!0}));var n=r.join(",");e({excluded:"false,false"===n?"":n,page:1})};return{label:A.N.formatMessage(p.Z.filterSystemsIncludedInAnalysis),type:H.Yu.checkbox,urlParam:"excluded",filterValues:{onChange:function(e,t){n(t)},items:N._9.map((function(e){return{label:e.label,value:e.value}})),value:null==r?void 0:r.split(",").flatMap((function(e,t){return"true"===(null==e?void 0:e.toLowerCase())?t.toString():[]}))}}};function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var L=function(e){var t=e.selectedHosts,r=e.intl,n=e.parameters,o=e.systems,a=e.methods,i=(0,l.useState)(!1),c=(0,s.Z)(i,2),f=c[0],d=c[1],b=a.apply,g=a.handleSelect,y=a.doOptOut;P.N.addNew({on:"SELECT_ENTITY",callback:function(e){return function(e){var r=e.data.selected?[e.data.id].concat((0,m.Z)(t)):t.filter((function(t){return t!==e.data.id}));g(!1,r)}(e)}});var v=(0,l.useMemo)((function(){var e=null==o?void 0:o.data.filter((function(e){return t.includes(e.id)}));return{selectedExcluded:e.some((function(e){return!0===e.attributes.opt_out})),selectedIncluded:e.some((function(e){return!1===e.attributes.opt_out}))}}),[t,o]),h=["",{label:r.formatMessage(p.Z.systemKebabExcludeAnalysis,{count:t.length||0}),onClick:function(){return y(null,!0)},props:{isDisabled:!t.length||!v.selectedIncluded}},{label:r.formatMessage(p.Z.systemKebabIncludeAnalysis,{count:t.length||0}),onClick:function(){return y(null,!1)},props:{isDisabled:!t.length||!v.selectedExcluded}}],D=(0,Z.Z)({selectedItems:t,selectorHandler:g,items:o,fetchResource:function(e){return(0,O.ip)(K(K({},n),e))}});return u().createElement(l.Fragment,null,u().createElement(j.Z,{id:"vuln-systems-primary-toolbar",bulkSelect:{count:t.length,items:D.items,isDisabled:0===o.meta.total_items&&0===t.length,checked:Boolean(t.length),ouiaId:"bulk-select",onSelect:function(){return D.handleOnCheckboxChange()}},actionsConfig:{actions:h,kebabToggleProps:{isDisabled:!t.length||0===o.meta.total_items},dropdownProps:{ouiaId:"toolbar-actions"}},filterConfig:{items:[(0,w.Z)("filter",p.Z.systemsSearchName,p.Z.searchFilterByName,n.filter,b),z(b,n)]},activeFiltersConfig:{filters:(0,E.DU)(n),onDelete:function(e,t){return(0,E.vH)(t,b)}},exportConfig:K({isDisabled:0===o.meta.total_items,extraItems:[(0,B.Ec)(f,d)],ouiaId:"export"},(0,E.HV)({downloadReport:function(e){var t=K({},n);S.Z.exec(O.lc,t,e,"system-list")}}))}),f&&u().createElement(T,{showButton:!1,params:n,filters:(0,E.DU)(n),onSuccess:function(){return d(!1)}}))};L.propTypes={systems:h.nE,parameters:g().object,selectedHosts:g().array,methods:g().shape({doOptOut:g().func,apply:g().func,handleSelect:g().func}),intl:g().any};const q=(0,v.EN)((0,y.ZP)(L));var U=r(86350),W=r(99385),Y=r(23320),$=r(57998),G=r(33739),J=r(66123),Q=r(46818),X=r(75863),ee=r(12140);function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const ne=function(){var e=(0,f.Z)(),t=(0,l.useState)(void 0),r=(0,s.Z)(t,2),a=r[0],i=r[1],m=(0,h.H1)(N.IV),b=(0,s.Z)(m,2),g=b[0],y=b[1],v=(0,l.useState)(!0),Z=(0,s.Z)(v,2),j=Z[0],w=Z[1],E=(0,M.l)({variant:"success"}),S=u().createRef(),D=(0,d.useDispatch)(),_=(0,d.useSelector)((function(e){var t=e.entities;return(null==t?void 0:t.rows)||[]}),d.shallowEqual),x=(0,d.useSelector)((function(e){var t=e.entities;return null==t?void 0:t.total})),C=(0,d.useSelector)((function(e){return e.SystemsPageStore.params}),d.shallowEqual),F=(0,d.useSelector)((function(e){return e.SystemsPageStore.error})),R=F.hasError,I=F.errorCode,T=(0,d.useSelector)((function(e){var t,r=e.entities;return null==r||null===(t=r.rows)||void 0===t?void 0:t.some((function(e){return e.patchAccess}))}));(0,l.useEffect)((function(){return function(){D((0,O.re)()),D((0,O.r5)())}}),[D]),(0,l.useEffect)((function(){a&&D((0,O.lA)(a))}),[a,D]);var B=function(e){D((0,O.SF)(e))};(0,l.useEffect)((function(){B(g),w(!1)}),[]),(0,ee.Z)((function(){j||y(re({},C))}),[C,j]);var H=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0;(a&&a.length>0||t)&&D((0,O.R0)(t||a,r)).then((function(){S.current.onRefreshData({page:1});var n=t?1:a.length||0;E(r?{msg:e.formatMessage(p.Z.systemsExcludedNotification,{count:n})}:{msg:e.formatMessage(p.Z.systemsResumedNotificationTitle,{count:n}),description:e.formatMessage(p.Z.systemsResumedNotificationBody)}),i([])}))},A=(0,l.useMemo)((function(){return A?A++:0}),[T]);return u().createElement(l.Fragment,null,u().createElement(Y.Z,{title:e.formatMessage(p.Z.systemsHeader),showBreadcrumb:!1}),u().createElement(U.Z,null,u().createElement(l.Fragment,null,R?u().createElement(J.Z,{code:I}):u().createElement(G.Z,{disableDefaultColumns:!0,onLoad:function(e){var t=e.mergeWithEntities,r=e.mergeWithDetail;P.Z.register(re(re({},t((0,$.K)(N.Bi),re({page:Number(C.page||1),perPage:Number(C.page_size||20)},C.sort&&{sortBy:{key:C.sort.replace(/^-/,""),direction:C.sort.match(/^-/)?"desc":"asc"}}))),r()))},tableProps:{isStickyHeader:!0,canSelectAll:!1,actionResolver:function(e){return(0,W.zs)(e,H)},variant:X.B.compact},showTagModal:!0,isFullView:!0,ref:S,autoRefresh:!0,customFilters:{vulnerabilityParams:{excluded:C.excluded,filter:C.filter}},hasCheckbox:0!==(null==_?void 0:_.length),columnCounter:A,columns:function(e){return function(e,t){var r=(0,s.Z)(N.Bi,2),n=r[0],o=r[1],a=e.filter((function(e){return"updated"===e.key})),i=e.filter((function(e){return"tags"===e.key})),c=[n,i=re(re({},i[0]),{},{props:{width:20,isStatic:!0}}),o,a=re(re({},a[0]),{},{cellTransforms:[Q.P8],props:{width:20}})];return t&&c.splice(2,0,N.$A),c}(e,T)},getEntities:function(){var e=(0,o.Z)(c().mark((function e(t,r,o,a){var s,i,l,u,f,p,d,m;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.vulnerabilityParams,i=r.orderBy,l=r.orderDirection,u=(0,n.Z)(r,["vulnerabilityParams","orderBy","orderDirection"]),f="".concat("ASC"===l?"":"-").concat(i),B({page:u.page,page_size:u.per_page,sort:f}),e.next=5,k.vk(re(re({},s),{},{page:u.page,page_size:u.per_page,sort:f}));case 5:return p=e.sent,e.next=8,a(p.data.map((function(e){return e.id})),re(re({},u),{},{hasItems:!0,fields:{}}));case 8:return d=e.sent,m=function(e){var t;return null===(t=d.results.find((function(t){return t.id===e})))||void 0===t?void 0:t.insights_id},e.abrupt("return",Promise.resolve({results:p.data.map((function(e){return re(re(re({},e),e.attributes),{},{insights_id:m(e.id)})})),total:p.meta.total_items}));case 11:case"end":return e.stop()}}),e)})));return function(t,r,n,o){return e.apply(this,arguments)}}(),hideFilters:{all:!0}},u().createElement(q,{parameters:C,systems:{data:_,meta:{total_items:x}},selectedHosts:a||[],methods:{doOptOut:H,apply:B,handleSelect:function(e,t){t||(t=[]),i(t)},setSelectedHosts:i},actions:!0})))))}}}]);
//# sourceMappingURL=../sourcemaps/Systems.d5f95f19ad4592386118.js.map