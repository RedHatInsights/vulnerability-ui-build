"use strict";(self.webpackChunkvulnerability=self.webpackChunkvulnerability||[]).push([[1013],{38828:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Le});var r=n(77865),a=n.n(r),o=n(44012),i=n(46043),c=n(91290),s=n(15265),l=n(30893),u=n(14748),p=n(75115),m=n(4942),f=n(93433),d=n(29439),v=n(28216),b=n(49739),E=n(83826),h=n(45697),y=n.n(h),g=n(78733),O=n(52064),Z=n(29648),k=n(74372),S=n(19738),P=n(87462),w=n(3351),C=n(22860),j=n(6934),_=n(75863),x=n(81739),M=n(22167),D=n(5938),R=n(24788);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){(0,m.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=function(e){var t=e.context,n=e.header,o=e.canEditStatusOrBusinessRisk,i=t.cves,c=t.methods,s=t.selectedCves,u=t.expandedRows,p=0===i.data.length,m=i.data&&i.data.map((function(e){return s.find((function(t){return t.id===e.id}))&&B(B({},e),{},{selected:!0})||e})).map((function(e,t){var n=t%2==0?u.includes(e.id):void 0;return B(B({},e),{},{isOpen:n})}));return i.isLoading?a().createElement(x.Z,{colSize:null==n?void 0:n.length,rowSize:20,variant:_.B.compact}):a().createElement(r.Fragment,null,a().createElement(w.i,{canSelectAll:!1,"aria-label":"Vulnerability CVE table",cells:n,rows:p?[{heightAuto:!0,cells:[{props:{colSpan:null==n?void 0:n.length},title:a().createElement(R.lP,{secondParagraph:l.Z.emptyStateThereShouldBeCVEs})}]}]:m,onSelect:p?void 0:function(e,n,r){var a=t.cves,o=t.methods,i=a.data[r]&&a.data[r].id;o.selectCves(n,i)},canCollapseAll:!0,onCollapse:p?void 0:function(e,n){void 0===n?function(){var e=t.cves,n=t.methods,r=t.isAllExpanded?[]:e.data.filter((function(e){return e.id})).map((function(e){return e.id}));n.openCves(r)}():c.openCves(n)},actionResolver:o&&i.data.length>0?function(e,t){return(0,M.hA)(c,t.rowIndex)}:void 0,sortBy:p?void 0:(0,Z.hO)([{key:"collapse"},{key:"checkbox"}].concat((0,f.Z)(n)),i.meta.sort),onSort:p?void 0:function(e,t,r){return(0,Z.L6)(t,r,[{key:"collapse"},{key:"checkbox"}].concat((0,f.Z)(n)),i.meta.sort,c.apply)},ouiaId:"cves-table",isStickyHeader:!0,variant:_.B.compact,isExpandable:!0},a().createElement(j.x,null),a().createElement(C.R,null)),a().createElement(D.Z,{meta:i.meta,apply:c.apply}))};L.propTypes={context:y().any,header:y().array,canEditStatusOrBusinessRisk:y().bool};const V=function(e){return a().createElement(fe.Consumer,null,(function(t){return a().createElement(L,(0,P.Z)({context:t},e))}))};var T=n(74806),A=n(93400),H=n(54728),F=n(83237),N=n(32132);const q=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).affecting;return{label:N.N.formatMessage(l.Z.filterSystemsExposed),type:F.Y.checkbox,urlParam:"affecting",filterValues:{onChange:function(t,n){var r;e({affecting:(r=n).length>0?null==r?void 0:r.join(","):void 0,page:1})},items:g.qr.map((function(e){return{label:e.label,value:e.value}})),value:null==t?void 0:t.split(",")}}};var z=n(95859),Y=n(26410),U=n(90960),G=n(95351),K=n(16369),W=n(35938),X=n(54534),$=n(1792),J=n(41489),Q=n(27255),ee=n(15248),te=n(40306);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,m.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae=function(e){var t=e.context,n=e.canEditStatusOrBusinessRisk,o=e.canExport,i=e.intl,c=(0,r.useState)(!1),s=(0,d.Z)(c,2),u=s[0],p=s[1],m=t.cves,v=t.params,b=t.methods,E=t.selectedCves,h=v.filter,y=E&&E.length,O=(0,A.Z)({selectedItems:E,selectorHandler:b.selectCves,items:m,fetchResource:function(e){return(0,te.cW)(re(re({},v),e))},multiRow:!0}),Z=[""].concat((0,f.Z)(n?[{label:i.formatMessage(l.Z.editBusinessRisk),onClick:function(){return b.showBusinessRiskModal(E.map((function(e){var t=e.id,n=e.business_risk_id,r=e.business_risk_text,a=e.attributes;return{id:t,business_risk_id:a?a.business_risk_id:n,justification:a?a.business_risk_text:r}})),!0)},props:{isDisabled:!y}},{label:i.formatMessage(l.Z.editStatus),onClick:function(){return b.showStatusModal(E.map((function(e){var t=e.id,n=e.exposed_systems_count,r=e.status_justification,a=e.status_id,o=e.attributes;return{id:t,exposed_systems_count:o?o.systems_affected:n,justification:o?o.status_text:r,status_id:o?o.status_id:a}}),[]),!0)},props:{isDisabled:!y}}]:[]),[{label:i.formatMessage(l.Z.columnManagementModalTitle),onClick:function(){return b.setColumnManagementModalOpen(!0)}}]);return a().createElement(a().Fragment,null,a().createElement(H.Z,{pagination:{isDisabled:0===m.meta.total_items,itemCount:m.meta.total_items||0,page:m.meta.page||1,perPage:m.meta.page_size||1,ouiaId:"pagination-top",onSetPage:function(e,t){return(0,ee.A6)(e,t,b.apply)},onPerPageSelect:function(e,t){return(0,ee.lO)(e,t,b.apply)}},actionsConfig:{actions:Z,dropdownProps:{ouiaId:"toolbar-actions"}},bulkSelect:{count:y,items:O.items,isDisabled:0===m.meta.total_items&&0===y,checked:Boolean(y),ouiaId:"bulk-select",onSelect:function(){return O.handleOnCheckboxChange()}},filterConfig:{items:[(0,G.Z)("filter",l.Z.cve,l.Z.searchFilterByCveID,h,b.apply),(0,K.Z)(b.apply,v,[],{isDynamic:!1,dropdownItems:g.rM.filter((function(e){return e.value!==g.Zm}))}),(0,X.Z)(b.apply,v),(0,U.Z)(b.apply,v),(0,Y.Z)(b.apply,v),(0,W.Z)(b.apply,v),q(b.apply,v),(0,z.Z)(b.apply,v),(0,$.Z)(b.apply,v)]},activeFiltersConfig:{filters:(0,ee.DU)(v),onDelete:function(e,t,n){return(0,ee.vH)(t,b.apply,n,g.MM)},deleteTitle:i.formatMessage(l.Z.resetFilters),showDeleteButton:!(0,ee.Yy)(v,g.MM,g.fU)},exportConfig:o&&re({isDisabled:0===m.meta.total_items,extraItems:[(0,J.Ec)(u,p)],ouiaId:"export"},(0,ee.HV)(b))}),u&&a().createElement(Q.Z,{showButton:!1,params:v,filters:(0,ee.DU)(v),onSuccess:function(){return p(!1)}}))};ae.propTypes={context:y().object,intl:y().object,canEditStatusOrBusinessRisk:y().bool,canExport:y().bool},ae.defaultProps={totalNumber:0,apply:function(){},downloadReport:function(){}};const oe=(0,T.ZP)((function(e){return a().createElement(fe.Consumer,null,(function(t){return a().createElement(ae,(0,P.Z)({context:t},e))}))}));var ie=n(62215),ce=n(83215),se=n(66123),le=n(97481),ue=n(37450);function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){(0,m.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var fe=a().createContext({}),de=function(e){var t=e.rbac,n=(0,v.I0)(),o=(0,r.useState)((function(){return function(){return null}})),i=(0,d.Z)(o,2),c=i[0],s=i[1],l=(0,r.useState)((function(){return function(){return null}})),u=(0,d.Z)(l,2),p=u[0],m=u[1],h=(0,r.useState)(!0),y=(0,d.Z)(h,2),P=y[0],w=y[1],C=(0,d.Z)(t,2),j=(0,d.Z)(C[0],4),_=j[0],x=j[1],M=j[2],D=j[3],I=C[1],B=(0,v.v9)((function(e){return e.CVEsStore.cveList})),L=(0,v.v9)((function(e){return e.CVEsStore.parameters})),T=(0,v.v9)((function(e){return e.CVEsStore.columns})),A=(0,v.v9)((function(e){return e.CVEsStore.selectedCves})),H=(0,v.v9)((function(e){return e.CVEsStore.expandedRows})),F=(0,v.v9)((function(e){return e.CVEsStore.isAllExpanded})),N=(0,ue.lg)(T,(function(e){return n((0,te.vP)(e))})),q=(0,d.Z)(N,2),z=q[0],Y=q[1],U=(0,r.useMemo)((function(){return(0,O.c_)(B,T)}),[B,T]),G=(0,Z.H1)(["show_irrelevant"].concat((0,f.Z)(g.kO))),K=(0,d.Z)(G,2),W=K[0],X=K[1],$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,Z.pX)(e);n((0,te.yM)(t))};return(0,r.useEffect)((function(){$(W)}),[]),(0,r.useEffect)((function(){P?w(!1):(n((0,te.jh)(L)),X(me({},L)))}),[L,P]),(0,r.useEffect)((function(){return function(){n((0,te.Ss)()),n((0,ce.L1)())}}),[n]),U.errors?a().createElement(se.Z,{code:U.errors.status}):I?a().createElement(le.Z,{centered:!0}):D?a().createElement(fe.Provider,{value:{cves:U,params:L,selectedCves:A,expandedRows:H,isAllExpanded:F,methods:{apply:$,downloadReport:function(e){ie.Z.exec(te.jh,L,e,"cves",(function(e){return n((0,ce.wN)(e))}),(function(){return n((0,ce.L1)())}))},selectCves:function(e,t){n((0,te.EY)(t||[]))},showBusinessRiskModal:function(e,t){var r=U.meta;m((function(){return function(){return a().createElement(k.Z,{cves:e,updateRef:function(){w(!0),n((0,te.Ss)()),(0,Z.$)(t?me(me({},r),{},{page:1}):r,L,$)}})}}))},showStatusModal:function(e,t){var r=U.meta;s((function(){return function(){return a().createElement(S.Z,{cves:e,canEditPairStatus:x,updateRef:function(){w(!0),n((0,te.Ss)()),(0,Z.$)(t?me(me({},r),{},{page:1}):r,L,$)}})}}))},openCves:function(e){n((0,te.Rk)(e))},setColumnManagementModalOpen:Y}}},a().createElement(p,null),a().createElement(c,null),z,a().createElement(b.K,null,a().createElement(E.v,null,a().createElement(oe,{canEditStatusOrBusinessRisk:_,canExport:M})),a().createElement(E.v,null,a().createElement(V,{header:T.filter((function(e){var t;return null!==(t=e.isShown)&&void 0!==t?t:e.isShownByDefault})),canEditStatusOrBusinessRisk:_})))):a().createElement(R.bY,{serviceName:g.m_})};de.propTypes={rbac:y().array.isRequired};const ve=function(){var e=(0,ue.Wu)([g._I.setCveStatusAndBusinessRisk,g._I.setPairStatus,g._I.basicReporting,g._I.readVulnerabilityResults]);return a().createElement(de,{rbac:e})};var be=n(15861),Ee=n(64687),he=n.n(Ee),ye=n(32203),ge=n(50693),Oe=n(16475),Ze=n(41448),ke=n(62394),Se=n(68340),Pe=n(68774),we=n(27578),Ce=n(71478),je=n(42601),_e=n(86896),xe=n(91036),Me=n.n(xe);function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){(0,m.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ie=function(e){var t,n=e.title,r=e.count,o=e.impact,i=e.onLinkClick,c=e.hasIcon;return a().createElement(ye.Z,{isFullHeight:!0,className:"card-box"},a().createElement(ke.e,null,a().createElement(Pe.D,null,a().createElement(Se.x,{component:Se.q.h4},a().createElement("b",null,n)),a().createElement(Se.x,{className:"pf-u-font-size-lg pf-u-font-weight-bold pf-u-mt-xs"},a().createElement("a",{onClick:i},c&&a().createElement(we.ZP,{color:null===(t=g.cv[o])||void 0===t?void 0:t.iconColor,size:"sm",className:"pf-u-mr-sm"}),r)))))};Ie.propTypes={title:y().node,count:y().number.isRequired,impact:y().oneOf(Object.keys(g.cv)),onLinkClick:y().func.isRequired,hasIcon:y().bool};const Be=function(){var e,t=(0,_e.Z)(),n=(0,v.I0)(),i=(0,r.useState)(!0),c=(0,d.Z)(i,2),s=c[0],p=c[1],m=(0,r.useState)({}),f=(0,d.Z)(m,2),h=f[0],y=f[1],O=(0,r.useState)({}),k=(0,d.Z)(O,2),S=k[0],P=k[1],w=(0,r.useState)(!0),C=(0,d.Z)(w,2),j=C[0],_=C[1],x=(0,v.v9)((function(e){return e.CVEsStore.parameters})),M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,Z.pX)(e);n((0,te.yM)(t))},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,ee.DU)(x);(0,ee.vH)(t,M,!0,e)},R=function(){var e=(0,be.Z)(he().mark((function e(){var t;return he().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.prev=1,e.next=4,(0,Ce.k5)();case 4:t=e.sent,e.next=11;break;case 7:if(e.prev=7,e.t0=e.catch(1),"404"===e.t0.status){e.next=11;break}throw e.t0;case 11:P(t);case 12:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=(0,be.Z)(he().mark((function e(){var t;return he().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Ce.rF)(x);case 2:t=e.sent,y(t),_(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,r.useEffect)((function(){s?p(!1):(R(),I())}),[x,s]),a().createElement(u.Z,{style:{paddingBottom:0}},a().createElement(b.K,{hasGutter:!0},a().createElement(E.v,null,j?a().createElement(ge.r,{hasGutter:!0},a().createElement(Oe.P,{span:12,md:3},a().createElement(je.Z,{isLoading:j,variant:je.t.inlineSkeleton,style:{height:"100px"}})),a().createElement(Oe.P,{span:12,md:3},a().createElement(je.Z,{isLoading:j,variant:je.t.inlineSkeleton,style:{height:"100px"}})),a().createElement(Oe.P,{span:12,md:3},a().createElement(je.Z,{isLoading:j,variant:je.t.inlineSkeleton,style:{height:"100px"}})),a().createElement(Oe.P,{span:12,md:3},a().createElement(je.Z,{isLoading:j,variant:je.t.inlineSkeleton,style:{height:"100px"}}))):a().createElement(ge.r,{hasGutter:!0,id:"dashbar"},a().createElement(Oe.P,{span:12,md:3},a().createElement(Ie,{title:a().createElement(o.Z,l.Z.dashbarKnownExploitsTitle),count:null==h?void 0:h.exploitable_cves,onLinkClick:function(){return D(Re(Re({},g.MM),{},{known_exploit:"true"}))}})),a().createElement(Oe.P,{span:12,md:3},a().createElement(Ie,{title:a().createElement(o.Z,l.Z.dashbarSecurityRulesTitle),count:null==h?void 0:h.cves_with_rule,onLinkClick:function(){return D(Re(Re({},g.MM),{},{rule_presence:"true"}))}})),a().createElement(Oe.P,{span:12,md:3},a().createElement(Ie,{title:a().createElement(o.Z,l.Z.dashbarCriticalVulnerabilitiesTitle),count:null==h?void 0:h.critical_cves,onLinkClick:function(){return D(Re(Re({},g.MM),{},{impact:"7"}))},impact:"Critical",hasIcon:!0})),a().createElement(Oe.P,{span:12,md:3},a().createElement(Ie,{title:a().createElement(o.Z,l.Z.dashbarImportantVulnerabilitiesTitle),count:null==h?void 0:h.important_cves,onLinkClick:function(){return D(Re(Re({},g.MM),{},{impact:"5"}))},impact:"Important",hasIcon:!0})))),(null==S?void 0:S.message)&&a().createElement(E.v,{id:"announcement"},a().createElement(Ze.b,{variant:"warning",isInline:!0,title:t.formatMessage(l.Z.dashbarAnnouncementTitle)},a().createElement("span",{dangerouslySetInnerHTML:(e=(0,Z.rY)(S.message),{__html:Me()(e)})})))))},Le=function(){var e=a().createElement(i.J,{enableFlip:!0,position:"right",headerContent:a().createElement(o.Z,l.Z.ovalPopoverHeader),bodyContent:a().createElement(o.Z,l.Z.ovalPopoverBody),footerContent:a().createElement("a",{href:"https://access.redhat.com/documentation/en-us/red_hat_insights/2023/html/assessing_and_monitoring_security_vulnerabilities_on_rhel_systems/index",target:"__blank",rel:"noopener noreferrer"},a().createElement(o.Z,l.Z.learnMore)," ",a().createElement(s.ZP,null))},a().createElement("span",null,a().createElement(o.Z,l.Z.cvesHeader),a().createElement(c.ZP,{color:"var(--pf-global--secondary-color--100)",className:"pf-u-ml-sm pointer cves-header-questionmark",style:{verticalAlign:"0"}})));return a().createElement(r.Fragment,null,a().createElement(p.Z,{title:e,showBreadcrumb:!1}),a().createElement(Be,null),a().createElement(u.Z,null,a().createElement(ve,null)))}}}]);
//# sourceMappingURL=../sourcemaps/LandingPage.2644366c8c25122e48557c71272d2946.js.map