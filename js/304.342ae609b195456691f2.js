(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[304],{84402:(e,t,r)=>{"use strict";r.d(t,{Z:()=>f});var n=r(25558),o=r.n(n),a=r(45697),s=r.n(a),i=r(70194),c=r(23025),u=r(60578),l=r(43109),p=function(e){var t=e.hasRule,r=e.hasExploit;return o().createElement(i.G7,null,r&&o().createElement(i.xv,{style:c.Z.footer},(0,l.aR)(u.Z.knownExploitPDFFooter)),t&&o().createElement(i.xv,{style:c.Z.footer},(0,l.aR)(u.Z.securityRulePDFFooter)))};p.propTypes={hasRule:s().bool,hasExploit:s().bool};const f=p},17304:(e,t,r)=>{"use strict";r.d(t,{Z:()=>R});var n=r(22122),o=r(85061),a=r(96156),s=r(92137),i=r(28481),c=r(81253),u=r(87757),l=r.n(u),p=r(25558),f=r.n(p),b=r(45697),m=r.n(b),v=r(59458),d=r(58141),y=r(40287),h=r(76558),Z=r(43109),_=r(60578),g=r(37936),O=r(10743),P=r(84402),D=r(58990),j=r(9470),k=r(86738);function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var E=function(e){var t=e.filters,r=e.params,a=e.reportData,u=void 0===a?{}:a,b=e.buttonProps,m=e.isReportDynamic,w=void 0!==m&&m,E=e.label,R=(0,c.Z)(e,["filters","params","reportData","buttonProps","isReportDynamic","label"]),F=(0,v.Z)(),S=(0,p.useState)(!1),T=(0,i.Z)(S,2),M=T[0],N=T[1],C=(0,p.useState)(!1),A=(0,i.Z)(C,2),H=A[0],U=A[1],z=(0,p.useState)(!1),G=(0,i.Z)(z,2),L=G[0],q=G[1],B=(0,k.l)(),I=function(e){return(0,h.F3)(e,(0,Z.s9)(u,r),!0)},J=function(){var e=(0,s.Z)(l().mark((function e(){var n,a,s,i,c,p;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(!0),B({msg:F.formatMessage(_.Z.customReportNotificationCve)}),e.next=4,(0,y.dH)(x(x(x({},r),D.Z.defaultParams),{},{sort:r.sort||"-cvss_score",affecting:"true,false"}));case 4:if(n=e.sent,a=n.data,s=n.meta,!u||!u.userNotes){e.next=11;break}return e.next=10,insights.chrome.auth.getUser();case 10:i=e.sent;case 11:return a=a.map((function(e){var t;return x(x({},e),{},{attributes:x(x({},e.attributes),{},{status:j.Em.find((function(t){return t.value===e.attributes.status_id.toString()})).label,business_risk:j.eF.find((function(t){return t.value===e.attributes.business_risk_id.toString()})).label,impact:(null===(t=j.cv[e.attributes.impact])||void 0===t?void 0:t.title)||F.formatMessage(_.Z.impactListUnknown),cvss_score:parseFloat(e.attributes.cvss3_score||e.attributes.cvss2_score).toFixed(1)})})})),U((function(){var e,t=a.some((function(e){return e.attributes.rules.length>0}));return w?t&&u&&(null===(e=u.header)||void 0===e?void 0:e.includes("rule_presence")):t})),q((function(){var e,t=a.some((function(e){return e.attributes.known_exploit}));return w?t&&u&&(null===(e=u.header)||void 0===e?void 0:e.includes("known_exploit")):t})),c=(0,g.Z)({data:a.splice(0,(0,Z.rg)(u,r)),meta:s,filters:t,intl:F,isReportDynamic:w,reportData:u,user:i,type:"cves"}),p=I(a),N(!1),e.abrupt("return",[c].concat((0,o.Z)(p.map((function(e,t){return(0,O.Z)({data:e,page:t,intl:F,header:u&&u.header,type:"cves",isReportDynamic:w})})))));case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return f().createElement("div",null,f().createElement(d.o6,(0,n.Z)({orientation:"landscape",size:"A4",type:"",fileName:"".concat(D.Z.filename(w?"reports":""),".pdf"),buttonProps:x({component:"button"},b),asyncFunction:J,allPagesHaveTitle:!1,footer:f().createElement(P.Z,{intl:F,hasRule:H,hasExploit:L}),reportName:w?u.reportTitle:F.formatMessage(_.Z.cvePDFReportName),label:M?F.formatMessage(_.Z.loading):F.formatMessage(E)},R)))};E.defaultProps={label:_.Z.kebabExportAsPDF},E.propTypes={filters:m().oneOfType([m().array,m().object]),params:m().object,reportData:m().object,buttonProps:m().object,label:m().oneOfType([m().array,m().object]),isReportDynamic:m().bool};const R=E}}]);