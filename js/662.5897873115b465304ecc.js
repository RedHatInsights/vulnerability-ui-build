(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[662],{66516:(e,t,n)=>{"use strict";n.d(t,{Z:()=>j});var i=n(28481),s=n(93149),r=n(83115),a=n(59775),u=n(49739),c=n(83826),o=n(43547),l=n(79851),f=n(35224),d=n(34512),v=n(42065),m=n(45697),y=n.n(m),p=n(77865),_=n.n(p),h=n(45243),g=n(91709),Z=n(74806),b=n(30893),E=function(e){var t=e.cveList,n=e.updateRef,m=e.inventoryList,y=e.intl,Z=e.type,E=(0,g.fj)(A()),j=E.JustificationInput,P=E.justification,R=E.setJustification,S=E.setProps,k=(0,p.useState)(function(){switch(Z){case"systemsExposed":if(m.every((function(e){return e.status_id===t[0].status_id&&e.justification===t[0].justification})))return!0;break;case"systemDetail":var e=t.every((function(e,t,n){return e.status_id===n[0].status_id&&e.justification===n[0].justification})),n=t.every((function(e){return e.status_id===e.cve_status_id&&e.justification===e.cve_justification}));if(e&&n)return!0}return!1}()),I=(0,i.Z)(k,2),C=I[0],M=I[1],x=(0,g.Hb)(L()),w=x.StatusSelect,T=x.statusId,N=x.setStatusId,D=x.setProps,O=m.map((function(e){return e.id||e.inventory_id})),H=m.map((function(e){return e.display_name}));function L(){switch(Z){case"systemsExposed":return C?t[0].status_id:m.every((function(e,t,n){return e.status_id===n[0].status_id}))?m[0].status_id:"0";case"systemDetail":return C?t.every((function(e,t,n){return e.cve_status_id===n[0].cve_status_id}))?t[0].cve_status_id:"0":t.every((function(e,t,n){return e.status_id===n[0].status_id}))?t[0].status_id:"0"}}function A(){switch(Z){case"systemsExposed":return C?t[0].justification:m.every((function(e,t,n){return e.justification===n[0].justification}))&&m[0].justification||"";case"systemDetail":return C?t.every((function(e,t,n){return e.cve_justification===n[0].cve_justification}))&&t[0].cve_justification||"":t.every((function(e,t,n){return e.justification===n[0].justification}))&&t[0].justification||""}}(0,p.useEffect)((function(){D({isDisabled:C,ouiaId:"status-select"}),S({disabled:C}),N(L()),R(A())}),[C,D,S]);var J={variant:"success",title:y.formatMessage(b.Z.cvePairStatusModalUpdateSuccessful)},U=y.formatMessage(b.Z.cvePairStatusModalTitle,{count:O.length*t.length});return _().createElement(g.ZP,{items:t,onSave:function(){var e=t.map((function(e){return e.id})),i=C?{cve:e,inventory_id:O}:{status_id:parseInt(T),cve:e,status_text:P,inventory_id:O};return(0,h.cr)(i).then(n)},onSuccessNotification:J,title:U,ouiaId:"status-modal"},_().createElement(u.K,{hasGutter:!0},function(){switch(Z){case"systemsExposed":return m.some((function(e,t,n){return e.status_id!==n[0].status_id}));case"systemDetail":return t.some((function(e,t,n){return e.status_id!==n[0].status_id}))}}()&&_().createElement(c.v,null,_().createElement(o.b,{variant:"warning",isInline:!0,title:y.formatMessage(b.Z.cvePairStatusModalAlert)})),_().createElement(c.v,null,y.formatMessage(b.Z.cvePairStatusModalSelected,{cveCount:t.length||0,cveId:t[0].id,systemCount:m.length||0,systemName:H[0],b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return _().createElement("b",null,t)}})),_().createElement(c.v,null,_().createElement(r.l,{key:"key"},_().createElement(a.c,{fieldId:"overall"},_().createElement(l.P,null,_().createElement(d.J,null,_().createElement(s.X,{label:y.formatMessage(b.Z.cvePairStatusModalUseOverallCheckbox),id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:C,onChange:function(e){return M(e)}})),_().createElement(d.J,null,_().createElement(f.u,{content:y.formatMessage(b.Z.cvePairStatusModalUseOverallTooltip)},_().createElement(v.ZP,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)",style:{verticalAlign:"0"}}))))),w,j))))};E.propTypes={cveList:y().array,updateRef:y().func,inventoryList:y().array,intl:y().any,type:y().oneOf(["systemsExposed","systemDetail"])};const j=(0,Z.ZP)(E)},16493:(e,t,n)=>{"use strict";n.d(t,{Z:()=>E});var i=n(85061),s=n(28481),r=n(6610),a=n(5991),u=n(10379),c=n(46070),o=n(77608),l=n(83215),f=n(19951),d=n(16712),v=n(36873),m=n(45697),y=n.n(m),p=n(77865),_=n.n(p),h=n(37703),g=n(30893),Z=n(44012);var b=function(e){(0,u.Z)(v,e);var t,n,l=(t=v,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,o.Z)(t);if(n){var s=(0,o.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,c.Z)(this,e)});function v(){var e,t;(0,r.Z)(this,v);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return(0,c.Z)(t,(e=t=l.call.apply(l,[this].concat(a)),t.baseIssueTemplate=function(e){return{id:"vulnerabilities:".concat(e),description:e}},t.cveHasRule=function(e){var t;return(null===(t=e.rules)||void 0===t?void 0:t.length)>0},t.someSystemsHaveRule=function(e){return e.some((function(e){return e.rule}))},t.filterRules=function(e,t){return e.rules.filter((function(e){var n=e.value;return t.some((function(e){var t,i=e.rule;return i?(null==i||null===(t=i.rule)||void 0===t?void 0:t.rule_id)===n:n}))}))},t.remediationProvider=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n=[].concat(n),r=[].concat(r);var u=[];if(a&&1===n.length){var c=n,o=(0,s.Z)(c,1),l=o[0];if(t.cveHasRule(l)&&t.someSystemsHaveRule(r)){var f=t.filterRules(l,r);u=f.reduce((function(e,n){var s=t.baseIssueTemplate(l.id);return s.id="".concat(s.id,":").concat(n.value),[].concat((0,i.Z)(e),[s])}),[])}else u=[t.baseIssueTemplate(l.id)]}return a||1!==(null===(e=r)||void 0===e?void 0:e.length)||(u=n.reduce((function(e,n){var s,r=t.baseIssueTemplate(n.id);return null!==(s=n.rules)&&void 0!==s&&s.rule_id&&(r.id="".concat(r.id,":").concat(n.rules.rule_id)),[].concat((0,i.Z)(e),[r])}),[])),!(!n.length||!r.length)&&{issues:u,systems:r.map((function(e){return e.id||e}))}},e))}return(0,a.Z)(v,[{key:"shouldComponentUpdate",value:function(e){return e.cves!==this.props.cves||e.systems!==this.props.systems}},{key:"render",value:function(){var e=this,t=this.props,n=t.cves,i=t.systems,s=t.manyRules,r=t.addNotification;return _().createElement("div",null,_().createElement(f.Z,{dataProvider:function(){return e.remediationProvider(n,i,s)},isDisabled:!1===this.remediationProvider(n,i),onRemediationCreated:function(e){return r(e.getNotification())}},_().createElement(d.ZP,{size:"sm",color:"var(--pf-global--BackgroundColor--100)"}),"Â ",_().createElement(Z.Z,g.Z.remediateLabel)))}}]),v}(p.Component);b.propTypes={cves:y().oneOfType([y().array,y().string]),systems:y().oneOfType([y().array,y().string]),addNotification:y().func,manyRules:y().bool};const E=(0,h.connect)(null,(function(e){return{addNotification:function(t){return e((0,l.wN)(t))}}}))((0,v.Z)(b))}}]);