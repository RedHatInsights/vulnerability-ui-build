"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[322],{98152:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Ze});var a=r(29439),n=r(77865),s=r.n(n),l=r(28216),o=r(50693),c=r(16475),i=r(32203),u=r(70),m=r(62394),p=r(49734),f=r(86350),d=r(82442),v=r(93433),y=r(15861),g=r(87757),Z=r.n(g),E=r(86896),b=r(3968),h=r(71478),x=r(30893),C=r(4942),_=r(45697),S=r.n(_),R=r(78733),M=r(62410),T=r(74093),O=r(80167),D=function(e){var t=e.counter,r=e.label;return s().createElement(T.G7,null,s().createElement(T.xv,{style:O.Z.counter},t),s().createElement(T.xv,{style:O.Z.counterLabel},r))};D.propTypes={counter:S().number,label:S().string};const N=D;var j=function(e){var t=e.data,r=e.intl,a=t.totalSystems,l=t.totalCves,o=t.totalRules;return s().createElement(n.Fragment,{key:"exec-first-page"},s().createElement(T.xv,{style:[O.Z.generated,O.Z.mb24]},r.formatMessage(x.Z.executiveReportGenerated,{date:(0,M.Z)({date:new Date,type:"exact"}).props.children})),s().createElement(T.xv,{style:O.Z.mb16},r.formatMessage(x.Z.executiveReportHeader)),s().createElement(T.xv,{style:O.Z.mb8},r.formatMessage(x.Z.executiveReportSubHeader,{systems:s().createElement(T.xv,{style:O.Z.bold},r.formatMessage(x.Z.executiveReportHeaderSystems,{systems:a})),cves:s().createElement(T.xv,{style:O.Z.bold},r.formatMessage(x.Z.executiveReportHeaderCVEs,{cves:l})),rules:s().createElement(T.xv,{style:O.Z.bold},r.formatMessage(x.Z.executiveReportHeaderRules,{rules:o}))})),s().createElement(b.$0,{withColumn:!1},s().createElement(b.s_,null,s().createElement(b.Lv,{style:O.Z.counterPanel},s().createElement(N,{counter:a,label:r.formatMessage(x.Z.executiveReportAnalyzedSystems,{systems:a})})),s().createElement(b.Lv,{style:O.Z.counterPanel},s().createElement(N,{counter:l,label:r.formatMessage(x.Z.executiveReportAnalyzedCVEs,{cves:l})})),s().createElement(b.Lv,{style:O.Z.counterPanel},s().createElement(N,{counter:o,label:r.formatMessage(x.Z.executiveReportAnalyzedRules,{rules:o})})))))};j.propTypes={data:S().exact({totalSystems:S().number,totalCves:S().number,totalRules:S().number}),intl:S().any};const w=j;var k=r(84506),P=r(39138),H=r.n(P),I=r(1809),L=function(e){var t=e.data,r=e.intl,l=function(e){return s().createElement(T.xv,{style:O.Z.mb8}," ",H()(e,{length:400}))},o=t.recentCvesData,c=t.CVSSChart,i=t.CVSSData,u=t.CVSSHeader,m=t.topCves,p=(0,k.Z)(u),f=p[0],d=p.slice(1);return s().createElement(n.Fragment,{key:"first-section"},s().createElement(T.xv,{style:O.Z.header},r.formatMessage(x.Z.cvesHeader)),s().createElement(b.$0,{titleProps:{style:O.Z.sectionTitle},title:r.formatMessage(x.Z.executiveReportCvesByCVSS)},s().createElement(b.sg,null,s().createElement(b.kL,{chartType:"pie",subTitle:"Cves",title:"100",data:c,colorSchema:"orange",legendHeader:f})),s().createElement(b.sg,null,s().createElement(b.iA,{withHeader:!0,rows:[d].concat((0,v.Z)(i))}))),s().createElement(b.$0,{titleProps:{style:O.Z.sectionTitle},title:r.formatMessage(x.Z.executiveReportRecentlyPublishedCves)},s().createElement(b.s_,{style:{flex:1}},o.map((function(e){var t=(0,a.Z)(e,2),r=t[0],l=t[1];return s().createElement(n.Fragment,{key:r},s().createElement(b.Lv,{style:{flex:1},title:r},l))})))),s().createElement(b.$0,{titleProps:{style:O.Z.sectionTitle},title:r.formatMessage(x.Z.executiveReportTop3),withColumn:!1},m.map((function(e){var t=e.synopsis,a=e.known_exploit,n=e.rule_presence,o=e.description,c=e.cvss3_score,i=e.systems_affected;return s().createElement(b.s_,{key:t,title:t,description:l(o),labels:s().createElement(I.Z,{hasExploit:a,hasRule:n,intl:r})},s().createElement(b.Lv,{title:r.formatMessage(x.Z.executiveReportPanelTitle)},Number.parseFloat(c).toFixed(1)),s().createElement(b.Lv,{title:r.formatMessage(x.Z.systemsExposed)},i.toString()))}))))};L.propTypes={data:S().exact({recentCvesData:S().array,CVSSChart:S().array,CVSSData:S().array,CVSSHeader:S().array,topCves:S().array}),intl:S().any};const F=L;var B=function(e){var t=e.data,r=e.intl,a=function(e,t){return s().createElement(n.Fragment,null,s().createElement(T.xv,{style:O.Z.mb8},"".concat(H()(e,{length:320}),"\n\n")),r.formatMessage(x.Z.associatedCves)," ",t.map((function(e){return e})).join(", "))},l=t.topRules,o=t.rulesHeader,c=t.rulesBySeverityMap,i=t.rulesChart;return s().createElement(n.Fragment,{key:"first-section"},s().createElement(T.xv,{style:O.Z.header},r.formatMessage(x.Z.rules)),s().createElement(b.$0,{titleProps:{style:O.Z.sectionTitle},title:r.formatMessage(x.Z.executiveReportRulesSection)},s().createElement(b.sg,null,s().createElement(b.iA,{withHeader:!0,rows:[o].concat((0,v.Z)(c))})),s().createElement(b.sg,null,s().createElement(b.kL,{chartType:"bar",subTitle:"rules",title:"Rules",data:i,colorSchema:"orange",legend:!1}))),s().createElement(b.$0,{titleProps:{style:O.Z.sectionTitle},title:r.formatMessage(x.Z.executiveReportTop3Rules),withColumn:!1},l.map((function(e,t){return s().createElement(b.s_,{key:t,title:e.name,description:a(e.description,e.associated_cves)},s().createElement(b.Lv,{title:r.formatMessage(x.Z.executiveReportRulePanelTitle)},s().createElement(b.Uc,{variant:e.severity})),s().createElement(b.Lv,{title:r.formatMessage(x.Z.systemsExposed)},e.systems_affected.toString()))}))))};B.propTypes={data:S().exact({topRules:S().array,rulesHeader:S().array,rulesBySeverityMap:S().array,rulesChart:S().array}),intl:S().any};const V=B;function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach((function(t){(0,C.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var $=function(e){var t,r=e.data,n=e.intl,l=r.cves_by_severity,o=r.recent_cves,c=r.top_cves,i=r.cves_total,u=r.system_count,m=r.top_rules,p=r.rules_total,f=r.rules_by_severity;0===(null==l||null===(t=l.na)||void 0===t?void 0:t.count)&&(delete l.na,delete R.cL.na);var d=Object.keys(f).reverse().map((function(e){return[R.q[e]].concat((0,v.Z)(Object.values(f[e]).map((function(e){return e.toString()}))))})),y=Object.values(l).reverse().map((function(e){var t=e.count,r=e.percentage,a=e.known_exploit_count;return[n.formatMessage(x.Z.executiveReportOfTotal,{count:t,percentage:r}),a.toString()]})),g=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=[];for(var n in e){var s=e[n],l=t[n],o=void 0!==l.count?l.count:l;r&&l.percentage&&(o=l.percentage),a.push([s,o.toString()])}return a},Z=g(R.YM,W({},o)),E=g(R.cL,W({},l),!0).map((function(e){var t=(0,a.Z)(e,2),r=t[0],n=t[1];return{x:r,y:Number(n)}})),b=d.map((function(e){var t=(0,a.Z)(e,3),r=t[0],n=t[2];return{name:r,x:r,y:Number(n)}})),h={totalSystems:u,totalCves:i,totalRules:p},C={recentCvesData:Z,CVSSChart:E,CVSSData:y,CVSSHeader:R.rs,topCves:c},_={topRules:m,rulesHeader:R.$D,rulesBySeverityMap:d,rulesChart:b};return[s().createElement(w,{key:"first-page",intl:n,data:h}),s().createElement(F,{key:"second-page-cves",intl:n,data:C}),s().createElement(V,{key:"third-page-rules",intl:n,data:_})]};$.propTypes={data:S().exact({cves_by_severity:S().object,recent_cves:S().object,top_cves:S().array,cves_total:S().number,system_count:S().number,rules_by_severity:S().object,rules_total:S().number,top_rules:S().array}),intl:S().any};const A=$;var U=r(37450),G=r(75201);const X=function(){var e=(0,E.Z)(),t=(0,n.useState)(!1),r=(0,a.Z)(t,2),l=r[0],o=r[1],c=(0,n.useState)(!1),i=(0,a.Z)(c,2),u=i[0],m=i[1],p=(0,n.useState)(!1),f=(0,a.Z)(p,2),d=f[0],g=f[1],C=(0,n.useState)(!1),_=(0,a.Z)(C,2),S=_[0],R=_[1],M=(0,U.lm)(),T=(0,a.Z)(M,2),O=T[0],D=T[1],N=function(){var t=(0,y.Z)(Z().mark((function t(){var r,a;return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,h.nK)();case 3:r=t.sent,t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(0),D(),O({variant:"danger",autoDismiss:!1,msg:e.formatMessage(x.Z.notificationReportDownloadFailureTitle),description:e.formatMessage(x.Z.notificationReportDownloadFailureBody)}),t.abrupt("return",[]);case 11:return a=A({data:r,intl:e}),g((function(){return r.top_cves.some((function(e){return!0===e.rule_presence}))})),R((function(){return r.top_cves.some((function(e){return!0===e.known_exploit}))})),o(!1),D(),O({variant:"success",msg:e.formatMessage(x.Z.notificationReportDownloadSuccess)}),t.abrupt("return",(0,v.Z)(a));case 18:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(){return t.apply(this,arguments)}}(),j=(new Date).toISOString().split("T"),w=(0,a.Z)(j,1)[0];return s().createElement(n.Fragment,null,s().createElement("a",{onClick:function(){return m(!0),o(!0),void O({msg:e.formatMessage(x.Z.notificationReportDownloadStart)})}},l?e.formatMessage(x.Z.loading):e.formatMessage(x.Z.executiveReportCardButton)),u&&s().createElement(b.o6,{fallback:s().createElement("div",null),type:e.formatMessage(x.Z.vulnerabilitiesHeader),fileName:"vulnerability_executive-report--".concat(w,".pdf"),buttonProps:{variant:"link",isInline:!0},groupName:"Red Hat Insights",asyncFunction:N,allPagesHaveTitle:!1,showButton:!1,footer:s().createElement(G.Z,{intl:e,hasRule:d,hasExploit:S}),onSuccess:function(){m(!1)}}))};var K=r(80236),q=r(47173),Y=r(83115),J=r(59775),Q=r(92607),ee=r(93149),te=r(23393),re=r(13115),ae=r(57980),ne=r(32132),se=r(27482);function le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?le(Object(r),!0).forEach((function(t){(0,C.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ce=function(e){var t=e.isOpen,r=e.handleModalClose,l=e.filterData,o=e.setFilterData,c=e.handleDownloadButton,i=e.columnsToInclude,u=e.setColumnsToInclude,m=e.userNotes,p=e.setUserNotes,f=e.reportTitle,d=e.setReportTitle,y=(0,n.useState)("all"),g=(0,a.Z)(y,2),Z=g[0],E=g[1],b=["rule_presence","known_exploit","impact","cvss_filter","business_risk_id","status_id","publish_date","rhel_version"];return(0,n.useEffect)((function(){"all"===Z&&u(Object.keys(R.jW))}),[Z,u]),s().createElement(K.u,{width:"50rem",title:ne.N.formatMessage(x.Z.configModalTitle),ouiaId:"custom-report-modal",isOpen:t,onClose:r,actions:[s().createElement(q.zx,{key:"export",variant:"primary",onClick:c,isDisabled:!(0,se.o)(l.cvss_filter.from,l.cvss_filter.to)||m.length>R.Z0},ne.N.formatMessage(x.Z.configModalExportReport)),s().createElement(q.zx,{key:"cancel",variant:"secondary",onClick:r},ne.N.formatMessage(x.Z.cancel))]},s().createElement(Y.l,null,s().createElement(J.c,{label:ne.N.formatMessage(x.Z.customReportTitleLabel),fieldId:"horizontal-form-name"},s().createElement(Q.oi,{value:f,onChange:function(e){return d(e)},type:"text",className:"report-text-input",id:"horizontal-form-name"})),s().createElement(J.c,{label:ne.N.formatMessage(x.Z.customReportFilterDataByLabel)},s().createElement("div",{className:"custom-report-filter-wrapper"},b&&b.map((function(e){var t;return null===(t=R.jW[e])||void 0===t?void 0:t.component({filterData:l,setFilterData:o,selectProps:oe({className:"pf-u-mr-sm pf-u-mb-sm"},R.jW[e].selectProps),options:R.jW[e].items,filterId:e,filterName:R.jW[e].title})})))),s().createElement(J.c,{label:ne.N.formatMessage(x.Z.customReportDataToIncludeLabel)},s().createElement(re.t,{"aria-label":"Default with single selectable"},s().createElement(ae.G,{text:ne.N.formatMessage(x.Z.customReportDataToggleAll),isSelected:"all"===Z,onChange:function(){return E("all")}}),s().createElement(ae.G,{text:ne.N.formatMessage(x.Z.customReportDataToggleCustom),isSelected:"custom"===Z,onChange:function(){return E("custom")}})),"custom"===Z&&s().createElement("div",{style:O.Z.collumns},s().createElement(ee.X,{id:"cve_id",label:"CVE ID",isChecked:!0,isDisabled:!0,className:"pf-u-mb-md"}),Object.entries(R.jW).map((function(e){var t=(0,a.Z)(e,2),r=t[0],n=t[1];return s().createElement(ee.X,{id:r,key:r,label:n.title,isChecked:i.includes(r),onChange:function(e){return function(e,t){u(t?[].concat((0,v.Z)(i),[e]):i.filter((function(t){return t!==e})))}(r,e)},className:"pf-u-mb-md"})})))),s().createElement(J.c,{label:ne.N.formatMessage(x.Z.customReportUserNotesLabel),fieldId:"user-notes-box",helperTextInvalid:ne.N.formatMessage(x.Z.customReportUserNoteTooLong),validated:m.length>R.Z0&&"error"},s().createElement(te.Kx,{value:m,onChange:function(e){return p(e)},type:"text",id:"user-notes-box",className:"report-text-input",resizeOrientation:"vertical",style:{minHeight:"4em"},validated:m.length>R.Z0&&"error"}))))};ce.propTypes={isOpen:S().bool,filterData:S().object,setFilterData:S().func,handleModalClose:S().func,handleDownloadButton:S().func,columnsToInclude:S().array,setColumnsToInclude:S().func,userNotes:S().string,setUserNotes:S().func,reportTitle:S().string,setReportTitle:S().func};const ie=ce;var ue=r(53279),me=function(e){var t=e.style;return s().createElement("img",{style:t,src:ue,alt:"Static pie solid"})};me.propTypes={style:S().object};var pe=r(75115),fe=r(33084),de=r(22408),ve=r(83215),ye=r(94909),ge=r(6023);const Ze=function(){var e=(0,U.Wu)([R._I.advancedReporting]),t=(0,a.Z)(e,2),r=(0,a.Z)(t[0],1)[0],v=t[1],y=(0,n.useState)(!1),g=(0,a.Z)(y,2),Z=g[0],E=g[1],b=(0,n.useState)(!1),h=(0,a.Z)(b,2),C=h[0],_=h[1],S=(0,n.useState)(ne.N.formatMessage(x.Z.customReportDefaultTitle)),M=(0,a.Z)(S,2),T=M[0],D=M[1],N=(0,n.useState)(""),j=(0,a.Z)(N,2),w=j[0],k=j[1],P=(0,n.useState)(Object.keys(R.jW)),H=(0,a.Z)(P,2),I=H[0],L=H[1],F=(0,n.useState)(R.OX),B=(0,a.Z)(F,2),V=B[0],z=B[1],W=(0,l.I0)();(0,n.useEffect)((function(){return function(){W((0,ve.L1)())}}),[W]);var $=function(){D(ne.N.formatMessage(x.Z.customReportDefaultTitle)),k(""),L(Object.keys(R.jW)),z(R.OX),_(!1),E(!1)};return v?s().createElement(ge.Z,{centered:!0}):r?s().createElement(s().Fragment,null,s().createElement(pe.Z,{title:ne.N.formatMessage(x.Z.reportsPageTitle),showBreadcrumb:!1}),s().createElement(f.Z,null,s().createElement(o.r,{hasGutter:!0,lg:3,md:4,sm:12},s().createElement(c.P,null,s().createElement(i.Z,{className:"report-card"},s().createElement(u.l,null,s().createElement(me,{style:O.Z.pieChartIcon}),s().createElement("span",{className:"pf-u-ml-sm",style:O.Z.cardTitle},ne.N.formatMessage(x.Z.executiveReportCardTitle))),s().createElement(m.e,null,ne.N.formatMessage(x.Z.executiveReportCardDescription)),s().createElement(p.e,null,s().createElement(X,null)))),s().createElement(c.P,null,s().createElement(i.Z,{className:"report-card"},s().createElement(u.l,null,s().createElement(d.ZP,{size:"lg",color:"var(--pf-global--link--Color)"}),s().createElement("span",{className:"pf-u-ml-sm",style:O.Z.cardTitle},ne.N.formatMessage(x.Z.customReportCardTitle))),s().createElement(m.e,null,ne.N.formatMessage(x.Z.customReportCardDescription)),s().createElement(p.e,null,s().createElement("a",{className:"create-report",onClick:function(){return E(!0)}},ne.N.formatMessage(x.Z.customReportCardButton))))))),s().createElement(ie,{isOpen:Z,columnsToInclude:I,setColumnsToInclude:L,filterData:V,userNotes:w,reportTitle:T,setReportTitle:D,setUserNotes:k,setFilterData:z,handleModalClose:$,handleDownloadButton:function(){_(!0),E(!1)}}),C&&s().createElement(fe.Z,{key:"download",reportData:{header:I,reportTitle:T,userNotes:w},showButton:!1,onSuccess:$,params:(0,de.pX)(V),filters:(0,de._R)(V),isReportDynamic:!0,label:x.Z.configModalExportReport})):s().createElement(ye.Z,{title:ne.N.formatMessage(x.Z.reportsPageTitle)})}},53279:(e,t,r)=>{e.exports=r.p+"fonts/chart-pie-solid.svg"}}]);
//# sourceMappingURL=../sourcemaps/Reports.4929e125b65b9bcb93dc54bac9a1f5b1.js.map