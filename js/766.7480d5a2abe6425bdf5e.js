"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[766],{1809:(e,t,r)=>{r.d(t,{Z:()=>v});var n=r(4942),a=r(77865),s=r.n(a),o=r(45697),l=r.n(o),i=r(74093),c=r(3968),u=r(80167),m=r(30893);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d=function(e){var t=e.intl,r=e.hasRule,n=e.hasExploit,a=e.isSmall,o=void 0!==a&&a;return s().createElement(i.G7,{style:u.Z.labelsWrapper},n&&s().createElement(i.G7,{style:f(f({},u.Z.label),{},{width:o?62:70})},s().createElement(c.Uc,{icon:!1,width:o?62:75,variant:4,label:t.formatMessage(m.Z.filterKnownExploit),textStyle:o?f(f({},u.Z.smallText),{},{left:-56}):void 0,labelStyle:{border:"solid",borderWidth:1,borderColor:"#c9190b",height:o?16:20}})),r&&s().createElement(i.G7,{style:u.Z.label},s().createElement(c.Uc,{icon:!1,width:o?59:63,label:t.formatMessage(m.Z.securityRuleLabel),textStyle:o?u.Z.smallText:void 0,labelStyle:{border:"solid",borderWidth:1,borderColor:"#bee1f4",height:o?16:20}})))};d.propTypes={hasRule:l().bool,hasExploit:l().bool,intl:l().any,isSmall:l().bool};const v=d},43198:(e,t,r)=>{r.d(t,{Z:()=>v});var n=r(77865),a=r.n(n),s=r(45697),o=r.n(s),l=r(3968),i=r(74093),c=r(30893),u=r(62598),m=r(52837),p=r(22408),f=r(80167),d=function(e){for(var t,r=e.data,s=e.meta,o=e.filters,d=e.intl,v=e.isReportDynamic,y=e.reportData,b=e.user,h=e.type,g=v?o:o.reduce((function(e,t){return e[t.key]={filter:t.category,values:"publish_date"===t.key?m.GZ.find((function(e){return e.value===t.chips[0].value})).timespan_label:t.chips.map((function(e){return e.name})).join(", ")},e}),{}),Z=[{name:"impact",msg:c.Z.CVEsPDFreportFiltersSeverity},{name:"business_risk_id",msg:c.Z.CVEsPDFreportFiltersBusinessRisk},{name:"status_id",msg:c.Z.CVEsPDFreportFiltersStatus},{name:"rule_presence",msg:c.Z.CVEsPDFreportFiltersDefinedValue},{name:"known_exploit",msg:c.Z.CVEsPDFreportFiltersDefinedValue}],_=Z.length-1;_>=0;_--)if(g.hasOwnProperty(Z[_].name)){Z[_].isLast=!0;break}return a().createElement(n.Fragment,{key:"first-section"},v&&a().createElement(l.nv,null,(0,p.aR)(c.Z.customReportIntroductionText)),"cves"===h?a().createElement(l.nv,null,(0,p.aR)(c.Z.customReportSearchTermCvssAndPublishDate,{hasSearchTerm:g.hasOwnProperty("filter")?"yes":"no",searchTerm:g.filter&&g.filter.values,score:g.cvss_filter&&g.cvss_filter.values||m.OX.cvss_filter.from.toFixed(1)+" - "+m.OX.cvss_filter.to.toFixed(1),published:g.publish_date&&g.publish_date.values||(0,p.aR)(c.Z.customReportTimespanAnytime)}),Z.map((function(e){return g.hasOwnProperty(e.name)&&(0,p.aR)(e.msg,{values:g[e.name].values.toLowerCase(),prefix:e.isLast?d.formatMessage(c.Z.customReportAnd):";"})})),a().createElement(i.xv,null,"."),"\n\n"):a().createElement(l.nv,null,g.filter?(0,p.aR)(c.Z.systemsPDFreportFiltersSearchTerm,{searchTerm:g.filter.values}):""),"cves"===h&&a().createElement(l.nv,null,a().createElement(i.xv,null,(0,p.aR)(c.Z.CVEsPDFreportSubHeader,{cve_count:s.total_items.toString(),system_count:s.system_count.toString()}),(v&&(null===(t=y.header)||void 0===t?void 0:t.includes("known_exploit"))||!v)&&(0,p.aR)(c.Z.CVEsPDFreportSubHeaderExploit,{knownExploitCount:s.knownExploitCount.toString()}))),y&&y.userNotes?a().createElement(i.G7,{style:f.Z.userNotes},a().createElement(l.nv,{style:f.Z.userNotesTitle},a().createElement(i.xv,{style:f.Z.bold},d.formatMessage(c.Z.customReportUserNoteLabel))),a().createElement(l.nv,null,a().createElement(i.xv,null,y.userNotes)),a().createElement(l.nv,null,b&&b.identity&&a().createElement(i.xv,{style:f.Z.italic},d.formatMessage(c.Z.customReportUserNotesGenerated,{name:"".concat(b.identity.user.first_name," ").concat(b.identity.user.last_name)})))):null,a().createElement(i.G7,{style:f.Z.mt16},(0,u.Z)({data:r,intl:d,header:y&&y.header,type:h,isReportDynamic:v})))};d.defaultProps={user:void 0},d.propTypes={intl:o().any,filters:o().array,data:o().object,meta:o().object,reportData:o().object,isReportDynamic:o().bool,user:o().object,type:o().string};const v=d},62598:(e,t,r)=>{r.d(t,{Z:()=>Z});var n=r(4942),a=r(93433),s=r(77865),o=r.n(s),l=r(45697),i=r.n(l),c=r(74093),u=r(3968),m=r(35240),p=r(52837),f=r(30893),d=r(80167),v=r(29648),y=r(1809);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g=function(e){var t=e.data,r=e.page,n=e.intl,l=e.header,i=e.type,b=e.isReportDynamic,g=void 0!==b&&b,Z=[{name:"publish_date",header:{value:n.formatMessage(f.Z.publishDate)}},{name:"cvss_filter",header:{value:n.formatMessage(f.Z.cvssBaseScore)},hit:"cvss_score"},{name:"impact",header:{value:n.formatMessage(f.Z.impact)},hit:"impact"},{name:"affecting",header:{value:n.formatMessage(f.Z.systemsExposed)},hit:"systems_affected"},{name:"business_risk_id",header:{value:n.formatMessage(f.Z.businessRisk)},hit:"business_risk"},{name:"status_id",header:{value:n.formatMessage(f.Z.status)},hit:"status"}],_=function(e){var t=e.value,r=e.style;return o().createElement(c.xv,{key:t,style:r},t)},O=["cvss_score","impact","systems_affected","business_risk","status"],E=[];l?(E.push({value:n.formatMessage(f.Z.cveId)}),O=[],Z.forEach((function(e){l.includes(e.name)&&(E.push(e.header),e.hit&&O.push(e.hit))}))):"cves"===i?E=[{value:n.formatMessage(f.Z.cveId)}].concat(Z.map((function(e){return e.header}))):(O=["display_name","cve_count","updated"],E=[{value:"Name"},{value:"Applicable CVEs"},{value:"Last seen"}]);var w=function(e){var t=e.rules&&e.rules.length>0;return g?t&&l.includes("rule_presence"):t},j=(0,a.Z)(t.map((function(e){var t,r,s=e.attributes;return[o().createElement(c.G7,{style:[d.Z.bodyCell,d.Z.cveCell]},o().createElement(c.G7,null,o().createElement(c.xv,null,o().createElement(c.rU,{style:d.Z.link,src:"".concat(p.OF,"/").concat(s.synopsis)},s.synopsis))),o().createElement(y.Z,{hasExploit:(t=s,r=t.known_exploit,g?r&&l.includes("known_exploit"):r),hasRule:w(s),intl:n,isSmall:!0})),(!l||l.includes("publish_date"))&&o().createElement(c.xv,{key:s.public_date,style:[d.Z.bodyCell,d.Z.cveCell]},(0,m.Un)(s.public_date))].concat((0,a.Z)(O.map((function(e){return _({value:s[e],style:[d.Z.bodyCell,d.Z.cveCell]})}))))}))),C=(0,a.Z)(t.map((function(e){var t=e.attributes;return[_({value:t.display_name,style:[d.Z.bodyCell,d.Z.systemNameCell]}),_({value:t.opt_out?n.formatMessage(f.Z.systemsTableExcluded):t.cve_count,style:[d.Z.bodyCell,d.Z.systemCell]}),_({value:(0,v.p6)(t.updated,!0),style:[d.Z.bodyCell,d.Z.systemCell]})]})));return o().createElement(s.Fragment,{key:r},o().createElement(u.iA,{withHeader:!0,rows:[E.map((function(e){return _(h(h({},e),{},{style:[d.Z.headerCell,"cves"===i?d.Z.cveCell:"Name"===e.value?d.Z.systemNameCell:d.Z.systemCell]}))}))].concat((0,a.Z)("cves"===i?j:C))}),0===t.length&&o().createElement(c.xv,null,n.formatMessage(f.Z.customReportNoCves)))};g.propTypes={data:i().object,intl:i().any,page:i().number,header:i().array,type:i().string,isReportDynamic:i().bool};const Z=g},37450:(e,t,r)=>{r.d(t,{lm:()=>Z,U:()=>_,a9:()=>O,ZS:()=>w});var n=r(29439),a=r(15861),s=r(45987),o=r(4942),l=r(87757),i=r.n(l),c=r(93386),u=r.n(c),m=r(77865),p=r(28216),f=r(86896),d=r(83215),v=r(83594),y=r(30893),b=["msg"];function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Z=function(e){var t=(0,p.I0)(),r=g({variant:"info"},e);return(0,m.useEffect)((function(){return function(){e.preventClear||t((0,d.L1)())}}),[t]),[function(e){var n=e.msg,a=(0,s.Z)(e,b);return t((0,d.wN)(g(g({title:n},r),a)))},function(){return t((0,d.L1)())}]},_=function(e,t){var r=function(){var r=(0,a.Z)(i().mark((function r(n,a){var s,o,l,c,u,m,p,f,d,v;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return l=a.orderBy,c=a.orderDirection,u=a.page,m=a.per_page,p=a.vulnerabilityParams,f="".concat("ASC"===c?"":"-").concat(l),d=g(g({},p),{},{page:u,page_size:m,sort:f}),t(g({},d)),r.next=6,e(g({},d));case 6:return v=r.sent,r.abrupt("return",{results:null==v||null===(s=v.data)||void 0===s?void 0:s.map((function(e){return g({id:e.id},e.attributes)})),total:null==v||null===(o=v.meta)||void 0===o?void 0:o.total_items});case 8:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}();return r},O=function(e){var t=Z({variant:"success"}),r=(0,n.Z)(t,1)[0],a=Z({variant:"danger",autoDismiss:!1}),s=(0,n.Z)(a,1)[0],o=(0,p.I0)(),l=(0,f.Z)();return function(t,n,a){var i=Object.keys(t).length;o((0,v.R0)(Object.keys(t),a)).then((function(){r(a?{msg:l.formatMessage(y.Z.notificationExcludeSuccess,{count:i,systemName:n})}:{msg:l.formatMessage(y.Z.notificationIncludeSuccessTitle,{count:i,systemName:n}),description:l.formatMessage(y.Z.notificationIncludeSuccessBody)})})).catch((function(){s(a?{msg:l.formatMessage(y.Z.notificationExcludeFailureTitle,{count:i,systemName:n}),description:l.formatMessage(y.Z.notificationExcludeFailureBody,{count:i})}:{msg:l.formatMessage(y.Z.notificationIncludeFailureTitle,{count:i,systemName:n}),description:l.formatMessage(y.Z.notificationIncludeFailureBody,{count:i})})})).finally(e)}},E=function(e){return{id:e.id,selected:!0}},w=function(e){var t=e.rawData,r=e.selectedRows,n=e.selectedRowsCount,s=e.handleSelect,o=e.fetchResource,l=e.multiRow,c=void 0!==l&&l,m=(0,f.Z)(),p=t.meta,d=t.data,v=d&&(Array.isArray(d)&&d.length&&c?d.length/2:d.length),b=function(){var e=(0,a.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o({page_size:p.total_items,page:1});case 2:e.sent.payload.then((function(e){var t=e.data;s(t.map(E))}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{count:n,checked:Boolean(n),isDisabled:0===p.total_items&&0===n,ouiaId:"bulk-select",items:[{title:m.formatMessage(y.Z.selectNone),onClick:function(){return s([])}},{title:"".concat(m.formatMessage(y.Z.selectPage,{count:v})),onClick:function(){var e=(null!=t?t:{}).data,n=e&&u()(e.filter((function(e){return e.id})).map(E),Object.values(r));s(n)}},{title:"".concat(m.formatMessage(y.Z.selectAll,{count:p.total_items?p.total_items:0})),onClick:b}]}}}}]);
//# sourceMappingURL=../sourcemaps/766.07433fd233a48a554e60acbfa3aa7167.js.map