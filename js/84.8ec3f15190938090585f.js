"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[84],{75201:(e,t,r)=>{r.d(t,{Z:()=>f});var n=r(77865),a=r.n(n),o=r(45697),s=r.n(o),i=r(74093),u=r(80167),c=r(30893),l=r(22408),p=function(e){var t=e.hasRule,r=e.hasExploit;return a().createElement(i.G7,null,r&&a().createElement(i.xv,{style:u.Z.footer},(0,l.aR)(c.Z.knownExploitPDFFooter)),t&&a().createElement(i.xv,{style:u.Z.footer},(0,l.aR)(c.Z.securityRulePDFFooter)))};p.propTypes={hasRule:s().bool,hasExploit:s().bool};const f=p},33084:(e,t,r)=>{r.d(t,{Z:()=>F});var n=r(87462),a=r(93433),o=r(4942),s=r(15861),i=r(29439),u=r(45987),c=r(87757),l=r.n(c),p=r(77865),f=r.n(p),b=r(45697),m=r.n(b),v=r(86896),d=r(3968),y=r(71478),h=r(29648),g=r(22408),Z=r(30893),_=r(43198),D=r(62598),w=r(75201),R=r(62215),k=r(52837),O=r(37450),P=["filters","params","reportData","buttonProps","isReportDynamic","label"];function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var j=function(e){var t=e.filters,r=e.params,o=e.reportData,c=void 0===o?{}:o,b=e.buttonProps,m=e.isReportDynamic,x=void 0!==m&&m,j=e.label,F=(0,u.Z)(e,P),S=(0,v.Z)(),M=(0,p.useState)(!1),T=(0,i.Z)(M,2),C=T[0],N=T[1],A=(0,p.useState)(!1),H=(0,i.Z)(A,2),U=H[0],z=H[1],B=(0,p.useState)(!1),G=(0,i.Z)(B,2),L=G[0],q=G[1],I=(0,O.lm)(),J=(0,i.Z)(I,2),K=J[0],Q=J[1];(0,p.useEffect)((function(){N(!0),K({msg:S.formatMessage(Z.Z.notificationReportDownloadStart)})}),[]);var V=function(e){return(0,h.F3)(e,(0,g.s9)(c,r),(function(e,t){return e+(t.attributes.rules.length>0)}))},W=function(){var e=(0,s.Z)(l().mark((function e(){var n,o,s,i,u,p,f,b;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,y.dH)(E(E(E({},r),R.Z.defaultParams),{},{sort:r.sort||"-cvss_score",affecting:"true"}));case 3:s=e.sent,n=s.data,o=s.meta,e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(0),Q(),K({variant:"danger",autoDismiss:!1,msg:S.formatMessage(Z.Z.notificationReportDownloadFailureTitle),description:S.formatMessage(Z.Z.notificationReportDownloadFailureBody)}),e.abrupt("return",[]);case 13:if(!c||!c.userNotes){e.next=17;break}return e.next=16,insights.chrome.auth.getUser();case 16:i=e.sent;case 17:return u=function(e,t){return t.knownExploitCount=e.filter((function(e){return!0===e.attributes.known_exploit})).length,e.map((function(e){var r;return t.hasRule||(t.hasRule=e.attributes.rules.length>0),E(E({},e),{},{attributes:E(E({},e.attributes),{},{status:k.Em.find((function(t){return t.value===e.attributes.status_id.toString()})).label,business_risk:k.eF.find((function(t){return t.value===e.attributes.business_risk_id.toString()})).label,impact:(null===(r=k.cv[e.attributes.impact])||void 0===r?void 0:r.title)||S.formatMessage(Z.Z.impactListUnknown),cvss_score:parseFloat(e.attributes.cvss3_score||e.attributes.cvss2_score).toFixed(1)})})}))},p=u(n,o),z((function(){var e;return x?o.hasRule&&c&&(null===(e=c.header)||void 0===e?void 0:e.includes("rule_presence")):o.hasRule})),q((function(){var e;return x?o.knownExploitCount>0&&c&&(null===(e=c.header)||void 0===e?void 0:e.includes("known_exploit")):o.knownExploitCount>0})),f=(0,_.Z)({data:p.splice(0,(0,g.rg)(c,r)),meta:o,filters:t,intl:S,isReportDynamic:x,reportData:c,user:i,type:"cves"}),b=V(p),N(!1),Q(),K({variant:"success",msg:S.formatMessage(Z.Z.notificationReportDownloadSuccess)}),e.abrupt("return",[f].concat((0,a.Z)(b.map((function(e,t){return(0,D.Z)({data:e,page:t,intl:S,header:c&&c.header,type:"cves",isReportDynamic:x})})))));case 27:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return f().createElement("div",null,f().createElement(d.o6,(0,n.Z)({fallback:null,orientation:"landscape",size:"A4",type:"",fileName:"".concat(R.Z.filename(x?"reports":""),".pdf"),buttonProps:E({component:"button"},b),asyncFunction:W,allPagesHaveTitle:!1,footer:f().createElement(w.Z,{intl:S,hasRule:U,hasExploit:L}),reportName:x?c.reportTitle:S.formatMessage(Z.Z.cvePDFReportName),label:C?S.formatMessage(Z.Z.loading):S.formatMessage(j)},F)))};j.defaultProps={label:Z.Z.kebabExportAsPDF},j.propTypes={filters:m().oneOfType([m().array,m().object]),params:m().object,reportData:m().object,buttonProps:m().object,label:m().oneOfType([m().array,m().object]),isReportDynamic:m().bool};const F=j}}]);
//# sourceMappingURL=../sourcemaps/84.50c110b4228d13ec3b28c32f586e7261.js.map