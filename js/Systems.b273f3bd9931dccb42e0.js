(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[743],{64487:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ie});var n=r(63038),o=r.n(n),a=r(59713),s=r.n(a),c=r(6479),i=r.n(c),l=r(25558),u=r.n(l),f=r(45697),p=r.n(f),d=r(74806),m=r(18623),b=r(276),g=r(319),y=r.n(g),v=r(5977),h=r(81815),O=r(57721),P=r(51937),j=r(74268),S=r(49629),E=r(16721),w=r(25032),_=r(64739),Z=r(67154),D=r.n(Z),k=r(87757),x=r.n(k),N=r(48926),C=r.n(N),R=r(86896),M=r(58141),F=r(92339),I=r(58504),H=r(7255),T=r(59912),A=r(25098);function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var z=function(e){var t=e.filters,r=e.params,n=e.reportData,a=void 0===n?{}:n,s=e.buttonProps,c=e.label,f=i()(e,["filters","params","reportData","buttonProps","label"]),p=(0,R.Z)(),d=(0,l.useState)(!1),b=o()(d,2),g=b[0],v=b[1],O=(0,A.l)(),P=function(e){return(0,h.F3)(e,T.tp.systemsReportRestPages)},j=function(){var e=C()(x().mark((function e(){var n,o,s,c,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(!0),O({msg:m.Z.customReportNotificationSystem}),e.next=4,(0,F.vk)(L(L({},r),_.Z.defaultParams));case 4:return n=e.sent,o=n.data,s=n.meta,c=(0,I.Z)({data:o.splice(0,T.tp.systemsReportFirstPage),meta:s,filters:t,intl:p}),i=P(o),v(!1),e.abrupt("return",[c].concat(y()(i.map((function(e,t){return(0,H.Z)({data:e,page:t,intl:p,header:a&&a.header})})))));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return u().createElement("div",null,u().createElement(M.o6,D()({},f,{label:g?p.formatMessage(m.Z.loading):p.formatMessage(c),asyncFunction:j,buttonProps:L({component:"button"},s),reportName:p.formatMessage(m.Z.systemPDFReportName),type:"",fileName:"".concat(_.Z.filename("system-list"),".pdf"),allPagesHaveTitle:!1,size:"A4",orientation:"landscape"})))};z.defaultProps={label:m.Z.kebabExportAsPDF},z.propTypes={filters:p().oneOfType([p().array,p().object]),params:p().object,reportData:p().object,buttonProps:p().object,label:p().oneOfType([p().array,p().object])};const V=z;var K=r(16343),U=r(89421),W=r(11550);const Y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.excluded,n=function(t){var r=[!1,!1];t.forEach((function(e){r[e]=!0}));var n=r.join(",");e({excluded:"false,false"===n?"":n,page:1})};return{label:W.N.formatMessage(m.Z.filterSystemsIncludedInAnalysis),type:U.Yu.checkbox,urlParam:"excluded",filterValues:{onChange:function(e,t){n(t)},items:T._9.map((function(e){return{label:e.label,value:e.value}})),value:null==r?void 0:r.split(",").flatMap((function(e,t){return"true"===(null==e?void 0:e.toLowerCase())?t.toString():[]}))}}};function $(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var G=function(e){var t=e.selectedHosts,r=e.intl,n=e.parameters,a=e.systems,s=e.methods,c=(0,l.useState)(!1),i=o()(c,2),f=i[0],p=i[1],d=s.apply,b=s.handleSelect,g=s.doOptOut;P.N.addNew({on:"SELECT_ENTITY",callback:function(e){return function(e){var r=e.data.selected?[e.data.id].concat(y()(t)):t.filter((function(t){return t!==e.data.id}));b(!1,r)}(e)}});var v=(0,l.useMemo)((function(){var e=null==a?void 0:a.data.filter((function(e){return t.includes(e.id)}));return{selectedExcluded:e.some((function(e){return!0===e.attributes.opt_out})),selectedIncluded:e.some((function(e){return!1===e.attributes.opt_out}))}}),[t,a]),h=["",{label:r.formatMessage(m.Z.systemKebabExcludeAnalysis,{count:t.length||0}),onClick:function(){return g(null,!0)},props:{isDisabled:!t.length||!v.selectedIncluded}},{label:r.formatMessage(m.Z.systemKebabIncludeAnalysis,{count:t.length||0}),onClick:function(){return g(null,!1)},props:{isDisabled:!t.length||!v.selectedExcluded}}],Z=(0,j.Z)({selectedItems:t,selectorHandler:b,items:a,fetchResource:function(e){return(0,O.ip)(q(q({},n),e))}});return u().createElement(l.Fragment,null,u().createElement(S.Z,{bulkSelect:{count:t.length,items:Z.items,isDisabled:0===a.meta.total_items&&0===t.length,checked:Boolean(t.length),ouiaId:"bulk-select",onSelect:function(){return Z.handleOnCheckboxChange()}},actionsConfig:{actions:h,dropdownProps:{ouiaId:"toolbar-actions"}},filterConfig:{items:[(0,E.Z)("filter",m.Z.systemsSearchName,m.Z.searchFilterByName,n.filter,d),Y(d,n)]},activeFiltersConfig:{filters:(0,w.DU)(n),onDelete:function(e,t){return(0,w.vH)(t,d)}},exportConfig:q({isDisabled:0===a.meta.total_items,extraItems:[(0,K.Ec)(f,p)],ouiaId:"export"},(0,w.HV)({downloadReport:function(e){var t=q({},n);_.Z.exec(O.lc,t,e,"system-list")}}))}),f&&u().createElement(V,{showButton:!1,params:n,filters:(0,w.DU)(n),onSuccess:function(){return p(!1)}}))};G.propTypes={systems:h.nE,parameters:p().object,selectedHosts:p().array,methods:p().shape({doOptOut:p().func,apply:p().func,handleSelect:p().func}),intl:p().any};const J=(0,v.EN)((0,d.ZP)(G));var Q=r(86350),X=r(52906),ee=r(91067),te=r(83215),re=r(25413),ne=r(33739),oe=r(55409);function ae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ae(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ce=function(e){var t=e.intl,r=(0,l.useState)(void 0),n=o()(r,2),a=n[0],s=n[1],c=(0,h.H1)(T.IV),f=o()(c,2),p=f[0],d=f[1],g=u().createRef(),y=(0,b.useDispatch)(),v=(0,b.useSelector)((function(e){return e.SystemsPageStore.payload})),j=(0,b.useSelector)((function(e){return e.SystemsPageStore.params})),S=(0,b.useSelector)((function(e){return e.SystemsPageStore.metadata})),E=(0,b.useSelector)((function(e){return e.SystemsPageStore.error})),w=E.hasError,_=E.errorCode,Z=(0,b.useSelector)((function(e){return e.SystemsPageStore.isLoading})),D=(0,l.useMemo)((function(){return(null==(e=v.data)?void 0:e.map((function(e){var t=e.attributes,r=t.cve_count,n=i()(t,["cve_count"]);return se({cve_count:r,id:e.attributes.inventory_id},n)})))||[];var e}),[v]);(0,l.useEffect)((function(){return function(){y((0,O.re)()),y((0,O.r5)())}}),[y]),(0,l.useEffect)((function(){a&&y((0,O.lA)(a))}),[a,y]);var k=function(e){y((0,O.SF)(e))};(0,l.useEffect)((function(){y((0,te.L1)())}),[w,y]),(0,l.useEffect)((function(){g.current?(y((0,O.lc)(j)),d(se({},j))):k(p)}),[j]);var x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0;(a&&a.length>0||e)&&y((0,O.R0)(e||a,r)).then((function(){y((0,O.lc)(se(se({},j),{},{page:1}))),!1===j.opt_out?y((0,te.wN)({variant:"success",title:t.formatMessage(m.Z.systemsExcludedNotification,{count:e?1:a.length||0})})):y((0,te.wN)({variant:"success",title:t.formatMessage(m.Z.systemsResumedNotificationTitle,{count:e?1:a.length||0}),description:t.formatMessage(m.Z.systemsResumedNotificationBody)})),s([])}))};return u().createElement(l.Fragment,null,u().createElement(ee.Z,{title:t.formatMessage(m.Z.systemsHeader),showBreadcrumb:!1}),u().createElement(Q.Z,null,u().createElement(l.Fragment,null,w?u().createElement(oe.Z,{code:_}):u().createElement(ne.Z,{onLoad:function(e){var t=e.mergeWithEntities,r=e.mergeWithDetail;P.Z.register(se(se({},t((0,re.K)(T.Bi))),r()))},tableProps:{isStickyHeader:!0,canSelectAll:!1,onSort:D.length>0&&function(e,t,r){return(0,h.L6)(t,r,T.d$,p.sort,k)},sortBy:D.length>0&&(0,h.hO)(T.d$,S.sort),actionResolver:function(e){return(0,X.zs)(e,x)}},showTags:!0,isFullView:!0,ref:g,items:D,page:S&&S.page||1,perPage:S&&S.page_size||20,total:S&&S.total_items||0,onRefresh:function(e){var t=e.page,r=e.per_page;S.page===t&&S.limit===r||k({page:t,page_size:r}),S&&S.total_items<=r&&g.current&&g.current.onRefreshData({page:t,page_size:r})},isLoaded:!Z,hasCheckbox:0!==v.length},v.data&&u().createElement(J,{parameters:j,systems:v,selectedHosts:a||[],methods:{doOptOut:x,apply:k,handleSelect:function(e,t){t||(t=[]),s(t)},setSelectedHosts:s},actions:!0})))))};ce.propTypes={intl:p().any};const ie=(0,d.ZP)(ce)}}]);
//# sourceMappingURL=Systems.b273f3bd9931dccb42e0.js.map