(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[743],{72937:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Y});var r=n(63038),o=n.n(r),s=n(59713),a=n.n(s),c=n(6479),i=n.n(c),l=n(45697),u=n.n(l),f=n(74806),d=n(18623),p=n(44981),m=n(319),g=n.n(m),y=n(25558),b=n.n(y),h=n(5977),v=n(81815),O=n(21130),S=n(51937),_=n(74268),E=n(47835),P=n(16721),j=n(25032),w=n(64739),D=n(66780),Z=n(16343),k=n(9038),x=n(11550),C=n(73966);const N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.excluded,r=function(t){var n=[!1,!1];t.forEach((function(e){n[e]=!0}));var r=n.join(",");e({excluded:"false,false"===r?"":r,page:1})};return{label:x.N.formatMessage(d.Z.systemsIncludedInAnalysis),type:k.conditionalFilterType.checkbox,urlParam:"excluded",filterValues:{onChange:function(e,t){r(t)},items:C._9.map((function(e){return{label:e.label,value:e.value}})),value:null==n?void 0:n.split(",").flatMap((function(e,t){return"true"===(null==e?void 0:e.toLowerCase())?t.toString():[]}))}}};function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var H=function(e){var t=e.selectedHosts,n=e.intl,r=e.parameters,s=e.systems,a=e.methods,c=(0,y.useState)(!1),i=o()(c,2),l=i[0],u=i[1],f=a.apply,p=a.handleSelect,m=a.doOptOut;S.N.addNew({on:"SELECT_ENTITY",callback:function(e){return function(e){var n=e.data.selected?[e.data.id].concat(g()(t)):t.filter((function(t){return t!==e.data.id}));p(!1,n)}(e)}});var h=(0,y.useMemo)((function(){var e=null==s?void 0:s.data.filter((function(e){return t.includes(e.id)}));return{selectedExcluded:e.some((function(e){return!0===e.attributes.opt_out})),selectedIncluded:e.some((function(e){return!1===e.attributes.opt_out}))}}),[t,s]),v=["",{label:n.formatMessage(d.Z.systemKebabExcludeAnalysis,{count:t.length||0}),onClick:function(){return m(null,!0)},props:{isDisabled:!t.length||!h.selectedIncluded}},{label:n.formatMessage(d.Z.systemKebabIncludeAnalysis,{count:t.length||0}),onClick:function(){return m(null,!1)},props:{isDisabled:!t.length||!h.selectedExcluded}}],k=(0,_.Z)({selectedItems:t,selectorHandler:p,items:s,fetchResource:function(e){return(0,O.ip)(M(M({},r),e))}});return b().createElement(y.Fragment,null,b().createElement(E.U,{bulkSelect:{count:t.length,items:k.items,isDisabled:0===s.meta.total_items&&0===t.length,checked:Boolean(t.length),ouiaId:"bulk-select",onSelect:function(){return k.handleOnCheckboxChange()}},actionsConfig:{actions:v,dropdownProps:{ouiaId:"toolbar-actions"}},filterConfig:{items:[(0,P.Z)("filter",d.Z.systemsSearchName,d.Z.searchFilterByName,r.filter,f),N(f,r)]},activeFiltersConfig:{filters:(0,j.DU)(r),onDelete:function(e,t){return(0,j.vH)(t,f)}},exportConfig:M({isDisabled:0===s.meta.total_items,extraItems:[(0,Z.Ec)(l,u)],ouiaId:"export"},(0,j.HV)({downloadReport:function(e){var t=M({},r);w.Z.exec(O.lc,t,e,"system-list")}}))}),l&&b().createElement(D.Z,{type:"systems",showButton:!1,params:r,filters:(0,j.DU)(r),onSuccess:function(){return u(!1)}}))};H.propTypes={systems:v.nE,parameters:u().object,selectedHosts:u().array,methods:u().shape({doOptOut:u().func,apply:u().func,handleSelect:u().func}),intl:u().any};const R=(0,h.EN)((0,f.ZP)(H));var T=n(89583),B=n(52906),F=n(91067),L=n(90017),A=n(25413),z=n(67006),V=n(58135);function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var W=function(e){var t=e.intl,n=(0,y.useState)(void 0),r=o()(n,2),s=r[0],a=r[1],c=(0,v._W)(C.IV),l=o()(c,2),u=l[0],f=l[1],m=b().createRef(),g=(0,p.useDispatch)(),h=(0,p.useSelector)((function(e){return e.SystemsPageStore.payload})),_=(0,p.useSelector)((function(e){return e.SystemsPageStore.params})),E=(0,p.useSelector)((function(e){return e.SystemsPageStore.metadata})),P=(0,p.useSelector)((function(e){return e.SystemsPageStore.error})),j=(0,p.useSelector)((function(e){return e.SystemsPageStore.isLoading})),w=(0,y.useMemo)((function(){return(null==(e=h.data)?void 0:e.map((function(e){var t=e.attributes,n=t.cve_count,r=i()(t,["cve_count"]);return U({cve_count:n,id:e.attributes.inventory_id},r)})))||[];var e}),[h]);(0,y.useEffect)((function(){return function(){g((0,O.re)()),g((0,O.r5)())}}),[g]),(0,y.useEffect)((function(){s&&g((0,O.lA)(s))}),[s,g]);var D=function(e){g((0,O.SF)(e))};(0,y.useEffect)((function(){g((0,L.clearNotifications)())}),[P,g]),(0,y.useEffect)((function(){m.current?(g((0,O.lc)(_)),u(U({},_))):D(f)}),[_]);var Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;(s&&s.length>0||e)&&g((0,O.R0)(e||s,n)).then((function(){g((0,O.lc)(U(U({},_),{},{page:1}))),!1===_.opt_out?g((0,L.addNotification)({variant:"success",title:t.formatMessage(d.Z.systemsExcludedNotification,{count:e?1:s.length||0})})):g((0,L.addNotification)({variant:"success",title:t.formatMessage(d.Z.systemsResumedNotificationTitle,{count:e?1:s.length||0}),description:t.formatMessage(d.Z.systemsResumedNotificationBody)})),a([])}))};return b().createElement(y.Fragment,null,b().createElement(F.Z,{title:t.formatMessage(d.Z.systemsHeader),showBreadcrumb:!1}),b().createElement(T.o,null,!P&&b().createElement(V.e_,{onLoad:function(e){var t=e.mergeWithEntities,n=e.mergeWithDetail;S.Z.register(U(U({},t((0,A.K)(C.Bi))),n()))},tableProps:{isStickyHeader:!0,canSelectAll:!1,onSort:w.length>0&&function(e,t,n){return(0,v.L6)(t,n,C.d$,f.sort,D)},sortBy:w.length>0&&(0,v.hO)(C.d$,E.sort),actionResolver:function(e){return(0,B.zs)(e,Z)}},showTags:!0,isFullView:!0,ref:m,items:w,page:E&&E.page||1,perPage:E&&E.page_size||20,total:E&&E.total_items||0,onRefresh:function(e){var t=e.page,n=e.per_page;E.page===t&&E.limit===n||D({page:t,page_size:n}),E&&E.total_items<=n&&m.current&&m.current.onRefreshData({page:t,page_size:n})},isLoaded:!j,hasCheckbox:0!==h.length},h.data&&b().createElement(R,{parameters:_,systems:h,selectedHosts:s||[],methods:{doOptOut:Z,apply:D,handleSelect:function(e,t){t||(t=[]),a(t)},setSelectedHosts:a},actions:!0}))||(g((0,L.clearNotifications)()),z.pY)))};W.propTypes={intl:u().any};const Y=(0,f.ZP)(W)}}]);
//# sourceMappingURL=Systems.70d1f2e851d6fad6e33b.js.map