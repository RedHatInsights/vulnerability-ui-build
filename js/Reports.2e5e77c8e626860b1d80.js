(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[322],{12319:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>fe});var n=r(63038),a=r.n(n),l=r(25558),s=r.n(l),o=r(49287),c=r(18038),i=r(2095),u=r(36104),m=r(85962),p=r(45587),f=r(89583),d=r(38686),v=r(87757),b=r.n(v),g=r(319),y=r.n(g),E=r(48926),h=r.n(E),O=r(86896),_=r(58141),x=r(92339),j=r(18623),N=r(59713),C=r.n(N),Z=r(45697),M=r.n(Z),T=r(73966),w=r(89736),S=r(94949),k=r(81815);function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){C()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var R=function(e){var t,r,n=e.data,o=e.intl,c=n.cves_by_severity,i=n.recent_cves,u=n.top_cves,m=n.cves_total,p=n.system_count,f=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[];for(var a in e){var l=e[a],s=t[a],c=void 0!==s.count?s.count:s;"na"===a&&0===c||(r&&s.percentage&&(c="number"===r?s.percentage:o.formatMessage(j.Z.executiveReportOfTotal,{count:c,percentage:s.percentage})),n.push([l,c.toString()]))}return n},d=f(T.YM,P({},i)),v=f(T.cL,P({},c),"number").map((function(e){var t=a()(e,2),r=t[0],n=t[1];return{x:"CVSS ".concat(r),y:Number(n)}})),b=f(T.cL,P({},c),"string"),g=(t={firstPage:[],secondPage:[]},r=0,u.forEach((function(e){var n=Math.ceil(e.description.length/70);r+=n;var a=s().createElement(_.s_,{key:e.synopsis,title:e.synopsis,description:e.description},s().createElement(_.Lv,{title:o.formatMessage(j.Z.executiveReportPanelTitle)},Number.parseFloat(e.cvss3_score).toFixed(1)),s().createElement(_.Lv,{title:o.formatMessage(j.Z.systemsExposed)},e.systems_affected.toString()));r<=15&&t.firstPage.push(a)||t.secondPage.push(a)})),t);return[s().createElement(l.Fragment,{key:"first-section"},s().createElement(_.nv,null,o.formatMessage(j.Z.executiveReportHeader)),s().createElement(_.nv,null,o.formatMessage(j.Z.executiveReportSubHeader,{systems:s().createElement(w.xv,{style:S.Z.bold},o.formatMessage(j.Z.executiveReportHeaderSystems,{systems:p})),cves:s().createElement(w.xv,{style:S.Z.bold},o.formatMessage(j.Z.executiveReportHeaderCVEs,{cves:m}))})),s().createElement(_.$0,{title:o.formatMessage(j.Z.executiveReportCvesBySeverity)},s().createElement(_.sg,null,s().createElement(_.iA,{withHeader:!0,rows:[T.rs].concat(y()(b))})),s().createElement(_.sg,null,s().createElement(_.kL,{chartType:"pie",subTitle:"Cves",title:"100",data:v}))),s().createElement(_.$0,{title:o.formatMessage(j.Z.executiveReportRecentlyPublishedCves)},s().createElement(_.sg,null,s().createElement(_.iA,{withHeader:!0,rows:[T.Wq].concat(y()(d))})),s().createElement(_.sg,null)),s().createElement(_.$0,{title:o.formatMessage(j.Z.executiveReportTop3),withColumn:!1},g.firstPage))].concat(y()((0,k.zd)(g.secondPage.length>0,g.secondPage)))};R.propTypes={data:M().exact({cves_by_severity:M().object,recent_cves:M().object,top_cves:M().array,cves_total:M().number,system_count:M().number}),intl:M().any};const I=R;var F=r(44981),B=r(90017);const W=function(){var e=(0,O.Z)(),t=(0,l.useState)(!1),r=a()(t,2),n=r[0],o=r[1],c=(0,l.useState)(!1),i=a()(c,2),u=i[0],m=i[1],p=(0,F.useDispatch)(),f=function(){var t=h()(b().mark((function t(){var r,n;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o(!0),p((0,B.addNotification)({dismissable:!0,variant:"info",title:e.formatMessage(j.Z.downloadExecutiveNotification)})),t.next=4,(0,x.nK)();case 4:return r=t.sent,n=I({data:r,intl:e}),o(!1),t.abrupt("return",y()(n));case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=(new Date).toISOString().split("T"),v=a()(d,1)[0];return s().createElement(l.Fragment,null,s().createElement("a",{onClick:function(){m(!0)}},e.formatMessage(j.Z.executiveReportCardButton)),u&&s().createElement(_.o6,{showButton:!1,label:n?e.formatMessage(j.Z.loading):e.formatMessage(j.Z.executiveReportCardButton),asyncFunction:f,buttonProps:{variant:"link",isInline:!0},type:e.formatMessage(j.Z.vulnerabilitiesHeader),fileName:"vulnerability_executive-report--".concat(v,".pdf"),allPagesHaveTitle:!1,onSuccess:function(){p((0,B.clearNotifications)()),m(!1)}}))};var L=r(78826),H=r(6202),z=r(4853),G=r(23811),U=r(12282),A=r(32752),X=r(85806),V=r(36842),$=r(21508),K=r(9568),Y=r(63540),q=r(80887),J=r(77221),Q=r(11550),ee=r(84564);function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach((function(t){C()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ne=function(e){var t,r,n=e.filterName,o=e.filterData,c=e.setFilterData,i=(0,l.useState)(!1),u=a()(i,2),m=u[0],p=u[1],f=function(e,t){c(re(re({},o),{},{cvss_filter:re(re({},o.cvss_filter),{},C()({},t,e))}))},d=function(e){var t=+o.cvss_filter[e],r=+o.cvss_filter.min,n=+o.cvss_filter.max;return t<0||t>10||r>n?"error":"default"},v=function(e,t){return s().createElement(q.Select,{variant:"checkbox","aria-label":"Select Input",onToggle:function(){return p(!m)},isOpen:m,placeholderText:"".concat(T.jW[t].title,": ").concat(0===o[t].length||o[t].length===T.jW[t].items.length?"All":o[t].map((function(e){return T.jW[t].items.find((function(t){return t.value===e})).label})).join(", ")),direction:"up",key:t,width:"auto",className:"pf-u-mr-sm pf-u-mb-sm custom-report-filter-select",onSelect:function(e,r){!function(e,t){var r=T.jW[e].items.find((function(e){return e.label===t})).value;if(o[e].includes(r)){var n=o[e].indexOf(r),a=o[e].slice();a.splice(n,1),c(re(re({},o),{},C()({},e,a)))}else c(re(re({},o),{},C()({},e,[].concat(y()(o[e]),[r]))))}(t,r)},selections:o[t].map((function(e){return T.jW[t].items.find((function(t){return t.value===e})).label})),isCheckboxSelectionBadgeHidden:!0},e.map((function(e){return s().createElement(J.SelectOption,{key:t+e.label,value:e.label})})))},b=s().createElement(V.Split,{className:"pf-u-m-md"},s().createElement($.SplitItem,null,s().createElement("span",{style:{fontSize:14}},Q.N.formatMessage(j.Z.customReportCvssMinLabel)),s().createElement("br",null),s().createElement(U.TextInput,{type:"number",onChange:function(e){return f(e,"min")},validated:d("min"),id:"cvss-min",value:o.cvss_filter.min,style:{width:"5em"}})),s().createElement($.SplitItem,null,s().createElement("br",null),s().createElement("span",{className:"pf-u-m-sm"},"-")),s().createElement($.SplitItem,null,s().createElement("span",{style:{fontSize:14}},Q.N.formatMessage(j.Z.customReportCvssMaxLabel)),s().createElement("br",null),s().createElement(U.TextInput,{type:"number",onChange:function(e){return f(e,"max")},validated:d("max"),id:"cvss-max",value:o.cvss_filter.max,style:{width:"5em"}}))),g=s().createElement(q.Select,{variant:"panel","aria-label":"Select Input",customContent:b,onToggle:function(){return p(!m)},isOpen:m,placeholderText:(t=+o.cvss_filter.min,r=+o.cvss_filter.max,0===t&&10===r?"".concat(T.jW.cvss_filter.title,": ").concat(Q.N.formatMessage(j.Z.optionsAll)):s().createElement(Y.Text,null,"".concat(T.jW.cvss_filter.title,": ").concat(parseFloat(t).toFixed(1)," - ").concat(parseFloat(r).toFixed(1)),(t<0||r>10||t>r)&&s().createElement(ee.ZP,{color:"var(--pf-global--danger-color--100)",className:"pf-u-ml-xs"}))),className:"pf-u-mr-sm pf-u-mb-sm",direction:"up",width:"auto"});return function(e){switch(e){case"status_id":return v(T.Em,"status_id");case"business_risk_id":return v(T.eF,"business_risk_id");case"publish_date":return function(e,t){return s().createElement(q.Select,{variant:"single","aria-label":"Select Input",onToggle:function(){return p(!m)},isOpen:m,placeholderText:"".concat(T.jW[t].title,":\n                ").concat(T.jW[t].items.find((function(e){return e.value===o[t]})).label),direction:"up",key:t,onSelect:function(e,r){!function(e,t){var r=T.jW[e].items.find((function(e){return e.label===t})).value;c(re(re({},o),{},C()({},e,r)))}(t,r)},className:"pf-u-mr-sm pf-u-mb-sm",width:"auto"},e.map((function(e){return s().createElement(J.SelectOption,{width:"100%",key:t+e.label,value:e.label},s().createElement(K.Radio,{"aria-label":"Select Input",label:e.label,value:e.label,isChecked:o[t]===e.value}))})))}(T.GZ,"publish_date");case"impact":return v(T.XY,"impact");case"cvss_filter":return g;default:return null}}(n)};ne.propTypes={filterName:M().string,filterData:M().object,setFilterData:M().func};const ae=ne;function le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?le(Object(r),!0).forEach((function(t){C()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var oe=function(e){var t=e.isOpen,r=e.handleModalClose,n=e.filterData,l=e.setFilterData,o=e.handleDownloadButton,c=e.columnsToInclude,i=e.setColumnsToInclude,u=e.userNotes,m=e.setUserNotes,p=e.reportTitle,f=e.setReportTitle,d=["publish_date","impact","cvss_filter","status_id","business_risk_id"];return s().createElement(L.Modal,{title:Q.N.formatMessage(j.Z.configModalTitle),id:"custom-report-modal",ouiaId:"custom-report-modal",isOpen:t,onClose:r,actions:[s().createElement(H.Button,{key:"export",variant:"primary",onClick:o,isDisabled:+n.cvss_filter.min<0||+n.cvss_filter.max>10||+n.cvss_filter.min>+n.cvss_filter.max||u.length>T.Z0},Q.N.formatMessage(j.Z.configModalExportReport)),s().createElement(H.Button,{key:"cancel",variant:"secondary",onClick:r},Q.N.formatMessage(j.Z.cancel))]},s().createElement(z.Form,null,s().createElement(G.FormGroup,{label:Q.N.formatMessage(j.Z.customReportTitleLabel),fieldId:"horizontal-form-name"},s().createElement(U.TextInput,{value:p,onChange:function(e){return f(e)},type:"text",id:"horizontal-form-name"}),s().createElement(A.Checkbox,{id:"hasRule",key:"hasRule",label:Q.N.formatMessage(j.Z.customOnlyCvesWithRulesLabel),isChecked:"true"===n.security_rule,onChange:function(e){return l(se(se({},n),{},{security_rule:e?"true":void 0}))},className:"pf-u-mt-md"})),s().createElement(G.FormGroup,{label:Q.N.formatMessage(j.Z.customReportDataToIncludeLabel),fieldId:"horizontal-form-name"},s().createElement("div",{style:{columnCount:2}},s().createElement(A.Checkbox,{id:"cve_id",label:"CVE ID",isChecked:!0,isDisabled:!0,className:"pf-u-mb-md"}),Object.entries(T.jW).map((function(e){var t=a()(e,2),r=t[0],n=t[1];return"security_rule"!==r&&s().createElement(A.Checkbox,{id:r,key:r,label:n.title,isChecked:c.includes(r),onChange:function(e){return function(e,t){i(t?[].concat(y()(c),[e]):c.filter((function(t){return t!==e})))}(r,e)},className:"pf-u-mb-md"})})))),s().createElement(G.FormGroup,{label:Q.N.formatMessage(j.Z.customReportFilterDataByLabel),fieldId:"horizontal-form-name"},s().createElement("div",{className:"custom-report-filter-wrapper"}," ",d&&d.map((function(e){return s().createElement(ae,{key:e,filterName:e,filterData:n,setFilterData:l})})))),s().createElement(G.FormGroup,{label:Q.N.formatMessage(j.Z.customReportUserNotesLabel),fieldId:"user-notes-box",helperTextInvalid:Q.N.formatMessage(j.Z.customReportUserNoteTooLong),validated:u.length>T.Z0&&"error"},s().createElement(X.Kx,{value:u,onChange:function(e){return m(e)},type:"text",id:"user-notes-box",resizeOrientation:"vertical",style:{minHeight:"4em"},validated:u.length>T.Z0&&"error"}))))};oe.propTypes={isOpen:M().bool,filterData:M().object,setFilterData:M().func,handleModalClose:M().func,handleDownloadButton:M().func,columnsToInclude:M().array,setColumnsToInclude:M().func,userNotes:M().string,setUserNotes:M().func,reportTitle:M().string,setReportTitle:M().func};const ce=oe;var ie=r(39152),ue=r(91067),me=r(66780),pe=r(37330);const fe=function(){var e=(0,l.useState)(!1),t=a()(e,2),r=t[0],n=t[1],v=(0,l.useState)(!1),b=a()(v,2),g=b[0],y=b[1],E=(0,l.useState)(Q.N.formatMessage(j.Z.customReportDefaultTitle)),h=a()(E,2),O=h[0],_=h[1],x=(0,l.useState)(""),N=a()(x,2),C=N[0],Z=N[1],M=(0,l.useState)(Object.keys(T.jW)),w=a()(M,2),k=w[0],D=w[1],P=(0,l.useState)(T.OX),R=a()(P,2),I=R[0],F=R[1],B=function(){_(Q.N.formatMessage(j.Z.customReportDefaultTitle)),Z(""),D(Object.keys(T.jW)),F(T.OX),y(!1),n(!1)};return s().createElement(s().Fragment,null,s().createElement(ue.Z,{title:Q.N.formatMessage(j.Z.reportsPageTitle),showBreadcrumb:!1}),s().createElement(f.o,null,s().createElement(o.Grid,{hasGutter:!0,lg:3,md:4,sm:12},s().createElement(c.GridItem,null,s().createElement(i.Card,{className:"report-card"},s().createElement(u.l,null,s().createElement(ie.r,{style:S.Z.pieChartIcon}),s().createElement("span",{className:"pf-u-ml-sm",style:S.Z.cardTitle},Q.N.formatMessage(j.Z.executiveReportCardTitle))),s().createElement(m.CardBody,null,Q.N.formatMessage(j.Z.executiveReportCardDescription)),s().createElement(p.e,null,s().createElement(W,null)))),s().createElement(c.GridItem,null,s().createElement(i.Card,{className:"report-card"},s().createElement(u.l,null,s().createElement(d.ZP,{size:"lg",color:"var(--pf-global--link--Color)"}),s().createElement("span",{className:"pf-u-ml-sm",style:S.Z.cardTitle},Q.N.formatMessage(j.Z.customReportCardTitle))),s().createElement(m.CardBody,null,Q.N.formatMessage(j.Z.customReportCardDescription)),s().createElement(p.e,null,s().createElement("a",{className:"create-report",onClick:function(){return n(!0)}},Q.N.formatMessage(j.Z.customReportCardButton))))))),s().createElement(ce,{isOpen:r,columnsToInclude:k,setColumnsToInclude:D,filterData:I,userNotes:C,reportTitle:O,setReportTitle:_,setUserNotes:Z,setFilterData:F,handleModalClose:B,handleDownloadButton:function(){y(!0),n(!1)}}),g&&s().createElement(me.Z,{type:"cves",key:"download",reportData:{header:k,reportTitle:O,userNotes:C},showButton:!1,onSuccess:B,params:(0,pe.pX)(I),filters:(0,pe._R)(I),isReportDynamic:!0,label:j.Z.configModalExportReport}))}}}]);
//# sourceMappingURL=Reports.2e5e77c8e626860b1d80.js.map