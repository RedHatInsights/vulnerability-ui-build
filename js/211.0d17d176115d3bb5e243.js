(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[211],{66780:(e,t,r)=>{"use strict";r.d(t,{Z:()=>B});var s=r(67154),a=r.n(s),n=r(87757),o=r.n(n),i=r(319),l=r.n(i),c=r(59713),u=r.n(c),p=r(48926),m=r.n(p),f=r(63038),v=r.n(f),y=r(6479),d=r.n(y),b=r(25558),h=r.n(b),g=r(45697),Z=r.n(g),_=r(86896),E=r(58141),P=r(92339),O=r(18623),D=r(89736),C=r(68738),j=r(59912),k=r(94949),F=r(81815);function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var x=function(e){var t=e.data,r=e.page,s=e.intl,a=e.header,n=e.type,o=e.isReportDynamic,i=void 0!==o&&o,c=[{name:"publish_date",header:{value:s.formatMessage(O.Z.publishDate)}},{name:"cvss_filter",header:{value:s.formatMessage(O.Z.cvssBaseScore)},hit:"cvss_score"},{name:"impact",header:{value:s.formatMessage(O.Z.impact)},hit:"impact"},{name:"affecting",header:{value:s.formatMessage(O.Z.systemsExposed)},hit:"systems_affected"},{name:"business_risk_id",header:{value:s.formatMessage(O.Z.businessRisk)},hit:"business_risk"},{name:"status_id",header:{value:s.formatMessage(O.Z.status)},hit:"status"}],u=function(e){var t=e.value,r=e.style;return h().createElement(D.xv,{key:t,style:r},t)},p=["cvss_score","impact","systems_affected","business_risk","status"],m=[];a?(m.push({value:s.formatMessage(O.Z.cveId)}),p=[],c.forEach((function(e){a.includes(e.name)&&(m.push(e.header),e.hit&&p.push(e.hit))}))):"cves"===n?m=[{value:s.formatMessage(O.Z.cveId)}].concat(c.map((function(e){return e.header}))):(p=["display_name","cve_count","updated"],m=[{value:"Name"},{value:"Applicable CVEs"},{value:"Last seen"}]);var f=function(e){var t=e.rules&&e.rules.length>0;return i?t&&a.includes("rule_presence"):t},v=l()(t.map((function(e){var t=e.attributes,r=f(t)?[k.Z.cveCellAlign,k.Z.bodyCell,k.Z.cveCell]:[k.Z.bodyCell,k.Z.cveCell];return[h().createElement(D.G7,{key:t.synopsis},f(t)&&h().createElement(E.vB,{style:w(w({},k.Z.bodyCell),k.Z.cveCell)}),h().createElement(D.xv,{style:r},h().createElement(D.rU,{style:k.Z.link,src:"".concat(j.OF,"/").concat(t.synopsis)},t.synopsis))),(!a||a.includes("publish_date"))&&h().createElement(D.xv,{key:t.public_date,style:[k.Z.bodyCell,k.Z.cveCell]},(0,C.h3)(t.public_date))].concat(l()(p.map((function(e){return u({value:t[e],style:[k.Z.bodyCell,k.Z.cveCell]})}))))}))),y=l()(t.map((function(e){var t=e.attributes;return[u({value:t.display_name,style:[k.Z.bodyCell,k.Z.systemNameCell]}),u({value:t.opt_out?s.formatMessage(O.Z.systemsTableExcluded):t.cve_count,style:[k.Z.bodyCell,k.Z.systemCell]}),u({value:(0,F.p6)(t.updated,!0),style:[k.Z.bodyCell,k.Z.systemCell]})]})));return h().createElement(b.Fragment,{key:r},h().createElement(E.iA,{withHeader:!0,rows:[m.map((function(e){return u(w(w({},e),{},{style:[k.Z.headerCell,"cves"===n?k.Z.cveCell:"Name"===e.value?k.Z.systemNameCell:k.Z.systemCell]}))}))].concat(l()("cves"===n?v:y))}),0===t.length&&h().createElement(D.xv,null,s.formatMessage(O.Z.customReportNoCves)))};x.propTypes={data:Z().object,intl:Z().any,page:Z().number,header:Z().array,type:Z().string,isReportDynamic:Z().bool};const N=x;var M=r(37330),S=function(e){for(var t=e.data,r=e.meta,s=e.filters,a=e.intl,n=e.isReportDynamic,o=e.reportData,i=e.user,l=e.type,c=n?s:s.reduce((function(e,t){return e[t.key]={filter:t.category,values:"publish_date"===t.key?j.GZ.find((function(e){return e.value===t.chips[0].value})).timespan_label:t.chips.map((function(e){return e.name})).join(", ")},e}),{}),u=[{name:"impact",msg:O.Z.CVEsPDFreportFiltersSeverity},{name:"business_risk_id",msg:O.Z.CVEsPDFreportFiltersBusinessRisk},{name:"status_id",msg:O.Z.CVEsPDFreportFiltersStatus},{name:"rule_presence",msg:O.Z.CVEsPDFreportFiltersSecurityRule},{name:"security_rule",msg:O.Z.CVEsPDFreportFiltersSecurityRule}],p=u.length-1;p>=0;p--)if(c.hasOwnProperty(u[p].name)){u[p].isLast=!0;break}return h().createElement(b.Fragment,{key:"first-section"},n&&h().createElement(E.nv,null,(0,M.Jo)(O.Z.customReportIntroductionText)),"cves"===l?h().createElement(E.nv,null,(0,M.Jo)(O.Z.customReportSearchTermCvssAndPublishDate,{hasSearchTerm:c.hasOwnProperty("filter")?"yes":"no",searchTerm:c.filter&&c.filter.values,score:c.cvss_filter&&c.cvss_filter.values||j.OX.cvss_filter.from.toFixed(1)+" - "+j.OX.cvss_filter.to.toFixed(1),published:c.publish_date&&c.publish_date.values||(0,M.Jo)(O.Z.customReportTimespanAnytime)}),u.map((function(e){return c.hasOwnProperty(e.name)&&(0,M.Jo)(e.msg,{values:c[e.name].values.toLowerCase(),prefix:e.isLast?a.formatMessage(O.Z.customReportAnd):";"})})),h().createElement(D.xv,null,"."),"\n\n"):h().createElement(E.nv,null,c.filter?(0,M.Jo)(O.Z.systemsPDFreportFiltersSearchTerm,{searchTerm:c.filter.values}):""),"cves"===l&&h().createElement(E.nv,null,(0,M.Jo)(O.Z.CVEsPDFreportSubHeader,{cve_count:r.total_items.toString(),system_count:r.system_count.toString()})),o&&o.userNotes?h().createElement(D.G7,{style:k.Z.userNotes},h().createElement(E.nv,{style:k.Z.userNotesTitle},h().createElement(D.xv,{style:k.Z.bold},a.formatMessage(O.Z.customReportUserNoteLabel))),h().createElement(E.nv,null,h().createElement(D.xv,null,o.userNotes)),h().createElement(E.nv,null,i&&i.identity&&h().createElement(D.xv,{style:k.Z.italic},a.formatMessage(O.Z.customReportUserNotesGenerated,{name:"".concat(i.identity.user.first_name," ").concat(i.identity.user.last_name)})))):null,N({data:t,intl:a,header:o&&o.header,type:l,isReportDynamic:n}))};S.defaultProps={user:void 0},S.propTypes={intl:Z().any,filters:Z().array,data:Z().object,meta:Z().object,reportData:Z().object,isReportDynamic:Z().bool,user:Z().object,type:Z().string};const T=S;var A=r(64739),V=r(44981),J=r(90017);function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var U=function(e){var t=e.filters,r=e.params,s=e.reportData,n=void 0===s?{}:s,i=e.buttonProps,c=e.isReportDynamic,u=void 0!==c&&c,p=e.type,f=e.label,y=d()(e,["filters","params","reportData","buttonProps","isReportDynamic","type","label"]),g=(0,_.Z)(),Z=(0,b.useState)(!1),C=v()(Z,2),F=C[0],R=C[1],w=(0,b.useState)(!1),x=v()(w,2),M=x[0],S=x[1],L=(0,V.useDispatch)();(0,b.useEffect)((function(){return function(){L((0,J.clearNotifications)())}}),[L]);var U=function(e){return e.reduce((function(e,t,r){var s=Math.floor(r/j.tp.otherPages);return!e[s]&&(e[s]=[]),e[s].push(t),e}),[])},B=function(){var e=m()(o().mark((function e(){var s,a,i,c,m,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R(!0),L((0,J.addNotification)({dismissable:!0,variant:"info",title:g.formatMessage(O.Z.customReportNotificationCve)})),e.next=4,(0,P.dH)(G(G(G({},r),A.Z.defaultParams),{},{sort:r.sort||"-cvss_score",affecting:"true,false"}));case 4:if(s=e.sent,a=s.data,i=s.meta,!n||!n.userNotes){e.next=11;break}return e.next=10,insights.chrome.auth.getUser();case 10:c=e.sent;case 11:return a=a.map((function(e){var t;return G(G({},e),{},{attributes:G(G({},e.attributes),{},{status:j.Em.find((function(t){return t.value===e.attributes.status_id.toString()})).label,business_risk:j.eF.find((function(t){return t.value===e.attributes.business_risk_id.toString()})).label,impact:(null===(t=j.cv[e.attributes.impact])||void 0===t?void 0:t.title)||g.formatMessage(O.Z.impactListUnknown),cvss_score:parseFloat(e.attributes.cvss3_score||e.attributes.cvss2_score).toFixed(1)})})})),S((function(){var e,t=a.some((function(e){return e.attributes.rules.length>0}));return u?t&&n&&(null===(e=n.header)||void 0===e?void 0:e.includes("rule_presence")):t})),m=T({data:a.splice(0,n.userNotes?j.tp.firstPageWithNote:j.tp.firstPageWithoutNote),meta:i,filters:t,intl:g,isReportDynamic:u,reportData:n,user:c,type:p}),f=U(a),R(!1),e.abrupt("return",[m].concat(l()(f.map((function(e,t){return N({data:e,page:t,intl:g,header:n&&n.header,type:p,isReportDynamic:u})})))));case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=m()(o().mark((function e(){var s,a,i,c,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R(!0),L((0,J.addNotification)({dismissable:!0,variant:"info",title:g.formatMessage(O.Z.customReportNotificationSystem)})),e.next=4,(0,P.vk)(G(G({},r),A.Z.defaultParams));case 4:return s=e.sent,a=s.data,i=s.meta,c=T({data:a.splice(0,j.tp.firstPageWithoutNote),meta:i,filters:t,intl:g}),u=U(a),R(!1),e.abrupt("return",[c].concat(l()(u.map((function(e,t){return N({data:e,page:t,intl:g,header:n&&n.header})})))));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return h().createElement("div",null,h().createElement(E.o6,a()({},y,{label:F?g.formatMessage(O.Z.loading):g.formatMessage(f),asyncFunction:"cves"===p?B:H,buttonProps:G({component:"button"},i),reportName:u?n.reportTitle:"cves"===p?g.formatMessage(O.Z.cvePDFReportName):g.formatMessage(O.Z.systemPDFReportName),type:"",fileName:"".concat(A.Z.filename("cves"===p?u?"reports":"":"system-list"),".pdf"),allPagesHaveTitle:!1,size:"A4",orientation:"landscape",footer:M&&h().createElement(D.G7,{style:k.Z.footer},h().createElement(D.xv,null,"*"),h().createElement(E.vB,{style:k.Z.footerIcon}),h().createElement(D.xv,{style:k.Z.footerText},g.formatMessage(O.Z.customReportFooter)))})))};U.defaultProps={label:O.Z.kebabExportAsPDF},U.propTypes={filters:Z().oneOfType([Z().array,Z().object]),params:Z().object,reportData:Z().object,buttonProps:Z().object,label:Z().oneOfType([Z().array,Z().object]),isReportDynamic:Z().bool,type:Z().string};const B=U}}]);
//# sourceMappingURL=211.0d17d176115d3bb5e243.js.map