(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[774],{12456:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Ne});var r=n(59713),o=n.n(r),a=n(34575),i=n.n(a),c=n(93913),s=n.n(c),l=n(2205),u=n.n(l),p=n(78585),f=n.n(p),d=n(29754),m=n.n(d),y=n(86350),v=n(83215),b=n(45697),O=n.n(b),g=n(25558),h=n.n(g),E=n(276),S=n(5977),j=n(57721),P=n(6479),_=n.n(P),w=n(63038),D=n.n(w),C=n(18623),Z=n(67154),R=n.n(Z),k=n(319),x=n.n(k),T=n(3351),A=n(22860),I=n(6934),L=n(75863),M=n(75959),F=n(32875),H=n(52906),N=n(81815),B=n(27272),V=n(67006);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Y=function(e){var t,n=e.context,r=e.header,o=e.entity,a=n.cves,i=n.methods,c=n.selectedCves,s=n.expandedRows,l=n.canEditStatus;(null==a||null===(t=a.meta)||void 0===t?void 0:t.patch_access)||(r=r.filter((function(e){return"advisory"!==e.key})));var u=!a.data||0===a.data.length,p=u?[]:a.data.map((function(e){return c.includes(e.id)&&K(K({},e),{},{selected:!0})||e})).map((function(e,t){var n=t%2==0?s.find((function(t){return t.id===e.id}))||!1:{isOpen:void 0};return K(K({},e),{},{isOpen:n&&n.isOpen})}));return h().createElement(g.Fragment,null,a.isLoading?h().createElement(M.Z,{colSize:6,rowSize:20,variant:L.B.compact}):h().createElement(g.Fragment,null,h().createElement(T.i,{isStickyHeader:!0,canSelectAll:!1,"aria-label":"Vulnerability CVE table",cells:r,rows:u?function(){var e=n.cves;return[{heightAuto:!0,cells:[{props:{colSpan:8},title:0!==["filter","cvss_from","cvss_to","public_from","public_to","impact","status_id"].filter((function(t){return Object.prototype.hasOwnProperty.call(e.meta,t)&&e.meta[t]})).length?V.UA:o?V.dX:e.data&&0!==e.data.length?void 0:V.vb}]}]}():p,onSelect:u?void 0:function(e,t,r){var o=n.cves,a=n.methods,i=o.data[r]&&o.data[r].id;a.selectCves(t,i)},actionResolver:!u&&l&&function(e,t){return(0,H.k8)(i,o,t.rowIndex)},sortBy:u?void 0:(0,N.hO)([{key:"collapse"},{key:"checkbox"}].concat(x()(r)),a.meta.sort),onCollapse:u?void 0:function(e,t,r){return function(e,t,r){var o=n.cves,a=n.methods,i=n.isAllExpanded,c=o.data[t]&&o.data[t].id;a.openCves(r,[c],i)}(0,t,r)},onSort:u?void 0:function(e,t,n){return(0,N.L6)(t,n,[{key:"collapse"},{key:"checkbox"}].concat(x()(r)),a.meta.sort,i.apply)},gridBreakPoint:"grid-lg",ouiaId:"cves-table",variant:L.B.compact},h().createElement(g.Fragment,null,h().createElement(I.x,null),h().createElement(A.R,null))),h().createElement(F.Z,null,h().createElement(B.Z,{meta:a.meta,apply:i.apply}))))};Y.propTypes={context:O().any,header:O().array,entity:O().string};const z=function(e){return h().createElement(Se.Consumer,null,(function(t){return h().createElement(Y,R()({context:t},e))}))};var X=n(74806),J=n(29558),W=n(59912),q=n(67754),G=n(49739),$=n(83826),Q=n(68340),ee=n(68774),te=n(64739),ne=n(39888),re=n(1658),oe=n(74268),ae=n(49629),ie=n(84589),ce=n(52663),se=n(96184),le=n(16721),ue=n(58671),pe=n(34970),fe=n(61369),de=n(25032);function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ve=function(e){var t=e.entity,n=e.intl,r=e.context,o=r.cves,a=r.parameters,i=r.methods,c=r.selectedCves,s=r.isAllExpanded,l=r.canEditStatus,u=r.canRemediate,p=a.filter,f=a.advisory,d=u&&(c&&c.length||0),m=(0,g.useMemo)((function(){return(0,oe.Z)({selectedItems:c,selectorHandler:i.selectCves,items:o,fetchResource:function(e){return i.fetchResource(ye(ye({},a),e))},multiRow:!0})}),[c,o,a,i]),y=[""].concat(x()(l?[{label:n.formatMessage(C.Z.editStatus),onClick:function(){return i.showStatusModal(x()(c).map((function(e){return ye({id:e},o.data.filter((function(t){return e===t.id})).map((function(e){return{status_id:e.status_id,cve_status_id:e.cve_status_id,justification:e.status_justification,cve_justification:e.cve_status_justification}}))[0])})),[])},props:{isDisabled:!d}}]:[]),[{label:s?n.formatMessage(C.Z.kebabCollapseCves):n.formatMessage(C.Z.kebabExpandCves),onClick:function(){var e=r.cves,t=r.methods,n=r.isAllExpanded,o=!n,a=n?[]:e.data.filter((function(e){return e.id})).map((function(e){return e.id}));t.openCves(o,a,!n)},props:{isDisabled:0===o.meta.total_items}}]),v=c.flatMap((function(e){return o.data.filter((function(t){return e===t.id}))}));return h().createElement(h().Fragment,null,h().createElement(ae.Z,{pagination:{itemCount:o.meta.total_items||0,page:o.meta.page||1,perPage:o.meta.page_size||1,ouiaId:"pagination-top",onSetPage:function(e,t){return(0,de.A6)(e,t,i.apply)},onPerPageSelect:function(e,t){return(0,de.lO)(e,t,i.apply)}},dedicatedAction:u&&t&&h().createElement(re.Z,{systems:t,cves:v}),actionsConfig:{actions:y,kebabToggleProps:{isDisabled:!d&&0===o.meta.total_items},dropdownProps:{ouiaId:"toolbar-actions"}},bulkSelect:{count:d,items:m.items,isDisabled:0===o.meta.total_items&&0===d,checked:Boolean(d),ouiaId:"bulk-select",onSelect:function(){return m.handleOnCheckboxChange()}},filterConfig:{items:[(0,le.Z)("filter",C.Z.cve,C.Z.searchFilterByCveID,p,i.apply),(0,ue.Z)(i.apply,a),(0,se.Z)(i.apply,a),(0,ce.Z)(i.apply,a),(0,pe.Z)(i.apply,a),(0,fe.Z)(i.apply,a),(0,ie.Z)(i.apply,a),(0,le.Z)("advisory",C.Z.advisory,C.Z.search,f,i.apply)]},activeFiltersConfig:{filters:(0,de.DU)(a),onDelete:function(e,t){return(0,de.vH)(t,i.apply)}},exportConfig:ye({isDisabled:0===o.meta.total_items,ouiaId:"export"},(0,de.HV)(i))}))};ve.defaultProps={totalNumber:0,apply:function(){},downloadReport:function(){}},ve.propTypes={entity:O().string,context:O().object,intl:O().any};const be=(0,X.ZP)((function(e){return h().createElement(Se.Consumer,null,(function(t){return h().createElement(ve,R()({context:t},e))}))}));var Oe=n(73727),ge=n(55409);function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Se=(0,g.createContext)({}),je=function(e){var t,n,r=e.entity,o=e.intl,a=e.allowedCveActions,i=e.showHeaderLabel,c=e.setPageTitle,s=(0,E.useDispatch)(),l=(0,g.useState)((function(){return function(){return null}})),u=D()(l,2),p=u[0],f=u[1],d=(0,g.useState)(!1),m=D()(d,2),y=m[0],b=m[1],O=(0,g.useState)(!0),S=D()(O,2),P=S[0],_=S[1],w=(0,E.useSelector)((function(e){return e.SystemCvesStore.cveList})),Z=(0,E.useSelector)((function(e){return e.SystemCvesStore.parameters})),R=(0,E.useSelector)((function(e){return e.SystemCvesStore.selectedCves})),k=(0,E.useSelector)((function(e){return e.SystemCvesStore.expandedRows})),x=(0,E.useSelector)((function(e){return e.SystemCvesStore.isAllExpanded})),T=["REMEDIATE","EDIT_STATUS"].map((function(e){return a.includes(e)})),A=D()(T,2),I=A[0],L=A[1],M=(0,g.useMemo)((function(){return(0,q.l3)(r.id,w)}),[w]),F=(0,N.H1)(W.kO),H=D()(F,2),B=H[0],U=H[1],K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,N.pX)(e);s((0,j.KV)(t))};return(0,g.useEffect)((function(){c&&(document.title="".concat(r.display_name,"\n                - ").concat(o.formatMessage(C.Z.systemsHeader)," - ").concat(o.formatMessage(C.Z.pageTitleSuffix))),P?(K(Ee({sort:"-public_date"},B)),_(!1)):(s((0,j.E8)(Ee(Ee({},Z),{},{system:r.id}))),y&&U(Ee({},Z))||b(!0))}),[Z]),(0,g.useEffect)((function(){return function(){s((0,j.jS)()),s((0,v.L1)())}}),[]),w.payload.errors?(t=w.payload.errors.status,404===(n=parseInt(t))&&r.id?V.yE:h().createElement(ge.Z,{code:n})):h().createElement(Se.Provider,{value:{cves:M,parameters:Z,selectedCves:R,expandedRows:k,isAllExpanded:x,canRemediate:I,canEditStatus:L,methods:{apply:K,downloadReport:function(e){var t=Ee(Ee({},Z),{},{system:r.id});te.Z.exec(j.E8,t,e,"system-cves")},selectCves:function(e,t){s((0,j.TT)(t))},openCves:function(e,t,n){s((0,j.pJ)({isOpen:e,cves:t,isAllExpanded:n}))},showStatusModal:function(e){var t=Array.from(M.data.filter((function(t){return e.some((function(e){return e.id===t.id}))})));t=t.map((function(e){return{id:e.id,cve_status_id:e.cve_status_id,status_id:e.status_id,justification:e.status_justification,cve_justification:e.cve_status_justification}})),f((function(){return function(){return h().createElement(ne.Z,{cveList:t,updateRef:function(){return(0,N.$)(M.meta,K)},inventoryList:[{id:r.id,display_name:r.display_name}],type:"systemDetail"})}}))},fetchResource:function(e){return(0,j.KX)(Ee(Ee({},e),{},{system:r.id}))}}}},h().createElement(p,null),h().createElement(G.K,{hasGutter:!0},i&&h().createElement($.v,null,h().createElement(ee.D,null,h().createElement(Q.x,{component:Q.q.h2},o.formatMessage(C.Z.cvesHeader)))),h().createElement($.v,null,h().createElement(be,{entity:r.id}))),h().createElement(z,{header:W.Vm,entity:r.id}))};je.defaultProps={allowedCveActions:[],showHeaderLabel:!1,setPageTitle:!1},je.propTypes={entity:O().object,intl:O().any,allowedCveActions:O().array,showHeaderLabel:O().bool};var Pe=(0,S.EN)((0,X.ZP)(je)),_e=function(e){var t=e.customItnlProvider,n=e.customRouter,r=_()(e,["customItnlProvider","customRouter"]),o=n?Oe.BrowserRouter:g.Fragment,a=t?J.Z:g.Fragment;return h().createElement(a,t&&{locale:navigator.language.slice(0,2),messages:C.Z},h().createElement(o,n&&{basename:"".concat(window.location.pathname)},h().createElement(Pe,r)))};_e.propTypes={customItnlProvider:O().bool,customRouter:O().bool},_e.defaultProps={customItnlProvider:!1,customRouter:!1};var we=function(e){u()(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=m()(t);if(n){var o=m()(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return f()(this,e)});function o(e){return i()(this,o),r.call(this,e)}return s()(o,[{key:"render",value:function(){var e=this.props,t=e.entity,n=e.isOptOut,r=e.optOutSystemHandler,o=e.loaded;return t&&o?n?h().createElement(h().Fragment,null,h().createElement(V.o0,{buttonAction:function(){return r(!1)}})):h().createElement(h().Fragment,null,h().createElement(Pe,{entity:{id:t.id,display_name:t.display_name},allowedCveActions:["EDIT_STATUS","REMEDIATE"],showHeaderLabel:!0,setPageTitle:!0})):null}}]),o}(h().Component);we.propTypes={entity:O().object,isOptOut:O().bool,loaded:O().bool,optOutSystemHandler:O().func};const De=(0,S.EN)((0,E.connect)((function(e){var t=e.entityDetails;return{entity:t.entity,isOptOut:t.opt_out,loaded:t.loaded}}),null)(we));var Ce=n(2545);function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ke={loaded:!1},xe=n(51937),Te=n(91067),Ae=n(38775),Ie=n(53895),Le=n(33902);function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var He=function(e){u()(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=m()(t);if(n){var o=m()(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return f()(this,e)});function o(e){var t;return i()(this,o),(t=r.call(this,e)).optOutSystem=function(e){t.props.optOutSystem(t.state.inventoryId,e).then((function(){t.props.fetchSystemDetails(t.state.inventoryId),!0===e?t.props.addNotification({variant:"success",title:t.props.intl.formatMessage(C.Z.inventoryOptOutSuccess)}):t.props.addNotification({variant:"success",title:t.props.intl.formatMessage(C.Z.inventoryResumeAnalysisTitle),description:t.props.intl.formatMessage(C.Z.inventoryResumeAnalysisDescription)})}))},t.state={inventoryId:t.props.match.params.inventoryId},t}return s()(o,[{key:"componentDidMount",value:function(){this.props.fetchSystemDetails(this.state.inventoryId)}},{key:"render",value:function(){var e=this,t=this.props,n=t.systemDetails,r=void 0===n?{}:n,o=t.errors,a=r.opt_out,i=void 0!==a&&a,c=r.entity,s=r.loaded;return h().createElement(h().Fragment,null,h().createElement(Ae.Z,null,h().createElement(Te.Z,{title:"",breadcrumbs:[{title:W.yy.systemsPage.title,to:W.yy.systemsPage.to,loaded:!0},{title:(null==c?void 0:c.display_name)||this.props.intl.formatMessage(C.Z.invalidSystem),isActive:!0,loaded:s}]},!o&&h().createElement(Ie.Z,{onLoad:function(t){var n=t.mergeWithEntities,r=t.mergeWithDetail,o=t.INVENTORY_ACTION_TYPES;xe.Z.register(Fe(Fe({},n()),r(function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case Ce.up+"_FULFILLED":return Re(Re({},n),r.payload.data);case e.LOAD_ENTITY_FULFILLED:return Re(Re({},n),{},{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return h().createElement(De,{optOutSystemHandler:t})}}]});case e.LOAD_ENTITY_REJECTED:return Re(Re({},n),{},{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return h().createElement(De,null)}}]});default:return n}}}(o,e.optOutSystem))))},hideBack:!0,actions:c&&[i?{title:this.props.intl.formatMessage(C.Z.inventoryKebabOptionsResume),onClick:function(){return e.optOutSystem(!1)}}:{title:this.props.intl.formatMessage(C.Z.inventoryKebabOptionsExclude),onClick:function(){return e.optOutSystem(!0)}}]})),h().createElement(y.Z,null,h().createElement(h().Fragment,null,h().createElement(Le.Z,{optOutSystemHandler:this.optOutSystem})))))}}]),o}(h().Component);He.propTypes={fetchSystemDetails:O().func,systemDetails:O().object,optOutSystem:O().func,match:O().object,addNotification:O().func,intl:O().any,errors:O().object};const Ne=(0,S.EN)((0,X.ZP)((0,E.connect)((function(e){return{errors:e.SystemCvesStore.cveList.payload.errors,systemDetails:e.entityDetails}}),(function(e){return{optOutSystem:function(t,n){return e((0,j.DP)(t,n))},fetchSystemDetails:function(t){return e((0,j.o0)(t))},addNotification:function(t){return e((0,v.wN)(t))}}}))(He)))}}]);
//# sourceMappingURL=SystemDetailsPage.679fb65aae5c22116580.js.map