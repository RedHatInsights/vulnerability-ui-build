"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[662],{66516:(t,e,n)=>{n.d(e,{Z:()=>j});var i=n(29439),s=n(93149),a=n(83115),r=n(59775),u=n(49739),c=n(83826),o=n(35540),l=n(79851),d=n(44479),f=n(34512),v=n(91290),m=n(45697),y=n.n(m),_=n(77865),p=n.n(_),g=n(71478),h=n(91709),E=n(74806),Z=n(30893),b=function(t){var e=t.cveList,n=t.updateRef,m=t.inventoryList,y=t.intl,E=t.type,b=(0,h.fj)(J()),j=b.JustificationInput,S=b.justification,M=b.setJustification,P=b.setProps,k=(0,_.useState)(function(){switch(E){case"systemsExposed":if(m.every((function(t){return t.status_id===e[0].status_id&&t.justification===e[0].justification})))return!0;break;case"systemDetail":var t=e.every((function(t,e,n){return t.status_id===n[0].status_id&&t.justification===n[0].justification})),n=e.every((function(t){return t.status_id===t.cve_status_id&&t.justification===t.cve_justification}));if(t&&n)return!0}return!1}()),x=(0,i.Z)(k,2),C=x[0],N=x[1],w=(0,h.Hb)(R()),I=w.StatusSelect,D=w.statusId,T=w.setStatusId,U=w.setProps,L=m.map((function(t){return t.id||t.inventory_id})),O=m.map((function(t){return t.display_name}));function R(){switch(E){case"systemsExposed":return C?e[0].status_id:m.every((function(t,e,n){return t.status_id===n[0].status_id}))?m[0].status_id:"0";case"systemDetail":return C?e.every((function(t,e,n){return t.cve_status_id===n[0].cve_status_id}))?e[0].cve_status_id:"0":e.every((function(t,e,n){return t.status_id===n[0].status_id}))?e[0].status_id:"0"}}function J(){switch(E){case"systemsExposed":return C?e[0].justification:m.every((function(t,e,n){return t.justification===n[0].justification}))&&m[0].justification||"";case"systemDetail":return C?e.every((function(t,e,n){return t.cve_justification===n[0].cve_justification}))&&e[0].cve_justification||"":e.every((function(t,e,n){return t.justification===n[0].justification}))&&e[0].justification||""}}(0,_.useEffect)((function(){U({isDisabled:C,ouiaId:"status-select"}),P({disabled:C}),T(R()),M(J())}),[C,U,P]);var A={variant:"success",title:"systemsExposed"===E?y.formatMessage(Z.Z.notificationSystemStatusUpdateSuccessful,{count:m.length||0,systemName:O[0]}):y.formatMessage(Z.Z.notificationStatusUpdateSuccessful,{count:e.length||0})},F={variant:"danger",autoDismiss:!1,title:y.formatMessage(Z.Z.notificationStatusUpdateFailureTitle),description:y.formatMessage(Z.Z.notificationStatusUpdateFailureBody)},B=y.formatMessage(Z.Z.cvePairStatusModalTitle,{count:L.length*e.length});return p().createElement(h.ZP,{items:e,onSave:function(){var t=e.map((function(t){return t.id})),i=C?{cve:t,inventory_id:L}:{status_id:parseInt(D),cve:t,status_text:S,inventory_id:L};return(0,g.cr)(i).then(n)},onSuccessNotification:A,onFailureNotification:F,title:B,ouiaId:"status-modal"},p().createElement(u.K,{hasGutter:!0},function(){switch(E){case"systemsExposed":return m.some((function(t,e,n){return t.status_id!==n[0].status_id}));case"systemDetail":return e.some((function(t,e,n){return t.status_id!==n[0].status_id}))}}()&&p().createElement(c.v,null,p().createElement(o.b,{variant:"warning",isInline:!0,title:y.formatMessage(Z.Z.cvePairStatusModalAlert)})),p().createElement(c.v,null,y.formatMessage(Z.Z.cvePairStatusModalSelected,{cveCount:e.length||0,cveId:e[0].id,systemCount:m.length||0,systemName:O[0],b:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return p().createElement("b",null,e)}})),p().createElement(c.v,null,p().createElement(a.l,{key:"key"},p().createElement(r.c,{fieldId:"overall"},p().createElement(l.P,null,p().createElement(f.J,null,p().createElement(s.X,{label:y.formatMessage(Z.Z.cvePairStatusModalUseOverallCheckbox),id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:C,onChange:function(t){return N(t)}})),p().createElement(f.J,null,p().createElement(d.u,{content:y.formatMessage(Z.Z.cvePairStatusModalUseOverallTooltip)},p().createElement(v.ZP,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)",style:{verticalAlign:"0"}}))))),I,j))))};b.propTypes={cveList:y().array,updateRef:y().func,inventoryList:y().array,intl:y().any,type:y().oneOf(["systemsExposed","systemDetail"])};const j=(0,E.ZP)(b)},16493:(t,e,n)=>{n.d(e,{Z:()=>g});var i=n(29439),s=n(93433),a=n(77865),r=n.n(a),u=n(45697),c=n.n(u),o=n(83215),l=n(98132),d=n(16712),f=n(36873),v=n(14494),m=n(30893),y=n(44012),_=n(29648),p=function(t){var e=t.cves,n=t.systems,a=t.manyRules,u=t.addNotification,c=function(t,e){return{id:"vulnerabilities:".concat(t),description:t,systems:[e]}};return r().createElement("div",null,r().createElement(l.Z,{dataProvider:function(){return function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[].concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]),a=[].concat(t),r=[];if(e&&1===n.length&&(r=a.reduce((function(t,e){var n,i=e.id,a=e.cve,r=e.rule,u=c(a,i);return r&&(u.id="".concat(u.id,":").concat(null==r||null===(n=r.rule)||void 0===n?void 0:n.rule_id)),[].concat((0,s.Z)(t),[u])}),[]),r=(0,_.X8)(r,"systems")),!e&&1===(null==a?void 0:a.length)){var u=(0,i.Z)(a,1)[0];r=n.reduce((function(t,e){var n=e.id,i=e.rules,a=c(n,u);return null!=i&&i.rule_id&&(a.id="".concat(a.id,":").concat(i.rule_id)),[].concat((0,s.Z)(t),[a])}),[])}return!(!n.length||!a.length)&&{issues:r}}(e,n,a)},isDisabled:0===e.length||0===n.length,onRemediationCreated:function(t){return u(t.getNotification())}},r().createElement(d.ZP,{size:"sm",color:"var(--pf-global--BackgroundColor--100)"}),"Â ",r().createElement(y.Z,m.Z.remediateLabel)))};p.propTypes={cves:c().oneOfType([c().array,c().string]),systems:c().oneOfType([c().array,c().string]),addNotification:c().func,manyRules:c().bool};const g=(0,v.$j)(null,(function(t){return{addNotification:function(e){return t((0,o.wN)(e))}}}))((0,f.Z)(p))}}]);
//# sourceMappingURL=../sourcemaps/662.a9690031c6d9615f7bae552279e50c4b.js.map