(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[774],{13846:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ke});var r=n(96156),o=n(6610),a=n(5991),i=n(10379),c=n(46070),s=n(77608),l=n(86350),u=n(83215),p=n(45697),f=n.n(p),d=n(77865),m=n.n(d),y=n(37703),v=n(5977),b=n(64196),O=n(81253),h=n(28481),g=n(30893),E=n(22122),Z=n(85061),S=n(3351),j=n(22860),P=n(6934),_=n(75863),w=n(75959),D=n(32875),C=n(99385),R=n(29648),k=n(5938),x=n(24788);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=function(e){var t,n=e.context,r=e.header,o=e.entity,a=n.cves,i=n.methods,c=n.selectedCves,s=n.expandedRows,l=n.canEditStatus;null!=a&&null!==(t=a.meta)&&void 0!==t&&t.patch_access||(r=r.filter((function(e){return"advisory"!==e.key})));var u=!a.data||0===a.data.length,p=u?[]:a.data.map((function(e){return c.includes(e.id)&&A(A({},e),{},{selected:!0})||e})).map((function(e,t){var n=t%2==0?s.find((function(t){return t.id===e.id}))||!1:{isOpen:void 0};return A(A({},e),{},{isOpen:n&&n.isOpen})}));return m().createElement(d.Fragment,null,a.isLoading?m().createElement(w.Z,{colSize:6,rowSize:20,variant:_.B.compact}):m().createElement(d.Fragment,null,m().createElement(S.i,{isStickyHeader:!0,canSelectAll:!1,"aria-label":"Vulnerability CVE table",cells:r,rows:u?function(){var e=n.cves;return[{heightAuto:!0,cells:[{props:{colSpan:8},title:0!==["filter","cvss_from","cvss_to","public_from","public_to","impact","status_id"].filter((function(t){return Object.prototype.hasOwnProperty.call(e.meta,t)&&e.meta[t]})).length?x.UA:o?x.dX:e.data&&0!==e.data.length?void 0:x.vb}]}]}():p,onSelect:u?void 0:function(e,t,r){var o=n.cves,a=n.methods,i=o.data[r]&&o.data[r].id;a.selectCves(t,i)},actionResolver:!u&&l&&function(e,t){return(0,C.k8)(i,o,t.rowIndex)},sortBy:u?void 0:(0,R.hO)([{key:"collapse"},{key:"checkbox"}].concat((0,Z.Z)(r)),a.meta.sort),onCollapse:u?void 0:function(e,t,r){return function(e,t,r){var o=n.cves,a=n.methods,i=n.isAllExpanded,c=o.data[t]&&o.data[t].id;a.openCves(r,[c],i)}(0,t,r)},onSort:u?void 0:function(e,t,n){return(0,R.L6)(t,n,[{key:"collapse"},{key:"checkbox"}].concat((0,Z.Z)(r)),a.meta.sort,i.apply)},gridBreakPoint:"grid-lg",ouiaId:"cves-table",variant:_.B.compact},m().createElement(d.Fragment,null,m().createElement(P.x,null),m().createElement(j.R,null))),m().createElement(D.Z,null,m().createElement(k.Z,{meta:a.meta,apply:i.apply}))))};I.propTypes={context:f().any,header:f().array,entity:f().string};const L=function(e){return m().createElement(de.Consumer,null,(function(t){return m().createElement(I,(0,E.Z)({context:t},e))}))};var M=n(74806),F=n(29558),H=n(6208),N=n(52064),B=n(49739),V=n(83826),U=n(68340),K=n(68774),Y=n(62215),z=n(66516),X=n(16493),J=n(93400),W=n(49629),q=n(95859),G=n(9088),$=n(90960),Q=n(95351),ee=n(16369),te=n(35938),ne=n(54534),re=n(1792),oe=n(15248);function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce=function(e){var t=e.entity,n=e.intl,r=e.context,o=r.cves,a=r.parameters,i=r.methods,c=r.selectedCves,s=r.isAllExpanded,l=r.canEditStatus,u=r.canRemediate,p=a.filter,f=a.advisory,y=u&&(c&&c.length||0),v=(0,d.useMemo)((function(){return(0,J.Z)({selectedItems:c,selectorHandler:i.selectCves,items:o,fetchResource:function(e){return i.fetchResource(ie(ie({},a),e))},multiRow:!0})}),[c,o,a,i]),b=[""].concat((0,Z.Z)(l?[{label:n.formatMessage(g.Z.editStatus),onClick:function(){return i.showStatusModal((0,Z.Z)(c).map((function(e){return ie({id:e},o.data.filter((function(t){return e===t.id})).map((function(e){return{status_id:e.status_id,cve_status_id:e.cve_status_id,justification:e.status_justification,cve_justification:e.cve_status_justification}}))[0])})),[])},props:{isDisabled:!y}}]:[]),[{label:s?n.formatMessage(g.Z.kebabCollapseCves):n.formatMessage(g.Z.kebabExpandCves),onClick:function(){var e=r.cves,t=r.methods,n=r.isAllExpanded,o=!n,a=n?[]:e.data.filter((function(e){return e.id})).map((function(e){return e.id}));t.openCves(o,a,!n)},props:{isDisabled:0===o.meta.total_items}}]),O=c.flatMap((function(e){return o.data.filter((function(t){return e===t.id}))}));return m().createElement(m().Fragment,null,m().createElement(W.Z,{pagination:{itemCount:o.meta.total_items||0,page:o.meta.page||1,perPage:o.meta.page_size||1,ouiaId:"pagination-top",onSetPage:function(e,t){return(0,oe.A6)(e,t,i.apply)},onPerPageSelect:function(e,t){return(0,oe.lO)(e,t,i.apply)}},dedicatedAction:u&&t&&m().createElement(X.Z,{systems:t,cves:O}),actionsConfig:{actions:b,kebabToggleProps:{isDisabled:!y&&0===o.meta.total_items},dropdownProps:{ouiaId:"toolbar-actions"}},bulkSelect:{count:y,items:v.items,isDisabled:0===o.meta.total_items&&0===y,checked:Boolean(y),ouiaId:"bulk-select",onSelect:function(){return v.handleOnCheckboxChange()}},filterConfig:{items:[(0,Q.Z)("filter",g.Z.cve,g.Z.searchFilterByCveID,p,i.apply),(0,ee.Z)(i.apply,a),(0,ne.Z)(i.apply,a),(0,$.Z)(i.apply,a),(0,G.Z)(i.apply,a),(0,te.Z)(i.apply,a),(0,q.Z)(i.apply,a),(0,re.Z)(i.apply,a),(0,Q.Z)("advisory",g.Z.advisory,g.Z.search,f,i.apply)]},activeFiltersConfig:{filters:(0,oe.DU)(a),onDelete:function(e,t){return(0,oe.vH)(t,i.apply)}},exportConfig:ie({isDisabled:0===o.meta.total_items,ouiaId:"export"},(0,oe.HV)(i))}))};ce.defaultProps={totalNumber:0,apply:function(){},downloadReport:function(){}},ce.propTypes={entity:f().string,context:f().object,intl:f().any};const se=(0,M.ZP)((function(e){return m().createElement(de.Consumer,null,(function(t){return m().createElement(ce,(0,E.Z)({context:t},e))}))}));var le=n(73727),ue=n(66123);function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var de=(0,d.createContext)({}),me=function(e){var t,n,r=e.entity,o=e.intl,a=e.allowedCveActions,i=e.showHeaderLabel,c=e.setPageTitle,s=(0,y.useDispatch)(),l=(0,d.useState)((function(){return function(){return null}})),p=(0,h.Z)(l,2),f=p[0],v=p[1],O=(0,d.useState)(!1),E=(0,h.Z)(O,2),Z=E[0],S=E[1],j=(0,d.useState)(!0),P=(0,h.Z)(j,2),_=P[0],w=P[1],D=(0,y.useSelector)((function(e){return e.SystemCvesStore.cveList})),C=(0,y.useSelector)((function(e){return e.SystemCvesStore.parameters})),k=(0,y.useSelector)((function(e){return e.SystemCvesStore.selectedCves})),T=(0,y.useSelector)((function(e){return e.SystemCvesStore.expandedRows})),A=(0,y.useSelector)((function(e){return e.SystemCvesStore.isAllExpanded})),I=["REMEDIATE","EDIT_STATUS"].map((function(e){return a.includes(e)})),M=(0,h.Z)(I,2),F=M[0],X=M[1],J=(0,d.useMemo)((function(){return(0,N.l3)(r.id,D)}),[D]),W=(0,R.H1)(H.kO),q=(0,h.Z)(W,2),G=q[0],$=q[1],Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,R.pX)(e);s((0,b.KV)(t))};return(0,d.useEffect)((function(){c&&(document.title="".concat(r.display_name,"\n                - ").concat(o.formatMessage(g.Z.systemsHeader)," - ").concat(o.formatMessage(g.Z.pageTitleSuffix))),_?(Q(fe({sort:"-public_date"},G)),w(!1)):(s((0,b.E8)(fe(fe({},C),{},{system:r.id}))),Z&&$(fe({},C))||S(!0))}),[C]),(0,d.useEffect)((function(){return function(){s((0,b.jS)()),s((0,u.L1)())}}),[]),D.payload.errors?(t=D.payload.errors.status,404===(n=parseInt(t))&&r.id?x.yE:m().createElement(ue.Z,{code:n})):m().createElement(de.Provider,{value:{cves:J,parameters:C,selectedCves:k,expandedRows:T,isAllExpanded:A,canRemediate:F,canEditStatus:X,methods:{apply:Q,downloadReport:function(e){var t=fe(fe({},C),{},{system:r.id});Y.Z.exec(b.E8,t,e,"system-cves")},selectCves:function(e,t){s((0,b.TT)(t))},openCves:function(e,t,n){s((0,b.pJ)({isOpen:e,cves:t,isAllExpanded:n}))},showStatusModal:function(e){var t=Array.from(J.data.filter((function(t){return e.some((function(e){return e.id===t.id}))})));t=t.map((function(e){return{id:e.id,cve_status_id:e.cve_status_id,status_id:e.status_id,justification:e.status_justification,cve_justification:e.cve_status_justification}})),v((function(){return function(){return m().createElement(z.Z,{cveList:t,updateRef:function(){return(0,R.$)(J.meta,Q)},inventoryList:[{id:r.id,display_name:r.display_name}],type:"systemDetail"})}}))},fetchResource:function(e){return(0,b.KX)(fe(fe({},e),{},{system:r.id}))}}}},m().createElement(f,null),m().createElement(B.K,{hasGutter:!0},i&&m().createElement(V.v,null,m().createElement(K.D,null,m().createElement(U.x,{component:U.q.h2},o.formatMessage(g.Z.cvesHeader)))),m().createElement(V.v,null,m().createElement(se,{entity:r.id}))),m().createElement(L,{header:H.Vm,entity:r.id}))};me.defaultProps={allowedCveActions:[],showHeaderLabel:!1,setPageTitle:!1},me.propTypes={entity:f().object,intl:f().any,allowedCveActions:f().array,showHeaderLabel:f().bool};var ye=(0,v.EN)((0,M.ZP)(me)),ve=function(e){var t=e.customItnlProvider,n=e.customRouter,r=(0,O.Z)(e,["customItnlProvider","customRouter"]),o=n?le.BrowserRouter:d.Fragment,a=t?F.Z:d.Fragment;return m().createElement(a,t&&{locale:navigator.language.slice(0,2),messages:g.Z},m().createElement(o,n&&{basename:"".concat(window.location.pathname)},m().createElement(ye,r)))};ve.propTypes={customItnlProvider:f().bool,customRouter:f().bool},ve.defaultProps={customItnlProvider:!1,customRouter:!1};var be=function(e){(0,i.Z)(l,e);var t,n,r=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,s.Z)(t);if(n){var o=(0,s.Z)(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function l(e){return(0,o.Z)(this,l),r.call(this,e)}return(0,a.Z)(l,[{key:"render",value:function(){var e=this.props,t=e.entity,n=e.isOptOut,r=e.optOutSystemHandler,o=e.loaded;return t&&o?n?m().createElement(m().Fragment,null,m().createElement(x.o0,{buttonAction:function(){return r(!1)}})):m().createElement(m().Fragment,null,m().createElement(ye,{entity:{id:t.id,display_name:t.display_name},allowedCveActions:["EDIT_STATUS","REMEDIATE"],showHeaderLabel:!0,setPageTitle:!0})):null}}]),l}(m().Component);be.propTypes={entity:f().object,isOptOut:f().bool,loaded:f().bool,optOutSystemHandler:f().func};const Oe=(0,v.EN)((0,y.connect)((function(e){var t=e.entityDetails;return{entity:t.entity,isOptOut:t.opt_out,loaded:t.loaded}}),null)(be));var he=n(75910);function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ze={loaded:!1},Se=n(83296),je=n(23320),Pe=n(38775),_e=n(53895),we=n(33902);function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Re=function(e){(0,i.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,s.Z)(t);if(n){var o=(0,s.Z)(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function u(e){var t;return(0,o.Z)(this,u),(t=r.call(this,e)).optOutSystem=function(e){t.props.optOutSystem(t.state.inventoryId,e).then((function(){t.props.fetchSystemDetails(t.state.inventoryId),!0===e?t.props.addNotification({variant:"success",title:t.props.intl.formatMessage(g.Z.inventoryOptOutSuccess)}):t.props.addNotification({variant:"success",title:t.props.intl.formatMessage(g.Z.inventoryResumeAnalysisTitle),description:t.props.intl.formatMessage(g.Z.inventoryResumeAnalysisDescription)})}))},t.state={inventoryId:t.props.match.params.inventoryId},t}return(0,a.Z)(u,[{key:"componentDidMount",value:function(){this.props.fetchSystemDetails(this.state.inventoryId)}},{key:"render",value:function(){var e=this,t=this.props,n=t.systemDetails,r=void 0===n?{}:n,o=t.errors,a=r.opt_out,i=void 0!==a&&a,c=r.entity,s=r.loaded;return m().createElement(m().Fragment,null,m().createElement(Pe.Z,null,m().createElement(je.Z,{title:"",breadcrumbs:[{title:H.yy.systemsPage.title,to:H.yy.systemsPage.to,loaded:!0},{title:(null==c?void 0:c.display_name)||this.props.intl.formatMessage(g.Z.invalidSystem),isActive:!0,loaded:s}]},!o&&m().createElement(_e.Z,{onLoad:function(t){var n=t.mergeWithEntities,r=t.mergeWithDetail,o=t.INVENTORY_ACTION_TYPES;Se.Z.register(Ce(Ce({},n()),r(function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ze,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case he.up+"_FULFILLED":return Ee(Ee({},n),r.payload.data);case e.LOAD_ENTITY_FULFILLED:return Ee(Ee({},n),{},{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return m().createElement(Oe,{optOutSystemHandler:t})}}]});case e.LOAD_ENTITY_REJECTED:return Ee(Ee({},n),{},{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return m().createElement(Oe,null)}}]});default:return n}}}(o,e.optOutSystem))))},hideBack:!0,actions:c&&[i?{title:this.props.intl.formatMessage(g.Z.inventoryKebabOptionsResume),onClick:function(){return e.optOutSystem(!1)}}:{title:this.props.intl.formatMessage(g.Z.inventoryKebabOptionsExclude),onClick:function(){return e.optOutSystem(!0)}}]})),m().createElement(l.Z,null,m().createElement(m().Fragment,null,m().createElement(we.Z,{optOutSystemHandler:this.optOutSystem})))))}}]),u}(m().Component);Re.propTypes={fetchSystemDetails:f().func,systemDetails:f().object,optOutSystem:f().func,match:f().object,addNotification:f().func,intl:f().any,errors:f().object};const ke=(0,v.EN)((0,M.ZP)((0,y.connect)((function(e){return{errors:e.SystemCvesStore.cveList.payload.errors,systemDetails:e.entityDetails}}),(function(e){return{optOutSystem:function(t,n){return e((0,b.DP)(t,n))},fetchSystemDetails:function(t){return e((0,b.o0)(t))},addNotification:function(t){return e((0,u.wN)(t))}}}))(Re)))}}]);
//# sourceMappingURL=../sourcemaps/SystemDetailsPage.a4ba5fafd5ee65030c14.js.map