(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[322],{12319:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>fe});var n=r(63038),a=r.n(n),l=r(25558),s=r.n(l),o=r(49287),c=r(18038),i=r(2095),u=r(36104),m=r(85962),p=r(45587),f=r(89583),d=r(38686),v=r(87757),b=r.n(v),g=r(319),E=r.n(g),y=r(48926),h=r.n(y),_=r(86896),x=r(58141),N=r(92339),O=r(18623),Z=r(59713),C=r.n(Z),M=r(45697),T=r.n(M),S=r(73966),j=r(89736),w=r(94949),D=r(81815);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){C()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var P=function(e){var t,r,n=e.data,o=e.intl,c=n.cves_by_severity,i=n.recent_cves,u=n.top_cves,m=n.cves_total,p=n.system_count,f=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[];for(var a in e){var l=e[a],s=t[a],c=void 0!==s.count?s.count:s;"na"===a&&0===c||(r&&s.percentage&&(c="number"===r?s.percentage:o.formatMessage(O.Z.executiveReportOfTotal,{count:c,percentage:s.percentage})),n.push([l,c.toString()]))}return n},d=f(S.YM,R({},i)),v=f(S.cL,R({},c),"number").map((function(e){var t=a()(e,2),r=t[0],n=t[1];return{x:"CVSS ".concat(r),y:Number(n)}})),b=f(S.cL,R({},c),"string"),g=(t={firstPage:[],secondPage:[]},r=0,u.forEach((function(e){var n=Math.ceil(e.description.length/70);r+=n;var a=s().createElement(x.s_,{key:e.synopsis,title:e.synopsis,description:e.description},s().createElement(x.Lv,{title:o.formatMessage(O.Z.executiveReportPanelTitle)},Number.parseFloat(e.cvss3_score).toFixed(1)),s().createElement(x.Lv,{title:o.formatMessage(O.Z.systemsExposed)},e.systems_affected.toString()));r<=15&&t.firstPage.push(a)||t.secondPage.push(a)})),t);return[s().createElement(l.Fragment,{key:"first-section"},s().createElement(x.nv,null,o.formatMessage(O.Z.executiveReportHeader)),s().createElement(x.nv,null,o.formatMessage(O.Z.executiveReportSubHeader,{systems:s().createElement(j.xv,{style:w.Z.bold},o.formatMessage(O.Z.executiveReportHeaderSystems,{systems:p})),cves:s().createElement(j.xv,{style:w.Z.bold},o.formatMessage(O.Z.executiveReportHeaderCVEs,{cves:m}))})),s().createElement(x.$0,{title:o.formatMessage(O.Z.executiveReportCvesBySeverity)},s().createElement(x.sg,null,s().createElement(x.iA,{withHeader:!0,rows:[S.rs].concat(E()(b))})),s().createElement(x.sg,null,s().createElement(x.kL,{chartType:"pie",subTitle:"Cves",title:"100",data:v}))),s().createElement(x.$0,{title:o.formatMessage(O.Z.executiveReportRecentlyPublishedCves)},s().createElement(x.sg,null,s().createElement(x.iA,{withHeader:!0,rows:[S.Wq].concat(E()(d))})),s().createElement(x.sg,null)),s().createElement(x.$0,{title:o.formatMessage(O.Z.executiveReportTop3),withColumn:!1},g.firstPage))].concat(E()((0,D.zd)(g.secondPage.length>0,g.secondPage)))};P.propTypes={data:T().exact({cves_by_severity:T().object,recent_cves:T().object,top_cves:T().array,cves_total:T().number,system_count:T().number}),intl:T().any};const I=P;var F=r(44981),B=r(90017);const W=function(){var e=(0,_.Z)(),t=(0,l.useState)(!1),r=a()(t,2),n=r[0],o=r[1],c=(0,l.useState)(!1),i=a()(c,2),u=i[0],m=i[1],p=(0,F.useDispatch)(),f=function(){var t=h()(b().mark((function t(){var r,n;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o(!0),p((0,B.addNotification)({dismissable:!0,variant:"info",title:e.formatMessage(O.Z.downloadExecutiveNotification)})),t.next=4,(0,N.nK)();case 4:return r=t.sent,n=I({data:r,intl:e}),o(!1),t.abrupt("return",E()(n));case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=(new Date).toISOString().split("T"),v=a()(d,1)[0];return s().createElement(l.Fragment,null,s().createElement("a",{onClick:function(){m(!0)}},e.formatMessage(O.Z.executiveReportCardButton)),u&&s().createElement(x.o6,{showButton:!1,label:n?e.formatMessage(O.Z.loading):e.formatMessage(O.Z.executiveReportCardButton),asyncFunction:f,buttonProps:{variant:"link",isInline:!0},type:e.formatMessage(O.Z.vulnerabilitiesHeader),fileName:"vulnerability_executive-report--".concat(v,".pdf"),allPagesHaveTitle:!1,onSuccess:function(){p((0,B.clearNotifications)()),m(!1)}}))};var L=r(78826),G=r(6202),H=r(4853),z=r(23811),A=r(12282),U=r(32752),X=r(85806),V=r(72278),$=r(82019),K=r(36842),Y=r(21508),q=r(9568),J=r(63540),Q=r(80887),ee=r(77221),te=r(11550),re=r(84564);function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach((function(t){C()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var le=function(e){var t,r,n=e.filterName,o=e.filterData,c=e.setFilterData,i=(0,l.useState)(!1),u=a()(i,2),m=u[0],p=u[1],f=function(e,t){c(ae(ae({},o),{},{cvss_filter:ae(ae({},o.cvss_filter),{},C()({},t,e))}))},d=function(e){var t=+o.cvss_filter[e],r=+o.cvss_filter.min,n=+o.cvss_filter.max;return t<0||t>10||r>n?"error":"default"},v=function(e){var t=o[e],r=S.jW[e],n=r.title,a=r.items;return 0===t.length||t.length===a.length?"".concat(n,": All"):"".concat(n,": ").concat(t.map((function(e){return a.find((function(t){return t.value===e})).label})).join(", "))},b=function(e,t){return s().createElement(Q.Select,{variant:"checkbox","aria-label":"Select Input",onToggle:function(){return p(!m)},isOpen:m,placeholderText:v(t),direction:"bottom",key:t,width:"auto",className:"pf-u-mr-sm pf-u-mb-sm custom-report-filter-select",onSelect:function(e,r){!function(e,t){var r=S.jW[e].items.find((function(e){return e.label===t})).value;if(o[e].includes(r)){var n=o[e].indexOf(r),a=o[e].slice();a.splice(n,1),c(ae(ae({},o),{},C()({},e,a)))}else c(ae(ae({},o),{},C()({},e,[].concat(E()(o[e]),[r]))))}(t,r)},selections:o[t].map((function(e){return S.jW[t].items.find((function(t){return t.value===e})).label})),isCheckboxSelectionBadgeHidden:!0},e.map((function(e){return s().createElement(ee.SelectOption,{key:t+e.label,value:e.label})})))},g=s().createElement(K.Split,{className:"pf-u-m-md"},s().createElement(Y.SplitItem,null,s().createElement("span",{style:{fontSize:14}},te.N.formatMessage(O.Z.customReportCvssMinLabel)),s().createElement("br",null),s().createElement(A.TextInput,{type:"number",onChange:function(e){return f(e,"min")},validated:d("min"),id:"cvss-min",value:o.cvss_filter.min,style:{width:"5em"}})),s().createElement(Y.SplitItem,null,s().createElement("br",null),s().createElement("span",{className:"pf-u-m-sm"},"-")),s().createElement(Y.SplitItem,null,s().createElement("span",{style:{fontSize:14}},te.N.formatMessage(O.Z.customReportCvssMaxLabel)),s().createElement("br",null),s().createElement(A.TextInput,{type:"number",onChange:function(e){return f(e,"max")},validated:d("max"),id:"cvss-max",value:o.cvss_filter.max,style:{width:"5em"}}))),y=s().createElement(Q.Select,{variant:"panel","aria-label":"Select Input",customContent:g,onToggle:function(){return p(!m)},isOpen:m,placeholderText:(t=+o.cvss_filter.min,r=+o.cvss_filter.max,0===t&&10===r?"".concat(S.jW.cvss_filter.title,": ").concat(te.N.formatMessage(O.Z.optionsAll)):s().createElement(J.Text,null,"".concat(S.jW.cvss_filter.title,": ").concat(parseFloat(t).toFixed(1)," - ").concat(parseFloat(r).toFixed(1)),(t<0||r>10||t>r)&&s().createElement(re.default,{color:"var(--pf-global--danger-color--100)",className:"pf-u-ml-xs"}))),className:"pf-u-mr-sm pf-u-mb-sm",direction:"bottom",width:"auto"});return function(e){switch(e){case"status_id":return b(S.Em,"status_id");case"business_risk_id":return b(S.eF,"business_risk_id");case"publish_date":return function(e,t){return s().createElement(Q.Select,{variant:"single","aria-label":"Select Input",onToggle:function(){return p(!m)},isOpen:m,placeholderText:"".concat(S.jW[t].title,":\n                ").concat(S.jW[t].items.find((function(e){return e.value===o[t]})).label),direction:"bottom",key:t,onSelect:function(e,r){!function(e,t){var r=S.jW[e].items.find((function(e){return e.label===t})).value;c(ae(ae({},o),{},C()({},e,r)))}(t,r)},className:"pf-u-mr-sm pf-u-mb-sm",width:"auto"},e.map((function(e){return s().createElement(ee.SelectOption,{width:"100%",key:t+e.label,value:e.label},s().createElement(q.Radio,{"aria-label":"Select Input",label:e.label,value:e.label,isChecked:o[t]===e.value}))})))}(S.GZ,"publish_date");case"impact":return b(S.XY,"impact");case"cvss_filter":return y;case"rule_presence":return b(S.rM,"rule_presence");default:return null}}(n)};le.propTypes={filterName:T().string,filterData:T().object,setFilterData:T().func};const se=le;var oe=function(e){var t=e.isOpen,r=e.handleModalClose,n=e.filterData,o=e.setFilterData,c=e.handleDownloadButton,i=e.columnsToInclude,u=e.setColumnsToInclude,m=e.userNotes,p=e.setUserNotes,f=e.reportTitle,d=e.setReportTitle,v=(0,l.useState)("all"),b=a()(v,2),g=b[0],y=b[1],h=["rule_presence","impact","cvss_filter","business_risk_id","status_id","publish_date"];return(0,l.useEffect)((function(){"all"===g&&u(Object.keys(S.jW))}),[g,u]),s().createElement(L.Modal,{title:te.N.formatMessage(O.Z.configModalTitle),id:"custom-report-modal",ouiaId:"custom-report-modal",isOpen:t,onClose:r,actions:[s().createElement(G.Button,{key:"export",variant:"primary",onClick:c,isDisabled:+n.cvss_filter.min<0||+n.cvss_filter.max>10||+n.cvss_filter.min>+n.cvss_filter.max||m.length>S.Z0},te.N.formatMessage(O.Z.configModalExportReport)),s().createElement(G.Button,{key:"cancel",variant:"secondary",onClick:r},te.N.formatMessage(O.Z.cancel))]},s().createElement(H.Form,null,s().createElement(z.FormGroup,{label:te.N.formatMessage(O.Z.customReportTitleLabel),fieldId:"horizontal-form-name"},s().createElement(A.TextInput,{value:f,onChange:function(e){return d(e)},type:"text",className:"report-text-input",id:"horizontal-form-name"})),s().createElement(z.FormGroup,{label:te.N.formatMessage(O.Z.customReportFilterDataByLabel)},s().createElement("div",{className:"custom-report-filter-wrapper"}," ",h&&h.map((function(e){return s().createElement(se,{key:e,filterName:e,filterData:n,setFilterData:o})})))),s().createElement(z.FormGroup,{label:te.N.formatMessage(O.Z.customReportDataToIncludeLabel)},s().createElement(V.tX,{"aria-label":"Default with single selectable"},s().createElement($.G,{text:te.N.formatMessage(O.Z.customReportDataToggleAll),isSelected:"all"===g,onChange:function(){return y("all")}}),s().createElement($.G,{text:te.N.formatMessage(O.Z.customReportDataToggleCustom),isSelected:"custom"===g,onChange:function(){return y("custom")}})),"custom"===g&&s().createElement("div",{style:w.Z.collumns},s().createElement(U.Checkbox,{id:"cve_id",label:"CVE ID",isChecked:!0,isDisabled:!0,className:"pf-u-mb-md"}),Object.entries(S.jW).map((function(e){var t=a()(e,2),r=t[0],n=t[1];return s().createElement(U.Checkbox,{id:r,key:r,label:n.title,isChecked:i.includes(r),onChange:function(e){return function(e,t){u(t?[].concat(E()(i),[e]):i.filter((function(t){return t!==e})))}(r,e)},className:"pf-u-mb-md"})})))),s().createElement(z.FormGroup,{label:te.N.formatMessage(O.Z.customReportUserNotesLabel),fieldId:"user-notes-box",helperTextInvalid:te.N.formatMessage(O.Z.customReportUserNoteTooLong),validated:m.length>S.Z0&&"error"},s().createElement(X.Kx,{value:m,onChange:function(e){return p(e)},type:"text",id:"user-notes-box",className:"report-text-input",resizeOrientation:"vertical",style:{minHeight:"4em"},validated:m.length>S.Z0&&"error"}))))};oe.propTypes={isOpen:T().bool,filterData:T().object,setFilterData:T().func,handleModalClose:T().func,handleDownloadButton:T().func,columnsToInclude:T().array,setColumnsToInclude:T().func,userNotes:T().string,setUserNotes:T().func,reportTitle:T().string,setReportTitle:T().func};const ce=oe;var ie=r(39152),ue=r(91067),me=r(66780),pe=r(37330);const fe=function(){var e=(0,l.useState)(!1),t=a()(e,2),r=t[0],n=t[1],v=(0,l.useState)(!1),b=a()(v,2),g=b[0],E=b[1],y=(0,l.useState)(te.N.formatMessage(O.Z.customReportDefaultTitle)),h=a()(y,2),_=h[0],x=h[1],N=(0,l.useState)(""),Z=a()(N,2),C=Z[0],M=Z[1],T=(0,l.useState)(Object.keys(S.jW)),j=a()(T,2),D=j[0],k=j[1],R=(0,l.useState)(S.OX),P=a()(R,2),I=P[0],F=P[1],B=function(){x(te.N.formatMessage(O.Z.customReportDefaultTitle)),M(""),k(Object.keys(S.jW)),F(S.OX),E(!1),n(!1)};return s().createElement(s().Fragment,null,s().createElement(ue.Z,{title:te.N.formatMessage(O.Z.reportsPageTitle),showBreadcrumb:!1}),s().createElement(f.o,null,s().createElement(o.Grid,{hasGutter:!0,lg:3,md:4,sm:12},s().createElement(c.GridItem,null,s().createElement(i.Card,{className:"report-card"},s().createElement(u.l,null,s().createElement(ie.r,{style:w.Z.pieChartIcon}),s().createElement("span",{className:"pf-u-ml-sm",style:w.Z.cardTitle},te.N.formatMessage(O.Z.executiveReportCardTitle))),s().createElement(m.CardBody,null,te.N.formatMessage(O.Z.executiveReportCardDescription)),s().createElement(p.e,null,s().createElement(W,null)))),s().createElement(c.GridItem,null,s().createElement(i.Card,{className:"report-card"},s().createElement(u.l,null,s().createElement(d.ZP,{size:"lg",color:"var(--pf-global--link--Color)"}),s().createElement("span",{className:"pf-u-ml-sm",style:w.Z.cardTitle},te.N.formatMessage(O.Z.customReportCardTitle))),s().createElement(m.CardBody,null,te.N.formatMessage(O.Z.customReportCardDescription)),s().createElement(p.e,null,s().createElement("a",{className:"create-report",onClick:function(){return n(!0)}},te.N.formatMessage(O.Z.customReportCardButton))))))),s().createElement(ce,{isOpen:r,columnsToInclude:D,setColumnsToInclude:k,filterData:I,userNotes:C,reportTitle:_,setReportTitle:x,setUserNotes:M,setFilterData:F,handleModalClose:B,handleDownloadButton:function(){E(!0),n(!1)}}),g&&s().createElement(me.Z,{type:"cves",key:"download",reportData:{header:D,reportTitle:_,userNotes:C},showButton:!1,onSuccess:B,params:(0,pe.pX)(I),filters:(0,pe._R)(I),isReportDynamic:!0,label:O.Z.configModalExportReport}))}}}]);
//# sourceMappingURL=Reports.fb9bac208c1576290ad2.js.map