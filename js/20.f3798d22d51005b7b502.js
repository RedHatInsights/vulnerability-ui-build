(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[20],{39888:(e,t,n)=>{"use strict";n.d(t,{Z:()=>S});var i=n(63038),s=n.n(i),r=n(93149),a=n(83115),u=n(59775),c=n(49739),o=n(83826),l=n(35540),f=n(79851),d=n(44479),v=n(34512),m=n(91290),y=n(45697),p=n.n(y),_=n(25558),h=n.n(_),g=n(92339),E=n(10752),b=n(74806),j=n(18623),P=function(e){var t=e.cveList,n=e.updateRef,i=e.inventoryList,y=e.intl,p=e.type,b=(0,E.fj)(A()),P=b.JustificationInput,S=b.justification,R=b.setJustification,Z=b.setProps,k=(0,_.useState)(function(){switch(p){case"systemsExposed":if(i.every((function(e){return e.status_id===t[0].status_id&&e.justification===t[0].justification})))return!0;break;case"systemDetail":var e=t.every((function(e,t,n){return e.status_id===n[0].status_id&&e.justification===n[0].justification})),n=t.every((function(e){return e.status_id===e.cve_status_id&&e.justification===e.cve_justification}));if(e&&n)return!0}return!1}()),I=s()(k,2),M=I[0],x=I[1],C=(0,E.Hb)(O()),w=C.StatusSelect,T=C.statusId,D=C.setStatusId,N=C.setProps,H=i.map((function(e){return e.id||e.inventory_id})),L=i.map((function(e){return e.display_name}));function O(){switch(p){case"systemsExposed":return M?t[0].status_id:i.every((function(e,t,n){return e.status_id===n[0].status_id}))?i[0].status_id:"0";case"systemDetail":return M?t.every((function(e,t,n){return e.cve_status_id===n[0].cve_status_id}))?t[0].cve_status_id:"0":t.every((function(e,t,n){return e.status_id===n[0].status_id}))?t[0].status_id:"0"}}function A(){switch(p){case"systemsExposed":return M?t[0].justification:i.every((function(e,t,n){return e.justification===n[0].justification}))&&i[0].justification||"";case"systemDetail":return M?t.every((function(e,t,n){return e.cve_justification===n[0].cve_justification}))&&t[0].cve_justification||"":t.every((function(e,t,n){return e.justification===n[0].justification}))&&t[0].justification||""}}(0,_.useEffect)((function(){N({isDisabled:M,ouiaId:"status-select"}),Z({disabled:M}),D(O()),R(A())}),[M,N,Z]);var J={variant:"success",title:y.formatMessage(j.Z.cvePairStatusModalUpdateSuccessful)},U=y.formatMessage(j.Z.cvePairStatusModalTitle,{count:H.length*t.length});return h().createElement(E.ZP,{items:t,onSave:function(){var e=t.map((function(e){return e.id})),i=M?{cve:e,inventory_id:H}:{status_id:parseInt(T),cve:e,status_text:S,inventory_id:H};return(0,g.cr)(i).then(n)},onSuccessNotification:J,title:U,ouiaId:"status-modal"},h().createElement(c.K,{hasGutter:!0},function(){switch(p){case"systemsExposed":return i.some((function(e,t,n){return e.status_id!==n[0].status_id}));case"systemDetail":return t.some((function(e,t,n){return e.status_id!==n[0].status_id}))}}()&&h().createElement(o.v,null,h().createElement(l.b,{variant:"warning",isInline:!0,title:y.formatMessage(j.Z.cvePairStatusModalAlert)})),h().createElement(o.v,null,y.formatMessage(j.Z.cvePairStatusModalSelected,{cveCount:t.length||0,cveId:t[0].id,systemCount:i.length||0,systemName:L[0],b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return h().createElement("b",null,t)}})),h().createElement(o.v,null,h().createElement(a.l,{key:"key"},h().createElement(u.c,{fieldId:"overall"},h().createElement(f.P,null,h().createElement(v.J,null,h().createElement(r.X,{label:y.formatMessage(j.Z.cvePairStatusModalUseOverallCheckbox),id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:M,onChange:function(e){return x(e)}})),h().createElement(v.J,null,h().createElement(d.u,{content:y.formatMessage(j.Z.cvePairStatusModalUseOverallTooltip)},h().createElement(m.ZP,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)",style:{verticalAlign:"0"}}))))),w,P))))};P.propTypes={cveList:p().array,updateRef:p().func,inventoryList:p().array,intl:p().any,type:p().oneOf(["systemsExposed","systemDetail"])};const S=(0,b.ZP)(P)},1658:(e,t,n)=>{"use strict";n.d(t,{Z:()=>C});var i=n(319),s=n.n(i),r=n(63038),a=n.n(r),u=n(34575),c=n.n(u),o=n(93913),l=n.n(o),f=n(2205),d=n.n(f),v=n(78585),m=n.n(v),y=n(29754),p=n.n(y),_=n(83215),h=n(19951),g=n(16712),E=n(76076),b=n(72892),j=n.n(b),P=n(45697),S=n.n(P),R=n(25558),Z=n.n(R),k=n(276),I=n(18623),M=n(44012);var x=function(e){d()(r,e);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=p()(t);if(n){var s=p()(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return m()(this,e)});function r(){var e,t;c()(this,r);for(var n=arguments.length,u=new Array(n),o=0;o<n;o++)u[o]=arguments[o];return m()(t,(e=t=i.call.apply(i,[this].concat(u)),t.baseIssueTemplate=function(e){return{id:"vulnerabilities:".concat(e),description:e}},t.cveHasRule=function(e){var t;return(null===(t=e.rules)||void 0===t?void 0:t.length)>0},t.someSystemsHaveRule=function(e){return e.some((function(e){return e.rule}))},t.filterRules=function(e,t){return e.rules.filter((function(e){var n=e.value;return t.some((function(e){var t,i=e.rule;return i?(null==i||null===(t=i.rule)||void 0===t?void 0:t.rule_id)===n:n}))}))},t.remediationProvider=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n=[].concat(n),i=[].concat(i);var u=[];if(r&&1===n.length){var c=n,o=a()(c,1),l=o[0];if(t.cveHasRule(l)&&t.someSystemsHaveRule(i)){var f=t.filterRules(l,i);u=f.reduce((function(e,n){var i=t.baseIssueTemplate(l.id);return i.id="".concat(i.id,":").concat(n.value),[].concat(s()(e),[i])}),[])}else u=[t.baseIssueTemplate(l.id)]}return r||1!==(null===(e=i)||void 0===e?void 0:e.length)||(u=n.reduce((function(e,n){var i,r=t.baseIssueTemplate(n.id);return(null===(i=n.rules)||void 0===i?void 0:i.rule_id)&&(r.id="".concat(r.id,":").concat(n.rules.rule_id)),[].concat(s()(e),[r])}),[])),!(!n.length||!i.length)&&{issues:u,systems:i.map((function(e){return e.id||e}))}},e))}return l()(r,[{key:"shouldComponentUpdate",value:function(e){return e.cves!==this.props.cves||e.systems!==this.props.systems}},{key:"render",value:function(){var e=this,t=this.props,n=t.cves,i=t.systems,s=t.manyRules,r=t.addNotification;return Z().createElement("div",null,Z().createElement(h.Z,{dataProvider:function(){return e.remediationProvider(n,i,s)},isDisabled:!1===this.remediationProvider(n,i),onRemediationCreated:function(e){return r(e.getNotification())}},Z().createElement(g.ZP,{size:"sm",color:j().value}),"Â ",Z().createElement(M.Z,I.Z.remediateLabel)))}}]),r}(R.Component);x.propTypes={cves:S().oneOfType([S().array,S().string]),systems:S().oneOfType([S().array,S().string]),addNotification:S().func,manyRules:S().bool};const C=(0,k.connect)(null,(function(e){return{addNotification:function(t){return e((0,_.wN)(t))}}}))((0,E.Z)(x))}}]);
//# sourceMappingURL=20.f3798d22d51005b7b502.js.map