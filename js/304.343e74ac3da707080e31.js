(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[304],{84402:(e,t,r)=>{"use strict";r.d(t,{Z:()=>f});var n=r(25558),o=r.n(n),a=r(45697),s=r.n(a),i=r(89736),c=r(23025),u=r(60578),l=r(43109),p=function(e){var t=e.hasRule,r=e.hasExploit;return o().createElement(i.G7,null,r&&o().createElement(i.xv,{style:c.Z.footer},(0,l.aR)(u.Z.knownExploitPDFFooter)),t&&o().createElement(i.xv,{style:c.Z.footer},(0,l.aR)(u.Z.securityRulePDFFooter)))};p.propTypes={hasRule:s().bool,hasExploit:s().bool};const f=p},17304:(e,t,r)=>{"use strict";r.d(t,{Z:()=>C});var n=r(67154),o=r.n(n),a=r(87757),s=r.n(a),i=r(319),c=r.n(i),u=r(59713),l=r.n(u),p=r(48926),f=r.n(p),b=r(63038),m=r.n(b),v=r(6479),d=r.n(v),y=r(25558),h=r.n(y),_=r(45697),g=r.n(_),O=r(59458),P=r(58141),D=r(40287),Z=r(76558),j=r(43109),k=r(60578),w=r(37936),x=r(10743),E=r(84402),R=r(58990),F=r(9470),S=r(86738);function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){l()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var N=function(e){var t=e.filters,r=e.params,n=e.reportData,a=void 0===n?{}:n,i=e.buttonProps,u=e.isReportDynamic,l=void 0!==u&&u,p=e.label,b=d()(e,["filters","params","reportData","buttonProps","isReportDynamic","label"]),v=(0,O.Z)(),_=(0,y.useState)(!1),g=m()(_,2),T=g[0],N=g[1],C=(0,y.useState)(!1),A=m()(C,2),H=A[0],U=A[1],z=(0,y.useState)(!1),G=m()(z,2),L=G[0],q=G[1],B=(0,S.l)(),I=function(e){return(0,Z.F3)(e,(0,j.s9)(a,r),!0)},J=function(){var e=f()(s().mark((function e(){var n,o,i,u,p,f;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(!0),B({msg:v.formatMessage(k.Z.customReportNotificationCve)}),e.next=4,(0,D.dH)(M(M(M({},r),R.Z.defaultParams),{},{sort:r.sort||"-cvss_score",affecting:"true,false"}));case 4:if(n=e.sent,o=n.data,i=n.meta,!a||!a.userNotes){e.next=11;break}return e.next=10,insights.chrome.auth.getUser();case 10:u=e.sent;case 11:return o=o.map((function(e){var t;return M(M({},e),{},{attributes:M(M({},e.attributes),{},{status:F.Em.find((function(t){return t.value===e.attributes.status_id.toString()})).label,business_risk:F.eF.find((function(t){return t.value===e.attributes.business_risk_id.toString()})).label,impact:(null===(t=F.cv[e.attributes.impact])||void 0===t?void 0:t.title)||v.formatMessage(k.Z.impactListUnknown),cvss_score:parseFloat(e.attributes.cvss3_score||e.attributes.cvss2_score).toFixed(1)})})})),U((function(){var e,t=o.some((function(e){return e.attributes.rules.length>0}));return l?t&&a&&(null===(e=a.header)||void 0===e?void 0:e.includes("rule_presence")):t})),q((function(){var e,t=o.some((function(e){return e.attributes.known_exploit}));return l?t&&a&&(null===(e=a.header)||void 0===e?void 0:e.includes("known_exploit")):t})),p=(0,w.Z)({data:o.splice(0,(0,j.rg)(a,r)),meta:i,filters:t,intl:v,isReportDynamic:l,reportData:a,user:u,type:"cves"}),f=I(o),N(!1),e.abrupt("return",[p].concat(c()(f.map((function(e,t){return(0,x.Z)({data:e,page:t,intl:v,header:a&&a.header,type:"cves",isReportDynamic:l})})))));case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return h().createElement("div",null,h().createElement(P.o6,o()({orientation:"landscape",size:"A4",type:"",fileName:"".concat(R.Z.filename(l?"reports":""),".pdf"),buttonProps:M({component:"button"},i),asyncFunction:J,allPagesHaveTitle:!1,footer:h().createElement(E.Z,{intl:v,hasRule:H,hasExploit:L}),reportName:l?a.reportTitle:v.formatMessage(k.Z.cvePDFReportName),label:T?v.formatMessage(k.Z.loading):v.formatMessage(p)},b)))};N.defaultProps={label:k.Z.kebabExportAsPDF},N.propTypes={filters:g().oneOfType([g().array,g().object]),params:g().object,reportData:g().object,buttonProps:g().object,label:g().oneOfType([g().array,g().object]),isReportDynamic:g().bool};const C=N}}]);