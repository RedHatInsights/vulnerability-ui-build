"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[740],{41740:(e,t,n)=>{n.d(t,{d3:()=>ue,QE:()=>pe,ZP:()=>me});var r=n(45987),o=n(4942),a=n(29439),s=n(77865),i=n.n(s),c=n(83594),l=n(45697),u=n.n(l),d=n(30893),p=n(5977),f=n(87462),m=n(93433),v=n(3351),y=n(22860),b=n(6934),g=n(75863),O=n(75959),h=n(43003),E=n(29648),Z=n(5938),S=n(24788);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=function(e){var t,n=e.context,r=e.header,o=e.entity,a=n.cves,c=n.methods,l=n.selectedCves,u=n.expandedRows,p=n.canEditStatus;null!=a&&null!==(t=a.meta)&&void 0!==t&&t.patch_access||(r=r.filter((function(e){return"advisory"!==e.key})));var f=!a.data||0===a.data.length,w=f?[]:a.data.map((function(e){return l.includes(e.id)&&C(C({},e),{},{selected:!0})||e})).map((function(e,t){var n=t%2==0?u.find((function(t){return t.id===e.id}))||!1:{isOpen:void 0};return C(C({},e),{},{isOpen:n&&n.isOpen})}));return a.isLoading?i().createElement(O.Z,{colSize:6,rowSize:20,variant:g.B.compact}):i().createElement(s.Fragment,null,i().createElement(v.i,{isStickyHeader:!0,canSelectAll:!1,"aria-label":"Vulnerability CVE table",cells:r,rows:f?[{heightAuto:!0,cells:[{props:{colSpan:8},title:i().createElement(S.lP,{secondParagraph:d.Z.emptyStateThisSystemShouldHaveCVEs})}]}]:w,onSelect:f?void 0:function(e,t,r){var o=n.cves,a=n.methods,s=o.data[r]&&o.data[r].id;a.selectCves(t,s)},actionResolver:!f&&p&&function(e,t){return(0,h.k8)(c,o,t.rowIndex)},sortBy:f?void 0:(0,E.hO)([{key:"collapse"},{key:"checkbox"}].concat((0,m.Z)(r)),a.meta.sort),onCollapse:f?void 0:function(e,t,r){return function(e,t,r){var o=n.cves,a=n.methods,s=n.isAllExpanded,i=o.data[t]&&o.data[t].id;a.openCves(r,[i],s)}(0,t,r)},onSort:f?void 0:function(e,t,n){return(0,E.L6)(t,n,[{key:"collapse"},{key:"checkbox"}].concat((0,m.Z)(r)),a.meta.sort,c.apply)},gridBreakPoint:"grid-lg",ouiaId:"cves-table",variant:g.B.compact},i().createElement(s.Fragment,null,i().createElement(b.x,null),i().createElement(y.R,null))),i().createElement(Z.Z,{meta:a.meta,apply:c.apply}))};P.propTypes={context:u().any,header:u().array,entity:u().string};const j=function(e){return i().createElement(ue.Consumer,null,(function(t){return i().createElement(P,(0,f.Z)({context:t},e))}))};var x=n(74806),_=n(29558),D=n(28216),k=n(78733),T=n(52064),R=n(49739),M=n(83826),A=n(68340),I=n(68774),H=n(62215),B=n(66516),L=n(16493),F=n(93400),V=n(49629),z=n(95859),K=n(9088),N=n(90960),U=n(95351),X=n(16369),q=n(35938),G=n(54534),J=n(1792),Q=n(63368),$=n(15248);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ee=function(e){var t=e.entity,n=e.intl,r=e.context,o=r.cves,a=r.parameters,c=r.methods,l=r.selectedCves,u=r.selectedRowsRawData,p=r.isAllExpanded,f=r.canEditStatus,v=r.canRemediate,y=a.filter,b=a.advisory,g=v&&(l&&l.length||0),O=u.filter((function(e){return e.attributes.remediation===k.sF})),h=(0,s.useMemo)((function(){return(0,F.Z)({selectedItems:l,selectorHandler:c.selectCves,items:o,fetchResource:function(e){return c.fetchResource(Y(Y({},a),e))},multiRow:!0})}),[l,o,a,c]),E=[""].concat((0,m.Z)(f?[{label:n.formatMessage(d.Z.editStatus),onClick:function(){return c.showStatusModal(u,!0)},props:{isDisabled:!g}}]:[]),[{label:n.formatMessage(d.Z.columnManagementModalTitle),onClick:function(){return c.setColumnModalOpen(!0)}}]);return i().createElement(V.Z,{pagination:{isDisabled:0===o.meta.total_items,itemCount:o.meta.total_items||0,page:o.meta.page||1,perPage:o.meta.page_size||1,ouiaId:"pagination-top",onSetPage:function(e,t){return(0,$.A6)(e,t,c.apply)},onPerPageSelect:function(e,t){return(0,$.lO)(e,t,c.apply)}},dedicatedAction:v&&t&&i().createElement(L.Z,{isDisabled:0===O.length,systems:t,cves:O}),actionsConfig:{actions:E,dropdownProps:{ouiaId:"toolbar-actions"}},bulkSelect:{count:g,items:h.items,isDisabled:0===o.meta.total_items&&0===g,checked:Boolean(g),ouiaId:"bulk-select",onSelect:function(){return h.handleOnCheckboxChange()}},filterConfig:{items:[(0,U.Z)("filter",d.Z.cve,d.Z.searchFilterByCveID,y,c.apply),(0,X.Z)(c.apply,a),(0,G.Z)(c.apply,a),(0,N.Z)(c.apply,a),(0,K.Z)(c.apply,a),(0,q.Z)(c.apply,a),(0,z.Z)(c.apply,a),(0,J.Z)(c.apply,a),(0,U.Z)("advisory",d.Z.advisory,d.Z.searchFilterByAdvisory,b,c.apply),(0,Q.Z)(c.apply,a)]},activeFiltersConfig:{filters:(0,$.DU)(a),onDelete:function(e,t){return(0,$.vH)(t,c.apply)},deleteTitle:n.formatMessage(d.Z.resetFilters)},exportConfig:Y({isDisabled:0===o.meta.total_items,ouiaId:"export"},(0,$.HV)(c)),expandAll:{isAllExpanded:p,onClick:function(){var e=r.cves,t=r.methods,n=r.isAllExpanded,o=!n,a=n?[]:e.data.filter((function(e){return e.id})).map((function(e){return e.id}));t.openCves(o,a,!n)}}})};ee.defaultProps={totalNumber:0,apply:function(){},downloadReport:function(){}},ee.propTypes={entity:u().string,context:u().object,intl:u().any};const te=(0,x.ZP)((function(e){return i().createElement(ue.Consumer,null,(function(t){return i().createElement(ee,(0,f.Z)({context:t},e))}))}));var ne=n(66123),re=n(83215),oe=n(87135),ae=n(66761),se=["id","attributes"],ie=["customItnlProvider"];function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ue=(0,s.createContext)({}),de=function(e){var t,n,o=e.entity,l=e.intl,u=e.allowedCveActions,p=e.showHeaderLabel,f=e.setPageTitle,m=(0,D.I0)(),v=(0,s.useState)((function(){return function(){return null}})),y=(0,a.Z)(v,2),b=y[0],g=y[1],O=(0,s.useState)(!1),h=(0,a.Z)(O,2),Z=h[0],S=h[1],w=(0,s.useState)(!0),C=(0,a.Z)(w,2),P=C[0],x=C[1],_=(0,s.useState)(!1),L=(0,a.Z)(_,2),F=L[0],V=L[1],z=(0,D.v9)((function(e){return e.SystemCvesStore.cveList})),K=(0,D.v9)((function(e){return e.SystemCvesStore.parameters})),N=(0,D.v9)((function(e){return e.SystemCvesStore.columns})),U=(0,D.v9)((function(e){return e.SystemCvesStore.selectedCves})),X=(0,D.v9)((function(e){return e.SystemCvesStore.selectedRowsRawData||[]})),q=(0,D.v9)((function(e){return e.SystemCvesStore.expandedRows})),G=(0,D.v9)((function(e){return e.SystemCvesStore.isAllExpanded})),J=["REMEDIATE","EDIT_STATUS"].map((function(e){return u.includes(e)})),Q=(0,a.Z)(J,2),$=Q[0],W=Q[1],Y=(0,s.useMemo)((function(){return(0,T.l3)(o.id,z,N)}),[z,o.id,N]),ee=(0,E.H1)(k.kO),ie=(0,a.Z)(ee,2),ce=ie[0],de=ie[1],pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,E.pX)(e);m((0,c.KV)(t))};return(0,s.useEffect)((function(){f&&(document.title="".concat(o.display_name,"\n                - ").concat(l.formatMessage(d.Z.systemsHeader)," - ").concat(l.formatMessage(d.Z.pageTitleSuffix))),P?(pe(le({sort:"-public_date"},ce)),x(!1)):(m((0,c.E8)(le(le({},K),{},{system:o.id}))),Z&&de(le({},K))||S(!0))}),[K]),(0,s.useEffect)((function(){return function(){m((0,c.jS)())}}),[m]),z.payload.errors?(t=z.payload.errors.status,404===(n=parseInt(t))&&o.id?i().createElement(oe.Z,{titleText:l.formatMessage(d.Z.notConnectedTitleText),bodyText:l.formatMessage(d.Z.notConnectedBodyText),buttonText:l.formatMessage(d.Z.notConnectedButtonText)}):i().createElement(ne.Z,{code:n})):i().createElement(ue.Provider,{value:{cves:Y,parameters:K,selectedCves:U,selectedRowsRawData:X,expandedRows:q,isAllExpanded:G,canRemediate:$,canEditStatus:W,methods:{apply:pe,downloadReport:function(e){var t=le(le({},K),{},{system:o.id});H.Z.exec(c.E8,t,e,"system-cves",(function(e){return m((0,re.wN)(e))}),(function(){return m((0,re.L1)())}))},selectCves:function(e,t){m((0,c.TT)(t))},openCves:function(e,t,n){m((0,c.pJ)({isOpen:e,cves:t,isAllExpanded:n}))},showStatusModal:function(e,t){var n=e.map((function(e){var t=e.id,n=e.attributes;return le({id:t,cve_status_id:n.cve_status_id,status_id:n.status_id,justification:n.status_text,cve_justification:n.cve_status_text},(0,r.Z)(e,se))}));g((function(){return function(){return i().createElement(B.Z,{cveList:n,updateRef:function(){m((0,c.jS)()),(0,E.$)(t?le(le({},Y.meta),{},{page:1}):Y.meta,K,pe)},inventoryList:[{id:o.id,display_name:o.display_name}],type:"systemDetail"})}}))},setColumnModalOpen:V,fetchResource:function(e){return(0,c.KX)(le(le({},e),{},{system:o.id}))}}}},i().createElement(b,null),i().createElement(ae.Z,{appliedColumns:N,applyColumns:function(e){return m((0,c.ke)(e))},isModalOpen:F,setModalOpen:V}),i().createElement(R.K,{hasGutter:!0},p&&i().createElement(M.v,null,i().createElement(I.D,null,i().createElement(A.x,{component:A.q.h2},l.formatMessage(d.Z.cvesHeader)))),i().createElement(M.v,null,i().createElement(te,{entity:o.id}))),i().createElement(j,{header:N.filter((function(e){var t;return null!==(t=e.isShown)&&void 0!==t?t:e.isShownByDefault})),entity:o.id}))};de.defaultProps={allowedCveActions:[],showHeaderLabel:!1,setPageTitle:!1},de.propTypes={entity:u().object,intl:u().any,allowedCveActions:u().array,showHeaderLabel:u().bool,setPageTitle:u().bool};var pe=(0,p.EN)((0,x.ZP)(de)),fe=function(e){var t=e.customItnlProvider,n=(0,r.Z)(e,ie),o=t?_.Z:s.Fragment;return i().createElement(o,t&&{locale:navigator.language.slice(0,2),messages:d.Z},i().createElement(pe,n))};fe.propTypes={customItnlProvider:u().bool,customRouter:u().bool},fe.defaultProps={customItnlProvider:!1,customRouter:!1};const me=174==n.j?fe:null}}]);
//# sourceMappingURL=../sourcemaps/740.398c7f15e64a1d0c4885a410b10c9738.js.map