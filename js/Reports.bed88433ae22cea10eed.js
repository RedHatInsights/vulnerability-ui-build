(self.webpackChunkvulnerability=self.webpackChunkvulnerability||[]).push([[9322],{77789:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ce});var a=r(4942),n=r(15861),o=r(70885),s=r(64687),l=r.n(s),c=r(77865),i=r.n(c),u=r(28216),m=r(50693),p=r(16475),f=r(32203),g=r(70),d=r(62394),b=r(49734),v=r(55140),y=r(14748),E=r(82442),O=r(42982),Z=r(45697),h=r.n(Z),j=r(80236),N=r(47173),D=r(83115),T=r(59775),P=r(92607),w=r(93149),C=r(23393),S=r(13115),M=r(57980),R=r(6208),k=r(30893),I=r(32132),x=r(80167),_=r(27482),F=r(87462),G=r(54680),W=r(92694),L=function(e){var t=e.sorterData,r=e.setSorterData,a=e.selectProps,n=e.options,s=(0,c.useState)(!1),l=(0,o.Z)(s,2),u=l[0],m=l[1];return i().createElement(G.P,(0,F.Z)({variant:"single",direction:"up","aria-label":"Select Input",onToggle:function(){return m(!u)},isOpen:u,placeholderText:n.find((function(e){return e.value===t})).label,key:"custom-sorter",onSelect:function(e,t){!function(e){var t=n.find((function(t){return t.label===e})).value;r(t),m(!1)}(t)},width:"auto"},a),n.map((function(e){return i().createElement(W.$,{width:"100%",key:e.label,value:e.label})})))};L.propTypes={sorterData:h().string,setSorterData:h().func,selectProps:h().object,options:h().array};const z=L;var B=r(95705),U=r(40306),A=r(29648);function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Q=function(e){var t=e.isOpen,r=e.handleModalClose,a=e.filterData,n=e.sorterData,s=e.setFilterData,l=e.setSorterData,m=e.handleDownloadButton,p=e.columnsToInclude,f=e.setColumnsToInclude,g=e.userNotes,d=e.setUserNotes,b=e.reportTitle,v=e.setReportTitle,y=e.inheritGlobalTags,E=e.setInheritGlobalTags,Z=e.globalFilterTags,h=(0,u.I0)(),F=(0,c.useState)(!0),G=(0,o.Z)(F,2),W=G[0],L=G[1],H=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(e,t){var r=t.major,a=t.minor,n="RHEL ".concat(r);return e[n]=[].concat((0,O.Z)(e[n]||[]),[{label:"RHEL ".concat(r,".").concat(a),value:"".concat(r,".").concat(a)}]),e}),{});return(e=Object.entries(e)).sort((function(e,t){return(0,A.n4)(e[0],t[0],!1)})),e=e.map((function(e){var t=(0,o.Z)(e,2),r=t[0],a=t[1];return[r,Array.from(a).sort((function(e,t){return(0,A.n4)(e.value,t.value,!1)}))]})),Object.fromEntries(e)}((0,u.v9)((function(e){var t,r=e.ReportsPageStore;return null==r||null===(t=r.operatingSystems)||void 0===t?void 0:t.data}))||[]),Q=["rule_presence","known_exploit","impact","cvss_filter","business_risk_id","status_id","publish_date","rhel_version"];return(0,c.useEffect)((function(){W&&f(Object.keys(R.jW))}),[W,f]),(0,c.useEffect)((function(){h((0,U.g6)())}),[h]),i().createElement(j.u,{width:"50rem",title:I.N.formatMessage(k.Z.configModalTitle),ouiaId:"custom-report-modal",isOpen:t,onClose:function(){r(),E(!0)},actions:[i().createElement(N.zx,{key:"export",variant:"primary",onClick:m,isDisabled:!(0,_.o)(a.cvss_filter.from,a.cvss_filter.to)||g.length>R.Z0},I.N.formatMessage(k.Z.configModalExportReport)),i().createElement(N.zx,{key:"cancel",variant:"secondary",onClick:function(){r(),E(!0)}},I.N.formatMessage(k.Z.cancel))]},i().createElement(D.l,null,i().createElement(T.c,{label:I.N.formatMessage(k.Z.customReportTitleLabel),fieldId:"horizontal-form-name"},i().createElement(P.oi,{value:b,onChange:function(e){return v(e)},type:"text",className:"report-text-input",id:"horizontal-form-name"})),i().createElement(T.c,{label:I.N.formatMessage(k.Z.customReportFilterDataByLabel)},i().createElement("div",{className:"custom-report-select-wrapper"},Q&&Q.map((function(e){var t;return null===(t=R.jW[e])||void 0===t?void 0:t.component(X(X({},R.jW[e]),{},{filterData:a,setFilterData:s,selectProps:X({className:"pf-u-mr-sm pf-u-mb-sm"},R.jW[e].selectProps),options:R.jW[e].items,filterId:e,filterName:R.jW[e].title},"rhel_version"===e?{options:Object.values(H).flat(),groups:H}:{}))})))),i().createElement(T.c,{label:I.N.formatMessage(k.Z.tagFilterTitle)},i().createElement(B.Z,{onEdit:function(){return E(!1)},selectedTags:a.tags,setSelectedTags:function(e){return s(X(X({},a),{},{tags:e}))},globalTags:Z,inheritGlobalTags:y}),(null==Z?void 0:Z.length)>0&&y&&i().createElement("div",{className:"pf-u-font-size-sm pf-u-mt-sm"},I.N.formatMessage(k.Z.tagFilterGlobal),i().createElement("a",{className:"pf-u-ml-md",onClick:function(){E(!1),a.tags=[]}},I.N.formatMessage(k.Z.tagFilterClear)))),i().createElement(T.c,{label:I.N.formatMessage(k.Z.customReportDataToIncludeLabel)},i().createElement(S.t,{"aria-label":"Default with single selectable"},i().createElement(M.G,{text:I.N.formatMessage(k.Z.customReportDataToggleAll),isSelected:W,onChange:function(){return L(!0)}}),i().createElement(M.G,{text:I.N.formatMessage(k.Z.customReportDataToggleCustom),isSelected:!W,onChange:function(){return L(!1)}})),W||i().createElement("div",{style:x.Z.columns},i().createElement(w.X,{id:"cve_id",label:"CVE ID",isChecked:!0,isDisabled:!0,className:"pf-u-mb-md"}),Object.entries(R.jW).filter((function(e){return!1!==(0,o.Z)(e,2)[1].hasColumn})).map((function(e){var t=(0,o.Z)(e,2),r=t[0],a=t[1];return i().createElement(w.X,{id:r,key:r,label:a.title,isChecked:p.includes(r),onChange:function(e){return function(e,t){f(t?[].concat((0,O.Z)(p),[e]):p.filter((function(t){return t!==e})))}(r,e)},className:"pf-u-mb-md"})})))),i().createElement(T.c,{label:I.N.formatMessage(k.Z.customReportSortDataByLabel)},i().createElement("div",{className:"custom-report-select-wrapper"},i().createElement(z,{sorterData:n,setSorterData:l,selectProps:{className:"pf-u-mr-sm pf-u-mb-sm"},options:R.AH}))),i().createElement(T.c,{label:I.N.formatMessage(k.Z.customReportUserNotesLabel),fieldId:"user-notes-box",helperTextInvalid:I.N.formatMessage(k.Z.customReportUserNoteTooLong),validated:g.length>R.Z0&&"error"},i().createElement(C.Kx,{value:g,onChange:function(e){return d(e)},type:"text",id:"user-notes-box",className:"report-text-input",resizeOrientation:"vertical",style:{minHeight:"4em"},validated:g.length>R.Z0&&"error"}))))};Q.propTypes={isOpen:h().bool,filterData:h().object,sorterData:h().string,setFilterData:h().func,setSorterData:h().func,handleModalClose:h().func,handleDownloadButton:h().func,columnsToInclude:h().array,setColumnsToInclude:h().func,userNotes:h().string,setUserNotes:h().func,reportTitle:h().string,setReportTitle:h().func,inheritGlobalTags:h().bool,setInheritGlobalTags:h().func,globalFilterTags:h().array};const J=Q,V=r.p+"fonts/chart-pie-solid.svg";var K=function(e){var t=e.style;return i().createElement("img",{style:t,src:V,alt:"Static pie solid"})};K.propTypes={style:h().object};var $=r(75115),q=r(22408),Y=r(83215),ee=r(37450),te=r(94909),re=r(97481),ae=r(86896);function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function se(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?se(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):se(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const ce=function(){var e,t=(0,ee.Wu)([R._I.advancedReporting,R._I.readVulnerabilityResults,R._I.readHosts],""),r=(0,o.Z)(t,2),a=(0,o.Z)(r[0],3),s=a[0],O=a[1],Z=a[2],h=r[1],j=(0,c.useState)(!1),N=(0,o.Z)(j,2),D=N[0],T=N[1],P=(0,c.useState)(I.N.formatMessage(k.Z.customReportDefaultTitle)),w=(0,o.Z)(P,2),C=w[0],S=w[1],M=(0,c.useState)(""),_=(0,o.Z)(M,2),F=_[0],G=_[1],W=(0,c.useState)(Object.keys(R.jW)),L=(0,o.Z)(W,2),z=L[0],B=L[1],U=(0,c.useState)(R.OX),A=(0,o.Z)(U,2),H=A[0],X=A[1],Q=(0,c.useState)(R.JQ),V=(0,o.Z)(Q,2),ne=V[0],se=V[1],ce=(0,c.useState)(!0),ie=(0,o.Z)(ce,2),ue=ie[0],me=ie[1],pe=null!==(e=(0,u.v9)((function(e){return e.ReportsPageStore.parameters.tags})))&&void 0!==e?e:[],fe=(0,v.Z)(),ge=(0,u.I0)();(0,c.useEffect)((function(){return function(){ge((0,Y.L1)())}}),[ge]);var de=function(e){var t=e.split("/"),r=(0,o.Z)(t,2),a=r[0],n=r[1].split("="),s=(0,o.Z)(n,2);return{string:e,namespace:a,key:s[0],value:s[1]}},be=(0,q.pM)(ge),ve=function(e){var t=(0,ae.Z)();return(0,c.useCallback)((function(r){var a=r.user,n=r.params,o=r.filters,s=r.reportData,l=oe(oe({},n),{},{page:1,page_size:Math.min(Number.MAX_SAFE_INTEGER,9007199254740991),sort:n.sort||"-cvss_score",affecting:"true",advanced_report:"true"}),c=(0,q.sH)({filters:o,intl:t,reportData:s,user:a});e(R.Us.vulnerabilities,(0,R.wI)("reports"),{filters:l,reportConfig:c})}),[])}(be),ye=function(){var e=(0,n.Z)(l().mark((function e(){var t,r,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fe.auth.getUser();case 2:t=e.sent,T(!1),r=(0,q.QT)(le(le({},H),{},{tags:ue?null==pe?void 0:pe.map(de):H.tags}),ne),a=(0,q._R)(le(le({},H),{},{tags:ue?null==pe?void 0:pe.map(de):H.tags})),ve({params:r,filters:a,reportData:{columnsToInclude:z,reportTitle:C,userNotes:F},user:t});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return h?i().createElement(re.Z,{centered:!0}):s&&Z?i().createElement(i().Fragment,null,i().createElement($.Z,{title:I.N.formatMessage(k.Z.reportsPageTitle),showBreadcrumb:!1}),i().createElement(y.Z,null,i().createElement(m.r,{hasGutter:!0,lg:3,md:4,sm:12},i().createElement(p.P,null,i().createElement(f.Z,{className:"report-card"},i().createElement(g.l,null,i().createElement(K,{style:x.Z.pieChartIcon}),i().createElement("span",{className:"pf-u-ml-sm",style:x.Z.cardTitle},I.N.formatMessage(k.Z.executiveReportCardTitle))),i().createElement(d.e,null,I.N.formatMessage(k.Z.executiveReportCardDescription)),i().createElement(b.e,null,i().createElement("a",{onClick:function(){be(R.Us.executive,(0,R.wI)("executive"))}},I.N.formatMessage(k.Z.executiveReportCardButton))))),O&&i().createElement(p.P,null,i().createElement(f.Z,{className:"report-card"},i().createElement(g.l,null,i().createElement(E.ZP,{size:"lg",color:"var(--pf-global--link--Color)"}),i().createElement("span",{className:"pf-u-ml-sm",style:x.Z.cardTitle},I.N.formatMessage(k.Z.customReportCardTitle))),i().createElement(d.e,null,I.N.formatMessage(k.Z.customReportCardDescription)),i().createElement(b.e,null,i().createElement("a",{className:"create-report",onClick:function(){return T(!0)}},I.N.formatMessage(k.Z.customReportCardButton))))))),i().createElement(J,{isOpen:D,columnsToInclude:z,setColumnsToInclude:B,filterData:H,sorterData:ne,userNotes:F,reportTitle:C,setReportTitle:S,setUserNotes:G,setFilterData:X,setSorterData:se,handleModalClose:function(){S(I.N.formatMessage(k.Z.customReportDefaultTitle)),G(""),B(Object.keys(R.jW)),X(R.OX),se(R.JQ),T(!1)},handleDownloadButton:ye,inheritGlobalTags:ue,setInheritGlobalTags:me,globalFilterTags:pe})):i().createElement(te.Z,{title:I.N.formatMessage(k.Z.reportsPageTitle),emptyStateTitle:I.N.formatMessage(k.Z.emptyStateNoAccessReportsPage)})}},97853:()=>{},72816:()=>{}}]);
//# sourceMappingURL=../sourcemaps/Reports.10d22aa4dda072981b2ee0d953555de5.js.map