"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[1013],{41489:(e,t,n)=>{n.d(t,{Ec:()=>c,Eh:()=>u,bp:()=>f});var a=n(87462),r=n(84457),s=n(77865),o=n.n(s),i=n(30893),l=n(44012),c=function(e,t,n){var s=(0,a.Z)({},n);return o().createElement(r.h,(0,a.Z)({key:"pdf",component:"button",onClick:function(){return t(!0)}},s),e?o().createElement(l.Z,i.Z.loading):o().createElement(l.Z,i.Z.kebabExportAsPDF))},u=function(e,t,n){var s=(0,a.Z)({},n);return o().createElement(r.h,(0,a.Z)({key:"editBusinessRisk",component:"button",onClick:function(){return e(t)}},s),o().createElement(l.Z,i.Z.kebabEditBusinessRisk))},f=function(e,t,n,s){var c=(0,a.Z)({},s);return o().createElement(r.h,(0,a.Z)({key:"editStatus",component:"button",onClick:function(){return e(t,n)}},c),o().createElement(l.Z,i.Z.kebabEditStatus))}},53651:(e,t,n)=>{n.r(t),n.d(t,{default:()=>be});var a=n(77865),r=n.n(a),s=n(44012),o=n(72683),i=n(91290),l=n(15265),c=n(30893),u=n(86350),f=n(75115),d=n(4942),p=n(93433),m=n(29439),v=n(28216),b=n(49739),E=n(83826),g=n(78733),h=n(52064),y=n(29648),Z=n(74372),S=n(19738),k=n(87462),O=n(45697),_=n.n(O),C=n(3351),P=n(22860),w=n(6934),x=n(75863),j=n(75959),M=n(43003),R=n(5938),I=n(24788);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=function(e){var t=e.context,n=e.header,s=e.canEditStatusOrBusinessRisk,o=t.cves,i=t.methods,l=t.selectedCves,u=t.expandedRows,f=0===o.data.length,d=o.data&&o.data.map((function(e){return l.includes(e.id)&&B(B({},e),{},{selected:!0})||e})).map((function(e,t){var n=t%2==0?u.includes(e.id):void 0;return B(B({},e),{},{isOpen:n})}));return o.isLoading?r().createElement(j.Z,{colSize:null==n?void 0:n.length,rowSize:20,variant:x.B.compact}):r().createElement(a.Fragment,null,r().createElement(C.i,{canSelectAll:!1,"aria-label":"Vulnerability CVE table",cells:n,rows:f?[{heightAuto:!0,cells:[{props:{colSpan:null==n?void 0:n.length},title:r().createElement(I.lP,{showHighVisibilityCveAlert:!0,secondParagraph:"true"===t.params.affecting?c.Z.emptyStateYourSystemsShouldHaveCVEs:c.Z.emptyStateThereShouldBeCVEs})}]}]:d,onSelect:f?void 0:function(e,n,a){var r=t.cves,s=t.methods,o=r.data[a]&&r.data[a].id;s.selectCves(n,o)},onCollapse:f?void 0:function(e,t){return i.openCves(t)},actionResolver:s&&o.data.length>0?function(e,t){return(0,M.hA)(i,t.rowIndex)}:void 0,sortBy:f?void 0:(0,y.hO)([{key:"collapse"},{key:"checkbox"}].concat((0,p.Z)(n)),o.meta.sort),onSort:f?void 0:function(e,t,a){return(0,y.L6)(t,a,[{key:"collapse"},{key:"checkbox"}].concat((0,p.Z)(n)),o.meta.sort,i.apply)},ouiaId:"cves-table",isStickyHeader:!0,variant:x.B.compact},r().createElement(w.x,null),r().createElement(P.R,null)),r().createElement(R.Z,{meta:o.meta,apply:i.apply}))};A.propTypes={context:_().any,header:_().array,canEditStatusOrBusinessRisk:_().bool};const F=function(e){return r().createElement(me.Consumer,null,(function(t){return r().createElement(A,(0,k.Z)({context:t},e))}))};var V=n(74806),T=n(83594),N=n(93400),H=n(98621),U=n(44612),L=n(32132);const z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.affecting,a=function(t){e({affecting:t.length>0?null==t?void 0:t.join(","):void 0,page:1})};return{label:L.N.formatMessage(c.Z.filterSystemsExposed),type:U.Y.checkbox,urlParam:"affecting",filterValues:{onChange:function(e,t){a(t)},items:g.qr.map((function(e){return{label:e.label,value:e.value}})),value:null==n?void 0:n.split(",")}}};var Y=n(95859),J=n(9088),K=n(90960),q=n(95351),G=n(16369),W=n(35938),X=n(54534),$=n(1792),Q=n(41489),ee=n(33084),te=n(15248);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var re=function(e){var t=(0,a.useState)(!1),n=(0,m.Z)(t,2),s=n[0],o=n[1],i=e.context,l=e.canEditStatusOrBusinessRisk,u=e.canExport,f=i.cves,d=i.params,v=i.methods,b=i.selectedCves,E=i.isAllExpanded,h=i.selectedRowsRawData,y=d.filter,Z=b&&b.length,S=(0,N.Z)({selectedItems:b,selectorHandler:v.selectCves,items:f,fetchResource:function(e){return(0,T.cW)(ae(ae({},d),e))},multiRow:!0}),k=[""].concat((0,p.Z)(l?[{label:e.intl.formatMessage(c.Z.editBusinessRisk),onClick:function(){return v.showBusinessRiskModal(h.map((function(e){var t=e.id,n=e.attributes;return{id:t,business_risk_id:n.business_risk_id,justification:n.business_risk_text}})),!0)},props:{isDisabled:!Z}},{label:e.intl.formatMessage(c.Z.editStatus),onClick:function(){return v.showStatusModal(h.map((function(e){var t=e.id,n=e.attributes;return{id:t,exposed_systems_count:n.systems_affected,justification:n.status_text,status_id:n.status_id}}),[]),!0)},props:{isDisabled:!Z}}]:[]),[{label:e.intl.formatMessage(c.Z.columnManagementModalTitle),onClick:function(){return v.setColumnModalOpen(!0)}}]);return r().createElement(r().Fragment,null,r().createElement(H.Z,{pagination:{isDisabled:0===f.meta.total_items,itemCount:f.meta.total_items||0,page:f.meta.page||1,perPage:f.meta.page_size||1,ouiaId:"pagination-top",onSetPage:function(e,t){return(0,te.A6)(e,t,v.apply)},onPerPageSelect:function(e,t){return(0,te.lO)(e,t,v.apply)}},actionsConfig:{actions:k,dropdownProps:{ouiaId:"toolbar-actions"}},bulkSelect:{count:Z,items:S.items,isDisabled:0===f.meta.total_items&&0===Z,checked:Boolean(Z),ouiaId:"bulk-select",onSelect:function(){return S.handleOnCheckboxChange()}},filterConfig:{items:[(0,q.Z)("filter",c.Z.cve,c.Z.searchFilterByCveID,y,v.apply),(0,G.Z)(v.apply,d),(0,X.Z)(v.apply,d),(0,K.Z)(v.apply,d),(0,J.Z)(v.apply,d),(0,W.Z)(v.apply,d),z(v.apply,d),(0,Y.Z)(v.apply,d),(0,$.Z)(v.apply,d)]},activeFiltersConfig:{filters:(0,te.DU)(d),onDelete:function(e,t,n){return(0,te.vH)(t,v.apply,n,g.MM)},deleteTitle:e.intl.formatMessage(c.Z.resetFilters),showDeleteButton:!(0,te.Yy)(d,g.MM,g.fU)},exportConfig:u&&ae({isDisabled:0===f.meta.total_items,extraItems:[(0,Q.Ec)(s,o)],ouiaId:"export"},(0,te.HV)(v)),expandAll:{isAllExpanded:E,onClick:function(){var t=e.context,n=t.cves,a=t.methods,r=t.isAllExpanded?[]:n.data.filter((function(e){return e.id})).map((function(e){return e.id}));a.openCves(r)}}}),s&&r().createElement(ee.Z,{showButton:!1,params:d,filters:(0,te.DU)(d),onSuccess:function(){return o(!1)}}))};re.propTypes={context:_().object,intl:_().object,canEditStatusOrBusinessRisk:_().bool,canExport:_().bool},re.defaultProps={totalNumber:0,apply:function(){},downloadReport:function(){}};const se=(0,V.ZP)((function(e){return r().createElement(me.Consumer,null,(function(t){return r().createElement(re,(0,k.Z)({context:t},e))}))}));var oe=n(62215),ie=n(83215),le=n(66123),ce=n(66761),ue=n(6023),fe=n(37450);function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var me=r().createContext({});const ve=function(){var e=(0,v.I0)(),t=(0,a.useState)((function(){return function(){return null}})),n=(0,m.Z)(t,2),s=n[0],o=n[1],i=(0,a.useState)((function(){return function(){return null}})),l=(0,m.Z)(i,2),c=l[0],u=l[1],f=(0,a.useState)(!0),d=(0,m.Z)(f,2),k=d[0],O=d[1],_=(0,a.useState)(!1),C=(0,m.Z)(_,2),P=C[0],w=C[1],x=(0,fe.Wu)([g._I.setCveStatusAndBusinessRisk,g._I.setPairStatus,g._I.basicReporting,g._I.readVulnerabilityResults]),j=(0,m.Z)(x,2),M=(0,m.Z)(j[0],4),R=M[0],D=M[1],B=M[2],A=M[3],V=j[1],N=(0,v.v9)((function(e){return e.CVEsStore.cveList})),H=(0,v.v9)((function(e){return e.CVEsStore.parameters})),U=(0,v.v9)((function(e){return e.CVEsStore.columns})),L=(0,v.v9)((function(e){return e.CVEsStore.selectedCves})),z=(0,v.v9)((function(e){return e.CVEsStore.selectedRowsRawData})),Y=(0,v.v9)((function(e){return e.CVEsStore.expandedRows})),J=(0,v.v9)((function(e){return e.CVEsStore.isAllExpanded})),K=(0,a.useMemo)((function(){return(0,h.c_)(N,U)}),[N,U]),q=(0,y.H1)(["show_irrelevant"].concat((0,p.Z)(g.kO))),G=(0,m.Z)(q,2),W=G[0],X=G[1],$=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,y.pX)(t);e((0,T.yM)(n))};return(0,a.useEffect)((function(){$(W)}),[]),(0,a.useEffect)((function(){k?O(!1):(e((0,T.jh)(H)),X(pe({},H)))}),[H]),(0,a.useEffect)((function(){return function(){e((0,T.Ss)()),e((0,ie.L1)())}}),[e]),K.errors?r().createElement(le.Z,{code:parseInt(K.errors.status)}):V?r().createElement(ue.Z,{centered:!0}):A?r().createElement(me.Provider,{value:{cves:K,selectedRowsRawData:z,params:H,selectedCves:L,expandedRows:Y,isAllExpanded:J,methods:{apply:$,downloadReport:function(t){oe.Z.exec(T.jh,H,t,"cves",(function(t){return e((0,ie.wN)(t))}),(function(){return e((0,ie.L1)())}))},selectCves:function(t,n){e((0,T.EY)(n||[]))},showBusinessRiskModal:function(t,n){var a=K.meta;u((function(){return function(){return r().createElement(Z.Z,{cves:t,updateRef:function(){O(!0),e((0,T.Ss)()),(0,y.$)(n?pe(pe({},a),{},{page:1}):a,H,$)}})}}))},showStatusModal:function(t,n){var a=K.meta;o((function(){return function(){return r().createElement(S.Z,{cves:t,canEditPairStatus:D,updateRef:function(){O(!0),e((0,T.Ss)()),(0,y.$)(n?pe(pe({},a),{},{page:1}):a,H,$)}})}}))},openCves:function(t){e((0,T.Rk)(t))},setColumnModalOpen:w}}},r().createElement(c,null),r().createElement(s,null),r().createElement(ce.Z,{appliedColumns:U,applyColumns:function(t){return e((0,T.vP)(t))},isModalOpen:P,setModalOpen:w}),r().createElement(b.K,null,r().createElement(E.v,null,r().createElement(se,{canEditStatusOrBusinessRisk:R,canExport:B})),r().createElement(E.v,null,r().createElement(F,{header:U.filter((function(e){var t;return null!==(t=e.isShown)&&void 0!==t?t:e.isShownByDefault})),canEditStatusOrBusinessRisk:R})))):r().createElement(I.bY,null)},be=function(){var e=r().createElement(o.J,{enableFlip:!0,position:"right",headerContent:r().createElement(s.Z,c.Z.ovalPopoverHeader),bodyContent:r().createElement(s.Z,c.Z.ovalPopoverBody),footerContent:r().createElement("a",{href:"https://access.redhat.com/documentation/en-us/red_hat_insights/2021/html/assessing_and_monitoring_security_vulnerabilities_on_rhel_systems/index",target:"__blank",rel:"noopener noreferrer"},r().createElement(s.Z,c.Z.learnMore)," ",r().createElement(l.ZP,null))},r().createElement("span",null,r().createElement(s.Z,c.Z.cvesHeader),r().createElement(i.ZP,{color:"var(--pf-global--secondary-color--100)",className:"pf-u-ml-sm pointer cves-header-questionmark",style:{verticalAlign:"0"}})));return r().createElement(a.Fragment,null,r().createElement(f.Z,{title:e,showBreadcrumb:!1}),r().createElement(u.Z,null,r().createElement(ve,null)))}},74372:(e,t,n)=>{n.d(t,{Z:()=>y});var a=n(29439),r=n(83115),s=n(59775),o=n(92504),i=n(49739),l=n(83826),c=n(23393),u=n(45697),f=n.n(u),d=n(77865),p=n.n(d),m=n(71478),v=n(78733),b=n(91709),E=n(74806),g=n(30893),h=function(e){var t=e.cves,n=e.updateRef,u=e.intl,f=(0,d.useState)(t),E=(0,a.Z)(f,1)[0],h=(0,d.useState)("0"),y=(0,a.Z)(h,2),Z=y[0],S=y[1],k=(0,d.useState)(),O=(0,a.Z)(k,2),_=O[0],C=O[1],P=(0,d.useCallback)((function(){C(E&&1===E.length&&E[0].justification||"")}),[E]);(0,d.useEffect)((function(){S(E&&1===E.length&&E[0].business_risk_id.toString()||"0"),P()}),[t,P,E]),(0,d.useEffect)(P,[P]);var w=function(e,t){var n=t.currentTarget.value;S(n)},x={variant:"success",title:u.formatMessage(g.Z.notificationBusinessRiskUpdateSuccessful,{count:E.length||0})},j={variant:"danger",autoDismiss:!1,title:u.formatMessage(g.Z.notificationBusinessRiskUpdateFailureTitle),description:u.formatMessage(g.Z.notificationBusinessRiskUpdateFailureBody)};return p().createElement(b.ZP,{items:E,onSave:function(){return(0,m.le)({business_risk_id:parseInt(Z),cve:E.map((function(e){return e.id})),business_risk_text:_}).then(n).catch((function(e){throw e}))},onSuccessNotification:x,onFailureNotification:j,title:u.formatMessage(g.Z.businessRiskModalTitle),ouiaId:"business-risk-modal"},p().createElement(i.K,{hasGutter:!0},p().createElement(l.v,null,u.formatMessage(g.Z.businessRiskModalInfo)),p().createElement(l.v,null,p().createElement(r.l,null,p().createElement(s.c,{label:u.formatMessage(g.Z.businessRiskLabel),fieldId:"businessRiskId"},v.eF.map((function(e){return p().createElement(o.Y,{className:"business-risk-radio",value:e.value,isChecked:Z===e.value,onChange:w,label:e.label,key:e.value,id:e.value,name:e.label,"aria-label":e.label,ouiaId:"business-risk-radio"})}))),p().createElement(s.c,{label:u.formatMessage(g.Z.justificationLabel),fieldId:"label"},p().createElement(c.Kx,{type:"text",onChange:function(e){C(e)},value:_,resizeOrientation:"vertical","aria-label":"justification",style:{minHeight:"2.25rem"}}))))))};h.propTypes={cves:f().array,updateRef:f().func,intl:f().any};const y=(0,E.ZP)(h)},19738:(e,t,n)=>{n.d(t,{Z:()=>k});var a=n(29439),r=n(93149),s=n(83115),o=n(59775),i=n(79851),l=n(34512),c=n(49739),u=n(83826),f=n(35224),d=n(53688),p=n(91290),m=n(45697),v=n.n(m),b=n(77865),E=n.n(b),g=n(71478),h=n(91709),y=n(74806),Z=n(30893),S=function(e){var t=e.cves,n=e.updateRef,m=e.intl,v=e.canEditPairStatus,y=(0,b.useState)(t),S=(0,a.Z)(y,1)[0],k=(0,h.Hb)(S&&S.every((function(e){return e.status_id===S[0].status_id}))&&S[0].status_id.toString()||"0"),O=k.StatusSelect,_=k.statusId,C=k.setProps,P=(0,h.fj)(S&&S.every((function(e){return e.justification===S[0].justification}))&&S[0].justification||""),w=P.JustificationInput,x=P.justification,j=(0,b.useState)(!1),M=(0,a.Z)(j,2),R=M[0],I=M[1],D=S.filter((function(e){return e.exposed_systems_count>0})).map((function(e){return e.id}));(0,b.useEffect)((function(){C({ouiaId:"status-select"})}),[C]);var B={variant:"success",title:m.formatMessage(Z.Z.notificationStatusUpdateSuccessful,{count:S.length||0})},A={variant:"danger",autoDismiss:!1,title:m.formatMessage(Z.Z.notificationStatusUpdateFailureTitle),description:m.formatMessage(Z.Z.notificationStatusUpdateFailureBody)},F=m.formatMessage(Z.Z.cveStatusModalTitle,{count:S.length||0});return E().createElement(h.ZP,{items:S,onSave:function(){return Promise.all([(0,g.xn)({cve:S.map((function(e){return e.id})),status_id:parseInt(_),status_text:x})].concat([!R&&D.length>0&&v&&(0,g.cr)({cve:D,status_id:parseInt(_),status_text:x})])).then((function(){return n(!R)})).catch((function(e){throw e}))},onSuccessNotification:B,onFailureNotification:A,title:F,ouiaId:"status-modal"},E().createElement(c.K,{hasGutter:!0},E().createElement(u.v,null,m.formatMessage(Z.Z.cveStatusModalSelected,{count:S.length||0,cveId:S[0].id,b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return E().createElement("b",null,t)}})),E().createElement(u.v,null,E().createElement(d.ZP,{className:"pf-u-mr-xs",fontSize:"var(--pf-global--FontSize--md)",color:"var(--pf-global--active-color--300)"}),m.formatMessage(Z.Z.cveStatusModalInfo,{count:S.length||0}),E().createElement(f.u,{content:m.formatMessage(Z.Z.cveStatusModalInfoTooltip)},E().createElement(p.ZP,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)"}))),E().createElement(u.v,null,E().createElement(s.l,{key:"key"},O,w,D.length>0&&v&&E().createElement(o.c,{fieldId:"overwrite"},E().createElement(i.P,null,E().createElement(l.J,null,E().createElement(r.X,{label:m.formatMessage(Z.Z.cveStatusModalOverwriteCheckbox),id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:R,onChange:function(e){return I(e)}})),E().createElement(l.J,null,E().createElement(f.u,{content:m.formatMessage(Z.Z.cveStatusModalOverwriteTooltip)},E().createElement(p.ZP,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)",style:{verticalAlign:"0"}})))))))))};S.propTypes={cves:v().array,updateRef:v().func,intl:v().any,canEditPairStatus:v().bool};const k=(0,y.ZP)(S)}}]);
//# sourceMappingURL=../sourcemaps/LandingPage.cb898b5ad72b40efb8655062e2b7c8a6.js.map