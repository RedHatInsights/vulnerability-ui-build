"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[873],{63368:(t,e,i)=>{i.d(e,{Z:()=>o});var n=i(44612),a=i(78733),s=i(32132),r=i(30893);const o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.remediation,o=function(e){t({remediation:e.length>"0"&&e.filter((function(t){return","!==t})).join(",")||"",page:1})};return{label:s.N.formatMessage(r.Z.filterRemediation),type:n.Y.checkbox,urlParam:"remediation",filterValues:{onChange:function(t,e){o(e)},items:a.Iv.map((function(t){return{label:t.label,value:t.value}})),value:i?i.split(","):[]}}}},66516:(t,e,i)=>{i.d(e,{Z:()=>j});var n=i(29439),a=i(93149),s=i(83115),r=i(59775),o=i(49739),u=i(83826),l=i(87116),c=i(79851),d=i(35224),v=i(34512),f=i(91290),m=i(45697),y=i.n(m),_=i(77865),p=i.n(_),g=i(71478),h=i(91709),b=i(74806),E=i(30893),Z=function(t){var e,i=t.cveList,m=t.updateRef,y=t.inventoryList,b=t.intl,Z=t.type,j=(0,h.fj)(A()),S=j.JustificationInput,M=j.justification,k=j.setJustification,P=j.setProps,x=(0,_.useState)(function(){switch(Z){case"systemsExposed":if(y.every((function(t){var e,n;return t.status_id===(null===(e=i[0])||void 0===e?void 0:e.status_id)&&t.justification===(null===(n=i[0])||void 0===n?void 0:n.justification)})))return!0;break;case"systemDetail":var t=i.every((function(t,e,i){var n,a;return t.status_id===(null===(n=i[0])||void 0===n?void 0:n.status_id)&&t.justification===(null===(a=i[0])||void 0===a?void 0:a.justification)})),e=i.every((function(t){return t.status_id===t.cve_status_id&&t.justification===t.cve_justification}));if(t&&e)return!0}return!1}()),N=(0,n.Z)(x,2),C=N[0],D=N[1],I=(0,h.Hb)(J()),w=I.StatusSelect,T=I.statusId,R=I.setStatusId,U=I.setProps,L=y.map((function(t){return t.id||t.inventory_id})),O=y.map((function(t){return t.display_name}));function J(){switch(Z){case"systemsExposed":return C?i[0].status_id:y.every((function(t,e,i){return t.status_id===i[0].status_id}))?null===(t=y[0])||void 0===t?void 0:t.status_id:"0";var t;case"systemDetail":var e,n;return C?i.every((function(t,e,i){return t.cve_status_id===i[0].cve_status_id}))?null===(e=i[0])||void 0===e?void 0:e.cve_status_id:"0":i.every((function(t,e,i){return t.status_id===i[0].status_id}))?null===(n=i[0])||void 0===n?void 0:n.status_id:"0"}}function A(){switch(Z){case"systemsExposed":return C?i[0].justification:y.every((function(t,e,i){var n;return t.justification===(null===(n=i[0])||void 0===n?void 0:n.justification)}))&&(null===(t=y[0])||void 0===t?void 0:t.justification)||"";var t;case"systemDetail":var e,n;return C?i.every((function(t,e,i){var n;return t.cve_justification===(null===(n=i[0])||void 0===n?void 0:n.cve_justification)}))&&(null===(e=i[0])||void 0===e?void 0:e.cve_justification)||"":i.every((function(t,e,i){var n;return t.justification===(null===(n=i[0])||void 0===n?void 0:n.justification)}))&&(null===(n=i[0])||void 0===n?void 0:n.justification)||""}}(0,_.useEffect)((function(){U({isDisabled:C,ouiaId:"status-select"}),P({disabled:C}),R(J()),k(A())}),[C,U,P]);var F={variant:"success",title:"systemsExposed"===Z?b.formatMessage(E.Z.notificationSystemStatusUpdateSuccessful,{count:y.length||0,systemName:O[0]}):b.formatMessage(E.Z.notificationStatusUpdateSuccessful,{count:i.length||0})},X={variant:"danger",autoDismiss:!1,title:b.formatMessage(E.Z.notificationStatusUpdateFailureTitle),description:b.formatMessage(E.Z.notificationStatusUpdateFailureBody)},$=b.formatMessage(E.Z.cvePairStatusModalTitle,{count:L.length*i.length});return p().createElement(h.ZP,{items:i,onSave:function(){var t=i.map((function(t){return t.id})),e=C?{cve:t,inventory_id:L}:{status_id:parseInt(T),cve:t,status_text:M,inventory_id:L};return(0,g.cr)(e).then(m)},onSuccessNotification:F,onFailureNotification:X,title:$,ouiaId:"status-modal"},p().createElement(o.K,{hasGutter:!0},function(){switch(Z){case"systemsExposed":return y.some((function(t,e,i){var n;return t.status_id!==(null===(n=i[0])||void 0===n?void 0:n.status_id)}));case"systemDetail":return i.some((function(t,e,i){var n;return t.status_id!==(null===(n=i[0])||void 0===n?void 0:n.status_id)}))}}()&&p().createElement(u.v,null,p().createElement(l.b,{variant:"warning",isInline:!0,title:b.formatMessage(E.Z.cvePairStatusModalAlert)})),p().createElement(u.v,null,b.formatMessage(E.Z.cvePairStatusModalSelected,{cveCount:i.length||0,cveId:null===(e=i[0])||void 0===e?void 0:e.id,systemCount:y.length||0,systemName:O[0],b:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return p().createElement("b",null,e)}})),p().createElement(u.v,null,p().createElement(s.l,{key:"key"},p().createElement(r.c,{fieldId:"overall"},p().createElement(c.P,null,p().createElement(v.J,null,p().createElement(a.X,{label:b.formatMessage(E.Z.cvePairStatusModalUseOverallCheckbox),id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:C,onChange:function(t){return D(t)}})),p().createElement(v.J,null,p().createElement(d.u,{content:b.formatMessage(E.Z.cvePairStatusModalUseOverallTooltip)},p().createElement(f.ZP,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)",style:{verticalAlign:"0"}}))))),w,S))))};Z.propTypes={cveList:y().array,updateRef:y().func,inventoryList:y().array,intl:y().any,type:y().oneOf(["systemsExposed","systemDetail"])};const j=(0,b.ZP)(Z)},16493:(t,e,i)=>{i.d(e,{Z:()=>h});var n=i(93433),a=i(29439),s=i(77865),r=i.n(s),o=i(45697),u=i.n(o),l=i(83215),c=i(98132),d=i(36873),v=i(28216),f=i(30893),m=i(44012),y=i(29648),_=i(2372),p=i(67463),g=function(t){var e=t.cves,i=t.systems,s=t.manyRules,o=t.addNotification,u=t.isDisabled,l=function(t,e){return{id:"vulnerabilities:".concat(t),description:t,systems:[e]}};return r().createElement(c.Z,{fallback:r().createElement(_.$,{size:p.S3.lg}),isDisabled:u,dataProvider:function(){return function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[].concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]),s=[].concat(t),r=[];if(e&&1===i.length){var o=(0,a.Z)(i,1)[0];r=s.reduce((function(t,e){var i,a=e.id,s=e.rule,r=l(o.id,a);return s&&(r.id="".concat(r.id,":").concat(null==s||null===(i=s.rule)||void 0===i?void 0:i.rule_id)),[].concat((0,n.Z)(t),[r])}),[]),r=(0,y.X8)(r,"systems")}if(!e&&1===(null==s?void 0:s.length)){var u=(0,a.Z)(s,1)[0];r=i.reduce((function(t,e){var i=e.id,a=e.attributes.rule,s=l(i,u);return null!=a&&a.rule_id&&(s.id="".concat(s.id,":").concat(a.rule_id)),[].concat((0,n.Z)(t),[s])}),[])}return!(!i.length||!s.length)&&{issues:r}}(e,i,s)},onRemediationCreated:function(t){return o(t.getNotification())}},r().createElement(m.Z,f.Z.remediateLabel))};g.propTypes={cves:u().oneOfType([u().array,u().string]),systems:u().oneOfType([u().array,u().string]),addNotification:u().func,manyRules:u().bool,isDisabled:u().bool};const h=(0,v.$j)(null,(function(t){return{addNotification:function(e){return t((0,l.wN)(e))}}}))((0,d.Z)(g))}}]);
//# sourceMappingURL=../sourcemaps/873.0f7ee546070128bb49108da32a7697a9.js.map