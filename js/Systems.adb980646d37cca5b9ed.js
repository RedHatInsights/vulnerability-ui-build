"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[743],{75584:(e,t,r)=>{r.r(t),r.d(t,{default:()=>se});var n=r(29439),o=r(93433),a=r(4942),s=r(84506),c=r(77865),l=r.n(c),i=r(86896),u=r(30893),p=r(14494),f=r(45697),d=r.n(f),m=r(74806),b=r(5977),y=r(29648),v=r(83594),g=r(49629),O=r(95351),w=r(15248),h=r(62215),P=r(87462),Z=r(15861),j=r(45987),D=r(87757),E=r.n(D),R=r(3968),S=r(71478),k=r(43198),_=r(62598),C=r(52837),F=r(37450),x=["filters","params","reportData","buttonProps","label"];function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var N=function(e){var t=e.filters,r=e.params,a=e.reportData,s=void 0===a?{}:a,p=e.buttonProps,f=e.label,d=(0,j.Z)(e,x),m=(0,i.Z)(),b=(0,c.useState)(!1),v=(0,n.Z)(b,2),g=v[0],O=v[1],w=(0,F.lm)(),D=(0,n.Z)(w,2),M=D[0],N=D[1],T=function(e){return(0,y.F3)(e,C.tp.systemsReportRestPages)},B=function(){var e=(0,Z.Z)(E().mark((function e(){var n,a,c,l,i;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),M({msg:m.formatMessage(u.Z.notificationReportDownloadStart)}),e.prev=2,e.next=5,(0,S.vk)(I(I({},r),h.Z.defaultParams));case 5:c=e.sent,n=c.data,a=c.meta,e.next=15;break;case 10:return e.prev=10,e.t0=e.catch(2),N(),M({variant:"danger",autoDismiss:!1,msg:m.formatMessage(u.Z.notificationReportDownloadFailureTitle),description:m.formatMessage(u.Z.notificationReportDownloadFailureBody)}),e.abrupt("return",[]);case 15:return l=(0,k.Z)({data:n.splice(0,C.tp.systemsReportFirstPage),meta:a,filters:t,intl:m}),i=T(n),O(!1),N(),M({variant:"success",msg:m.formatMessage(u.Z.notificationReportDownloadSuccess)}),e.abrupt("return",[l].concat((0,o.Z)(i.map((function(e,t){return(0,_.Z)({data:e,page:t,intl:m,header:s&&s.header})})))));case 21:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}();return l().createElement("div",null,l().createElement(R.o6,(0,P.Z)({},d,{label:g?m.formatMessage(u.Z.loading):m.formatMessage(f),asyncFunction:B,buttonProps:I({component:"button"},p),reportName:m.formatMessage(u.Z.systemPDFReportName),type:"",fileName:"".concat(h.Z.filename("system-list"),".pdf"),allPagesHaveTitle:!1,size:"A4",orientation:"landscape"})))};N.defaultProps={label:u.Z.kebabExportAsPDF},N.propTypes={filters:d().oneOfType([d().array,d().object]),params:d().object,reportData:d().object,buttonProps:d().object,label:d().oneOfType([d().array,d().object])};const T=N;var B=r(41489),A=r(44612),H=r(32132);const U=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.excluded,n=function(t){e({excluded:t.length>0?null==t?void 0:t.join(","):void 0,page:1})};return{label:H.N.formatMessage(u.Z.filterSystemsIncludedInAnalysis),type:A.Y.checkbox,urlParam:"excluded",filterValues:{onChange:function(e,t){n(t)},items:C._9.map((function(e){return{label:e.label,value:e.value}})),value:(null==r?void 0:r.length)>0?null==r?void 0:r.split(","):void 0}}};var V=r(83215);function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var L=function(e){var t=e.selectedRows,r=e.selectedRowsCount,o=e.selectedRowsRawData,a=e.intl,s=e.parameters,i=e.systems,f=e.methods,d=(0,c.useState)(!1),m=(0,n.Z)(d,2),b=m[0],y=m[1],P=f.apply,Z=f.handleSelect,j=f.doOptOut,D=(0,p.I0)(),E=(0,c.useMemo)((function(){return{selectedExcluded:o.some((function(e){return!0===e.opt_out})),selectedIncluded:o.some((function(e){return!1===e.opt_out}))}}),[o]),R=["",{label:a.formatMessage(u.Z.systemKebabExcludeAnalysis,{count:r}),onClick:function(){return j(t,null==o?void 0:o[0].display_name,!0)},props:{isDisabled:!r||!E.selectedIncluded}},{label:a.formatMessage(u.Z.systemKebabIncludeAnalysis,{count:r}),onClick:function(){return j(t,null==o?void 0:o[0].display_name,!1,t)},props:{isDisabled:!r||!E.selectedExcluded}}],S=(0,F.ZS)({rawData:i,selectedRows:t,selectedRowsCount:r,handleSelect:Z,fetchResource:function(e){return(0,v.ip)(K(K({},s),e))}});return l().createElement(c.Fragment,null,l().createElement(g.Z,{className:"vuln-systems-primary-toolbar",bulkSelect:S,actionsConfig:{actions:R,kebabToggleProps:{isDisabled:!r},dropdownProps:{ouiaId:"toolbar-actions"}},filterConfig:{items:[(0,O.Z)("filter",u.Z.systemsSearchName,u.Z.searchFilterByName,s.filter,P),U(P,s)]},activeFiltersConfig:{filters:(0,w.DU)(s),onDelete:function(e,t,r){return(0,w.vH)(t,f.apply,r,C.Sy)},deleteTitle:a.formatMessage(u.Z.resetFilters),showDeleteButton:!(0,w.Yy)(s,C.Sy,C.D2)},exportConfig:K({isDisabled:0===i.meta.total_items,extraItems:[(0,B.Ec)(b,y)],ouiaId:"export"},(0,w.HV)({downloadReport:function(e){var t=K({},s);h.Z.exec(v.lc,t,e,"system-list",(function(e){return D((0,V.wN)(e))}),(function(){return D((0,V.L1)())}))}}))}),b&&l().createElement(T,{showButton:!1,params:s,filters:(0,w.DU)(s),onSuccess:function(){return y(!1)}}))};L.propTypes={systems:y.nE,parameters:d().object,selectedRows:d().array,selectedRowsCount:d().number,selectedRowsRawData:d().array,methods:d().shape({doOptOut:d().func,apply:d().func,handleSelect:d().func}),intl:d().any};const Y=(0,b.EN)((0,m.ZP)(L));var W=r(83296),q=r(86350),G=r(43003),J=r(75115),Q=r(57998),X=r(33739),$=r(66123),ee=r(14112),te=r(75863),re=r(12140),ne=r(24788);function oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const se=function(){var e=l().createRef(),t=(0,p.I0)(),r=(0,i.Z)(),a=(0,y.H1)(C.IV),f=(0,n.Z)(a,2),d=f[0],m=f[1],b=(0,p.v9)((function(e){var t=e.entities;return(null==t?void 0:t.rows)||[]}),p.wU),g=(0,p.v9)((function(e){var t=e.entities;return null==t?void 0:t.total})),O=(0,p.v9)((function(e){var t=e.entities;return(null==t?void 0:t.selectedRows)||{}})),w=Object.keys(O).length||0,h=(0,p.v9)((function(e){var t=e.entities;return(null==t?void 0:t.selectedRowsRawData)||[]})),P=(0,p.v9)((function(e){return e.SystemsPageStore.params}),p.wU),Z=(0,p.v9)((function(e){return e.SystemsPageStore.error})),j=Z.hasError,D=Z.errorCode;(0,c.useEffect)((function(){return function(){t((0,v.re)()),t((0,v.r5)())}}),[t]);var E=function(e){return t((0,v.SF)(e))};(0,c.useEffect)((function(){return E(d)}),[]),(0,re.Z)((function(){return m(ae({},P))}),[P]);var R=(0,F.a9)((function(){return t((0,v.r5)()),e.current.onRefreshData({page:1})})),k=(0,c.useMemo)((function(){return k?k++:0}),[]),_=(0,F.U)(S.vk,m);return l().createElement(c.Fragment,null,l().createElement(J.Z,{title:r.formatMessage(u.Z.vulnerabilitySystemsHeader),showBreadcrumb:!1}),l().createElement(q.Z,null,l().createElement(c.Fragment,null,j?l().createElement($.Z,{code:D}):l().createElement(X.Z,{disableDefaultColumns:!0,onLoad:function(e){var t=e.mergeWithEntities;W.Z.register(ae({},t((0,Q.K)(C.Bi),ae({page:Number(P.page||1),perPage:Number(P.page_size||20)},P.sort&&{sortBy:{key:P.sort.replace(/^-/,""),direction:P.sort.match(/^-/)?"desc":"asc"}}))))},tableProps:{isStickyHeader:!0,canSelectAll:!1,actionResolver:(null==b?void 0:b.length)>0&&function(e){return(0,G.zs)(e,R)},variant:te.B.compact},showTagModal:!0,isFullView:!0,ref:e,autoRefresh:!0,customFilters:{vulnerabilityParams:ae({},P)},hasCheckbox:0!==(null==b?void 0:b.length),columnCounter:k,columns:function(e){return function(e){var t=(0,s.Z)(C.Bi),r=t[0],n=t.slice(1),a=e.find((function(e){return"updated"===e.key})),c=e.find((function(e){return"tags"===e.key}));return c=ae(ae({},c),{},{props:{width:10,isStatic:!0}}),a=ae(ae({},a),{},{transforms:[ee.P8],cellTransforms:[ee.P8],props:{width:20}}),[r,c].concat((0,o.Z)(n),[a])}(e)},getEntities:_,hideFilters:{all:!0},noSystemsTable:l().createElement(ne.UE,null)},l().createElement(Y,{parameters:P,systems:{data:b,meta:{total_items:g}},selectedRows:O,selectedRowsCount:w,selectedRowsRawData:h,methods:{doOptOut:R,apply:E,handleSelect:function(e){return t((0,v.hd)(e))}},actions:!0})))))}}}]);
//# sourceMappingURL=../sourcemaps/Systems.3548ab060741ef7a8f48829f0c12a6ae.js.map