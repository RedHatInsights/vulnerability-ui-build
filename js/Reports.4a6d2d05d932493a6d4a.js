(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[322],{99714:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>re});var a=r(63038),n=r.n(a),s=r(25558),o=r.n(s),l=r(49287),c=r(18038),i=r(2095),u=r(36104),m=r(85962),p=r(45587),f=r(89583),d=r(38686),v=r(87757),g=r.n(v),b=r(319),E=r.n(b),y=r(48926),h=r.n(y),Z=r(86896),N=r(58141),C=r(92339),M=r(18623),_=r(59713),x=r.n(_),T=r(45697),R=r.n(T),D=r(59912),O=r(89736),k=r(94949),w=r(81815);function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){x()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var P=function(e){var t,r,a=e.data,l=e.intl,c=a.cves_by_severity,i=a.recent_cves,u=a.top_cves,m=a.cves_total,p=a.system_count,f=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=[];for(var n in e){var s=e[n],o=t[n],c=void 0!==o.count?o.count:o;"na"===n&&0===c||(r&&o.percentage&&(c="number"===r?o.percentage:l.formatMessage(M.Z.executiveReportOfTotal,{count:c,percentage:o.percentage})),a.push([s,c.toString()]))}return a},d=f(D.YM,S({},i)),v=f(D.cL,S({},c),"number").map((function(e){var t=n()(e,2),r=t[0],a=t[1];return{x:"CVSS ".concat(r),y:Number(a)}})),g=f(D.cL,S({},c),"string"),b=(t={firstPage:[],secondPage:[]},r=0,u.forEach((function(e){var a=Math.ceil(e.description.length/70);r+=a;var n=o().createElement(N.s_,{key:e.synopsis,title:e.synopsis,description:e.description},o().createElement(N.Lv,{title:l.formatMessage(M.Z.executiveReportPanelTitle)},Number.parseFloat(e.cvss3_score).toFixed(1)),o().createElement(N.Lv,{title:l.formatMessage(M.Z.systemsExposed)},e.systems_affected.toString()));r<=15&&t.firstPage.push(n)||t.secondPage.push(n)})),t);return[o().createElement(s.Fragment,{key:"first-section"},o().createElement(N.nv,null,l.formatMessage(M.Z.executiveReportHeader)),o().createElement(N.nv,null,l.formatMessage(M.Z.executiveReportSubHeader,{systems:o().createElement(O.xv,{style:k.Z.bold},l.formatMessage(M.Z.executiveReportHeaderSystems,{systems:p})),cves:o().createElement(O.xv,{style:k.Z.bold},l.formatMessage(M.Z.executiveReportHeaderCVEs,{cves:m}))})),o().createElement(N.$0,{title:l.formatMessage(M.Z.executiveReportCvesBySeverity)},o().createElement(N.sg,null,o().createElement(N.iA,{withHeader:!0,rows:[D.rs].concat(E()(g))})),o().createElement(N.sg,null,o().createElement(N.kL,{chartType:"pie",subTitle:"Cves",title:"100",data:v}))),o().createElement(N.$0,{title:l.formatMessage(M.Z.executiveReportRecentlyPublishedCves)},o().createElement(N.sg,null,o().createElement(N.iA,{withHeader:!0,rows:[D.Wq].concat(E()(d))})),o().createElement(N.sg,null)),o().createElement(N.$0,{title:l.formatMessage(M.Z.executiveReportTop3),withColumn:!1},b.firstPage))].concat(E()((0,w.zd)(b.secondPage.length>0,b.secondPage)))};P.propTypes={data:R().exact({cves_by_severity:R().object,recent_cves:R().object,top_cves:R().array,cves_total:R().number,system_count:R().number}),intl:R().any};const I=P;var F=r(44981),B=r(90017);const G=function(){var e=(0,Z.Z)(),t=(0,s.useState)(!1),r=n()(t,2),a=r[0],l=r[1],c=(0,s.useState)(!1),i=n()(c,2),u=i[0],m=i[1],p=(0,F.useDispatch)(),f=function(){var t=h()(g().mark((function t(){var r,a;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l(!0),p((0,B.addNotification)({dismissable:!0,variant:"info",title:e.formatMessage(M.Z.downloadExecutiveNotification)})),t.next=4,(0,C.nK)();case 4:return r=t.sent,a=I({data:r,intl:e}),l(!1),t.abrupt("return",E()(a));case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=(new Date).toISOString().split("T"),v=n()(d,1)[0];return o().createElement(s.Fragment,null,o().createElement("a",{onClick:function(){m(!0)}},e.formatMessage(M.Z.executiveReportCardButton)),u&&o().createElement(N.o6,{showButton:!1,label:a?e.formatMessage(M.Z.loading):e.formatMessage(M.Z.executiveReportCardButton),asyncFunction:f,buttonProps:{variant:"link",isInline:!0},type:e.formatMessage(M.Z.vulnerabilitiesHeader),fileName:"vulnerability_executive-report--".concat(v,".pdf"),allPagesHaveTitle:!1,onSuccess:function(){p((0,B.clearNotifications)()),m(!1)}}))};var L=r(78826),H=r(6202),W=r(4853),z=r(23811),U=r(12282),X=r(32752),A=r(85806),V=r(72278),$=r(82019),K=r(11550),q=function(e){var t=e.isOpen,r=e.handleModalClose,a=e.filterData,l=e.setFilterData,c=e.handleDownloadButton,i=e.columnsToInclude,u=e.setColumnsToInclude,m=e.userNotes,p=e.setUserNotes,f=e.reportTitle,d=e.setReportTitle,v=(0,s.useState)("all"),g=n()(v,2),b=g[0],y=g[1],h=["rule_presence","impact","cvss_filter","business_risk_id","status_id","publish_date"];return(0,s.useEffect)((function(){"all"===b&&u(Object.keys(D.jW))}),[b,u]),o().createElement(L.Modal,{title:K.N.formatMessage(M.Z.configModalTitle),id:"custom-report-modal",ouiaId:"custom-report-modal",isOpen:t,onClose:r,actions:[o().createElement(H.Button,{key:"export",variant:"primary",onClick:c,isDisabled:a.cvss_filter.from<0||a.cvss_filter.to>10||a.cvss_filter.from>a.cvss_filter.to||m.length>D.Z0},K.N.formatMessage(M.Z.configModalExportReport)),o().createElement(H.Button,{key:"cancel",variant:"secondary",onClick:r},K.N.formatMessage(M.Z.cancel))]},o().createElement(W.Form,null,o().createElement(z.FormGroup,{label:K.N.formatMessage(M.Z.customReportTitleLabel),fieldId:"horizontal-form-name"},o().createElement(U.TextInput,{value:f,onChange:function(e){return d(e)},type:"text",className:"report-text-input",id:"horizontal-form-name"})),o().createElement(z.FormGroup,{label:K.N.formatMessage(M.Z.customReportFilterDataByLabel)},o().createElement("div",{className:"custom-report-filter-wrapper"},h&&h.map((function(e){var t;return null===(t=D.jW[e])||void 0===t?void 0:t.component({filterData:a,setFilterData:l,selectProps:{className:"pf-u-mr-sm pf-u-mb-sm"},options:D.jW[e].items,filterId:e,filterName:D.jW[e].title})})))),o().createElement(z.FormGroup,{label:K.N.formatMessage(M.Z.customReportDataToIncludeLabel)},o().createElement(V.tX,{"aria-label":"Default with single selectable"},o().createElement($.G,{text:K.N.formatMessage(M.Z.customReportDataToggleAll),isSelected:"all"===b,onChange:function(){return y("all")}}),o().createElement($.G,{text:K.N.formatMessage(M.Z.customReportDataToggleCustom),isSelected:"custom"===b,onChange:function(){return y("custom")}})),"custom"===b&&o().createElement("div",{style:k.Z.collumns},o().createElement(X.Checkbox,{id:"cve_id",label:"CVE ID",isChecked:!0,isDisabled:!0,className:"pf-u-mb-md"}),Object.entries(D.jW).map((function(e){var t=n()(e,2),r=t[0],a=t[1];return o().createElement(X.Checkbox,{id:r,key:r,label:a.title,isChecked:i.includes(r),onChange:function(e){return function(e,t){u(t?[].concat(E()(i),[e]):i.filter((function(t){return t!==e})))}(r,e)},className:"pf-u-mb-md"})})))),o().createElement(z.FormGroup,{label:K.N.formatMessage(M.Z.customReportUserNotesLabel),fieldId:"user-notes-box",helperTextInvalid:K.N.formatMessage(M.Z.customReportUserNoteTooLong),validated:m.length>D.Z0&&"error"},o().createElement(A.Kx,{value:m,onChange:function(e){return p(e)},type:"text",id:"user-notes-box",className:"report-text-input",resizeOrientation:"vertical",style:{minHeight:"4em"},validated:m.length>D.Z0&&"error"}))))};q.propTypes={isOpen:R().bool,filterData:R().object,setFilterData:R().func,handleModalClose:R().func,handleDownloadButton:R().func,columnsToInclude:R().array,setColumnsToInclude:R().func,userNotes:R().string,setUserNotes:R().func,reportTitle:R().string,setReportTitle:R().func};const Y=q;var J=r(39152),Q=r(91067),ee=r(66780),te=r(37330);const re=function(){var e=(0,s.useState)(!1),t=n()(e,2),r=t[0],a=t[1],v=(0,s.useState)(!1),g=n()(v,2),b=g[0],E=g[1],y=(0,s.useState)(K.N.formatMessage(M.Z.customReportDefaultTitle)),h=n()(y,2),Z=h[0],N=h[1],C=(0,s.useState)(""),_=n()(C,2),x=_[0],T=_[1],R=(0,s.useState)(Object.keys(D.jW)),O=n()(R,2),w=O[0],j=O[1],S=(0,s.useState)(D.OX),P=n()(S,2),I=P[0],F=P[1],B=function(){N(K.N.formatMessage(M.Z.customReportDefaultTitle)),T(""),j(Object.keys(D.jW)),F(D.OX),E(!1),a(!1)};return o().createElement(o().Fragment,null,o().createElement(Q.Z,{title:K.N.formatMessage(M.Z.reportsPageTitle),showBreadcrumb:!1}),o().createElement(f.o,null,o().createElement(l.Grid,{hasGutter:!0,lg:3,md:4,sm:12},o().createElement(c.GridItem,null,o().createElement(i.Card,{className:"report-card"},o().createElement(u.l,null,o().createElement(J.r,{style:k.Z.pieChartIcon}),o().createElement("span",{className:"pf-u-ml-sm",style:k.Z.cardTitle},K.N.formatMessage(M.Z.executiveReportCardTitle))),o().createElement(m.CardBody,null,K.N.formatMessage(M.Z.executiveReportCardDescription)),o().createElement(p.e,null,o().createElement(G,null)))),o().createElement(c.GridItem,null,o().createElement(i.Card,{className:"report-card"},o().createElement(u.l,null,o().createElement(d.ZP,{size:"lg",color:"var(--pf-global--link--Color)"}),o().createElement("span",{className:"pf-u-ml-sm",style:k.Z.cardTitle},K.N.formatMessage(M.Z.customReportCardTitle))),o().createElement(m.CardBody,null,K.N.formatMessage(M.Z.customReportCardDescription)),o().createElement(p.e,null,o().createElement("a",{className:"create-report",onClick:function(){return a(!0)}},K.N.formatMessage(M.Z.customReportCardButton))))))),o().createElement(Y,{isOpen:r,columnsToInclude:w,setColumnsToInclude:j,filterData:I,userNotes:x,reportTitle:Z,setReportTitle:N,setUserNotes:T,setFilterData:F,handleModalClose:B,handleDownloadButton:function(){E(!0),a(!1)}}),b&&o().createElement(ee.Z,{type:"cves",key:"download",reportData:{header:w,reportTitle:Z,userNotes:x},showButton:!1,onSuccess:B,params:(0,te.pX)(I),filters:(0,te._R)(I),isReportDynamic:!0,label:M.Z.configModalExportReport}))}}}]);
//# sourceMappingURL=Reports.4a6d2d05d932493a6d4a.js.map