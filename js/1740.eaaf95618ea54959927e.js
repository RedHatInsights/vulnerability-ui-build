(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[1740],{41740:(e,t,n)=>{"use strict";n.d(t,{d3:()=>ie,QE:()=>se,ZP:()=>ue});var r=n(81253),a=n(96156),o=n(28481),i=n(77865),c=n.n(i),s=n(9048),l=n(45697),u=n.n(l),p=n(30893),d=n(5977),f=n(22122),m=n(85061),v=n(3351),y=n(22860),b=n(6934),g=n(75863),O=n(75959),E=n(32875),h=n(99385),_=n(29648),j=n(5938),Z=n(24788);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w=function(e){var t,n=e.context,r=e.header,a=e.entity,o=n.cves,s=n.methods,l=n.selectedCves,u=n.expandedRows,p=n.canEditStatus;null!=o&&null!==(t=o.meta)&&void 0!==t&&t.patch_access||(r=r.filter((function(e){return"advisory"!==e.key})));var d=!o.data||0===o.data.length,f=d?[]:o.data.map((function(e){return l.includes(e.id)&&S(S({},e),{},{selected:!0})||e})).map((function(e,t){var n=t%2==0?u.find((function(t){return t.id===e.id}))||!1:{isOpen:void 0};return S(S({},e),{},{isOpen:n&&n.isOpen})}));return c().createElement(i.Fragment,null,o.isLoading?c().createElement(O.Z,{colSize:6,rowSize:20,variant:g.B.compact}):c().createElement(i.Fragment,null,c().createElement(v.i,{isStickyHeader:!0,canSelectAll:!1,"aria-label":"Vulnerability CVE table",cells:r,rows:d?function(){var e=n.cves;return[{heightAuto:!0,cells:[{props:{colSpan:8},title:0!==["filter","cvss_from","cvss_to","public_from","public_to","impact","status_id"].filter((function(t){return Object.prototype.hasOwnProperty.call(e.meta,t)&&e.meta[t]})).length?Z.UA:a?Z.dX:e.data&&0!==e.data.length?void 0:Z.vb}]}]}():f,onSelect:d?void 0:function(e,t,r){var a=n.cves,o=n.methods,i=a.data[r]&&a.data[r].id;o.selectCves(t,i)},actionResolver:!d&&p&&function(e,t){return(0,h.k8)(s,a,t.rowIndex)},sortBy:d?void 0:(0,_.hO)([{key:"collapse"},{key:"checkbox"}].concat((0,m.Z)(r)),o.meta.sort),onCollapse:d?void 0:function(e,t,r){return function(e,t,r){var a=n.cves,o=n.methods,i=n.isAllExpanded,c=a.data[t]&&a.data[t].id;o.openCves(r,[c],i)}(0,t,r)},onSort:d?void 0:function(e,t,n){return(0,_.L6)(t,n,[{key:"collapse"},{key:"checkbox"}].concat((0,m.Z)(r)),o.meta.sort,s.apply)},gridBreakPoint:"grid-lg",ouiaId:"cves-table",variant:g.B.compact},c().createElement(i.Fragment,null,c().createElement(b.x,null),c().createElement(y.R,null))),c().createElement(E.Z,null,c().createElement(j.Z,{meta:o.meta,apply:s.apply}))))};w.propTypes={context:u().any,header:u().array,entity:u().string};const C=function(e){return c().createElement(ie.Consumer,null,(function(t){return c().createElement(w,(0,f.Z)({context:t},e))}))};var x=n(74806),k=n(29558),D=n(14494),A=n(6208),R=n(52064),I=n(49739),T=n(83826),H=n(68340),M=n(68774),L=n(62215),F=n(66516),B=n(16493),V=n(93400),z=n(49629),K=n(95859),U=n(9088),X=n(90960),N=n(95351),q=n(16369),G=n(35938),J=n(54534),Q=n(1792),$=n(15248);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ee=function(e){var t=e.entity,n=e.intl,r=e.context,a=r.cves,o=r.parameters,s=r.methods,l=r.selectedCves,u=r.isAllExpanded,d=r.canEditStatus,f=r.canRemediate,v=o.filter,y=o.advisory,b=f&&(l&&l.length||0),g=(0,i.useMemo)((function(){return(0,V.Z)({selectedItems:l,selectorHandler:s.selectCves,items:a,fetchResource:function(e){return s.fetchResource(Y(Y({},o),e))},multiRow:!0})}),[l,a,o,s]),O=[""].concat((0,m.Z)(d?[{label:n.formatMessage(p.Z.editStatus),onClick:function(){return s.showStatusModal((0,m.Z)(l).map((function(e){return Y({id:e},a.data.filter((function(t){return e===t.id})).map((function(e){return{status_id:e.status_id,cve_status_id:e.cve_status_id,justification:e.status_justification,cve_justification:e.cve_status_justification}}))[0])})),[])},props:{isDisabled:!b}}]:[])),E=l.flatMap((function(e){return a.data.filter((function(t){return e===t.id}))}));return c().createElement(c().Fragment,null,c().createElement(z.Z,{pagination:{itemCount:a.meta.total_items||0,page:a.meta.page||1,perPage:a.meta.page_size||1,ouiaId:"pagination-top",onSetPage:function(e,t){return(0,$.A6)(e,t,s.apply)},onPerPageSelect:function(e,t){return(0,$.lO)(e,t,s.apply)}},dedicatedAction:f&&t&&c().createElement(B.Z,{systems:t,cves:E}),actionsConfig:{actions:O,kebabToggleProps:{isDisabled:!b||0===a.meta.total_items},dropdownProps:{ouiaId:"toolbar-actions"}},bulkSelect:{count:b,items:g.items,isDisabled:0===a.meta.total_items&&0===b,checked:Boolean(b),ouiaId:"bulk-select",onSelect:function(){return g.handleOnCheckboxChange()}},filterConfig:{items:[(0,N.Z)("filter",p.Z.cve,p.Z.searchFilterByCveID,v,s.apply),(0,q.Z)(s.apply,o),(0,J.Z)(s.apply,o),(0,X.Z)(s.apply,o),(0,U.Z)(s.apply,o),(0,G.Z)(s.apply,o),(0,K.Z)(s.apply,o),(0,Q.Z)(s.apply,o),(0,N.Z)("advisory",p.Z.advisory,p.Z.search,y,s.apply)]},activeFiltersConfig:{filters:(0,$.DU)(o),onDelete:function(e,t){return(0,$.vH)(t,s.apply)}},exportConfig:Y({isDisabled:0===a.meta.total_items,ouiaId:"export"},(0,$.HV)(s)),expandAll:{isAllExpanded:u,onClick:function(){var e=r.cves,t=r.methods,n=r.isAllExpanded,a=!n,o=n?[]:e.data.filter((function(e){return e.id})).map((function(e){return e.id}));t.openCves(a,o,!n)}}}))};ee.defaultProps={totalNumber:0,apply:function(){},downloadReport:function(){}},ee.propTypes={entity:u().string,context:u().object,intl:u().any};const te=(0,x.ZP)((function(e){return c().createElement(ie.Consumer,null,(function(t){return c().createElement(ee,(0,f.Z)({context:t},e))}))}));var ne=n(83215),re=n(66123);function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ie=(0,i.createContext)({}),ce=function(e){var t,n,r=e.entity,a=e.intl,l=e.allowedCveActions,u=e.showHeaderLabel,d=e.setPageTitle,f=(0,D.useDispatch)(),m=(0,i.useState)((function(){return function(){return null}})),v=(0,o.Z)(m,2),y=v[0],b=v[1],g=(0,i.useState)(!1),O=(0,o.Z)(g,2),E=O[0],h=O[1],j=(0,i.useState)(!0),P=(0,o.Z)(j,2),S=P[0],w=P[1],x=(0,D.useSelector)((function(e){return e.SystemCvesStore.cveList})),k=(0,D.useSelector)((function(e){return e.SystemCvesStore.parameters})),B=(0,D.useSelector)((function(e){return e.SystemCvesStore.selectedCves})),V=(0,D.useSelector)((function(e){return e.SystemCvesStore.expandedRows})),z=(0,D.useSelector)((function(e){return e.SystemCvesStore.isAllExpanded})),K=["REMEDIATE","EDIT_STATUS"].map((function(e){return l.includes(e)})),U=(0,o.Z)(K,2),X=U[0],N=U[1],q=(0,i.useMemo)((function(){return(0,R.l3)(r.id,x)}),[x]),G=(0,_.H1)(A.kO),J=(0,o.Z)(G,2),Q=J[0],$=J[1],W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,_.pX)(e);f((0,s.KV)(t))};return(0,i.useEffect)((function(){d&&(document.title="".concat(r.display_name,"\n                - ").concat(a.formatMessage(p.Z.systemsHeader)," - ").concat(a.formatMessage(p.Z.pageTitleSuffix))),S?(W(oe({sort:"-public_date"},Q)),w(!1)):(f((0,s.E8)(oe(oe({},k),{},{system:r.id}))),E&&$(oe({},k))||h(!0))}),[k]),(0,i.useEffect)((function(){return function(){f((0,s.jS)()),f((0,ne.L1)())}}),[]),x.payload.errors?(t=x.payload.errors.status,404===(n=parseInt(t))&&r.id?Z.yE:c().createElement(re.Z,{code:n})):c().createElement(ie.Provider,{value:{cves:q,parameters:k,selectedCves:B,expandedRows:V,isAllExpanded:z,canRemediate:X,canEditStatus:N,methods:{apply:W,downloadReport:function(e){var t=oe(oe({},k),{},{system:r.id});L.Z.exec(s.E8,t,e,"system-cves")},selectCves:function(e,t){f((0,s.TT)(t))},openCves:function(e,t,n){f((0,s.pJ)({isOpen:e,cves:t,isAllExpanded:n}))},showStatusModal:function(e){var t=Array.from(q.data.filter((function(t){return e.some((function(e){return e.id===t.id}))})));t=t.map((function(e){return{id:e.id,cve_status_id:e.cve_status_id,status_id:e.status_id,justification:e.status_justification,cve_justification:e.cve_status_justification}})),b((function(){return function(){return c().createElement(F.Z,{cveList:t,updateRef:function(){return(0,_.$)(q.meta,W)},inventoryList:[{id:r.id,display_name:r.display_name}],type:"systemDetail"})}}))},fetchResource:function(e){return(0,s.KX)(oe(oe({},e),{},{system:r.id}))}}}},c().createElement(y,null),c().createElement(I.K,{hasGutter:!0},u&&c().createElement(T.v,null,c().createElement(M.D,null,c().createElement(H.x,{component:H.q.h2},a.formatMessage(p.Z.cvesHeader)))),c().createElement(T.v,null,c().createElement(te,{entity:r.id}))),c().createElement(C,{header:A.Vm,entity:r.id}))};ce.defaultProps={allowedCveActions:[],showHeaderLabel:!1,setPageTitle:!1},ce.propTypes={entity:u().object,intl:u().any,allowedCveActions:u().array,showHeaderLabel:u().bool};var se=(0,d.EN)((0,x.ZP)(ce)),le=function(e){var t=e.customItnlProvider,n=(0,r.Z)(e,["customItnlProvider"]),a=t?k.Z:i.Fragment;return c().createElement(a,t&&{locale:navigator.language.slice(0,2),messages:p.Z},c().createElement(se,n))};le.propTypes={customItnlProvider:u().bool,customRouter:u().bool},le.defaultProps={customItnlProvider:!1,customRouter:!1};const ue=4174==n.j?le:null}}]);
//# sourceMappingURL=../sourcemaps/1740.5ec93d8dbecf8c333346.js.map