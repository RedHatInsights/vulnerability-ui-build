(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[20],{39888:(t,e,n)=>{"use strict";n.d(e,{Z:()=>k});var i=n(63038),s=n.n(i),r=n(32752),a=n(4853),u=n(23811),c=n(81159),o=n(34023),l=n(70044),f=n(36842),d=n(76004),v=n(21508),m=n(55795),y=n(45697),p=n.n(y),_=n(25558),h=n.n(_),g=n(92339),E=n(10752),b=n(74806),S=n(18623),j=function(t){var e=t.cveList,n=t.updateRef,i=t.inventoryList,y=t.intl,p=t.type,b=(0,E.fj)(O()),j=b.JustificationInput,k=b.justification,I=b.setJustification,P=b.setProps,R=(0,_.useState)(function(){switch(p){case"systemsExposed":if(i.every((function(t){return t.status_id===e[0].status_id&&t.justification===e[0].justification})))return!0;break;case"systemDetail":var t=e.every((function(t,e,n){return t.status_id===n[0].status_id&&t.justification===n[0].justification})),n=e.every((function(t){return t.status_id===t.cve_status_id&&t.justification===t.cve_justification}));if(t&&n)return!0}return!1}()),Z=s()(R,2),x=Z[0],C=Z[1],M=(0,E.Hb)(L()),T=M.StatusSelect,w=M.statusId,D=M.setStatusId,N=M.setProps,A=i.map((function(t){return t.id||t.inventory_id})),H=i.map((function(t){return t.display_name}));function L(){switch(p){case"systemsExposed":return x?e[0].status_id:i.every((function(t,e,n){return t.status_id===n[0].status_id}))?i[0].status_id:"0";case"systemDetail":return x?e.every((function(t,e,n){return t.cve_status_id===n[0].cve_status_id}))?e[0].cve_status_id:"0":e.every((function(t,e,n){return t.status_id===n[0].status_id}))?e[0].status_id:"0"}}function O(){switch(p){case"systemsExposed":return x?e[0].justification:i.every((function(t,e,n){return t.justification===n[0].justification}))&&i[0].justification||"";case"systemDetail":return x?e.every((function(t,e,n){return t.cve_justification===n[0].cve_justification}))&&e[0].cve_justification||"":e.every((function(t,e,n){return t.justification===n[0].justification}))&&e[0].justification||""}}(0,_.useEffect)((function(){N({isDisabled:x,ouiaId:"status-select"}),P({disabled:x}),D(L()),I(O())}),[x,N,P]);var U={variant:"success",title:y.formatMessage(S.Z.cvePairStatusModalUpdateSuccessful)},F=y.formatMessage(S.Z.cvePairStatusModalTitle,{count:A.length*e.length});return h().createElement(E.ZP,{items:e,onSave:function(){var t=e.map((function(t){return t.id})),i=x?{cve:t,inventory_id:A}:{status_id:parseInt(w),cve:t,status_text:k,inventory_id:A};return(0,g.cr)(i).then(n)},onSuccessNotification:U,title:F,ouiaId:"status-modal"},h().createElement(c.Stack,{hasGutter:!0},function(){switch(p){case"systemsExposed":return i.some((function(t,e,n){return t.status_id!==n[0].status_id}));case"systemDetail":return e.some((function(t,e,n){return t.status_id!==n[0].status_id}))}}()&&h().createElement(o.StackItem,null,h().createElement(l.Alert,{variant:"warning",isInline:!0,title:y.formatMessage(S.Z.cvePairStatusModalAlert)})),h().createElement(o.StackItem,null,y.formatMessage(S.Z.cvePairStatusModalSelected,{cveCount:e.length||0,cveId:e[0].id,systemCount:i.length||0,systemName:H[0],b:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return h().createElement("b",null,e)}})),h().createElement(o.StackItem,null,h().createElement(a.Form,{key:"key"},h().createElement(u.FormGroup,{fieldId:"overall"},h().createElement(f.Split,null,h().createElement(v.SplitItem,null,h().createElement(r.Checkbox,{label:y.formatMessage(S.Z.cvePairStatusModalUseOverallCheckbox),id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:x,onChange:function(t){return C(t)}})),h().createElement(v.SplitItem,null,h().createElement(d.Tooltip,{content:y.formatMessage(S.Z.cvePairStatusModalUseOverallTooltip)},h().createElement(m.ZP,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)",style:{verticalAlign:"0"}}))))),T,j))))};j.propTypes={cveList:p().array,updateRef:p().func,inventoryList:p().array,intl:p().any,type:p().oneOf(["systemsExposed","systemDetail"])};const k=(0,b.ZP)(j)},1658:(t,e,n)=>{"use strict";n.d(e,{Z:()=>T});var i=n(319),s=n.n(i),r=n(63038),a=n.n(r),u=n(34575),c=n.n(u),o=n(93913),l=n.n(o),f=n(2205),d=n.n(f),v=n(78585),m=n.n(v),y=n(29754),p=n.n(y),_=n(90017),h=n(74905),g=n(61829),E=n(50448),b=n.n(E),S=n(72892),j=n.n(S),k=n(45697),I=n.n(k),P=n(25558),R=n.n(P),Z=n(18790),x=n(18623),C=n(44012);var M=function(t){d()(r,t);var e,n,i=(e=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=p()(e);if(n){var s=p()(this).constructor;t=Reflect.construct(i,arguments,s)}else t=i.apply(this,arguments);return m()(this,t)});function r(){var t,e;c()(this,r);for(var n=arguments.length,u=new Array(n),o=0;o<n;o++)u[o]=arguments[o];return m()(e,(t=e=i.call.apply(i,[this].concat(u)),e.baseIssueTemplate=function(t){return{id:"vulnerabilities:".concat(t),description:t}},e.cveHasRule=function(t){var e;return(null===(e=t.rules)||void 0===e?void 0:e.length)>0},e.someSystemsHaveRule=function(t){return t.some((function(t){return t.rule}))},e.filterRules=function(t,e){return t.rules.filter((function(t){var n=t.value;return e.some((function(t){var e,i=t.rule;return i?(null==i||null===(e=i.rule)||void 0===e?void 0:e.rule_id)===n:n}))}))},e.remediationProvider=function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n=[].concat(n),i=[].concat(i);var u=[];if(r&&1===n.length){var c=n,o=a()(c,1),l=o[0];if(e.cveHasRule(l)&&e.someSystemsHaveRule(i)){var f=e.filterRules(l,i);u=f.reduce((function(t,n){var i=e.baseIssueTemplate(l.id);return i.id="".concat(i.id,":").concat(n.value),[].concat(s()(t),[i])}),[])}else u=[e.baseIssueTemplate(l.id)]}return r||1!==(null===(t=i)||void 0===t?void 0:t.length)||(u=n.reduce((function(t,n){var i,r=e.baseIssueTemplate(n.id);return(null===(i=n.rules)||void 0===i?void 0:i.rule_id)&&(r.id="".concat(r.id,":").concat(n.rules.rule_id)),[].concat(s()(t),[r])}),[])),!(!n.length||!i.length)&&{issues:u,systems:i.map((function(t){return t.id||t}))}},t))}return l()(r,[{key:"shouldComponentUpdate",value:function(t){return t.cves!==this.props.cves||t.systems!==this.props.systems}},{key:"render",value:function(){var t=this,e=this.props,n=e.cves,i=e.systems,s=e.manyRules,r=e.addNotification;return R().createElement("div",null,R().createElement(h.ZP,{dataProvider:function(){return t.remediationProvider(n,i,s)},isDisabled:!1===this.remediationProvider(n,i),onRemediationCreated:function(t){return r(t.getNotification())}},R().createElement(g.ZP,{size:"sm",color:j().value}),"Â ",R().createElement(C.Z,x.Z.remediateLabel)))}}]),r}(P.Component);M.propTypes={cves:I().oneOfType([I().array,I().string]),systems:I().oneOfType([I().array,I().string]),addNotification:I().func,manyRules:I().bool};const T=(0,Z.connect)(null,(function(t){return{addNotification:function(e){return t((0,_.addNotification)(e))}}}))(b()(M))}}]);
//# sourceMappingURL=20.a8438017dc4844cba40a.js.map