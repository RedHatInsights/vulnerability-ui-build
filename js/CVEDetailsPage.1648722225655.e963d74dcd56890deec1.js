"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[226],{60448:(e,t,a)=>{var n=a(95318);t.Z=void 0;var r=n(a(319)),s=n(a(34575)),l=n(a(93913)),o=n(a(81506)),c=n(a(2205)),i=n(a(78585)),u=n(a(29754)),m=n(a(59713)),f=n(a(22491)),d=a(73004),p=a(69573),v=n(a(45697));var g=function(e){(0,c.default)(v,e);var t,a,n=(t=v,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,u.default)(t);if(a){var r=(0,u.default)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return(0,i.default)(this,e)});function v(){var e;(0,s.default)(this,v);for(var t=arguments.length,a=new Array(t),l=0;l<t;l++)a[l]=arguments[l];return e=n.call.apply(n,[this].concat(a)),(0,m.default)((0,o.default)(e),"createColumns",(function(){var t=e.props.colSize;return(0,r.default)(Array(t)).map((function(){return{title:f.default.createElement(p.Skeleton,{size:p.SkeletonSize.sm})}}))})),(0,m.default)((0,o.default)(e),"getColumns",(function(){var t=e.props,a=t.paddingColumnSize,n=t.columns;return e.newArray(a).map((function(){return""})).concat(n||e.createColumns())})),(0,m.default)((0,o.default)(e),"createRows",(function(){var t=e.props,a=t.colSize,n=t.rowSize,r=t.columns,s=t.paddingColumnSize,l=r?r.length:a;return e.newArray(n).map((function(){return{disableSelection:!0,cells:e.newArray(s).map((function(){return""})).concat(e.newArray(l).map((function(){return{title:f.default.createElement(p.Skeleton,{size:p.SkeletonSize.md})}})))}}))})),(0,m.default)((0,o.default)(e),"selectVariant",(function(){return e.props.hasRadio?(null===d.RowSelectVariant||void 0===d.RowSelectVariant?void 0:d.RowSelectVariant.radio)||"radio":(null===d.RowSelectVariant||void 0===d.RowSelectVariant?void 0:d.RowSelectVariant.checkbox)||"checkbox"})),(0,m.default)((0,o.default)(e),"newArray",(function(e){return(0,r.default)(Array(e))})),e}return(0,l.default)(v,[{key:"render",value:function(){var e=this.props,t=e.canSelectAll,a=e.isSelectable,n=e.sortBy,r=e.variant;return f.default.createElement(d.Table,{cells:this.getColumns(),rows:this.createRows(),sortBy:n,"aria-label":"Loading",onSelect:a,selectVariant:a?this.selectVariant():null,canSelectAll:t,variant:r},f.default.createElement(d.TableHeader,null),f.default.createElement(d.TableBody,null))}}]),v}(f.default.Component);g.propTypes={colSize:v.default.number,rowSize:v.default.number,columns:v.default.array,paddingColumnSize:v.default.number,sortBy:v.default.shape({index:v.default.number,direction:v.default.oneOf(["asc","desc"])}),isSelectable:v.default.bool,canSelectAll:v.default.bool,hasRadio:v.default.bool,variant:v.default.string},g.defaultProps={rowSize:0,paddingColumnSize:0,canSelectAll:!1,isSelectable:!1,hasRadio:!1,variant:null};var E=g;t.Z=E},39591:(e,t,a)=>{a.d(t,{Z:()=>c});var n=a(45987),r=a(22491),s=a.n(r),l=a(45697),o=function(e){var t=e.component,a=(0,n.Z)(e,["component"]);return(0,r.useEffect)((function(){console.error("Unable to load iventory component. Failed to load ".concat(t,"."),a)}),[]),s().createElement("div",null,s().createElement("h1",null,"Unable to load inventory component"),s().createElement("h2",null,"Failed to load ",t),s().createElement("code",null,"More info can be found in browser console output."))};o.propTypes={component:a.n(l)().string};const c=o},33739:(e,t,a)=>{a.d(t,{Z:()=>g});var n=a(87462),r=a(22491),s=a.n(r),l=a(45697),o=a.n(l),c=a(38106),i=a(5977),u=a(28216),m=a(52643),f=a(2372),d=a(39591),p=function(e){var t=(0,i.k6)(),a=(0,u.oR)();return s().createElement(r.Suspense,{fallback:e.fallback},s().createElement(c.ScalprumComponent,(0,n.Z)({history:t,store:a,appName:"inventory",module:"./InventoryTable",scope:"inventory",ErrorComponent:s().createElement(d.Z,(0,n.Z)({component:"InventoryDetailHead",history:t,store:a},e)),ref:e.innerRef},e)))};p.propTypes={fallback:o().node,innerRef:o().object};var v=s().forwardRef((function(e,t){return s().createElement(p,(0,n.Z)({innerRef:t},e))}));v.propTypes={fallback:o().node},v.defaultProps={fallback:s().createElement(m.b,{className:"pf-u-p-lg"},s().createElement(f.$,{size:"xl"}))};const g=v},38463:(e,t,a)=>{a.d(t,{Z:()=>Z});var n=a(45987),r=a(22491),s=a.n(r),l=a(87441),o=a(45697),c=a.n(o),i=a(74806),u=a(91036),m=a.n(u),f=a(67585),d=a(83826),p=a(68774),v=a(78733),g=a(30893),E=["text","truncate","intl"],b=new l.TU.Renderer;b.link=function(){var e=l.TU.Renderer.prototype.link.apply(this,arguments);return e.replace("<a ",'<a target="_blank" rel="noopener noreferrer" ')},l.TU.setOptions({renderer:b});var y=function(e){var t=e.text,a=e.truncate,r=e.intl,o=(0,n.Z)(e,E);return t&&s().createElement(d.v,o,s().createElement(p.D,{className:"rule-description"},a&&t.length>v.ct?s().createElement(f.Z,{length:v.ct,expandText:r.formatMessage(g.Z.readMore),collapseText:r.formatMessage(g.Z.readLess),text:(0,l.TU)(t),spaceBetween:!0}):s().createElement("span",{dangerouslySetInnerHTML:function(e){return{__html:m()(e)}}((0,l.TU)(t))})))};y.defaultProps={truncate:!0,link:null},y.propTypes={intl:c().oneOfType([c().string,c().object]),truncate:c().bool,text:c().string.isRequired};const Z=(0,i.ZP)(y)},92162:(e,t,a)=>{a.d(t,{Z:()=>p});var n=a(87462),r=a(93433),s=a(29439),l=a(22491),o=a.n(l),c=a(78733),i=a(44612),u=a(54680),m=a(92694),f=a(32132),d=a(30893);const p=function(e,t){var a=o().useState(!1),l=(0,s.Z)(a,2),p=l[0],v=l[1],g=o().useState(10),E=(0,s.Z)(g,2),b=E[0],y=E[1],Z=c.iP.slice().reverse(),h=e?e.split(","):[];return{type:i.Y.custom,label:f.N.formatMessage(d.Z.osFilterLabel),filterValues:{children:o().createElement(u.P,(0,n.Z)({variant:"checkbox",onToggle:function(e){v(e)},onSelect:function(e,a){var n,s=c.iP.find((function(e){return e.label===a})).value;h.includes(s)?(n=h).splice(n.indexOf(s),1):n=[].concat((0,r.Z)(h),[s]),t({rhel_version:n.join(","),page:1})},selections:h.map((function(e){return c.iP.find((function(t){return t.value===e})).label})),isOpen:p,"aria-label":"os-version-filter",placeholderText:f.N.formatMessage(d.Z.osFilterPlaceholder)},b<Z.length&&{loadingVariant:{text:f.N.formatMessage(d.Z.viewMore),onClick:function(){y(Z.length)}}},{style:{maxHeight:"420px",overflow:"auto"}}),Z.slice(0,b).map((function(e,t){return o().createElement(m.$,{isDisabled:e.disabled,key:t,value:e.label,description:null==e?void 0:e.description})})))}}}},16369:(e,t,a)=>{a.d(t,{Z:()=>v});var n=a(4942),r=a(87462),s=a(44612),l=a(78733),o=a(32132),c=a(30893),i=a(2883),u=a.n(i),m=a(18446),f=a.n(m);function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3?arguments[3]:void 0,i=(0,r.Z)({},n),m=[];t.rule_presence&&(m=m.concat(t.rule_presence.split(","))),t.rule&&(m=m.concat(t.rule.split(",")));var d=function(t){e(p(p(p({},i.isDynamic&&{rule:t.join(",")||void 0}),!i.isDynamic&&{rule_presence:t.join(",")||void 0}),{},{page:1}))},v=function(){var e=i.dropdownItems?i.dropdownItems:l.rM;return u()(e,a,f()).map((function(e){return{label:e.label,value:e.value}}))};return{label:o.N.formatMessage(c.Z.filterSecurityRules),type:s.Y.checkbox,key:"security_rule",filterValues:{onChange:function(e,t){d(t)},items:v(),value:m}}}},1792:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(44612),r=a(78733),s=a(32132),l=a(30893);const o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.status_id,o=function(t){e({status_id:t.length>"0"&&t.filter((function(e){return","!==e})).join(",")||"",page:1})};return{label:s.N.formatMessage(l.Z.filterStatus),type:n.Y.checkbox,key:"status",filterValues:{onChange:function(e,t){o(t)},items:r.Em.map((function(e){return{label:e.label,value:e.value}})),value:a?a.split(","):[]}}}},41489:(e,t,a)=>{a.d(t,{Ec:()=>i,Eh:()=>u,bp:()=>m});var n=a(87462),r=a(84457),s=a(22491),l=a.n(s),o=a(30893),c=a(44012),i=function(e,t,a){var s=(0,n.Z)({},a);return l().createElement(r.h,(0,n.Z)({key:"pdf",component:"button",onClick:function(){return t(!0)}},s),e?l().createElement(c.Z,o.Z.loading):l().createElement(c.Z,o.Z.kebabExportAsPDF))},u=function(e,t,a){var s=(0,n.Z)({},a);return l().createElement(r.h,(0,n.Z)({key:"editBusinessRisk",component:"button",onClick:function(){return e(t)}},s),l().createElement(c.Z,o.Z.kebabEditBusinessRisk))},m=function(e,t,a,s){var i=(0,n.Z)({},s);return l().createElement(r.h,(0,n.Z)({key:"editStatus",component:"button",onClick:function(){return e(t,a)}},i),l().createElement(c.Z,o.Z.kebabEditStatus))}},61790:(e,t,a)=>{a.d(t,{Z:()=>m});var n=a(22491),r=a.n(n),s=a(45697),l=a.n(s),o=a(21947),c=a(86135),i=a(53411),u=function(e){var t=e.hasExploit,a=e.hasRule,n=e.isCompact;return(t||a)&&r().createElement(o.e,{className:"cve-labels-grouped--nowrap"},t&&r().createElement(c.Z,{isCompact:n}),a&&r().createElement(i.Z,{isCompact:n}))};u.propTypes={hasExploit:l().bool.isRequired,hasRule:l().bool.isRequired,isCompact:l().bool};const m=u},86135:(e,t,a)=>{a.d(t,{Z:()=>v});var n=a(4942),r=a(22491),s=a.n(r),l=a(69174),o=a(35224),c=a(45697),i=a.n(c),u=a(44012),m=a(30893);function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p=function(e){var t=e.style,a=e.className,n=e.isCompact;return s().createElement(o.u,{content:s().createElement(u.Z,m.Z.knownExploitDescription)},s().createElement(l._,{color:"red",style:d({},t),className:["cve-labels",a],isCompact:n},s().createElement(u.Z,m.Z.knownExploit)))};p.propTypes={style:i().object,className:i().string,isCompact:i().bool};const v=p},29059:(e,t,a)=>{a.r(t),a.d(t,{CVEPageContext:()=>dt,default:()=>pt});var n=a(29439),r=a(86350),s=a(22491),l=a.n(s),o=a(22167),c=a(28216),i=a(40306),u=a(78733),m=a(50693),f=a(16475),d=a(45697),p=a.n(d),v=a(49739),g=a(83826),E=a(68340),b=a(68774),y=a(28191),Z=a(92298),h=a(74806),S=a(30893),w=a(4942),N=a(87462),M=a(45987),k=a(56455),O=a(60448),P=a(6023),x=a(75863),R=["isLoading","variant","children","size"];function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(Object(a),!0).forEach((function(t){(0,w.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var _={spinner:"spinner",table:"table",compactTable:"compactTable",rectangle:"rectangle",inlineSkeleton:"inlineSkeleton",skeleton:"skeleton"},V=function(e){var t=e.isLoading,a=e.variant,n=e.children,r=e.size,s=(0,M.Z)(e,R);if(t)switch(a){case _.spinner:return l().createElement(P.Z,(0,N.Z)({centered:!0},s));case _.table:return l().createElement(O.Z,s);case _.compactTable:return l().createElement(O.Z,(0,N.Z)({variant:x.B.compact},s));case _.rectangle:return l().createElement(k.Z,(0,N.Z)({shape:"square"},s));case _.inlineSkeleton:return l().createElement(k.Z,(0,N.Z)({size:null!=r?r:k.i.lg},s,{style:C({display:"inline-block"},s.style)}));default:return l().createElement(k.Z,(0,N.Z)({size:null!=r?r:k.i.lg},s))}return n};V.propTypes={isLoading:p().bool,variant:p().oneOf(Object.keys(_)),style:p().object,children:p().node,size:p().string};const L=V;var D=a(24788),I=function(e){var t=e.cveAttributes,a=e.intl,n=t.public_date,r=t.description,s=t.rh_link,o=r&&"unknown"!==r;return l().createElement(dt.Consumer,null,(function(e){return l().createElement(v.K,{hasGutter:!0},o&&l().createElement(g.v,{className:"pf-u-mt-sm"},l().createElement(y.k,null,l().createElement(Z.B,null,a.formatMessage(S.Z.publishDate),":"),l().createElement(Z.B,{grow:{default:"grow"}},l().createElement(L,{isLoading:e.isLoading,variant:_.inlineSkeleton,size:"sm"},n)))),l().createElement(g.v,null,l().createElement(L,{isLoading:e.isLoading,variant:_.rectangle,style:{height:"132px",width:"100%"}},o?l().createElement(b.D,{style:{textAlign:"justify"}},l().createElement(E.x,{component:E.q.p},r)):l().createElement(D.xT,null))),l().createElement(g.v,{className:"pf-u-mt-sm pf-u-mb-md"},s))}))};I.propTypes={cveAttributes:p().any,intl:p().any};const A=(0,h.ZP)(I);var T=a(79851),B=a(34512),z=a(47173),F=a(90496),U=a(29648),H=a(72683),q=a(91290),J=a(3351),K=a(22860),G=a(6934),W=a(32132),Y={AV:{name:W.N.formatMessage(S.Z.vectorNamesV3AV),values:{N:W.N.formatMessage(S.Z.vectorValuesNetwork),A:W.N.formatMessage(S.Z.vectorValuesAdjacent),L:W.N.formatMessage(S.Z.vectorValuesLocal),P:W.N.formatMessage(S.Z.vectorValuesPhysical)}},AC:{name:W.N.formatMessage(S.Z.vectorNamesV3AC),values:{L:W.N.formatMessage(S.Z.vectorValuesLow),H:W.N.formatMessage(S.Z.vectorValuesHigh)}},PR:{name:W.N.formatMessage(S.Z.vectorNamesV3PR),values:{N:W.N.formatMessage(S.Z.vectorValuesNone),L:W.N.formatMessage(S.Z.vectorValuesLow),H:W.N.formatMessage(S.Z.vectorValuesHigh)}},UI:{name:W.N.formatMessage(S.Z.vectorNamesV3UI),values:{N:W.N.formatMessage(S.Z.vectorValuesNone),R:W.N.formatMessage(S.Z.vectorValuesRequired)}},S:{name:W.N.formatMessage(S.Z.vectorNamesV3S),values:{U:W.N.formatMessage(S.Z.vectorValuesUnchanged),C:W.N.formatMessage(S.Z.vectorValuesChanged)}},C:{name:W.N.formatMessage(S.Z.vectorNamesV3C),values:{N:W.N.formatMessage(S.Z.vectorValuesNone),L:W.N.formatMessage(S.Z.vectorValuesLow),H:W.N.formatMessage(S.Z.vectorValuesHigh)}},I:{name:W.N.formatMessage(S.Z.vectorNamesV3I),values:{N:W.N.formatMessage(S.Z.vectorValuesNone),L:W.N.formatMessage(S.Z.vectorValuesLow),H:W.N.formatMessage(S.Z.vectorValuesHigh)}},A:{name:W.N.formatMessage(S.Z.vectorNamesV3A),values:{N:W.N.formatMessage(S.Z.vectorValuesNone),L:W.N.formatMessage(S.Z.vectorValuesLow),H:W.N.formatMessage(S.Z.vectorValuesHigh)}},CVSS:{name:W.N.formatMessage(S.Z.vectorNamesCvssVersion),values:{"3.0":3}}},$={AV:{name:W.N.formatMessage(S.Z.vectorNamesV2AV),values:{N:W.N.formatMessage(S.Z.vectorValuesNetwork),A:W.N.formatMessage(S.Z.vectorValuesAdjacentNetwork),L:W.N.formatMessage(S.Z.vectorValuesLocal)}},AC:{name:W.N.formatMessage(S.Z.vectorNamesV2AC),values:{N:W.N.formatMessage(S.Z.vectorValuesNone),L:W.N.formatMessage(S.Z.vectorValuesLow),H:W.N.formatMessage(S.Z.vectorValuesHigh)}},Au:{name:W.N.formatMessage(S.Z.vectorNamesV2AU),values:{M:W.N.formatMessage(S.Z.vectorValuesMultiple),S:W.N.formatMessage(S.Z.vectorValuesSingle),N:W.N.formatMessage(S.Z.vectorValuesNone)}},C:{name:W.N.formatMessage(S.Z.vectorNamesV2C),values:{C:W.N.formatMessage(S.Z.vectorValuesComplete),P:W.N.formatMessage(S.Z.vectorValuesPartial),N:W.N.formatMessage(S.Z.vectorValuesNone)}},I:{name:W.N.formatMessage(S.Z.vectorNamesV2I),values:{C:W.N.formatMessage(S.Z.vectorValuesComplete),P:W.N.formatMessage(S.Z.vectorValuesPartial),N:W.N.formatMessage(S.Z.vectorValuesNone)}},A:{name:W.N.formatMessage(S.Z.vectorNamesV2A),values:{C:W.N.formatMessage(S.Z.vectorValuesComplete),P:W.N.formatMessage(S.Z.vectorValuesPartial),N:W.N.formatMessage(S.Z.vectorValuesNone)}}},Q=a(60329),X=function(e){var t,a,r,s=e.cvss2_metrics,o=e.cvss3_metrics,c=e.score,i=e.intl,u=(o?"CVSS 3.0":s&&"CVSS 2.0")||"CVSS 3.0",m=o||s,f=(a=o&&Y||s&&$,r={},(t=m)&&t.split("/").forEach((function(e){var t=e.split(":"),s=(0,n.Z)(t,2),l=s[0],o=s[1],c=a[l]&&a[l].name,i=a[l]&&a[l].values[o]||"N/A";c&&(r[c]=i)})),r);return delete f.cvssVersion,l().createElement(dt.Consumer,null,(function(e){return l().createElement(b.D,null,l().createElement(H.J,{id:"popover-cvss",position:"bottom",maxWidth:"100%",enableFlip:!0,headerContent:"".concat(u," ").concat(i.formatMessage(S.Z.cvssVectorPopoverTitle)),bodyContent:l().createElement(L,{isLoading:e.isLoading,colSize:2,rowSize:8,variant:_.compactTable},m?l().createElement(J.i,{"aria-label":"Metric breakdown",variant:x.B.compact,gridBreakPoint:"",cells:[i.formatMessage(S.Z.cvssVectorMetric),i.formatMessage(S.Z.cvssVectorValue)],rows:Object.entries(f)},l().createElement(G.x,null),l().createElement(K.R,null)):"N/A")},l().createElement(Q.Z,{isLarge:!0,className:"pf-u-mb-xs pointer"},u," ",i.formatMessage(S.Z.cvssVectorVectorString),l().createElement(q.ZP,{color:"var(--pf-global--secondary-color--100)",className:"pf-u-ml-xs"}))),l().createElement(L,{isLoading:e.isLoading,style:{width:"320px"}},l().createElement("span",{className:"pf-u-mr-md"},c),l().createElement("span",{id:"cvss-vector-content"},i.formatMessage(S.Z.vector)+": ",(null==m?void 0:m.substring(m.indexOf("/")+1))||"N/A")))}))};X.propTypes={cvss2_metrics:p().string,cvss3_metrics:p().string,score:p().any,intl:p().any};const ee=(0,h.ZP)(X);var te=function(e){var t=e.title,a=e.value,n=e.content;return l().createElement(H.J,{id:"popover",bodyContent:n,headerContent:"",position:"bottom",appendTo:document.querySelector(".vulnerability")},l().createElement(v.K,{className:"popover-content"},l().createElement(g.v,null,l().createElement(Q.Z,{isLarge:!0},t)),l().createElement(g.v,null,l().createElement("a",null,a))))};te.propTypes={title:p().any,value:p().any,content:p().any};const ae=te;var ne=a(69957),re=a(86896),se=a(43376),le=function(e){var t=e.cveAttributes,a=e.canEditStatusOrBusinessRisk,n=e.showStatusModal,r=e.showBusinessRiskModal,s=(0,re.Z)(),o=(0,U.nJ)(t.impact||"Unknown"),c=t.business_risk,i=t.business_risk_justification,m=t.status,f=t.status_justification,d=t.systems_status_detail,p=t.systems_status_divergent,E=d&&Object.keys(d).map((function(e){return[u.Em.find((function(t){return t.value===e.toString()})).label,d[e].toString()]})),y=l().createElement(v.K,{className:"pf-u-p-xs"},l().createElement(g.v,null,l().createElement(Q.Z,{className:"pf-u-mb-xs"},s.formatMessage(S.Z.justificationNote))),l().createElement(g.v,null,i||"--"),a&&l().createElement(g.v,{className:"pf-u-mt-sm"},l().createElement(z.zx,{variant:"secondary",onClick:r},s.formatMessage(S.Z.editBusinessRisk)))),Z=l().createElement(v.K,{className:"pf-u-p-xs"},l().createElement(g.v,null,l().createElement(Q.Z,{className:"pf-u-mb-xs"},s.formatMessage(S.Z.cveStatus)),m||"--",l().createElement(Q.Z,{className:"pf-u-mb-xs pf-u-mt-sm"},s.formatMessage(S.Z.justificationNote)),f||"--"),p>0&&l().createElement(g.v,null,l().createElement(b.D,null,l().createElement("hr",{className:"pf-u-mt-sm pf-u-mb-sm"})),l().createElement(Q.Z,{isLarge:!0},s.formatMessage(S.Z.cveDetailsPageSystemsWTCves)),l().createElement(J.i,{"aria-label":"Status details",gridBreakPoint:"",cells:[s.formatMessage(S.Z.statusLabel),s.formatMessage(S.Z.count)],rows:E,className:"status-breakdown-table",variant:"compact"},l().createElement(G.x,null),l().createElement(K.R,null))),a&&l().createElement(g.v,{className:"pf-u-mt-sm"},l().createElement(z.zx,{variant:"secondary",onClick:n},s.formatMessage(S.Z.editStatus))));return l().createElement(dt.Consumer,null,(function(e){return l().createElement(v.K,{hasGutter:!0},l().createElement(g.v,null,l().createElement(T.P,{hasGutter:!0},l().createElement(B.J,null,l().createElement(ae,{title:s.formatMessage(S.Z.businessRiskLabel),value:l().createElement(L,{isLoading:e.isLoading,style:{width:"100px"}},c),content:y})),l().createElement(B.J,{className:"pf-u-ml-lg"},l().createElement(ae,{title:s.formatMessage(S.Z.statusLabel),content:Z,value:l().createElement(L,{isLoading:e.isLoading,style:{width:"100px"}},l().createElement("span",null,p>0&&l().createElement(ne.ZP,{color:"var(--pf-global--primary-color--100)"})," ",m))})))),l().createElement(g.v,null,l().createElement(Q.Z,{className:"pf-u-mb-xs",isLarge:!0},s.formatMessage(S.Z.impact)),l().createElement(L,{isLoading:e.isLoading,style:{width:"100px"}},l().createElement("span",{id:"severity-shield",style:{color:o.color}},l().createElement(se.Z,{impact:o.title,hasLabel:!0})))),l().createElement(g.v,null,l().createElement(ee,{cvss2_metrics:t.cvss2_metrics,cvss3_metrics:t.cvss3_metrics,score:(0,F.Z)(t.cvss2_score,t.cvss3_score)})))}))};le.propTypes={cveAttributes:p().any,canEditStatusOrBusinessRisk:p().bool,showStatusModal:p().func,showBusinessRiskModal:p().func};const oe=le;var ce=a(35224),ie=a(32203),ue=a(62394),me=a(61932),fe=a(73727),de=a(40400);const pe=(0,de.IU)({name:"AngleDoubleDownIcon",height:512,width:320,svgPath:"M143 256.3L7 120.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4 96.4-96.4c9.4-9.4 24.6-9.4 33.9 0L313 86.3c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.4 9.5-24.6 9.5-34 .1zm34 192l136-136c9.4-9.4 9.4-24.6 0-33.9l-22.6-22.6c-9.4-9.4-24.6-9.4-33.9 0L160 352.1l-96.4-96.4c-9.4-9.4-24.6-9.4-33.9 0L7 278.3c-9.4 9.4-9.4 24.6 0 33.9l136 136c9.4 9.5 24.6 9.5 34 .1z",yOffset:0,xOffset:0}),ve=(0,de.IU)({name:"AngleDoubleUpIcon",height:512,width:320,svgPath:"M177 255.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 351.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 425.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1zm-34-192L7 199.7c-9.4 9.4-9.4 24.6 0 33.9l22.6 22.6c9.4 9.4 24.6 9.4 33.9 0l96.4-96.4 96.4 96.4c9.4 9.4 24.6 9.4 33.9 0l22.6-22.6c9.4-9.4 9.4-24.6 0-33.9l-136-136c-9.2-9.4-24.4-9.4-33.8 0z",yOffset:0,xOffset:0}),ge=function(){return l().createElement("svg",{className:"ins-c-critical-icon",viewbox:"0 0 10 10"},l().createElement("polygon",{points:"10 10, 10 3, 5 0, 0 3, 0 10, 5 8"}))},Ee=(0,de.IU)({name:"EqualsIcon",height:512,width:448,svgPath:"M416 304H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32zm0-192H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",yOffset:0,xOffset:0});var be=a(69174),ye=a(94184),Ze=a.n(ye),he={1:{icon:l().createElement(pe,null),text:"Low"},2:{icon:l().createElement(Ee,null),text:"Moderate"},3:{icon:l().createElement(ve,null),text:"Important"},4:{icon:l().createElement(ge,null),text:"Critical"}},Se=function(e){var t=e.value,a=e.text,n=e.hideIcon,r=e.className,s=e.rest;return l().createElement(be._,(0,N.Z)({},s,{className:Ze()(r,"ins-c-label-".concat(t)),icon:!n&&he[t].icon}),a||he[t].text)};Se.propTypes={value:p().number,text:p().node,hideIcon:p().bool,className:p().string,rest:p().object},Se.defaultProps={value:1};const we=Se;var Ne=a(68778),Me=a(15265);const ke=(0,de.IU)({name:"PowerOffIcon",height:512,width:512,svgPath:"M400 54.1c63 45 104 118.6 104 201.9 0 136.8-110.8 247.7-247.5 248C120 504.3 8.2 393 8 256.4 7.9 173.1 48.9 99.3 111.8 54.2c11.7-8.3 28-4.8 35 7.7L162.6 90c5.9 10.5 3.1 23.8-6.6 31-41.5 30.8-68 79.6-68 134.9-.1 92.3 74.5 168.1 168 168.1 91.6 0 168.6-74.2 168-169.1-.3-51.8-24.7-101.8-68.1-134-9.7-7.2-12.4-20.5-6.5-30.9l15.8-28.1c7-12.4 23.2-16.1 34.8-7.8zM296 264V24c0-13.3-10.7-24-24-24h-32c-13.3 0-24 10.7-24 24v240c0 13.3 10.7 24 24 24h32c13.3 0 24-10.7 24-24z",yOffset:0,xOffset:0});var Oe=a(53411),Pe=a(38463),xe=function(e){var t=e.rules,a=e.synopsis,n=e.changeExposedSystemsParameters,r=e.intl,o=(0,c.I0)(),i=[].concat(t).sort((function(e,t){return t.systems_affected-e.systems_affected}));return i&&i.map((function(e,t){var c;return e.summary&&l().createElement(ie.Z,{className:"card-box",key:e.rule_id,ouiaId:"security-rule-card-"+t},l().createElement(me.L,{toggleText:l().createElement(T.P,null,l().createElement(B.J,{className:"pf-u-mr-xl"},l().createElement(b.D,null,l().createElement(E.x,{component:E.q.h4},l().createElement(Oe.Z,{className:"pf-u-mr-sm"}),e.description))),l().createElement(B.J,{id:"filter-affected-systems-split"},e.rule_id&&l().createElement(b.D,null,l().createElement(E.x,{id:"filter-affected-systems",onClick:function(t){var a;a=e.rule_id,o(n({rule:a})),t.stopPropagation()},component:E.q.small},l().createElement(fe.rU,{key:e.rule_id,to:"/cves/".concat(a,"/?rule=").concat(e.rule_id)},r.formatMessage(S.Z.filterByAffectedSystems,{count:null!==(c=e.systems_affected)&&void 0!==c?c:-1}))))))},l().createElement(ue.e,{className:"rule-card-body"},l().createElement(m.r,{hasGutter:!0},l().createElement(f.P,{md:9,sm:12},l().createElement(v.K,{hasGutter:!0},l().createElement(g.v,null,l().createElement(Pe.Z,{text:e.summary})),l().createElement(g.v,null,l().createElement(b.D,null,l().createElement(T.P,null,e.rule_impact&&l().createElement(B.J,null,l().createElement(Q.Z,{className:"label pf-u-mb-xs"},r.formatMessage(S.Z.impact)),l().createElement(ce.u,{content:Object.values(u.l8)[e.rule_impact-1]},l().createElement(we,{value:e.rule_impact,className:"severity-label"}))),l().createElement(B.J,null,l().createElement(Q.Z,{className:"label pf-u-mb-xs"},r.formatMessage(S.Z.riskOfChange)),l().createElement(ce.u,{content:u.p3[e.change_risk]},u.MS[e.change_risk])),l().createElement(B.J,null,l().createElement(Q.Z,{className:"label pf-u-mb-xs"},r.formatMessage(S.Z.remediationLabel)),l().createElement(T.P,null,l().createElement(B.J,null,e.playbook_count?l().createElement(s.Fragment,null,l().createElement(Ne.ZP,{className:"checkCircleIcon pf-u-mr-xs"}),r.formatMessage(S.Z.yes),l().createElement(ce.u,{content:r.formatMessage(S.Z.ansibleRemediationTooltip)},l().createElement(q.ZP,{className:"l-sm-spacer outlinedQuestionCircleIcon"}))):r.formatMessage(S.Z.no)),l().createElement(B.J,{className:"pf-u-ml-md"},e.reboot_required&&l().createElement(E.x,null,l().createElement(ke,{className:"pf-u-mr-xs powerOffIcon"}),r.formatMessage(S.Z.rebootRequired)))))))),e.kbase_node_id&&l().createElement(g.v,null,l().createElement(b.D,null,l().createElement(E.x,{className:"pf-u-mt-xs",component:E.q.p},l().createElement("a",{className:"kb-link",href:"".concat(u.E7,"/").concat(e.kbase_node_id),target:"_blank",rel:"noopener noreferrer"},r.formatMessage(S.Z.knowledgebaseArticle),l().createElement(Me.ZP,{className:"l-sm-spacer"}))))))),l().createElement(f.P,{md:3,sm:12},l().createElement(b.D,null,l().createElement(Q.Z,null,r.formatMessage(S.Z.associatedCves)),l().createElement(E.x,{component:E.q.p,className:"pf-u-mt-xs associated-cves"},a," (",r.formatMessage(S.Z.current),")",e.associated_cves.filter((function(e){return e!==a})).map((function(e,t){return l().createElement("a",{className:"associated-cve-link",key:t,href:"".concat(u.OF,"/").concat(e)},e)})).reduce((function(e,t){return[e,", ",t]}),[""]))))))))}))};xe.defaultProps={rules:[]},xe.propTypes={intl:p().any,rules:p().array,synopsis:p().string,changeExposedSystemsParameters:p().func};const Re=(0,h.ZP)(xe);var je=a(86135),Ce=function(){var e=(0,re.Z)();return l().createElement(ie.Z,{className:"card-box",ouiaId:"known-exploit-card"},l().createElement(me.L,{toggleText:l().createElement(b.D,null,l().createElement(E.x,{component:E.q.h4},l().createElement(je.Z,{className:"pf-u-mr-sm"}),e.formatMessage(S.Z.knownExploitHeader)))},l().createElement(ue.e,null,e.formatMessage(S.Z.knownExploitDescription))))},_e=function(e){var t=e.data,a=e.changeExposedSystemsParameters,n=e.canEditStatusOrBusinessRisk,r=e.showStatusModal,s=e.showBusinessRiskModal;return l().createElement(m.r,{hasGutter:!0},l().createElement(f.P,{md:8,sm:12},l().createElement(A,{cveAttributes:t.data})),l().createElement(f.P,{md:4,sm:12,className:"pf-u-mt-sm pf-u-ml-sm"},l().createElement(oe,{cveAttributes:t.data,canEditStatusOrBusinessRisk:n,showStatusModal:r,showBusinessRiskModal:s})),t.data.known_exploit&&l().createElement(Ce,null),l().createElement(Re,{changeExposedSystemsParameters:a,synopsis:t.data.synopsis,rules:t.data.rules}))};_e.propTypes={data:p().object,changeExposedSystemsParameters:p().func,canEditStatusOrBusinessRisk:p().bool,showStatusModal:p().func,showBusinessRiskModal:p().func};const Ve=_e;var Le=a(41489),De=a(74372),Ie=a(19738),Ae=a(66516),Te=a(83296),Be=a(57998),ze=a(62215),Fe=a(33739),Ue=a(66123),He=a(83215),qe=a(93433),Je=a(6982),Ke=a(7092),Ge=a(16369),We=a(1792),Ye=a(92162),$e=a(15248),Qe=a(37450),Xe=a(95351),et=a(63368);function tt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function at(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(a),!0).forEach((function(t){(0,w.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):tt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var nt=function(e){var t=e.rawData,a=e.cveName,n=e.cveStatusDetails,r=e.selectedRows,o=e.selectedRowsCount,c=e.selectedRowsRawData,m=e.filterRuleValues,f=e.expandAll,d=e.hasSecurityRule,p=e.isAllExpanded,v=e.parameters,g=e.methods,E=e.canEditPairStatus,b=e.canExport,y=e.children,Z=(0,re.Z)(),h=g.apply,w=g.showStatusModal,N=g.handleSelect,M=g.downloadReport,k=g.setColumnModalOpen,O=t.isLoaded,P=t.meta,x=c.filter((function(e){return e.remediation===u.sF})),R=[""].concat((0,qe.Z)(E?[{label:Z.formatMessage(S.Z.editStatus),onClick:function(){return w([n],c)},props:{isDisabled:!o}}]:[]),[{label:Z.formatMessage(S.Z.columnManagementModalTitle),onClick:function(){return k(!0)}}]),j=(0,Xe.Z)("filter",S.Z.systemsSearchName,S.Z.searchFilterByName,v.filter,h),C=(0,Xe.Z)("advisory",S.Z.advisory,S.Z.searchFilterByAdvisory,v.advisory,h),_=(0,Ye.Z)(v.rhel_version,h),V=(0,Qe.ZS)({rawData:t,selectedRows:r,selectedRowsCount:o,handleSelect:N,fetchResource:function(e){return(0,i.Wf)(at(at({id:a},v),e))}});return p&&t.data.filter((function(e){return void 0===e.isOpen})).length>0&&f(t,!1),l().createElement(s.Fragment,null,l().createElement(Je.Z,{className:"vuln-systems-primary-toolbar",exportConfig:b&&at({isDisabled:0===P.totalItems,ouiaId:"export"},(0,$e.HV)({downloadReport:M})),dedicatedAction:O&&l().createElement(Ke.Z,{manyRules:!0,isDisabled:0===c.length,systems:x,cves:{id:a,rules:m}}),actionsConfig:{actions:R,dropdownProps:{ouiaId:"toolbar-actions"}},activeFiltersConfig:{filters:(0,$e.DU)(at({},v),m),onDelete:function(e,t){return(0,$e.vH)(t,h)},deleteTitle:Z.formatMessage(S.Z.resetFilters)},bulkSelect:V,filterConfig:{items:[j,(0,Ge.Z)(h,v,m,{isDynamic:!0,dropdownItems:u.cM}),(0,We.Z)(h,v),C,_,(0,et.Z)(h,v)]},expandAll:d?{isAllExpanded:p,onClick:function(){return f(t,p)}}:void 0}),y)};nt.propTypes={rawData:U.nE,parameters:p().object,cveName:p().string,cveStatusDetails:p().object,filterRuleValues:p().object,expandAll:p().func,hasSecurityRule:p().bool,isAllExpanded:p().bool,selectedRows:p().array,selectedRowsCount:p().number,selectedRowsRawData:p().array,children:p().node,methods:p().shape({apply:p().func,handleSelect:p().func,showStatusModal:p().func,downloadReport:p().func,setColumnModalOpen:p().func}),canEditPairStatus:p().bool,canExport:p().bool};var rt=a(71478),st=a(66761);function lt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ot(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(a),!0).forEach((function(t){(0,w.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):lt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ct=function(e){var t=e.intl,a=e.cveName,r=e.cveStatusDetails,m=e.filterRuleValues,f=e.hasSecurityRule,d=e.canEditPairStatus,p=e.canExport,y=e.inventoryRef,Z=e.refreshInventory,h=(0,Qe.Wu)([u._I.readHosts],"inventory"),w=(0,n.Z)(h,2),N=(0,n.Z)(w[0],1)[0],M=w[1],k=(0,c.I0)(),O=(0,s.useState)(!1),R=(0,n.Z)(O,2),j=R[0],C=R[1],_=(0,s.useState)((function(){return function(){return null}})),V=(0,n.Z)(_,2),L=V[0],I=V[1],A=(0,U.H1)(u.qB),T=(0,n.Z)(A,2),B=T[0],z=T[1],F=(0,s.useState)(!1),H=(0,n.Z)(F,2),q=H[0],J=H[1],K=(0,c.v9)((function(e){var t=e.entities;return(null==t?void 0:t.rows)||[]}),c.wU),G=(0,c.v9)((function(e){var t=e.entities;return null==t?void 0:t.total})),W=(0,c.v9)((function(e){var t=e.entities;return null==t?void 0:t.meta})),Y=(0,c.v9)((function(e){var t=e.entities;return(null==t?void 0:t.error)||{}})),$=(0,c.v9)((function(e){var t=e.entities;return(null==t?void 0:t.selectedRows)||{}})),Q=(0,c.v9)((function(e){var t,a=e.entities;return null!==(t=null==a?void 0:a.selectedRowsCount)&&void 0!==t?t:0})),X=(0,c.v9)((function(e){var t=e.entities;return(null==t?void 0:t.selectedRowsRawData)||[]})),ee=(0,c.v9)((function(e){var t=e.entities;return(null==t?void 0:t.loaded)||!1})),te=(0,c.v9)((function(e){return e.CVEDetailsPageStore.parameters}),c.wU),ae=(0,c.v9)((function(e){return e.CVEDetailsPageStore.columns})),ne=function(e){return k((0,i.vv)(e))};(0,s.useEffect)((function(){return ne(B)}),[]),(0,s.useEffect)((function(){return z(ot(ot({},te),W))}),[z,te,W]),(0,s.useEffect)((function(){return function(){k((0,i.r5)())}}),[k]);var re=function(e,t){I((function(){return function(){return l().createElement(Ae.Z,{cveList:e,updateRef:function(){Z(),k((0,i.ZO)(a))},inventoryList:t,type:"systemsExposed"})}}))},se=(0,Qe.U)(rt.ip,{id:a,createRows:o.JF}),le=(0,s.useState)(0),oe=(0,n.Z)(le,2),ce=oe[0],ie=oe[1];(0,s.useEffect)((function(){return ie(ce+1)}),[ae]);return l().createElement(v.K,{hasGutter:!0},l().createElement(g.v,null,l().createElement(b.D,null,l().createElement(E.x,{component:E.q.h2},t.formatMessage(S.Z.affectsSystems)))),l().createElement(g.v,null,M?l().createElement(P.Z,{centered:!0}):null!=Y&&Y.hasError&&!N?l().createElement(Ue.Z,{code:null==Y?void 0:Y.errorCode}):l().createElement(Fe.Z,{disableDefaultColumns:!0,onLoad:function(e){var t=e.mergeWithEntities;Te.Z.register(ot({},t((0,Be.K)(u.jp),ot({page:Number(te.page||1),perPage:20},te.sort&&{sortBy:{key:te.sort.replace(/^-/,""),direction:te.sort.match(/^-/)?"desc":"asc"}}))))},tableProps:{isStickyHeader:!0,canSelectAll:!1,actionResolver:function(){return d&&G&&(0,o.ji)(re,r)},variant:x.B.compact},paginationProps:{isDisabled:!G},showTagModal:!0,isFullView:!0,ref:y,autoRefresh:!0,key:"inventory",customFilters:{vulnerabilityParams:ot({},te)},expandable:f,columnsCounter:ce,columns:function(e){return t=e,ae.filter((function(e){var t;return null!==(t=e.isShown)&&void 0!==t?t:e.isShownByDefault})).map((function(e){return ot(ot({},t.find((function(t){var a=t.key;return e.key===a}))),e)}));var t},getEntities:se,hasCheckbox:0!==G,showActions:0!==G,onExpandClick:function(e,t,a,n){var r=n.id;return k((0,i.yw)(r,a))},hideFilters:{all:!0},noSystemsTable:l().createElement(D.UE,null)},l().createElement(nt,{rawData:{data:K,meta:{totalItems:G},isLoaded:ee},parameters:te,cveName:a,expandAll:function(e,t){e.data.forEach((function(e){k((0,i.yw)(e.id,!t))})),C(!t)},hasSecurityRule:f,isAllExpanded:j,selectedRows:$,selectedRowsCount:Q,selectedRowsRawData:X,cveStatusDetails:r,filterRuleValues:m,methods:{downloadReport:function(e){ze.Z.exec(i.TA,ot({id:a},te),e,"systems-exposed",(function(e){return k((0,He.wN)(e))}),(function(){return k((0,He.L1)())}))},apply:ne,handleSelect:function(e){return k((0,i.hd)(e))},showStatusModal:re,setColumnModalOpen:J},canEditPairStatus:d,canExport:p},L&&l().createElement(L,null),l().createElement(st.Z,{appliedColumns:ae,applyColumns:function(e){return k((0,i.w8)(e))},isModalOpen:q,setModalOpen:J})))))};ct.propTypes={intl:p().object,cveName:p().string,cveStatusDetails:p().object,filterRuleValues:p().array,hasSecurityRule:p().bool,canEditPairStatus:p().bool,canExport:p().bool,inventoryRef:p().object,refreshInventory:p().func};const it=(0,h.ZP)(ct);var ut=a(75115),mt=a(61790),ft=a(5977),dt=l().createContext({isLoading:!0});const pt=function(){var e,t,a=(0,c.I0)(),m=l().createRef(),f=(0,ft.$B)(),d=(0,re.Z)(),p=(0,Qe.Wu)([u._I.setPairStatus,u._I.setCveStatusAndBusinessRisk,u._I.basicReporting,u._I.readVulnerabilityResults]),v=(0,n.Z)(p,2),g=(0,n.Z)(v[0],4),E=g[0],b=g[1],y=g[2],Z=g[3],h=v[1],w=(0,s.useState)(f.params.cve),N=(0,n.Z)(w,1)[0],M=(0,s.useState)((function(){return function(){return null}})),k=(0,n.Z)(M,2),O=k[0],P=k[1],x=(0,s.useState)((function(){return function(){return null}})),R=(0,n.Z)(x,2),j=R[0],C=R[1],_=(0,c.v9)((function(e){return e.CVEDetailsPageStore.cveDetails})),V=(0,s.useMemo)((function(){return(0,o.m4)(_)}),[_]),L=(0,c.v9)((function(e){var t=e.entities;return null==t?void 0:t.total}));(0,s.useEffect)((function(){a((0,i.ZO)(N))}),[a,N]);var I=function(){return a((0,i.r5)()),m.current.onRefreshData({page:1})},A=function(e){P((function(){return function(){return l().createElement(De.Z,{open:!0,cves:e,updateRef:function(){return a((0,i.ZO)(N))}})}}))},T=function(e){C((function(){return function(){return l().createElement(Ie.Z,{cves:e,updateRef:function(e){a((0,i.ZO)(N)),e&&I()},canEditPairStatus:E})}}))};(0,s.useEffect)((function(){return function(){a((0,i.ds)()),a((0,He.L1)())}}),[a]);var B=V.error,z=V.data,F={id:N,status_id:V.data.status_id,justification:V.data.status_justification,exposed_systems_count:L||0},U={business_risk_id:V.data.business_risk_id,id:N,justification:V.data.business_risk_justification},H=[(0,Le.Eh)(A,[U]),(0,Le.bp)(T,[F])],q=z.rules,J=q&&q.map((function(e){return{value:e.rule_id,label:e.description}})),K=function(e){return[{title:u.yy.cvesPage.title,to:u.yy.cvesPage.to,loaded:!0},{title:e,isActive:!0,loaded:!0}]};return l().createElement(dt.Provider,{value:V&&{isLoading:V.isLoading||h}},Z?null!=B&&B.hasError?l().createElement(l().Fragment,null,l().createElement(ut.Z,{title:N,breadcrumbs:K(d.formatMessage(S.Z.unknownCveId))}),l().createElement(Ue.Z,{code:null==B?void 0:B.errorCode})):l().createElement(s.Fragment,null,l().createElement(ut.Z,{title:z.celebrity_name?N+" - "+z.celebrity_name:N,actions:b&&H,actionsOuiaId:"cve-actions",breadcrumbs:K(N),labels:[l().createElement(mt.Z,{key:"labels",hasExploit:!(null===(e=_.payload.data)||void 0===e||!e.attributes.known_exploit),hasRule:(null===(t=_.payload.data)||void 0===t?void 0:t.attributes.rules.length)>0})]},l().createElement(Ve,{changeExposedSystemsParameters:i.vv,canEditStatusOrBusinessRisk:b,data:V,showStatusModal:function(){return T([F])},showBusinessRiskModal:function(){return A([U])}}),l().createElement(j,null),l().createElement(O,null)),l().createElement(r.Z,null,l().createElement(it,{cveName:N,filterRuleValues:J,cveStatusDetails:F,hasSecurityRule:(null==q?void 0:q.length)>0,canEditPairStatus:E,canExport:y,inventoryRef:m,refreshInventory:I}))):l().createElement(l().Fragment,null,l().createElement(ut.Z,{title:N,breadcrumbs:K(N)}),l().createElement(D.bY,null)))}},91709:(e,t,a)=>{a.d(t,{Hb:()=>Z,ZP:()=>w,fj:()=>h});var n=a(87462),r=a(29439),s=a(47173),l=a(59775),o=a(90784),c=a(22608),i=a(80236),u=a(23393),m=a(83215),f=a(45697),d=a.n(f),p=a(22491),v=a.n(p),g=a(28216),E=a(78733),b=a(30893),y=a(44012);function Z(e){var t=(0,p.useState)(e),a=(0,r.Z)(t,2),s=a[0],i=a[1],u=(0,p.useState)({}),m=(0,r.Z)(u,2),f=m[0],d=m[1];return{StatusSelect:v().createElement(l.c,{label:v().createElement(y.Z,b.Z.statusLabel),fieldId:"statusId"},v().createElement(o.i,(0,n.Z)({"aria-label":"Select Input",onChange:function(e){return i(e)},value:s},f),E.Em.map((function(e){var t=e.value,a=e.label;return v().createElement(c.j,{key:t,value:t,label:a})})))),statusId:s,setStatusId:i,setProps:d}}function h(e){var t=(0,p.useState)(e),a=(0,r.Z)(t,2),s=a[0],o=a[1],c=(0,p.useState)({}),i=(0,r.Z)(c,2),m=i[0],f=i[1];return{JustificationInput:v().createElement(l.c,{label:v().createElement(y.Z,b.Z.justificationLabel),fieldId:"label"},v().createElement(u.Kx,(0,n.Z)({key:"input",type:"text",onChange:function(e){return o(e)},value:s,resizeOrientation:"vertical","aria-label":"justification note",style:{minHeight:"2.25rem"}},m))),justification:s,setJustification:o,setProps:f}}var S=function(e){var t=e.items,a=e.title,n=e.onSave,l=e.onSuccessNotification,o=e.onFailureNotification,c=e.ouiaId,u=e.children,f=(0,p.useState)(t),d=(0,r.Z)(f,2),Z=d[0],h=d[1],S=(0,g.I0)(),w=function(){h(void 0)};return v().createElement(i.u,{variant:"small",title:a,isOpen:Boolean(Z),onClose:w,actions:[v().createElement(s.zx,{key:"save",variant:"primary",ouiaId:"save",onClick:function(){n().then((function(){return S((0,m.wN)(l))})).catch((function(e){return S((0,m.wN)("503"===e.status?E.iF:"403"===e.status?E._V:o))})),w()}},v().createElement(y.Z,b.Z.save)),v().createElement(s.zx,{key:"cancel",variant:"secondary",ouiaId:"close",onClick:w},v().createElement(y.Z,b.Z.cancel))],ouiaId:c},u)};S.propTypes={children:d().any,onClose:d().func,items:d().array,updateRef:d().func,title:d().string,onSave:d().func,onSuccessNotification:d().object,onFailureNotification:d().object,ouiaId:d().string};const w=S},74372:(e,t,a)=>{a.d(t,{Z:()=>Z});var n=a(29439),r=a(83115),s=a(59775),l=a(92504),o=a(49739),c=a(83826),i=a(23393),u=a(45697),m=a.n(u),f=a(22491),d=a.n(f),p=a(71478),v=a(78733),g=a(91709),E=a(74806),b=a(30893),y=function(e){var t=e.cves,a=e.updateRef,u=e.intl,m=(0,f.useState)(t),E=(0,n.Z)(m,1)[0],y=(0,f.useState)("0"),Z=(0,n.Z)(y,2),h=Z[0],S=Z[1],w=(0,f.useState)(),N=(0,n.Z)(w,2),M=N[0],k=N[1],O=(0,f.useCallback)((function(){k(E&&1===E.length&&E[0].justification||"")}),[E]);(0,f.useEffect)((function(){S(E&&1===E.length&&E[0].business_risk_id.toString()||"0"),O()}),[t,O,E]),(0,f.useEffect)(O,[O]);var P=function(e,t){var a=t.currentTarget.value;S(a)},x={variant:"success",title:u.formatMessage(b.Z.notificationBusinessRiskUpdateSuccessful,{count:E.length||0})},R={variant:"danger",autoDismiss:!1,title:u.formatMessage(b.Z.notificationBusinessRiskUpdateFailureTitle),description:u.formatMessage(b.Z.notificationBusinessRiskUpdateFailureBody)};return d().createElement(g.ZP,{items:E,onSave:function(){return(0,p.le)({business_risk_id:parseInt(h),cve:E.map((function(e){return e.id})),business_risk_text:M}).then(a).catch((function(e){throw e}))},onSuccessNotification:x,onFailureNotification:R,title:u.formatMessage(b.Z.businessRiskModalTitle),ouiaId:"business-risk-modal"},d().createElement(o.K,{hasGutter:!0},d().createElement(c.v,null,u.formatMessage(b.Z.businessRiskModalInfo)),d().createElement(c.v,null,d().createElement(r.l,null,d().createElement(s.c,{label:u.formatMessage(b.Z.businessRiskLabel),fieldId:"businessRiskId"},v.eF.map((function(e){return d().createElement(l.Y,{className:"business-risk-radio",value:e.value,isChecked:h===e.value,onChange:P,label:e.label,key:e.value,id:e.value,name:e.label,"aria-label":e.label,ouiaId:"business-risk-radio"})}))),d().createElement(s.c,{label:u.formatMessage(b.Z.justificationLabel),fieldId:"label"},d().createElement(i.Kx,{type:"text",onChange:function(e){k(e)},value:M,resizeOrientation:"vertical","aria-label":"justification",style:{minHeight:"2.25rem"}}))))))};y.propTypes={cves:m().array,updateRef:m().func,intl:m().any};const Z=(0,E.ZP)(y)},19738:(e,t,a)=>{a.d(t,{Z:()=>w});var n=a(29439),r=a(93149),s=a(83115),l=a(59775),o=a(79851),c=a(34512),i=a(49739),u=a(83826),m=a(35224),f=a(53688),d=a(91290),p=a(45697),v=a.n(p),g=a(22491),E=a.n(g),b=a(71478),y=a(91709),Z=a(74806),h=a(30893),S=function(e){var t=e.cves,a=e.updateRef,p=e.intl,v=e.canEditPairStatus,Z=(0,g.useState)(t),S=(0,n.Z)(Z,1)[0],w=(0,y.Hb)(S&&S.every((function(e){return e.status_id===S[0].status_id}))&&S[0].status_id.toString()||"0"),N=w.StatusSelect,M=w.statusId,k=w.setProps,O=(0,y.fj)(S&&S.every((function(e){return e.justification===S[0].justification}))&&S[0].justification||""),P=O.JustificationInput,x=O.justification,R=(0,g.useState)(!1),j=(0,n.Z)(R,2),C=j[0],_=j[1],V=S.filter((function(e){return e.exposed_systems_count>0})).map((function(e){return e.id}));(0,g.useEffect)((function(){k({ouiaId:"status-select"})}),[k]);var L={variant:"success",title:p.formatMessage(h.Z.notificationStatusUpdateSuccessful,{count:S.length||0})},D={variant:"danger",autoDismiss:!1,title:p.formatMessage(h.Z.notificationStatusUpdateFailureTitle),description:p.formatMessage(h.Z.notificationStatusUpdateFailureBody)},I=p.formatMessage(h.Z.cveStatusModalTitle,{count:S.length||0});return E().createElement(y.ZP,{items:S,onSave:function(){return Promise.all([(0,b.xn)({cve:S.map((function(e){return e.id})),status_id:parseInt(M),status_text:x})].concat([!C&&V.length>0&&v&&(0,b.cr)({cve:V,status_id:parseInt(M),status_text:x})])).then((function(){return a(!C)})).catch((function(e){throw e}))},onSuccessNotification:L,onFailureNotification:D,title:I,ouiaId:"status-modal"},E().createElement(i.K,{hasGutter:!0},E().createElement(u.v,null,p.formatMessage(h.Z.cveStatusModalSelected,{count:S.length||0,cveId:S[0].id,b:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return E().createElement("b",null,t)}})),E().createElement(u.v,null,E().createElement(f.ZP,{className:"pf-u-mr-xs",fontSize:"var(--pf-global--FontSize--md)",color:"var(--pf-global--active-color--300)"}),p.formatMessage(h.Z.cveStatusModalInfo,{count:S.length||0}),E().createElement(m.u,{content:p.formatMessage(h.Z.cveStatusModalInfoTooltip)},E().createElement(d.ZP,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)"}))),E().createElement(u.v,null,E().createElement(s.l,{key:"key"},N,P,V.length>0&&v&&E().createElement(l.c,{fieldId:"overwrite"},E().createElement(o.P,null,E().createElement(c.J,null,E().createElement(r.X,{label:p.formatMessage(h.Z.cveStatusModalOverwriteCheckbox),id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:C,onChange:function(e){return _(e)}})),E().createElement(c.J,null,E().createElement(m.u,{content:p.formatMessage(h.Z.cveStatusModalOverwriteTooltip)},E().createElement(d.ZP,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)",style:{verticalAlign:"0"}})))))))))};S.propTypes={cves:v().array,updateRef:v().func,intl:v().any,canEditPairStatus:v().bool.isRequired};const w=(0,Z.ZP)(S)},57998:(e,t,a)=>{a.d(t,{K:()=>f});var n=a(4942),r=a(18535),s=a(75910),l=a(77043),o=a.n(l);function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={columns:[],rows:[],entities:[],loaded:!1,tagsLoaded:!1,allTagsLoaded:!1,invConfig:{},sortBy:{key:"updated",direction:"desc"},page:1,perPage:20,selectedRows:{},prevLoadedRows:[],selectedRowsRawData:[],selectedRowsCount:0};function m(e,t,a){var n=e.find((function(e){return"advisory"===e.key}));return t.selectedRows||(t.selectedRows={}),t.sortBy||(t.sortBy={key:"updated",direction:"desc"}),t.loaded?(!t.rows.some((function(e){return e.patchAccess}))&&n&&(n.isShown=!1),i(i({},t),{},{columns:e,rows:t.rows.map((function(e){return i(i({},e),{},{selected:t.selectedRows[e.id]||!1})})),prevLoadedRows:o()(a.payload.results,t.prevLoadedRows,"id"),meta:a.payload.meta})):t}var f=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,a=arguments.length>1?arguments[1]:void 0,n=i({},t);switch(a.type){case s.LY+"_FULFILLED":return m(e,n,a);case s.pr:return(0,r.hd)(n,a);case s.xC:return i(i({},n),{},{rows:n.rows.map((function(e){return i(i({},e),{},{isOpen:e.id===a.payload.id?a.payload.isOpen:e.isOpen})}))});case s.t2:return u;default:return n}}}}}]);
//# sourceMappingURL=../sourcemaps/CVEDetailsPage.6d48e5db172921776632eb6a55620f14.js.map