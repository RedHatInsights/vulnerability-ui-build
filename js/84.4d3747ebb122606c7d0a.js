"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[84],{75201:(e,t,r)=>{r.d(t,{Z:()=>f});var n=r(77865),a=r.n(n),o=r(45697),s=r.n(o),i=r(74093),u=r(80167),l=r(30893),c=r(22408),p=function(e){var t=e.hasRule,r=e.hasExploit;return a().createElement(i.G7,null,r&&a().createElement(i.xv,{style:u.Z.footer},(0,c.aR)(l.Z.knownExploitPDFFooter)),t&&a().createElement(i.xv,{style:u.Z.footer},(0,c.aR)(l.Z.securityRulePDFFooter)))};p.propTypes={hasRule:s().bool,hasExploit:s().bool};const f=p},33084:(e,t,r)=>{r.d(t,{Z:()=>F});var n=r(87462),a=r(93433),o=r(4942),s=r(15861),i=r(29439),u=r(45987),l=r(87757),c=r.n(l),p=r(77865),f=r.n(p),b=r(45697),v=r.n(b),m=r(86896),d=r(3968),h=r(71478),g=r(29648),y=r(22408),Z=r(30893),_=r(43198),w=r(62598),D=r(75201),k=r(62215),P=r(78733),R=r(37450),x=["filters","params","reportData","buttonProps","isReportDynamic","label"];function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var j=function(e){var t=e.filters,r=e.params,o=e.reportData,l=void 0===o?{}:o,b=e.buttonProps,v=e.isReportDynamic,O=void 0!==v&&v,j=e.label,F=(0,u.Z)(e,x),M=(0,m.Z)(),S=(0,p.useState)(!1),T=(0,i.Z)(S,2),C=T[0],N=T[1],H=(0,p.useState)(!1),A=(0,i.Z)(H,2),U=A[0],z=A[1],B=(0,p.useState)(!1),G=(0,i.Z)(B,2),L=G[0],q=G[1],I=(0,R.lm)(),J=(0,i.Z)(I,2),K=J[0],Q=J[1];(0,p.useEffect)((function(){N(!0),K({msg:M.formatMessage(Z.Z.notificationReportDownloadStart)})}),[]);var V=function(e){return(0,g.F3)(e,P.tp.otherPages,(function(e){var t=e.attributes;return t.rules.length>0||t.known_exploit?P.tp.labelsHeightMultiplier:1}))},W=function(){var e=(0,s.Z)(c().mark((function e(){var n,o,s,i,u,p,f,b;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,h.dH)(E(E(E({},r),k.Z.defaultParams),{},{sort:r.sort||"-cvss_score",affecting:"true"}));case 3:s=e.sent,n=s.data,o=s.meta,e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(0),Q(),K({variant:"danger",autoDismiss:!1,msg:M.formatMessage(Z.Z.notificationReportDownloadFailureTitle),description:M.formatMessage(Z.Z.notificationReportDownloadFailureBody)}),e.abrupt("return",[]);case 13:if(!l||!l.userNotes){e.next=17;break}return e.next=16,insights.chrome.auth.getUser();case 16:i=e.sent;case 17:return u=function(e,t){return t.knownExploitCount=e.filter((function(e){return!0===e.attributes.known_exploit})).length,e.map((function(e){var r;return t.hasRule||(t.hasRule=e.attributes.rules.length>0),E(E({},e),{},{attributes:E(E({},e.attributes),{},{status:P.Em.find((function(t){return t.value===e.attributes.status_id.toString()})).label,business_risk:P.eF.find((function(t){return t.value===e.attributes.business_risk_id.toString()})).label,impact:(null===(r=P.cv[e.attributes.impact])||void 0===r?void 0:r.title)||M.formatMessage(Z.Z.impactListUnknown),cvss_score:parseFloat(e.attributes.cvss3_score||e.attributes.cvss2_score).toFixed(1)})})}))},p=u(n,o),z((function(){var e;return O?o.hasRule&&l&&(null===(e=l.header)||void 0===e?void 0:e.includes("rule_presence")):o.hasRule})),q((function(){var e;return O?o.knownExploitCount>0&&l&&(null===(e=l.header)||void 0===e?void 0:e.includes("known_exploit")):o.knownExploitCount>0})),f=(0,_.Z)({data:p.splice(0,(0,y.rg)(l,r)),meta:o,filters:t,intl:M,isReportDynamic:O,reportData:l,user:i,type:"cves"}),b=V(p),N(!1),Q(),K({variant:"success",msg:M.formatMessage(Z.Z.notificationReportDownloadSuccess)}),e.abrupt("return",[f].concat((0,a.Z)(b.map((function(e,t){return(0,w.Z)({data:e,page:t,intl:M,header:l&&l.header,type:"cves",isReportDynamic:O})})))));case 27:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return f().createElement("div",null,f().createElement(d.o6,(0,n.Z)({fallback:null,orientation:"landscape",size:"A4",type:"",fileName:"".concat(k.Z.filename(O?"reports":""),".pdf"),buttonProps:E({component:"button"},b),asyncFunction:W,allPagesHaveTitle:!1,footer:f().createElement(D.Z,{intl:M,hasRule:U,hasExploit:L}),reportName:O?l.reportTitle:M.formatMessage(Z.Z.cvePDFReportName),label:C?M.formatMessage(Z.Z.loading):M.formatMessage(j)},F)))};j.defaultProps={label:Z.Z.kebabExportAsPDF},j.propTypes={filters:v().oneOfType([v().array,v().object]),params:v().object,reportData:v().object,buttonProps:v().object,label:v().oneOfType([v().array,v().object]),isReportDynamic:v().bool};const F=j}}]);
//# sourceMappingURL=../sourcemaps/84.d328b8f63bf10fca4cd86077fdca2726.js.map