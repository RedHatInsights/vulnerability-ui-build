(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[322],{78132:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>fe});var a=r(63038),n=r.n(a),s=r(25558),l=r.n(s),o=r(50693),c=r(16475),i=r(32203),u=r(70),m=r(62394),p=r(49734),f=r(44510),d=r(82442),v=r(87757),y=r.n(v),g=r(319),E=r.n(g),b=r(48926),Z=r.n(b),x=r(86896),h=r(58141),C=r(92339),M=r(18623),S=r(59713),R=r.n(S),_=r(45697),N=r.n(_),T=r(59912),D=r(89478),k=r(89736),O=r(94949),w=function(e){var t=e.counter,r=e.label;return l().createElement(k.G7,null,l().createElement(k.xv,{style:O.Z.counter},t),l().createElement(k.xv,{style:O.Z.counterLabel},r))};w.propTypes={counter:N().number,label:N().string};const j=w;var P=function(e){var t=e.data,r=e.intl,a=t.totalSystems,n=t.totalCves,o=t.totalRules;return l().createElement(s.Fragment,{key:"exec-first-page"},l().createElement(k.xv,{style:[O.Z.generated,O.Z.mb24]},r.formatMessage(M.Z.executiveReportGenerated,{date:(0,D.t6)({date:new Date,type:"exact"}).props.children})),l().createElement(k.xv,{style:O.Z.mb16},r.formatMessage(M.Z.executiveReportHeader)),l().createElement(k.xv,{style:O.Z.mb8},r.formatMessage(M.Z.executiveReportSubHeader,{systems:l().createElement(k.xv,{style:O.Z.bold},r.formatMessage(M.Z.executiveReportHeaderSystems,{systems:a})),cves:l().createElement(k.xv,{style:O.Z.bold},r.formatMessage(M.Z.executiveReportHeaderCVEs,{cves:n})),rules:l().createElement(k.xv,{style:O.Z.bold},r.formatMessage(M.Z.executiveReportHeaderRules,{rules:o}))})),l().createElement(h.$0,{withColumn:!1},l().createElement(h.s_,null,l().createElement(h.Lv,{style:O.Z.counterPanel},l().createElement(j,{counter:a,label:r.formatMessage(M.Z.executiveReportAnalyzedSystems,{systems:a})})),l().createElement(h.Lv,{style:O.Z.counterPanel},l().createElement(j,{counter:n,label:r.formatMessage(M.Z.executiveReportAnalyzedCVEs,{cves:n})})),l().createElement(h.Lv,{style:O.Z.counterPanel},l().createElement(j,{counter:o,label:r.formatMessage(M.Z.executiveReportAnalyzedRules,{rules:o})})))))};P.propTypes={data:N().exact({totalSystems:N().number,totalCves:N().number,totalRules:N().number}),intl:N().any};const H=P;var L=r(39138),I=r.n(L),F=function(e){var t=e.data,r=e.intl,a=t.recentCvesData,o=t.CVSSChart,c=t.CVSSData,i=t.CVSSHeader,u=t.topCves;return l().createElement(s.Fragment,{key:"first-section"},l().createElement(k.xv,{style:O.Z.header},r.formatMessage(M.Z.cvesHeader)),l().createElement(h.$0,{title:r.formatMessage(M.Z.executiveReportCvesByCVSS)},l().createElement(h.sg,null,l().createElement(h.kL,{chartType:"pie",subTitle:"Cves",title:"100",data:o})),l().createElement(h.sg,null,l().createElement(h.iA,{withHeader:!0,rows:[i].concat(E()(c))}))),l().createElement(h.$0,{title:r.formatMessage(M.Z.executiveReportRecentlyPublishedCves)},l().createElement(h.s_,{style:{flex:1}},a.map((function(e){var t=n()(e,2),r=t[0],a=t[1];return l().createElement(s.Fragment,{key:r},l().createElement(h.Lv,{style:{flex:1},title:r},a))})))),l().createElement(h.$0,{title:r.formatMessage(M.Z.executiveReportTop3),withColumn:!1},u.map((function(e){return l().createElement(h.s_,{key:e.synopsis,title:e.synopsis,description:(t=e.description,l().createElement(k.xv,{style:O.Z.mb8}," ",I()(t,{length:300})))},l().createElement(h.Lv,{title:r.formatMessage(M.Z.executiveReportPanelTitle)},Number.parseFloat(e.cvss3_score).toFixed(1)),l().createElement(h.Lv,{title:r.formatMessage(M.Z.systemsExposed)},e.systems_affected.toString()));var t}))))};F.propTypes={data:N().exact({recentCvesData:N().array,CVSSChart:N().array,CVSSData:N().array,CVSSHeader:N().array,topCves:N().array}),intl:N().any};const B=F;var V=function(e){var t=e.data,r=e.intl,a=function(e,t){return l().createElement(s.Fragment,null,l().createElement(k.xv,{style:O.Z.mb8}," ",I()(e,{length:300})),l().createElement(k.xv,null,r.formatMessage(M.Z.associatedCves)," ",t.map((function(e){return e})).join(", ")))},n=t.topRules,o=t.rulesHeader,c=t.rulesBySeverityMap;return l().createElement(s.Fragment,{key:"first-section"},l().createElement(k.xv,{style:O.Z.header},r.formatMessage(M.Z.rules)),l().createElement(h.$0,{title:r.formatMessage(M.Z.executiveReportRulesSection)},l().createElement(h.sg,null,l().createElement(h.iA,{withHeader:!0,rows:[o].concat(E()(c))}))),l().createElement(h.$0,{title:r.formatMessage(M.Z.executiveReportTop3Rules),withColumn:!1},n.map((function(e,t){return l().createElement(h.s_,{key:t,title:e.name,description:a(e.description,e.associated_cves)},l().createElement(h.Lv,{title:r.formatMessage(M.Z.executiveReportRulePanelTitle)},l().createElement(h.Uc,{variant:e.severity-1})),l().createElement(h.Lv,{title:r.formatMessage(M.Z.systemsExposed)},e.systems_affected.toString()))}))))};V.propTypes={data:N().exact({topRules:N().array,rulesHeader:N().array,rulesBySeverityMap:N().array}),intl:N().any};const z=V;function W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?W(Object(r),!0).forEach((function(t){R()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var A=function(e){var t=e.data,r=e.intl,a=t.cves_by_severity,s=t.recent_cves,o=t.top_cves,c=t.cves_total,i=t.system_count,u=t.top_rules,m=t.rules_total,p=t.rules_by_severity,f=Object.keys(p).map((function(e){return[T.q[e]].concat(E()(Object.values(p[e]).map((function(e){return e.toString()}))))})),d=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[];for(var s in e){var l=e[s],o=t[s],c=void 0!==o.count?o.count:o;"na"===s&&0===c||(a&&o.percentage&&(c="number"===a?o.percentage:r.formatMessage(M.Z.executiveReportOfTotal,{count:c,percentage:o.percentage})),n.push([l,c.toString()]))}return n},v={totalSystems:i,totalCves:c,totalRules:m},y={recentCvesData:d(T.YM,$({},s)),CVSSChart:d(T.cL,$({},a),"number").map((function(e){var t=n()(e,2),r=t[0],a=t[1];return{x:"CVSS ".concat(r),y:Number(a)}})),CVSSData:d(T.cL,$({},a),"string"),CVSSHeader:T.rs,topCves:o},g={topRules:u,rulesHeader:T.$D,rulesBySeverityMap:f};return[l().createElement(H,{key:"first-page",intl:r,data:v}),l().createElement(B,{key:"second-page-cves",intl:r,data:y}),l().createElement(z,{key:"third-page-rules",intl:r,data:g})]};A.propTypes={data:N().exact({cves_by_severity:N().object,recent_cves:N().object,top_cves:N().array,cves_total:N().number,system_count:N().number}),intl:N().any};const G=A;var U=r(276),X=r(83215);const K=function(){var e=(0,x.Z)(),t=(0,s.useState)(!1),r=n()(t,2),a=r[0],o=r[1],c=(0,s.useState)(!1),i=n()(c,2),u=i[0],m=i[1],p=(0,U.useDispatch)(),f=function(){var t=Z()(y().mark((function t(){var r,a;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o(!0),p((0,X.wN)({dismissable:!0,variant:"info",title:e.formatMessage(M.Z.downloadExecutiveNotification)})),t.next=4,(0,C.nK)();case 4:return r=t.sent,a=G({data:r,intl:e}),o(!1),t.abrupt("return",E()(a));case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=(new Date).toISOString().split("T"),v=n()(d,1)[0];return l().createElement(s.Fragment,null,l().createElement("a",{onClick:function(){m(!0)}},e.formatMessage(M.Z.executiveReportCardButton)),u&&l().createElement(h.o6,{groupName:"Red Hat Insights",showButton:!1,label:a?e.formatMessage(M.Z.loading):e.formatMessage(M.Z.executiveReportCardButton),asyncFunction:f,buttonProps:{variant:"link",isInline:!0},type:e.formatMessage(M.Z.vulnerabilitiesHeader),fileName:"vulnerability_executive-report--".concat(v,".pdf"),allPagesHaveTitle:!1,onSuccess:function(){p((0,X.L1)()),m(!1)}}))};var q=r(80236),Y=r(47173),J=r(83115),Q=r(59775),ee=r(92607),te=r(93149),re=r(45469),ae=r(13115),ne=r(57980),se=r(11550),le=function(e){var t=e.isOpen,r=e.handleModalClose,a=e.filterData,o=e.setFilterData,c=e.handleDownloadButton,i=e.columnsToInclude,u=e.setColumnsToInclude,m=e.userNotes,p=e.setUserNotes,f=e.reportTitle,d=e.setReportTitle,v=(0,s.useState)("all"),y=n()(v,2),g=y[0],b=y[1],Z=["rule_presence","impact","cvss_filter","business_risk_id","status_id","publish_date"];return(0,s.useEffect)((function(){"all"===g&&u(Object.keys(T.jW))}),[g,u]),l().createElement(q.u,{width:"50rem",title:se.N.formatMessage(M.Z.configModalTitle),ouiaId:"custom-report-modal",isOpen:t,onClose:r,actions:[l().createElement(Y.zx,{key:"export",variant:"primary",onClick:c,isDisabled:a.cvss_filter.from<0||a.cvss_filter.to>10||a.cvss_filter.from>a.cvss_filter.to||m.length>T.Z0},se.N.formatMessage(M.Z.configModalExportReport)),l().createElement(Y.zx,{key:"cancel",variant:"secondary",onClick:r},se.N.formatMessage(M.Z.cancel))]},l().createElement(J.l,null,l().createElement(Q.c,{label:se.N.formatMessage(M.Z.customReportTitleLabel),fieldId:"horizontal-form-name"},l().createElement(ee.oi,{value:f,onChange:function(e){return d(e)},type:"text",className:"report-text-input",id:"horizontal-form-name"})),l().createElement(Q.c,{label:se.N.formatMessage(M.Z.customReportFilterDataByLabel)},l().createElement("div",{className:"custom-report-filter-wrapper"},Z&&Z.map((function(e){var t;return null===(t=T.jW[e])||void 0===t?void 0:t.component({filterData:a,setFilterData:o,selectProps:{className:"pf-u-mr-sm pf-u-mb-sm"},options:T.jW[e].items,filterId:e,filterName:T.jW[e].title})})))),l().createElement(Q.c,{label:se.N.formatMessage(M.Z.customReportDataToIncludeLabel)},l().createElement(ae.t,{"aria-label":"Default with single selectable"},l().createElement(ne.G,{text:se.N.formatMessage(M.Z.customReportDataToggleAll),isSelected:"all"===g,onChange:function(){return b("all")}}),l().createElement(ne.G,{text:se.N.formatMessage(M.Z.customReportDataToggleCustom),isSelected:"custom"===g,onChange:function(){return b("custom")}})),"custom"===g&&l().createElement("div",{style:O.Z.collumns},l().createElement(te.X,{id:"cve_id",label:"CVE ID",isChecked:!0,isDisabled:!0,className:"pf-u-mb-md"}),Object.entries(T.jW).map((function(e){var t=n()(e,2),r=t[0],a=t[1];return l().createElement(te.X,{id:r,key:r,label:a.title,isChecked:i.includes(r),onChange:function(e){return function(e,t){u(t?[].concat(E()(i),[e]):i.filter((function(t){return t!==e})))}(r,e)},className:"pf-u-mb-md"})})))),l().createElement(Q.c,{label:se.N.formatMessage(M.Z.customReportUserNotesLabel),fieldId:"user-notes-box",helperTextInvalid:se.N.formatMessage(M.Z.customReportUserNoteTooLong),validated:m.length>T.Z0&&"error"},l().createElement(re.Kx,{value:m,onChange:function(e){return p(e)},type:"text",id:"user-notes-box",className:"report-text-input",resizeOrientation:"vertical",style:{minHeight:"4em"},validated:m.length>T.Z0&&"error"}))))};le.propTypes={isOpen:N().bool,filterData:N().object,setFilterData:N().func,handleModalClose:N().func,handleDownloadButton:N().func,columnsToInclude:N().array,setColumnsToInclude:N().func,userNotes:N().string,setUserNotes:N().func,reportTitle:N().string,setReportTitle:N().func};const oe=le,ce=(r.p,r.p+"fonts/chart-pie-solid.svg");N().object;var ie=function(e){var t=e.style;return l().createElement("img",{style:t,src:ce,alt:"Static pie solid"})};ie.propTypes={style:N().object};var ue=r(91067),me=r(66780),pe=r(37330);const fe=function(){var e=(0,s.useState)(!1),t=n()(e,2),r=t[0],a=t[1],v=(0,s.useState)(!1),y=n()(v,2),g=y[0],E=y[1],b=(0,s.useState)(se.N.formatMessage(M.Z.customReportDefaultTitle)),Z=n()(b,2),x=Z[0],h=Z[1],C=(0,s.useState)(""),S=n()(C,2),R=S[0],_=S[1],N=(0,s.useState)(Object.keys(T.jW)),D=n()(N,2),k=D[0],w=D[1],j=(0,s.useState)(T.OX),P=n()(j,2),H=P[0],L=P[1],I=function(){h(se.N.formatMessage(M.Z.customReportDefaultTitle)),_(""),w(Object.keys(T.jW)),L(T.OX),E(!1),a(!1)};return(0,s.useEffect)((function(){var e,t,r;null===(e=insights)||void 0===e||null===(t=e.chrome)||void 0===t||null===(r=t.hideGlobalFilter)||void 0===r||r.call(t)})),l().createElement(l().Fragment,null,l().createElement(ue.Z,{title:se.N.formatMessage(M.Z.reportsPageTitle),showBreadcrumb:!1}),l().createElement(f.o,null,l().createElement(o.r,{hasGutter:!0,lg:3,md:4,sm:12},l().createElement(c.P,null,l().createElement(i.Z,{className:"report-card"},l().createElement(u.l,null,l().createElement(ie,{style:O.Z.pieChartIcon}),l().createElement("span",{className:"pf-u-ml-sm",style:O.Z.cardTitle},se.N.formatMessage(M.Z.executiveReportCardTitle))),l().createElement(m.e,null,se.N.formatMessage(M.Z.executiveReportCardDescription)),l().createElement(p.e,null,l().createElement(K,null)))),l().createElement(c.P,null,l().createElement(i.Z,{className:"report-card"},l().createElement(u.l,null,l().createElement(d.ZP,{size:"lg",color:"var(--pf-global--link--Color)"}),l().createElement("span",{className:"pf-u-ml-sm",style:O.Z.cardTitle},se.N.formatMessage(M.Z.customReportCardTitle))),l().createElement(m.e,null,se.N.formatMessage(M.Z.customReportCardDescription)),l().createElement(p.e,null,l().createElement("a",{className:"create-report",onClick:function(){return a(!0)}},se.N.formatMessage(M.Z.customReportCardButton))))))),l().createElement(oe,{isOpen:r,columnsToInclude:k,setColumnsToInclude:w,filterData:H,userNotes:R,reportTitle:x,setReportTitle:h,setUserNotes:_,setFilterData:L,handleModalClose:I,handleDownloadButton:function(){E(!0),a(!1)}}),g&&l().createElement(me.Z,{type:"cves",key:"download",reportData:{header:k,reportTitle:x,userNotes:R},showButton:!1,onSuccess:I,params:(0,pe.pX)(H),filters:(0,pe._R)(H),isReportDynamic:!0,label:M.Z.configModalExportReport}))}}}]);
//# sourceMappingURL=Reports.0c7b752e6f605550d92f.js.map