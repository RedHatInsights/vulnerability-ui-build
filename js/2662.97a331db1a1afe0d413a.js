(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[2662],{66516:(t,e,n)=>{"use strict";n.d(e,{Z:()=>j});var s=n(28481),i=n(93149),r=n(83115),a=n(59775),u=n(49739),c=n(83826),o=n(43547),l=n(79851),f=n(35224),d=n(34512),v=n(42065),m=n(45697),y=n.n(m),p=n(77865),_=n.n(p),h=n(71478),g=n(91709),Z=n(74806),E=n(30893),b=function(t){var e=t.cveList,n=t.updateRef,m=t.inventoryList,y=t.intl,Z=t.type,b=(0,g.fj)(J()),j=b.JustificationInput,P=b.justification,k=b.setJustification,S=b.setProps,C=(0,p.useState)(function(){switch(Z){case"systemsExposed":if(m.every((function(t){return t.status_id===e[0].status_id&&t.justification===e[0].justification})))return!0;break;case"systemDetail":var t=e.every((function(t,e,n){return t.status_id===n[0].status_id&&t.justification===n[0].justification})),n=e.every((function(t){return t.status_id===t.cve_status_id&&t.justification===t.cve_justification}));if(t&&n)return!0}return!1}()),I=(0,s.Z)(C,2),M=I[0],x=I[1],w=(0,g.Hb)(A()),R=w.StatusSelect,T=w.statusId,N=w.setStatusId,D=w.setProps,O=m.map((function(t){return t.id||t.inventory_id})),L=m.map((function(t){return t.display_name}));function A(){switch(Z){case"systemsExposed":return M?e[0].status_id:m.every((function(t,e,n){return t.status_id===n[0].status_id}))?m[0].status_id:"0";case"systemDetail":return M?e.every((function(t,e,n){return t.cve_status_id===n[0].cve_status_id}))?e[0].cve_status_id:"0":e.every((function(t,e,n){return t.status_id===n[0].status_id}))?e[0].status_id:"0"}}function J(){switch(Z){case"systemsExposed":return M?e[0].justification:m.every((function(t,e,n){return t.justification===n[0].justification}))&&m[0].justification||"";case"systemDetail":return M?e.every((function(t,e,n){return t.cve_justification===n[0].cve_justification}))&&e[0].cve_justification||"":e.every((function(t,e,n){return t.justification===n[0].justification}))&&e[0].justification||""}}(0,p.useEffect)((function(){D({isDisabled:M,ouiaId:"status-select"}),S({disabled:M}),N(A()),k(J())}),[M,D,S]);var U={variant:"success",title:y.formatMessage(E.Z.cvePairStatusModalUpdateSuccessful)},B=y.formatMessage(E.Z.cvePairStatusModalTitle,{count:O.length*e.length});return _().createElement(g.ZP,{items:e,onSave:function(){var t=e.map((function(t){return t.id})),s=M?{cve:t,inventory_id:O}:{status_id:parseInt(T),cve:t,status_text:P,inventory_id:O};return(0,h.cr)(s).then(n)},onSuccessNotification:U,title:B,ouiaId:"status-modal"},_().createElement(u.K,{hasGutter:!0},function(){switch(Z){case"systemsExposed":return m.some((function(t,e,n){return t.status_id!==n[0].status_id}));case"systemDetail":return e.some((function(t,e,n){return t.status_id!==n[0].status_id}))}}()&&_().createElement(c.v,null,_().createElement(o.b,{variant:"warning",isInline:!0,title:y.formatMessage(E.Z.cvePairStatusModalAlert)})),_().createElement(c.v,null,y.formatMessage(E.Z.cvePairStatusModalSelected,{cveCount:e.length||0,cveId:e[0].id,systemCount:m.length||0,systemName:L[0],b:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return _().createElement("b",null,e)}})),_().createElement(c.v,null,_().createElement(r.l,{key:"key"},_().createElement(a.c,{fieldId:"overall"},_().createElement(l.P,null,_().createElement(d.J,null,_().createElement(i.X,{label:y.formatMessage(E.Z.cvePairStatusModalUseOverallCheckbox),id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:M,onChange:function(t){return x(t)}})),_().createElement(d.J,null,_().createElement(f.u,{content:y.formatMessage(E.Z.cvePairStatusModalUseOverallTooltip)},_().createElement(v.ZP,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)",style:{verticalAlign:"0"}}))))),R,j))))};b.propTypes={cveList:y().array,updateRef:y().func,inventoryList:y().array,intl:y().any,type:y().oneOf(["systemsExposed","systemDetail"])};const j=(0,Z.ZP)(b)},16493:(t,e,n)=>{"use strict";n.d(e,{Z:()=>j});var s=n(28481),i=n(85061),r=n(6610),a=n(5991),u=n(10379),c=n(46070),o=n(77608),l=n(77865),f=n.n(l),d=n(45697),v=n.n(d),m=n(83215),y=n(49953),p=n(16712),_=n(36873),h=n(14494),g=n(30893),Z=n(44012),E=n(29648);var b=function(t){(0,u.Z)(d,t);var e,n,l=(e=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,s=(0,o.Z)(e);if(n){var i=(0,o.Z)(this).constructor;t=Reflect.construct(s,arguments,i)}else t=s.apply(this,arguments);return(0,c.Z)(this,t)});function d(){var t,e;(0,r.Z)(this,d);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return(0,c.Z)(e,(t=e=l.call.apply(l,[this].concat(a)),e.baseIssueTemplate=function(t,e){return{id:"vulnerabilities:".concat(t),description:t,systems:[e]}},e.remediationProvider=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=[].concat(t),u=[].concat(n),c=[];if(r&&1===a.length&&(c=u.reduce((function(t,n){var s,r=n.id,a=n.cve,u=n.rule,c=e.baseIssueTemplate(a,r);return u&&(c.id="".concat(c.id,":").concat(null==u||null===(s=u.rule)||void 0===s?void 0:s.rule_id)),[].concat((0,i.Z)(t),[c])}),[]),c=(0,E.X8)(c,"systems")),!r&&1===(null==u?void 0:u.length)){var o=(0,s.Z)(u,1),l=o[0];c=a.reduce((function(t,n){var s=n.id,r=n.rules,a=e.baseIssueTemplate(s,l);return null!=r&&r.rule_id&&(a.id="".concat(a.id,":").concat(r.rule_id)),[].concat((0,i.Z)(t),[a])}),[])}return!(!a.length||!u.length)&&{issues:c}},t))}return(0,a.Z)(d,[{key:"shouldComponentUpdate",value:function(t){return t.cves!==this.props.cves||t.systems!==this.props.systems}},{key:"render",value:function(){var t=this,e=this.props,n=e.cves,s=e.systems,i=e.manyRules,r=e.addNotification;return f().createElement("div",null,f().createElement(y.Z,{dataProvider:function(){return t.remediationProvider(n,s,i)},isDisabled:0===n.length||0===s.length,onRemediationCreated:function(t){return r(t.getNotification())}},f().createElement(p.ZP,{size:"sm",color:"var(--pf-global--BackgroundColor--100)"}),"Â ",f().createElement(Z.Z,g.Z.remediateLabel)))}}]),d}(l.Component);b.propTypes={cves:v().oneOfType([v().array,v().string]),systems:v().oneOfType([v().array,v().string]),addNotification:v().func,manyRules:v().bool};const j=(0,h.connect)(null,(function(t){return{addNotification:function(e){return t((0,m.wN)(e))}}}))((0,_.Z)(b))}}]);
//# sourceMappingURL=../sourcemaps/2662.488bdfa61c1b0c752346.js.map