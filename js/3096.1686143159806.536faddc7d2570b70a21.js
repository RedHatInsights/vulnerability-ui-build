(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[3096],{38463:(e,t,r)=>{"use strict";r.d(t,{Z:()=>O});var n=r(45987),a=r(77865),i=r.n(a),s=r(87441),c=r(45697),o=r.n(c),u=r(74806),l=r(91036),f=r.n(l),p=r(19535),v=r(83826),m=r(68774),d=r(78733),y=r(30893),b=["text","truncate","intl"],h=new s.TU.Renderer;h.link=function(){var e=s.TU.Renderer.prototype.link.apply(this,arguments);return e.replace("<a ",'<a target="_blank" rel="noopener noreferrer" ')},s.TU.setOptions({renderer:h});var g=function(e){var t=e.text,r=e.truncate,a=e.intl,c=(0,n.Z)(e,b);return t&&i().createElement(v.v,c,i().createElement(m.D,{className:"rule-description"},r&&t.length>d.ct?i().createElement(p.Z,{length:d.ct,expandText:a.formatMessage(y.Z.readMore),collapseText:a.formatMessage(y.Z.readLess),text:(0,s.TU)(t),spaceBetween:!0}):i().createElement("span",{dangerouslySetInnerHTML:function(e){return{__html:f()(e)}}((0,s.TU)(t))})))};g.defaultProps={truncate:!0,link:null},g.propTypes={intl:o().oneOfType([o().string,o().object]),truncate:o().bool,text:o().string.isRequired};const O=(0,u.ZP)(g)},66123:(e,t,r)=>{"use strict";r.d(t,{Z:()=>v});var n=r(77865),a=r.n(n),i=r(45697),s=r.n(i),c=r(56700),o=r(15984),u=r(2443),l=r(24788),f=r(78733),p=function(e){var t=e.code;switch(parseInt(t)){case 403:return a().createElement(l.bY,{serviceName:f.m_});case 404:return a().createElement(c.Z,null);case 500:case 502:case 503:return a().createElement(o.Z,null);default:return a().createElement(u.Z,null)}};p.propTypes={code:s().oneOf([s().number,s().string])};const v=p},95351:(e,t,r)=>{"use strict";r.d(t,{Z:()=>f});var n=r(4942),a=r(29439),i=r(83237),s=r(32132),c=r(23279),o=r.n(c),u=r(77865),l=r.n(u);const f=function(e,t,r,c,u){var f=l().useState(),p=(0,a.Z)(f,2),v=p[0],m=p[1],d=l().useState((function(){return o()((function(t){var r;void 0!==t&&u((r={},(0,n.Z)(r,e,t),(0,n.Z)(r,"page",1),r))}),400)})),y=(0,a.Z)(d,1)[0];return l().useEffect((function(){return m(c)}),[c]),{type:i.Y.text,label:s.N.formatMessage(t),key:e,filterValues:{"aria-label":"search-field",id:"search-".concat(t.id),onChange:function(e,t){m(t),y(t)},placeholder:s.N.formatMessage(r),value:v}}}},16369:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(4942),a=r(87462),i=r(83237),s=r(78733),c=r(32132),o=r(30893),u=r(2883),l=r.n(u),f=r(18446),p=r.n(f);function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3?arguments[3]:void 0,u=(0,a.Z)({},n),f=[];t.rule_presence&&(f=f.concat(t.rule_presence.split(","))),t.rule&&(f=f.concat(t.rule.split(",")));var v=function(t){e(m(m(m({},u.isDynamic&&{rule:t.join(",")||void 0}),!u.isDynamic&&{rule_presence:t.join(",")||void 0}),{},{page:1}))},d=function(){var e=u.dropdownItems?u.dropdownItems:s.rM;return l()(e,r,p()).map((function(e){return{label:e.label,value:e.value}}))};return{label:c.N.formatMessage(o.Z.filterSecurityRules),type:i.Y.checkbox,key:"security_rule",filterValues:{onChange:function(e,t){v(t)},items:d(),value:f}}}},1792:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(83237),a=r(78733),i=r(32132),s=r(30893);const c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.status_id,c=function(t){e({status_id:t.length>"0"&&t.filter((function(e){return","!==e})).join(",")||"",page:1})};return{label:i.N.formatMessage(s.Z.filterStatus),type:n.Y.checkbox,key:"status",filterValues:{onChange:function(e,t){c(t)},items:a.Em.map((function(e){return{label:e.label,value:e.value}})),value:r?r.split(","):[]}}}},61790:(e,t,r)=>{"use strict";r.d(t,{Z:()=>f});var n=r(77865),a=r.n(n),i=r(45697),s=r.n(i),c=r(21947),o=r(86135),u=r(53411),l=function(e){var t=e.hasExploit,r=e.hasRule,n=e.isCompact;return(t||r)&&a().createElement(c.e,{className:"cve-labels-grouped--nowrap"},t&&a().createElement(o.Z,{isCompact:n}),r&&a().createElement(u.Z,{isCompact:n}))};l.propTypes={hasExploit:s().bool.isRequired,hasRule:s().bool.isRequired,isCompact:s().bool};const f=l},86135:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(4942),a=r(77865),i=r.n(a),s=r(69174),c=r(75824),o=r(45697),u=r.n(o),l=r(44012),f=r(30893);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var m=function(e){var t=e.style,r=e.className,n=e.isCompact;return i().createElement(c.u,{content:i().createElement(l.Z,f.Z.knownExploitDescription)},i().createElement(s._,{color:"red",style:v({},t),className:["cve-labels",r],isCompact:n},i().createElement(l.Z,f.Z.knownExploit)))};m.propTypes={style:u().object,className:u().string,isCompact:u().bool};const d=m},91709:(e,t,r)=>{"use strict";r.d(t,{Hb:()=>O,ZP:()=>_,fj:()=>j});var n=r(87462),a=r(29439),i=r(47173),s=r(59775),c=r(90784),o=r(22608),u=r(80236),l=r(23393),f=r(83215),p=r(45697),v=r.n(p),m=r(77865),d=r.n(m),y=r(28216),b=r(78733),h=r(30893),g=r(44012);function O(e){var t=(0,m.useState)(e),r=(0,a.Z)(t,2),i=r[0],u=r[1],l=(0,m.useState)({}),f=(0,a.Z)(l,2),p=f[0],v=f[1];return{StatusSelect:d().createElement(s.c,{label:d().createElement(g.Z,h.Z.statusLabel),fieldId:"statusId"},d().createElement(c.i,(0,n.Z)({"aria-label":"Select Input",onChange:function(e){return u(e)},value:i},p),b.Em.map((function(e){var t=e.value,r=e.label;return d().createElement(o.j,{key:t,value:t,label:r})})))),statusId:i,setStatusId:u,setProps:v}}function j(e){var t=(0,m.useState)(e),r=(0,a.Z)(t,2),i=r[0],c=r[1],o=(0,m.useState)({}),u=(0,a.Z)(o,2),f=u[0],p=u[1];return{JustificationInput:d().createElement(s.c,{label:d().createElement(g.Z,h.Z.justificationLabel),fieldId:"label"},d().createElement(l.Kx,(0,n.Z)({key:"input",type:"text",onChange:function(e){return c(e)},value:i,resizeOrientation:"vertical","aria-label":"justification note",style:{minHeight:"2.25rem"}},f))),justification:i,setJustification:c,setProps:p}}var Z=function(e){var t=e.items,r=e.title,n=e.onSave,s=e.onSuccessNotification,c=e.onFailureNotification,o=e.ouiaId,l=e.children,p=(0,m.useState)(t),v=(0,a.Z)(p,2),O=v[0],j=v[1],Z=(0,y.I0)(),_=function(){j(void 0)};return d().createElement(u.u,{variant:"small",title:r,isOpen:Boolean(O),onClose:_,actions:[d().createElement(i.zx,{key:"save",variant:"primary",ouiaId:"save",onClick:function(){n().then((function(){return Z((0,f.wN)(s))})).catch((function(e){return Z((0,f.wN)("503"===e.status?b.iF:"403"===e.status?b._V:c))})),_()}},d().createElement(g.Z,h.Z.save)),d().createElement(i.zx,{key:"cancel",variant:"secondary",ouiaId:"close",onClick:_},d().createElement(g.Z,h.Z.cancel))],ouiaId:o},l)};Z.propTypes={children:v().any,onClose:v().func,items:v().array,updateRef:v().func,title:v().string,onSave:v().func,onSuccessNotification:v().object,onFailureNotification:v().object,ouiaId:v().string};const _=Z},62215:(e,t,r)=>{"use strict";r.d(t,{Z:()=>y});var n=r(4942),a=r(15861),i=r(71002),s=r(43144),c=r(15671),o=r(64687),u=r.n(o),l=r(35240),f=r(32132),p=r(30893),v=r(78733);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const y=new((0,s.Z)((function e(){var t=this;(0,c.Z)(this,e),this.filename=function(e){var r=(new Date).toISOString().replace(/[T:]/g,"-").split(".")[0]+"-utc";switch(e){case"reports":return"vulnerability_cves-report--".concat((new Date).toISOString().split("T")[0]);case"systems-exposed":return"vulnerability_systems-exposed-".concat(t.params.cve,"--").concat(r);case"system-list":return"vulnerability_systems--".concat(r);default:return"vulnerability_cves--".concat(r)}},this.checkTypes=function(e,r,n){if("function"!=typeof e)throw"exec expects the 1st param to be funtion. Received ".concat((0,i.Z)(e));if(!t.pages.includes(r))throw"Page ".concat(r," does not exist");if(!t.formats.includes(n))throw"Format ".concat(n," is not supported")},this.exec=function(){var e=(0,a.Z)(u().mark((function e(r,n,a,i,s,c){var o,f,p,m,y;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(t.notifications.start),t.checkTypes(r,i,a),t.params.cve=(null==n?void 0:n.id)||null,e.prev=3,e.next=6,r(d(d(d(d({},n.id&&{id:n.id}),n),t.defaultParams),{},{data_format:a,report:"true"}));case 6:return o=e.sent,f=o.payload,e.next=10,f;case 10:p=e.sent,m=p.data,y="json"===a?JSON.stringify(m):m,(0,l.Sv)(y,t.filename(i),a),c(),s(t.notifications.success),e.next=23;break;case 18:throw e.prev=18,e.t0=e.catch(3),c(),s("403"===e.t0.status?v._V:t.notifications.failure),"".concat(e.t0);case 23:case"end":return e.stop()}}),e,null,[[3,18]])})));return function(t,r,n,a,i,s){return e.apply(this,arguments)}}(),this.defaultParams={page:1,page_size:Math.min(Number.MAX_SAFE_INTEGER,9007199254740991)},this.params={cve:null},this.pages=["systems-exposed","system-cves","cves","system-list"],this.formats=["csv","json"],this.notifications={start:{variant:"info",title:f.N.formatMessage(p.Z.notificationReportDownloadStart)},success:{variant:"success",title:f.N.formatMessage(p.Z.notificationReportDownloadSuccess)},failure:{variant:"danger",autoDismiss:!1,title:f.N.formatMessage(p.Z.notificationReportDownloadFailureTitle),description:f.N.formatMessage(p.Z.notificationReportDownloadFailureBody)}}})))},15248:(e,t,r)=>{"use strict";r.d(t,{A6:()=>f,DU:()=>m,HV:()=>v,Yy:()=>y,lO:()=>p,vH:()=>d});var n=r(4942),a=r(30893),i=r(78733),s=r(32132),c=r(18446),o=r.n(c);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f=function(e,t,r){return r({page:t})},p=function(e,t,r){return r({page_size:t,page:1})},v=function(e){return{onSelect:function(t,r){return e.downloadReport(r)}}},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=e.filter,n=e.advisory,c=function(e,r){return i.Oq[e].items.reduce((function(n,a){if(r===a.value)n.name=a.label,n.value=a.value;else if("rule_presence"===e){var s=t.find((function(e){return e.value===r}));["true","false",i.Zm].includes(r)?n.name=i.Oq.rule_presence.items.find((function(e){return e.value===r})).label:n.name=s&&s.label||r,n.value=r}return n}),{})},o=function(e,t){return e.reduce((function(e,r){return e.push(c(t,r)),e}),[])},u=function(e,t){return Object.keys(e).includes(t)&&!["",void 0].includes(e[t])},l=Object.keys(i.Oq).reduce((function(t,r){if("rule_presence"===r&&(u(e,"rule_presence")||u(e,"rule"))){var n=[].concat(e.rule_presence?e.rule_presence.split(","):[],e.rule?e.rule.split(","):[]);t.push({key:r,multiValue:n,category:i.Oq[r].title,chips:o(n,r)})}else if("cvss_filter"===r&&(u(e,"cvss_from")||u(e,"cvss_to"))){var a=e.cvss_from&&parseFloat(e.cvss_from).toFixed(1)||"0.0",s=e.cvss_to&&parseFloat(e.cvss_to).toFixed(1)||"10.0";"0.0"===a&&"10.0"===s||t.push({key:r,category:i.Oq[r].title,chips:[{name:"".concat(a," - ").concat(s)}]})}else if("rhel_version"===r&&u(e,"rhel_version"))t.push({key:r,multiValue:e.rhel_version.split(","),category:"Operating system",chips:e.rhel_version.split(",").map((function(e){return{value:e,name:"RHEL ".concat(e)}}))});else if(u(e,r)){var l="string"==typeof e[r]&&e[r].split(","),f=l&&l.length>1&&o(l,r)||[c(r,e[r])];t.push({key:r,multiValue:l,category:i.Oq[r].title,chips:f})}return t}),[]);return r&&l.push({key:"filter",category:s.N.formatMessage(a.Z.searchLabel),chips:[{name:r}]}),n&&l.push({key:"advisory",category:s.N.formatMessage(a.Z.advisoryName),chips:[{name:n}]}),l},d=function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(n)return e(t,r),void r(l(l({},a),{},{page:1}));var i=t.reduce((function(e,t){if("rule_presence"===t.key){var r=t.multiValue.filter((function(e){return!t.chips.some((function(t){return t.value===e}))}));e.rule_presence=r.filter((function(e){return["true","false"].includes(e)})).join(",")||"",e.rule=r.filter((function(e){return!["true","false"].includes(e)})).join(",")||""}else"filter"===t.key||"advisory"===t.key||t.multiValue&&1===t.multiValue.length?e[t.key]="":"cvss_filter"===t.key?(e.cvss_filter=void 0,e.cvss_from=void 0,e.cvss_to=void 0):e[t.key]=t.multiValue.filter((function(e){return!t.chips.some((function(t){return t.value===e}))})).join(",");return""===e[t.key]&&(e[t.key]=void 0),e}),{});r(l(l({},i),{},{page:1}))},y=function(e,t,r){return e=r.reduce((function(t,r){return l(l({},t),e[r]&&(0,n.Z)({},r,e[r]))}),{}),o()(e,t)}},81754:()=>{},21626:()=>{},91993:()=>{},54994:()=>{},44690:()=>{},37494:()=>{}}]);
//# sourceMappingURL=../sourcemaps/3096.3d4396cac2c89d3681bc98860ac3ead8.js.map