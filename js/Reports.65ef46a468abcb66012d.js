(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1229:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(12),n=r.__importStar(a(1)),l=r.__importDefault(a(1180)),s=a(20),c=a(139);var o;!function(e){e.horizontal="horizontal",e.vertical="vertical",e.both="both"}(o=t.TextAreResizeOrientation||(t.TextAreResizeOrientation={}));class i extends n.Component{constructor(e){super(e),this.handleChange=e=>{this.props.onChange&&this.props.onChange(e.currentTarget.value,e)},e.id||e["aria-label"]||console.error("TextArea: TextArea requires either an id or aria-label to be specified")}render(){const e=this.props,{className:t,value:a,onChange:i,validated:u,isRequired:m,resizeOrientation:f}=e,p=r.__rest(e,["className","value","onChange","validated","isRequired","resizeOrientation"]),d="resize"+c.capitalize(f);return n.createElement("textarea",Object.assign({className:s.css(l.default.formControl,t,f!==o.both&&l.default.modifiers[d],u===c.ValidatedOptions.success&&l.default.modifiers.success),onChange:this.handleChange},"string"!=typeof this.props.defaultValue&&{value:a},{"aria-invalid":u===c.ValidatedOptions.error,required:m},p))}}t.TextArea=i,i.defaultProps={className:"",isRequired:!1,validated:"default",resizeOrientation:"both","aria-label":null}},1945:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(12),n=r.__importStar(a(1)),l=a(20),s=r.__importDefault(a(59));t.CardTitle=e=>{var{children:t=null,className:a=""}=e,c=r.__rest(e,["children","className"]);return n.createElement("div",Object.assign({className:l.css(s.default.cardTitle,a)},c),t)}},1946:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(12),n=r.__importStar(a(1)),l=r.__importDefault(a(59)),s=a(20);t.CardFooter=e=>{var{children:t=null,className:a="",component:c="div"}=e,o=r.__rest(e,["children","className","component"]);const i=c;return n.createElement(i,Object.assign({className:s.css(l.default.cardFooter,a)},o),t)}},1947:function(e,t,a){"use strict";t.__esModule=!0,t.FileAltIconConfig={name:"FileAltIcon",height:512,width:384,svgPath:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 236c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-64c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-72v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm96-114.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z",yOffset:0,xOffset:0,transform:""},t.FileAltIcon=a(35).createIcon(t.FileAltIconConfig),t.default=t.FileAltIcon},1962:function(e,t,a){"use strict";a.r(t);var r=a(128),n=a.n(r),l=a(1),s=a.n(l),c=a(517),o=a(1308),i=a(1309),u=a(718),m=a(1945),f=a(719),p=a(1946),d=a(504),b=a(1947),v=a.n(b),g=a(171),h=a.n(g),y=a(82),O=a.n(y),E=a(251),_=a.n(E),C=a(558),j=a(1276),x=a(60),T=a(4),M=a(28),w=a.n(M),S=a(2),D=a.n(S),N=a(21),P=a(256),R=a(510);function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){w()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var F=function(e){var t=e.data,a=e.intl,r=70,c=t.cves_by_severity,o=t.recent_cves,i=t.top_cves,u=t.cves_total,m=t.system_count,f=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[];for(var l in e){var s=e[l],c=t[l],o=void 0!==c.count?c.count:c;"na"===l&&0===o||(r&&c.percentage&&(o="number"===r?c.percentage:a.formatMessage(T.a.executiveReportOfTotal,{count:o,percentage:c.percentage})),n.push([s,o.toString()]))}return n},p=f(N.K,I({},o)),d=f(N.h,I({},c),"number").map((function(e){var t=n()(e,2),a=t[0],r=t[1];return{x:"CVSS ".concat(a),y:Number(r)}})),b=f(N.h,I({},c),"string"),v=function(){var e={firstPage:[],secondPage:[]},t=0;return i.forEach((function(n){var l=Math.ceil(n.description.length/r);t+=l;var c=s.a.createElement(j.e,{key:n.synopsis,title:n.synopsis,description:n.description},s.a.createElement(j.f,{title:a.formatMessage(T.a.executiveReportPanelTitle)},Number.parseFloat(n.cvss3_score).toFixed(1)),s.a.createElement(j.f,{title:a.formatMessage(T.a.systemsExposed)},n.systems_affected.toString()));t<=15&&e.firstPage.push(c)||e.secondPage.push(c)})),e};return[s.a.createElement(l.Fragment,{key:"first-section"},s.a.createElement(j.g,null,a.formatMessage(T.a.executiveReportHeader)),s.a.createElement(j.g,null,a.formatMessage(T.a.executiveReportSubHeader,{systems:s.a.createElement(P.j,{style:R.a.bold},a.formatMessage(T.a.executiveReportHeaderSystems,{systems:m})),cves:s.a.createElement(P.j,{style:R.a.bold},a.formatMessage(T.a.executiveReportHeaderCVEs,{cves:u}))})),s.a.createElement(j.h,{title:a.formatMessage(T.a.executiveReportCvesBySeverity)},s.a.createElement(j.c,null,s.a.createElement(j.i,{withHeader:!0,rows:[N.g].concat(O()(b))})),s.a.createElement(j.c,null,s.a.createElement(j.b,{chartType:"pie",subTitle:"Cves",title:"100",data:d}))),s.a.createElement(j.h,{title:a.formatMessage(T.a.executiveReportRecentlyPublishedCves)},s.a.createElement(j.c,null,s.a.createElement(j.i,{withHeader:!0,rows:[N.J].concat(O()(p))})),s.a.createElement(j.c,null)),s.a.createElement(j.h,{title:a.formatMessage(T.a.executiveReportTop3),withColumn:!1},v().firstPage)),v().secondPage]};F.propTypes={data:D.a.exact({cves_by_severity:D.a.object,recent_cves:D.a.object,top_cves:D.a.array,cves_total:D.a.number,system_count:D.a.number}),intl:D.a.any};var z=F,B=a(152),H=a(487),A=function(){var e=Object(C.a)(),t=Object(l.useState)(!1),a=n()(t,2),r=a[0],c=a[1],o=Object(l.useState)(!1),i=n()(o,2),u=i[0],m=i[1],f=Object(B.useDispatch)(),p=function(){var t=_()(h.a.mark((function t(){var a,r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c(!0),f(Object(H.addNotification)({dismissable:!0,variant:"info",title:e.formatMessage(T.a.downloadExecutiveNotification)})),t.next=4,Object(x.h)();case 4:return a=t.sent,r=z({data:a,intl:e}),c(!1),t.abrupt("return",O()(r));case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=(new Date).toISOString().split("T"),b=n()(d,1)[0];return s.a.createElement(l.Fragment,null,s.a.createElement("a",{href:!0,onClick:function(){m(!0)}},e.formatMessage(T.a.executiveReportCardButton)),u&&s.a.createElement(j.d,{showButton:!1,label:r?e.formatMessage(T.a.loading):e.formatMessage(T.a.executiveReportCardButton),asyncFunction:p,buttonProps:{variant:"link",isInline:!0},type:e.formatMessage(T.a.vulnerabilitiesHeader),fileName:"vulnerability_executive-report--".concat(b,".pdf"),allPagesHaveTitle:!1,onSuccess:function(){f(Object(H.clearNotifications)()),m(!1)}}))},V=a(1310),G=a(138),L=a(1210),q=a(1193),U=a(1188),J=a(1177),K=a(1229),W=a(248),Q=a(154),X=a(1197),Y=a(51),Z=a(1214),$=a(1195),ee=a(7),te=a(705),ae=a.n(te);function re(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ne(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?re(Object(a),!0).forEach((function(t){w()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):re(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var le=function(e){var t,a,r=e.filterName,c=e.filterData,o=e.setFilterData,i=Object(l.useState)(!1),u=n()(i,2),m=u[0],f=u[1],p=function(e,t){o(ne(ne({},c),{},{cvss_filter:ne(ne({},c.cvss_filter),{},w()({},t,e))}))},d=function(e){var t=+c.cvss_filter[e],a=+c.cvss_filter.min,r=+c.cvss_filter.max;return t<0||t>10||a>r?"error":"default"},b=function(e,t){return s.a.createElement(Z.Select,{variant:"checkbox","aria-label":"Select Input",onToggle:function(){return f(!m)},isOpen:m,placeholderText:"".concat(N.f[t].title,": ").concat(0===c[t].length||c[t].length===N.f[t].items.length?"All":c[t].map((function(e){return N.f[t].items.find((function(t){return t.value===e})).label})).join(", ")),direction:"up",key:t,width:"auto",className:"pf-u-mr-sm pf-u-mb-sm custom-report-filter-select",onSelect:function(e,a){!function(e,t){var a=N.f[e].items.find((function(e){return e.label===t})).value;if(c[e].includes(a)){var r=c[e].indexOf(a),n=c[e].slice();n.splice(r,1),o(ne(ne({},c),{},w()({},e,n)))}else o(ne(ne({},c),{},w()({},e,[].concat(O()(c[e]),[a]))))}(t,a)},selections:c[t].map((function(e){return N.f[t].items.find((function(t){return t.value===e})).label})),isCheckboxSelectionBadgeHidden:!0},e.map((function(e){return s.a.createElement($.SelectOption,{key:t+e.label,value:e.label})})))},v=function(e,t){return s.a.createElement(Z.Select,{variant:"single","aria-label":"Select Input",onToggle:function(){return f(!m)},isOpen:m,placeholderText:"".concat(N.f[t].title,":\n                ").concat(N.f[t].items.find((function(e){return e.value===c[t]})).label),direction:"up",key:t,onSelect:function(e,a){!function(e,t){var a=N.f[e].items.find((function(e){return e.label===t})).value;o(ne(ne({},c),{},w()({},e,a)))}(t,a)},className:"pf-u-mr-sm pf-u-mb-sm",width:"auto"},e.map((function(e){return s.a.createElement($.SelectOption,{width:"100%",key:t+e.label,value:e.label},s.a.createElement(X.Radio,{"aria-label":"Select Input",label:e.label,value:e.label,isChecked:c[t]===e.value}))})))},g=s.a.createElement(W.Split,{className:"pf-u-m-md"},s.a.createElement(Q.SplitItem,null,s.a.createElement("span",{style:{fontSize:14}},ee.a.formatMessage(T.a.customReportCvssMinLabel)),s.a.createElement("br",null),s.a.createElement(U.TextInput,{type:"number",onChange:function(e){return p(e,"min")},validated:d("min"),id:"cvss-min",value:c.cvss_filter.min,style:{width:"5em"}})),s.a.createElement(Q.SplitItem,null,s.a.createElement("br",null),s.a.createElement("span",{className:"pf-u-m-sm"},"-")),s.a.createElement(Q.SplitItem,null,s.a.createElement("span",{style:{fontSize:14}},ee.a.formatMessage(T.a.customReportCvssMaxLabel)),s.a.createElement("br",null),s.a.createElement(U.TextInput,{type:"number",onChange:function(e){return p(e,"max")},validated:d("max"),id:"cvss-max",value:c.cvss_filter.max,style:{width:"5em"}}))),h=s.a.createElement(Z.Select,{variant:"panel","aria-label":"Select Input",customContent:g,onToggle:function(){return f(!m)},isOpen:m,placeholderText:(t=+c.cvss_filter.min,a=+c.cvss_filter.max,0===t&&10===a?"".concat(N.f.cvss_filter.title,": ").concat(ee.a.formatMessage(T.a.optionsAll)):s.a.createElement(Y.Text,null,"".concat(N.f.cvss_filter.title,": ").concat(parseFloat(t).toFixed(1)," - ").concat(parseFloat(a).toFixed(1)),(t<0||a>10||t>a)&&s.a.createElement(ae.a,{color:"var(--pf-global--danger-color--100)",className:"pf-u-ml-xs"}))),className:"pf-u-mr-sm pf-u-mb-sm",direction:"up",width:"auto"});return function(e){switch(e){case"status_id":return b(N.w,"status_id");case"business_risk_id":return b(N.c,"business_risk_id");case"publish_date":return v(N.q,"publish_date");case"impact":return b(N.m,"impact");case"cvss_filter":return h;default:return null}}(r)};le.propTypes={filterName:D.a.string,filterData:D.a.object,setFilterData:D.a.func};var se=le;function ce(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function oe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(a),!0).forEach((function(t){w()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ce(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ie=function(e){var t=e.isOpen,a=e.handleModalClose,r=e.filterData,l=e.setFilterData,c=e.handleDownloadButton,o=e.columnsToInclude,i=e.setColumnsToInclude,u=e.userNotes,m=e.setUserNotes,f=e.reportTitle,p=e.setReportTitle,d=["publish_date","impact","cvss_filter","status_id","business_risk_id"];return s.a.createElement(V.Modal,{title:ee.a.formatMessage(T.a.configModalTitle),id:"custom-report-modal",isOpen:t,onClose:a,actions:[s.a.createElement(G.Button,{key:"export",variant:"primary",onClick:c},ee.a.formatMessage(T.a.configModalExportReport)),s.a.createElement(G.Button,{key:"cancel",variant:"secondary",onClick:a},ee.a.formatMessage(T.a.cancel))]},s.a.createElement(L.Form,null,s.a.createElement(q.FormGroup,{label:ee.a.formatMessage(T.a.customReportTitleLabel),fieldId:"horizontal-form-name"},s.a.createElement(U.TextInput,{value:f,onChange:function(e){return p(e)},type:"text",id:"horizontal-form-name"}),s.a.createElement(J.Checkbox,{id:"hasRule",key:"hasRule",label:ee.a.formatMessage(T.a.customOnlyCvesWithRulesLabel),isChecked:"true"===r.security_rule,onChange:function(e){return l(oe(oe({},r),{},{security_rule:e?"true":void 0}))},className:"pf-u-mt-md"})),s.a.createElement(q.FormGroup,{label:ee.a.formatMessage(T.a.customReportDataToIncludeLabel),fieldId:"horizontal-form-name"},s.a.createElement("div",{style:{columnCount:2}},s.a.createElement(J.Checkbox,{id:"cve_id",label:"CVE ID",isChecked:!0,isDisabled:!0,className:"pf-u-mb-md"}),Object.entries(N.f).map((function(e){var t=n()(e,2),a=t[0],r=t[1];return s.a.createElement(J.Checkbox,{id:a,key:a,label:r.title,isChecked:o.includes(a),onChange:function(e){return function(e,t){i(t?[].concat(O()(o),[e]):o.filter((function(t){return t!==e})))}(a,e)},className:"pf-u-mb-md"})})))),s.a.createElement(q.FormGroup,{label:ee.a.formatMessage(T.a.customReportFilterDataByLabel),fieldId:"horizontal-form-name"},s.a.createElement("div",{className:"custom-report-filter-wrapper"}," ",d&&d.map((function(e){return s.a.createElement(se,{key:e,filterName:e,filterData:r,setFilterData:l})})))),s.a.createElement(q.FormGroup,{label:ee.a.formatMessage(T.a.customReportUserNotesLabel),fieldId:"horizontal-form-name",helperTextInvalid:ee.a.formatMessage(T.a.customReportUserNoteTooLong),validated:u.length>N.p&&"error"},s.a.createElement(K.TextArea,{value:u,onChange:function(e){return m(e)},type:"text",id:"horizontal-form-name",resizeOrientation:"vertical",style:{minHeight:"4em"},validated:u.length>N.p&&"error"}))))};ie.propTypes={isOpen:D.a.bool,filterData:D.a.object,setFilterData:D.a.func,handleModalClose:D.a.func,handleDownloadButton:D.a.func,columnsToInclude:D.a.array,setColumnsToInclude:D.a.func,userNotes:D.a.string,setUserNotes:D.a.func,reportTitle:D.a.string,setReportTitle:D.a.func};var ue=ie,me=a(132),fe=a(507),pe=a(1474),de=a(166);t.default=function(){var e=Object(l.useState)(!1),t=n()(e,2),a=t[0],r=t[1],b=Object(l.useState)(!1),g=n()(b,2),h=g[0],y=g[1],O=Object(l.useState)(ee.a.formatMessage(T.a.customReportDefaultTitle)),E=n()(O,2),_=E[0],C=E[1],j=Object(l.useState)(""),x=n()(j,2),M=x[0],w=x[1],S=Object(l.useState)(Object.keys(N.f)),D=n()(S,2),P=D[0],k=D[1],I=Object(l.useState)(N.j),F=n()(I,2),z=F[0],B=F[1],H=function(){C(ee.a.formatMessage(T.a.customReportDefaultTitle)),w(""),k(Object.keys(N.f)),B(N.j),y(!1),r(!1)};return s.a.createElement(c.Page,null,s.a.createElement(fe.a,{title:ee.a.formatMessage(T.a.reportsPageTitle),showBreadcrumb:!1}),s.a.createElement(d.Main,null,s.a.createElement(o.Grid,{hasGutter:!0,lg:3,md:4,sm:12},s.a.createElement(i.GridItem,null,s.a.createElement(u.Card,{className:"report-card"},s.a.createElement(m.CardTitle,null,s.a.createElement(me.b,{style:R.a.pieChartIcon}),s.a.createElement("span",{className:"pf-u-ml-sm",style:R.a.cardTitle},ee.a.formatMessage(T.a.executiveReportCardTitle))),s.a.createElement(f.CardBody,null,ee.a.formatMessage(T.a.executiveReportCardDescription)),s.a.createElement(p.CardFooter,null,s.a.createElement(A,null)))),s.a.createElement(i.GridItem,null,s.a.createElement(u.Card,{className:"report-card"},s.a.createElement(m.CardTitle,null,s.a.createElement(v.a,{size:"lg",color:"var(--pf-global--link--Color)"}),s.a.createElement("span",{className:"pf-u-ml-sm",style:R.a.cardTitle},ee.a.formatMessage(T.a.customReportCardTitle))),s.a.createElement(f.CardBody,null,ee.a.formatMessage(T.a.customReportCardDescription)),s.a.createElement(p.CardFooter,null,s.a.createElement("a",{className:"create-report",onClick:function(){return r(!0)}},ee.a.formatMessage(T.a.customReportCardButton))))))),s.a.createElement(ue,{isOpen:a,columnsToInclude:P,setColumnsToInclude:k,filterData:z,userNotes:M,reportTitle:_,setReportTitle:C,setUserNotes:w,setFilterData:B,handleModalClose:H,handleDownloadButton:function(){y(!0),r(!1)}}),h&&s.a.createElement(pe.a,{type:"cves",key:"download",reportData:{header:P,reportTitle:_,userNotes:M},showButton:!1,onSuccess:H,params:Object(de.b)(z),filters:Object(de.a)(z),isReportDynamic:!0,buttonProps:{isDisabled:+z.cvss_filter.min<0||+z.cvss_filter.max>10||+z.cvss_filter.min>+z.cvss_filter.max||M.length>N.p,style:{marginRight:"0.5em"}},label:T.a.configModalExportReport}))}}}]);
//# sourceMappingURL=Reports.65ef46a468abcb66012d.js.map