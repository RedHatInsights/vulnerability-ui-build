"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[743],{75584:(e,t,r)=>{r.r(t),r.d(t,{default:()=>ae});var n=r(4942),a=r(29439),o=r(77865),s=r.n(o),l=r(86896),c=r(30893),i=r(28216),u=r(45697),f=r.n(u),p=r(74806),d=r(5977),m=r(29648),b=r(83594),v=r(49629),y=r(95351),g=r(15248),O=r(62215),w=r(87462),h=r(93433),Z=r(15861),P=r(45987),j=r(87757),D=r.n(j),E=r(3968),S=r(71478),R=r(43198),C=r(62598),k=r(52837),M=r(37450),_=["filters","params","reportData","buttonProps","label"];function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var I=function(e){var t=e.filters,r=e.params,n=e.reportData,i=void 0===n?{}:n,u=e.buttonProps,f=e.label,p=(0,P.Z)(e,_),d=(0,l.Z)(),b=(0,o.useState)(!1),v=(0,a.Z)(b,2),y=v[0],g=v[1],j=(0,M.lm)(),F=(0,a.Z)(j,2),I=F[0],N=F[1],T=k.tp.systemsReportRestPages,B=k.tp.systemsReportFirstPage;(0,o.useEffect)((function(){g(!0),I({msg:d.formatMessage(c.Z.notificationReportDownloadStart)})}),[]);var A=function(e){return(0,m.F3)(e,T)},H=function(){var e=(0,Z.Z)(D().mark((function e(){var n,a,o,s,l;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,S.vk)(x(x({},r),O.Z.defaultParams));case 3:o=e.sent,n=o.data,a=o.meta,e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(0),N(),I({variant:"danger",autoDismiss:!1,msg:d.formatMessage(c.Z.notificationReportDownloadFailureTitle),description:d.formatMessage(c.Z.notificationReportDownloadFailureBody)}),e.abrupt("return",[]);case 13:return s=(0,R.Z)({data:n.splice(0,B),meta:a,filters:t,intl:d}),l=A(n),g(!1),N(),I({variant:"success",msg:d.formatMessage(c.Z.notificationReportDownloadSuccess)}),e.abrupt("return",[s].concat((0,h.Z)(l.map((function(e,t){return(0,C.Z)({data:e,page:t,intl:d,header:i&&i.header})})))));case 19:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return s().createElement("div",null,s().createElement(E.o6,(0,w.Z)({},p,{fallback:null,label:y?d.formatMessage(c.Z.loading):d.formatMessage(f),asyncFunction:H,buttonProps:x({component:"button"},u),reportName:d.formatMessage(c.Z.systemPDFReportName),type:"",fileName:"".concat(O.Z.filename("system-list"),".pdf"),allPagesHaveTitle:!1,size:"A4",orientation:"landscape"})))};I.defaultProps={label:c.Z.kebabExportAsPDF},I.propTypes={filters:f().oneOfType([f().array,f().object]),params:f().object,reportData:f().object,buttonProps:f().object,label:f().oneOfType([f().array,f().object])};const N=I;var T=r(41489),B=r(44612),A=r(32132);const H=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.excluded,n=function(t){e({excluded:t.length>0?null==t?void 0:t.join(","):void 0,page:1})};return{label:A.N.formatMessage(c.Z.filterSystemsIncludedInAnalysis),type:B.Y.checkbox,urlParam:"excluded",filterValues:{onChange:function(e,t){n(t)},items:k._9.map((function(e){return{label:e.label,value:e.value}})),value:(null==r?void 0:r.length)>0?null==r?void 0:r.split(","):void 0}}};var U=r(83215);function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var K=function(e){var t=e.selectedRows,r=e.selectedRowsCount,n=e.selectedRowsRawData,l=e.intl,u=e.parameters,f=e.rawData,p=e.methods,d=(0,o.useState)(!1),m=(0,a.Z)(d,2),w=m[0],h=m[1],Z=p.apply,P=p.handleSelect,j=p.doOptOut,D=p.setColumnModalOpen,E=(0,i.I0)(),S=(0,o.useMemo)((function(){return{selectedExcluded:n.some((function(e){return!0===e.opt_out})),selectedIncluded:n.some((function(e){return!1===e.opt_out}))}}),[n]),R=["",{label:l.formatMessage(c.Z.systemKebabExcludeAnalysis,{count:r}),onClick:function(){return j(t,null==n?void 0:n[0].display_name,!0)},props:{isDisabled:!r||!S.selectedIncluded}},{label:l.formatMessage(c.Z.systemKebabIncludeAnalysis,{count:r}),onClick:function(){return j(t,null==n?void 0:n[0].display_name,!1,t)},props:{isDisabled:!r||!S.selectedExcluded}},{label:l.formatMessage(c.Z.columnManagementModalTitle),onClick:function(){return D(!0)}}],C=(0,M.ZS)({rawData:f,selectedRows:t,selectedRowsCount:r,handleSelect:P,fetchResource:function(e){return(0,b.ip)(z(z({},u),e))}});return s().createElement(o.Fragment,null,s().createElement(v.Z,{className:"vuln-systems-primary-toolbar",bulkSelect:C,actionsConfig:{actions:R,dropdownProps:{ouiaId:"toolbar-actions"}},filterConfig:{items:[(0,y.Z)("filter",c.Z.systemsSearchName,c.Z.searchFilterByName,u.filter,Z),H(Z,u)]},activeFiltersConfig:{filters:(0,g.DU)(u),onDelete:function(e,t,r){return(0,g.vH)(t,p.apply,r,k.Sy)},deleteTitle:l.formatMessage(c.Z.resetFilters),showDeleteButton:!(0,g.Yy)(u,k.Sy,k.D2)},exportConfig:z({isDisabled:0===f.meta.totalItems,extraItems:[(0,T.Ec)(w,h)],ouiaId:"export"},(0,g.HV)({downloadReport:function(e){var t=z({},u);O.Z.exec(b.lc,t,e,"system-list",(function(e){return E((0,U.wN)(e))}),(function(){return E((0,U.L1)())}))}}))}),w&&s().createElement(N,{showButton:!1,params:u,filters:(0,g.DU)(u),onSuccess:function(){return h(!1)}}))};K.propTypes={rawData:m.nE,parameters:f().object,selectedRows:f().array,selectedRowsCount:f().number,selectedRowsRawData:f().array,methods:f().shape({doOptOut:f().func,apply:f().func,handleSelect:f().func,setColumnModalOpen:f().func}),intl:f().any};const L=(0,d.EN)((0,p.ZP)(K));var Y=r(83296),W=r(86350),q=r(43003),G=r(75115),J=r(15768),Q=r(33739),X=r(66123),$=r(75863),ee=r(24788),te=r(66761);function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const ae=function(){var e=s().createRef(),t=(0,i.I0)(),r=(0,l.Z)(),n=(0,m.H1)(k.IV),u=(0,a.Z)(n,2),f=u[0],p=u[1],d=(0,i.v9)((function(e){var t=e.entities;return(null==t?void 0:t.rows)||[]}),i.wU),v=(0,i.v9)((function(e){var t=e.entities;return null==t?void 0:t.total})),y=(0,i.v9)((function(e){var t=e.entities;return null==t?void 0:t.meta})),g=(0,i.v9)((function(e){var t=e.entities;return(null==t?void 0:t.selectedRows)||{}})),O=(0,i.v9)((function(e){var t=e.entities;return null==t?void 0:t.selectedRowsCount})),w=(0,i.v9)((function(e){var t=e.entities;return(null==t?void 0:t.selectedRowsRawData)||[]})),h=(0,i.v9)((function(e){var t=e.entities;return(null==t?void 0:t.loaded)||!1})),Z=(0,i.v9)((function(e){return e.SystemsPageStore.params}),i.wU),P=(0,i.v9)((function(e){return e.SystemsPageStore.error})),j=P.hasError,D=P.errorCode,E=(0,o.useState)(k.Bi),R=(0,a.Z)(E,2),C=R[0],_=R[1],F=(0,o.useState)(!1),x=(0,a.Z)(F,2),I=x[0],N=x[1];(0,o.useEffect)((function(){return function(){t((0,b.re)()),t((0,b.r5)())}}),[t]);var T=function(e){return t((0,b.SF)(e))};(0,o.useEffect)((function(){return T(f)}),[]),(0,o.useEffect)((function(){return p(ne(ne({},Z),y))}),[p,Z,y]);var B=(0,M.a9)((function(){return t((0,b.r5)()),e.current.onRefreshData({page:1})})),A=(0,M.U)(S.vk,{}),H=(0,o.useState)(0),U=(0,a.Z)(H,2),V=U[0],z=U[1];return(0,o.useEffect)((function(){return z(V+1)}),[C]),s().createElement(o.Fragment,null,s().createElement(te.Z,{appliedColumns:C,applyColumns:_,isModalOpen:I,setModalOpen:N}),s().createElement(G.Z,{title:r.formatMessage(c.Z.vulnerabilitySystemsHeader),showBreadcrumb:!1}),s().createElement(W.Z,null,j?s().createElement(X.Z,{code:D}):s().createElement(Q.Z,{disableDefaultColumns:!0,onLoad:function(e){var t=e.mergeWithEntities;Y.Z.register(ne({},t((0,J.K)(C),ne({page:Number(Z.page||1),perPage:Number(Z.page_size||20)},Z.sort&&{sortBy:{key:Z.sort.replace(/^-/,""),direction:Z.sort.match(/^-/)?"desc":"asc"}}))))},tableProps:{isStickyHeader:!0,canSelectAll:!1,actionResolver:v>0&&function(e){return(0,q.zs)(e,B)},variant:$.B.compact},showTagModal:!0,isFullView:!0,ref:e,autoRefresh:!0,customFilters:{vulnerabilityParams:ne({},Z)},columnsCounter:V,columns:function(e){return t=e,C.filter((function(e){return e.isShown})).map((function(e){return ne(ne({},t.find((function(t){var r=t.key;return e.key===r}))),e)}));var t},getEntities:A,hideFilters:{all:!0},noSystemsTable:s().createElement(ee.UE,null)},s().createElement(L,{parameters:Z,rawData:{data:d,meta:{totalItems:v},isLoaded:h},selectedRows:g,selectedRowsCount:O,selectedRowsRawData:w,methods:{doOptOut:B,apply:T,handleSelect:function(e){return t((0,b.hd)(e))},setColumnModalOpen:N},actions:!0}))))}}}]);
//# sourceMappingURL=../sourcemaps/Systems.bb6d56ca39adfcd0d930099479bb5fa6.js.map