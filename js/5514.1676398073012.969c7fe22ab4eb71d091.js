"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[5514],{67463:(e,t,n)=>{t.S3=void 0;const i=n(70655);i.__importStar(n(77865)),i.__importDefault(n(62698)),n(38296);var a;(a=t.S3||(t.S3={})).sm="sm",a.md="md",a.lg="lg",a.xl="xl"},63368:(e,t,n)=>{n.d(t,{Z:()=>o});var i=n(83237),a=n(78733),s=n(32132),r=n(30893);const o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.remediation,o=function(t){e({remediation:t.length>"0"&&t.filter((function(e){return","!==e})).join(",")||"",page:1})};return{label:s.N.formatMessage(r.Z.filterRemediation),type:i.Y.checkbox,urlParam:"remediation",key:"remediation",filterValues:{onChange:function(e,t){o(t)},items:a.Iv.map((function(e){return{label:e.label,value:e.value}})),value:n?n.split(","):[]}}}},66516:(e,t,n)=>{n.d(t,{Z:()=>E});var i=n(29439),a=n(93149),s=n(83115),r=n(59775),o=n(49739),u=n(83826),l=n(41448),c=n(79851),d=n(75824),v=n(34512),f=n(91290),m=n(45697),p=n.n(m),y=n(77865),_=n.n(y),g=n(71478),h=n(91709),b=n(74806),j=n(30893),S=function(e){var t,n=e.cveList,m=e.updateRef,p=e.inventoryList,b=e.intl,S=e.type,E=(0,h.fj)(A()),Z=E.JustificationInput,x=E.justification,k=E.setJustification,O=E.setProps,P=(0,y.useState)(function(){switch(S){case"systemsExposed":if(p.every((function(e){var t,i;return e.status_id===(null===(t=n[0])||void 0===t?void 0:t.status_id)&&e.justification===(null===(i=n[0])||void 0===i?void 0:i.justification)})))return!0;break;case"systemDetail":var e=n.every((function(e,t,n){var i,a;return e.status_id===(null===(i=n[0])||void 0===i?void 0:i.status_id)&&e.justification===(null===(a=n[0])||void 0===a?void 0:a.justification)})),t=n.every((function(e){return e.status_id===e.cve_status_id&&e.justification===e.cve_justification}));if(e&&t)return!0}return!1}()),N=(0,i.Z)(P,2),M=N[0],w=N[1],C=(0,h.Hb)(J()),I=C.StatusSelect,D=C.statusId,R=C.setStatusId,T=C.setProps,U=p.map((function(e){return e.id||e.inventory_id})),L=p.map((function(e){return e.display_name}));function J(){switch(S){case"systemsExposed":return M?n[0].status_id:p.every((function(e,t,n){return e.status_id===n[0].status_id}))?null===(e=p[0])||void 0===e?void 0:e.status_id:"0";var e;case"systemDetail":var t,i;return M?n.every((function(e,t,n){return e.cve_status_id===n[0].cve_status_id}))?null===(t=n[0])||void 0===t?void 0:t.cve_status_id:"0":n.every((function(e,t,n){return e.status_id===n[0].status_id}))?null===(i=n[0])||void 0===i?void 0:i.status_id:"0"}}function A(){switch(S){case"systemsExposed":return M?n[0].justification:p.every((function(e,t,n){var i;return e.justification===(null===(i=n[0])||void 0===i?void 0:i.justification)}))&&(null===(e=p[0])||void 0===e?void 0:e.justification)||"";var e;case"systemDetail":var t,i;return M?n.every((function(e,t,n){var i;return e.cve_justification===(null===(i=n[0])||void 0===i?void 0:i.cve_justification)}))&&(null===(t=n[0])||void 0===t?void 0:t.cve_justification)||"":n.every((function(e,t,n){var i;return e.justification===(null===(i=n[0])||void 0===i?void 0:i.justification)}))&&(null===(i=n[0])||void 0===i?void 0:i.justification)||""}}(0,y.useEffect)((function(){T({isDisabled:M,ouiaId:"status-select"}),O({disabled:M}),R(J()),k(A())}),[M,T,O]);var B={variant:"success",title:"systemsExposed"===S?b.formatMessage(j.Z.notificationSystemStatusUpdateSuccessful,{count:p.length||0,systemName:L[0]}):b.formatMessage(j.Z.notificationStatusUpdateSuccessful,{count:n.length||0})},F={variant:"danger",autoDismiss:!1,title:b.formatMessage(j.Z.notificationStatusUpdateFailureTitle),description:b.formatMessage(j.Z.notificationStatusUpdateFailureBody)},z=b.formatMessage(j.Z.cvePairStatusModalTitle,{count:U.length*n.length});return _().createElement(h.ZP,{items:n,onSave:function(){var e=n.map((function(e){return e.id})),t=M?{cve:e,inventory_id:U}:{status_id:parseInt(D),cve:e,status_text:x,inventory_id:U};return(0,g.cr)(t).then(m)},onSuccessNotification:B,onFailureNotification:F,title:z,ouiaId:"status-modal"},_().createElement(o.K,{hasGutter:!0},function(){switch(S){case"systemsExposed":return p.some((function(e,t,n){var i;return e.status_id!==(null===(i=n[0])||void 0===i?void 0:i.status_id)}));case"systemDetail":return n.some((function(e,t,n){var i;return e.status_id!==(null===(i=n[0])||void 0===i?void 0:i.status_id)}))}}()&&_().createElement(u.v,null,_().createElement(l.b,{variant:"warning",isInline:!0,title:b.formatMessage(j.Z.cvePairStatusModalAlert)})),_().createElement(u.v,null,b.formatMessage(j.Z.cvePairStatusModalSelected,{cveCount:n.length||0,cveId:null===(t=n[0])||void 0===t?void 0:t.id,systemCount:p.length||0,systemName:L[0],b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return _().createElement("b",null,t)}})),_().createElement(u.v,null,_().createElement(s.l,{key:"key"},_().createElement(r.c,{fieldId:"overall"},_().createElement(c.P,null,_().createElement(v.J,null,_().createElement(a.X,{label:b.formatMessage(j.Z.cvePairStatusModalUseOverallCheckbox),id:"alt-form-checkbox-1",name:"alt-form-checkbox-1",isChecked:M,onChange:function(e){return w(e)}})),_().createElement(v.J,null,_().createElement(d.u,{content:b.formatMessage(j.Z.cvePairStatusModalUseOverallTooltip)},_().createElement(f.ZP,{className:"pf-u-ml-xs",color:"var(--pf-global--Color--200)",style:{verticalAlign:"0"}}))))),I,Z))))};S.propTypes={cveList:p().array,updateRef:p().func,inventoryList:p().array,intl:p().any,type:p().oneOf(["systemsExposed","systemDetail"])};const E=(0,b.ZP)(S)},7092:(e,t,n)=>{n.d(t,{Z:()=>x});var i=n(93433),a=n(29439),s=n(77865),r=n.n(s),o=n(45697),u=n.n(o),l=n(83215),c=n(28216),d=n(30893),v=n(44012),f=n(29648),m=n(2372),p=n(67463),y=n(85893),_=n(59823),g=n(48335),h=n(94184),b=n.n(h),j=function(){return j=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},j.apply(this,arguments)},S=function(e){var t=e.appName,n=e.scope,i=e.module,a=e.fallback,s=void 0===a?(0,y.jsx)(g.Bullseye,{children:(0,y.jsx)(g.Spinner,{size:"xl"})}):a,r=e.innerRef,o=e.className,u=e.component,l=void 0===u?"section":u,c=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]])}return n}(e,["appName","scope","module","fallback","innerRef","className","component"]),d=j({className:o,appName:t,module:i,scope:null!=n?n:t,ErrorComponent:s,ref:r,fallback:s},c);return(0,y.jsx)(l,j({className:b()(o,t)},{children:(0,y.jsx)(_.ScalprumComponent,j({},d))}))};const E=r().forwardRef((function(e,t){return(0,y.jsx)(S,j({innerRef:t},e))}));var Z=function(e){var t=e.cves,n=e.systems,s=e.manyRules,o=e.isDisabled,u=(0,c.I0)(),y=function(e,t){return{id:"vulnerabilities:".concat(e),description:e,systems:[t]}};return r().createElement(E,{appName:"remediations",module:"./RemediationButton",fallback:r().createElement(m.$,{size:p.S3.lg}),isDisabled:o,dataProvider:function(){return function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[].concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]),s=[].concat(e),r=[];if(t&&1===n.length){var o=(0,a.Z)(n,1)[0];r=s.reduce((function(e,t){var n,a=t.id,s=t.rule,r=y(o.id,a);return s&&(r.id="".concat(r.id,":").concat(null==s||null===(n=s.rule)||void 0===n?void 0:n.rule_id)),[].concat((0,i.Z)(e),[r])}),[]),r=(0,f.X8)(r,"systems")}if(!t&&1===(null==s?void 0:s.length)){var u=(0,a.Z)(s,1)[0];r=n.reduce((function(e,t){var n=t.id,a=t.rule,s=y(n,u);return null!=a&&a.rule_id&&(s.id="".concat(s.id,":").concat(a.rule_id)),[].concat((0,i.Z)(e),[s])}),[])}return!(!n.length||!s.length)&&{issues:r}}(t,n,s)},onRemediationCreated:function(e){return u((0,l.wN)(e.getNotification()))}},r().createElement(v.Z,d.Z.remediateLabel))};Z.propTypes={cves:u().oneOfType([u().array,u().string]),systems:u().oneOfType([u().array,u().string]),manyRules:u().bool,isDisabled:u().bool};const x=Z}}]);
//# sourceMappingURL=../sourcemaps/5514.d3ff3714b0bdde339a29816a37bbff32.js.map