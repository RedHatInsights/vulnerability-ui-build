(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[322],{15329:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>fe});var a=r(28481),n=r(77865),l=r.n(n),s=r(50693),o=r(16475),c=r(32203),i=r(70),u=r(62394),m=r(49734),p=r(86350),f=r(82442),d=r(85061),v=r(92137),y=r(87757),g=r.n(y),E=r(86896),Z=r(3968),b=r(71478),h=r(30893),x=r(96156),C=r(45697),_=r.n(C),R=r(6208),S=r(62410),M=r(74093),T=r(80167),N=function(e){var t=e.counter,r=e.label;return l().createElement(M.G7,null,l().createElement(M.xv,{style:T.Z.counter},t),l().createElement(M.xv,{style:T.Z.counterLabel},r))};N.propTypes={counter:_().number,label:_().string};const D=N;var k=function(e){var t=e.data,r=e.intl,a=t.totalSystems,s=t.totalCves,o=t.totalRules;return l().createElement(n.Fragment,{key:"exec-first-page"},l().createElement(M.xv,{style:[T.Z.generated,T.Z.mb24]},r.formatMessage(h.Z.executiveReportGenerated,{date:(0,S.Z)({date:new Date,type:"exact"}).props.children})),l().createElement(M.xv,{style:T.Z.mb16},r.formatMessage(h.Z.executiveReportHeader)),l().createElement(M.xv,{style:T.Z.mb8},r.formatMessage(h.Z.executiveReportSubHeader,{systems:l().createElement(M.xv,{style:T.Z.bold},r.formatMessage(h.Z.executiveReportHeaderSystems,{systems:a})),cves:l().createElement(M.xv,{style:T.Z.bold},r.formatMessage(h.Z.executiveReportHeaderCVEs,{cves:s})),rules:l().createElement(M.xv,{style:T.Z.bold},r.formatMessage(h.Z.executiveReportHeaderRules,{rules:o}))})),l().createElement(Z.$0,{withColumn:!1},l().createElement(Z.s_,null,l().createElement(Z.Lv,{style:T.Z.counterPanel},l().createElement(D,{counter:a,label:r.formatMessage(h.Z.executiveReportAnalyzedSystems,{systems:a})})),l().createElement(Z.Lv,{style:T.Z.counterPanel},l().createElement(D,{counter:s,label:r.formatMessage(h.Z.executiveReportAnalyzedCVEs,{cves:s})})),l().createElement(Z.Lv,{style:T.Z.counterPanel},l().createElement(D,{counter:o,label:r.formatMessage(h.Z.executiveReportAnalyzedRules,{rules:o})})))))};k.propTypes={data:_().exact({totalSystems:_().number,totalCves:_().number,totalRules:_().number}),intl:_().any};const w=k;var O=r(39138),j=r.n(O),P=r(1809),H=function(e){var t=e.data,r=e.intl,s=function(e){return l().createElement(M.xv,{style:T.Z.mb8}," ",j()(e,{length:400}))},o=t.recentCvesData,c=t.CVSSChart,i=t.CVSSData,u=t.CVSSHeader,m=t.topCves,p=(0,a.Z)(u,2),f=p[0],v=p[1];return l().createElement(n.Fragment,{key:"first-section"},l().createElement(M.xv,{style:T.Z.header},r.formatMessage(h.Z.cvesHeader)),l().createElement(Z.$0,{titleProps:{style:T.Z.sectionTitle},title:r.formatMessage(h.Z.executiveReportCvesByCVSS)},l().createElement(Z.sg,null,l().createElement(Z.kL,{chartType:"pie",subTitle:"Cves",title:"100",data:c,colorSchema:"orange",legendHeader:f})),l().createElement(Z.sg,null,l().createElement(Z.iA,{withHeader:!0,rows:[[v]].concat((0,d.Z)(i))}))),l().createElement(Z.$0,{titleProps:{style:T.Z.sectionTitle},title:r.formatMessage(h.Z.executiveReportRecentlyPublishedCves)},l().createElement(Z.s_,{style:{flex:1}},o.map((function(e){var t=(0,a.Z)(e,2),r=t[0],s=t[1];return l().createElement(n.Fragment,{key:r},l().createElement(Z.Lv,{style:{flex:1},title:r},s))})))),l().createElement(Z.$0,{titleProps:{style:T.Z.sectionTitle},title:r.formatMessage(h.Z.executiveReportTop3),withColumn:!1},m.map((function(e){var t=e.synopsis,a=e.known_exploit,n=e.security_rule,o=e.description,c=e.cvss3_score,i=e.systems_affected;return l().createElement(Z.s_,{key:t,title:t,description:s(o),labels:l().createElement(P.Z,{hasExploit:a,hasRule:n,intl:r})},l().createElement(Z.Lv,{title:r.formatMessage(h.Z.executiveReportPanelTitle)},Number.parseFloat(c).toFixed(1)),l().createElement(Z.Lv,{title:r.formatMessage(h.Z.systemsExposed)},i.toString()))}))))};H.propTypes={data:_().exact({recentCvesData:_().array,CVSSChart:_().array,CVSSData:_().array,CVSSHeader:_().array,topCves:_().array}),intl:_().any};const L=H;var I=function(e){var t=e.data,r=e.intl,a=function(e,t){return l().createElement(n.Fragment,null,l().createElement(M.xv,{style:T.Z.mb8},"".concat(j()(e,{length:320}),"\n\n")),r.formatMessage(h.Z.associatedCves)," ",t.map((function(e){return e})).join(", "))},s=t.topRules,o=t.rulesHeader,c=t.rulesBySeverityMap,i=t.rulesChart;return l().createElement(n.Fragment,{key:"first-section"},l().createElement(M.xv,{style:T.Z.header},r.formatMessage(h.Z.rules)),l().createElement(Z.$0,{titleProps:{style:T.Z.sectionTitle},title:r.formatMessage(h.Z.executiveReportRulesSection)},l().createElement(Z.sg,null,l().createElement(Z.iA,{withHeader:!0,rows:[o].concat((0,d.Z)(c))})),l().createElement(Z.sg,null,l().createElement(Z.kL,{chartType:"bar",subTitle:"rules",title:"Rules",data:i,colorSchema:"orange",legend:!1}))),l().createElement(Z.$0,{titleProps:{style:T.Z.sectionTitle},title:r.formatMessage(h.Z.executiveReportTop3Rules),withColumn:!1},s.map((function(e,t){return l().createElement(Z.s_,{key:t,title:e.name,description:a(e.description,e.associated_cves)},l().createElement(Z.Lv,{title:r.formatMessage(h.Z.executiveReportRulePanelTitle)},l().createElement(Z.Uc,{variant:e.severity})),l().createElement(Z.Lv,{title:r.formatMessage(h.Z.systemsExposed)},e.systems_affected.toString()))}))))};I.propTypes={data:_().exact({topRules:_().array,rulesHeader:_().array,rulesBySeverityMap:_().array,rulesChart:_().array}),intl:_().any};const F=I;function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){(0,x.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var z=function(e){var t,r=e.data,n=e.intl,s=r.cves_by_severity,o=r.recent_cves,c=r.top_cves,i=r.cves_total,u=r.system_count,m=r.top_rules,p=r.rules_total,f=r.rules_by_severity;0===(null==s||null===(t=s.na)||void 0===t?void 0:t.count)&&(delete s.na,delete R.cL.na);var v=Object.keys(f).reverse().map((function(e){return[R.q[e]].concat((0,d.Z)(Object.values(f[e]).map((function(e){return e.toString()}))))})),y=Object.values(s).reverse().map((function(e){var t=e.count,r=e.percentage;return[n.formatMessage(h.Z.executiveReportOfTotal,{count:t,percentage:r})]})),g=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=[];for(var n in e){var l=e[n],s=t[n],o=void 0!==s.count?s.count:s;r&&s.percentage&&(o=s.percentage),a.push([l,o.toString()])}return a},E=g(R.YM,V({},o)),Z=g(R.cL,V({},s),!0).map((function(e){var t=(0,a.Z)(e,2),r=t[0],n=t[1];return{x:r,y:Number(n)}})),b=v.map((function(e){var t=(0,a.Z)(e,3),r=t[0],n=t[2];return{name:r,x:r,y:Number(n)}})),x={totalSystems:u,totalCves:i,totalRules:p},C={recentCvesData:E,CVSSChart:Z,CVSSData:y,CVSSHeader:R.rs,topCves:c},_={topRules:m,rulesHeader:R.$D,rulesBySeverityMap:v,rulesChart:b};return[l().createElement(w,{key:"first-page",intl:n,data:x}),l().createElement(L,{key:"second-page-cves",intl:n,data:C}),l().createElement(F,{key:"third-page-rules",intl:n,data:_})]};z.propTypes={data:_().exact({cves_by_severity:_().object,recent_cves:_().object,top_cves:_().array,cves_total:_().number,system_count:_().number,rules_by_severity:_().object,rules_total:_().number,top_rules:_().array}),intl:_().any};const W=z;var $=r(14494),A=r(83215),G=r(37450),U=r(75201);const X=function(){var e=(0,E.Z)(),t=(0,n.useState)(!1),r=(0,a.Z)(t,2),s=r[0],o=r[1],c=(0,n.useState)(!1),i=(0,a.Z)(c,2),u=i[0],m=i[1],p=(0,n.useState)(!1),f=(0,a.Z)(p,2),y=f[0],x=f[1],C=(0,n.useState)(!1),_=(0,a.Z)(C,2),R=_[0],S=_[1],M=(0,G.l)(),T=(0,$.useDispatch)(),N=function(){var t=(0,v.Z)(g().mark((function t(){var r,a;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o(!0),M({msg:e.formatMessage(h.Z.downloadExecutiveNotification)}),t.next=4,(0,b.nK)();case 4:return r=t.sent,a=W({data:r,intl:e}),x((function(){return r.top_cves.some((function(e){return!0===e.security_rule}))})),S((function(){return r.top_cves.some((function(e){return!0===e.known_exploit}))})),o(!1),t.abrupt("return",(0,d.Z)(a));case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),D=(new Date).toISOString().split("T"),k=(0,a.Z)(D,1)[0];return l().createElement(n.Fragment,null,l().createElement("a",{onClick:function(){m(!0)}},e.formatMessage(h.Z.executiveReportCardButton)),u&&l().createElement(Z.o6,{type:e.formatMessage(h.Z.vulnerabilitiesHeader),fileName:"vulnerability_executive-report--".concat(k,".pdf"),buttonProps:{variant:"link",isInline:!0},groupName:"Red Hat Insights",asyncFunction:N,allPagesHaveTitle:!1,showButton:!1,footer:l().createElement(U.Z,{intl:e,hasRule:y,hasExploit:R}),label:s?e.formatMessage(h.Z.loading):e.formatMessage(h.Z.executiveReportCardButton),onSuccess:function(){T((0,A.L1)()),m(!1)}}))};var K=r(80236),q=r(47173),Y=r(83115),J=r(59775),Q=r(92607),ee=r(93149),te=r(23393),re=r(13115),ae=r(57980),ne=r(32132),le=r(27482),se=function(e){var t=e.isOpen,r=e.handleModalClose,s=e.filterData,o=e.setFilterData,c=e.handleDownloadButton,i=e.columnsToInclude,u=e.setColumnsToInclude,m=e.userNotes,p=e.setUserNotes,f=e.reportTitle,v=e.setReportTitle,y=(0,n.useState)("all"),g=(0,a.Z)(y,2),E=g[0],Z=g[1],b=["rule_presence","known_exploit","impact","cvss_filter","business_risk_id","status_id","publish_date"];return(0,n.useEffect)((function(){"all"===E&&u(Object.keys(R.jW))}),[E,u]),l().createElement(K.u,{width:"50rem",title:ne.N.formatMessage(h.Z.configModalTitle),ouiaId:"custom-report-modal",isOpen:t,onClose:r,actions:[l().createElement(q.zx,{key:"export",variant:"primary",onClick:c,isDisabled:!(0,le.o)(s.cvss_filter.from,s.cvss_filter.to)||m.length>R.Z0},ne.N.formatMessage(h.Z.configModalExportReport)),l().createElement(q.zx,{key:"cancel",variant:"secondary",onClick:r},ne.N.formatMessage(h.Z.cancel))]},l().createElement(Y.l,null,l().createElement(J.c,{label:ne.N.formatMessage(h.Z.customReportTitleLabel),fieldId:"horizontal-form-name"},l().createElement(Q.oi,{value:f,onChange:function(e){return v(e)},type:"text",className:"report-text-input",id:"horizontal-form-name"})),l().createElement(J.c,{label:ne.N.formatMessage(h.Z.customReportFilterDataByLabel)},l().createElement("div",{className:"custom-report-filter-wrapper"},b&&b.map((function(e){var t;return null===(t=R.jW[e])||void 0===t?void 0:t.component({filterData:s,setFilterData:o,selectProps:{className:"pf-u-mr-sm pf-u-mb-sm"},options:R.jW[e].items,filterId:e,filterName:R.jW[e].title})})))),l().createElement(J.c,{label:ne.N.formatMessage(h.Z.customReportDataToIncludeLabel)},l().createElement(re.t,{"aria-label":"Default with single selectable"},l().createElement(ae.G,{text:ne.N.formatMessage(h.Z.customReportDataToggleAll),isSelected:"all"===E,onChange:function(){return Z("all")}}),l().createElement(ae.G,{text:ne.N.formatMessage(h.Z.customReportDataToggleCustom),isSelected:"custom"===E,onChange:function(){return Z("custom")}})),"custom"===E&&l().createElement("div",{style:T.Z.collumns},l().createElement(ee.X,{id:"cve_id",label:"CVE ID",isChecked:!0,isDisabled:!0,className:"pf-u-mb-md"}),Object.entries(R.jW).map((function(e){var t=(0,a.Z)(e,2),r=t[0],n=t[1];return l().createElement(ee.X,{id:r,key:r,label:n.title,isChecked:i.includes(r),onChange:function(e){return function(e,t){u(t?[].concat((0,d.Z)(i),[e]):i.filter((function(t){return t!==e})))}(r,e)},className:"pf-u-mb-md"})})))),l().createElement(J.c,{label:ne.N.formatMessage(h.Z.customReportUserNotesLabel),fieldId:"user-notes-box",helperTextInvalid:ne.N.formatMessage(h.Z.customReportUserNoteTooLong),validated:m.length>R.Z0&&"error"},l().createElement(te.Kx,{value:m,onChange:function(e){return p(e)},type:"text",id:"user-notes-box",className:"report-text-input",resizeOrientation:"vertical",style:{minHeight:"4em"},validated:m.length>R.Z0&&"error"}))))};se.propTypes={isOpen:_().bool,filterData:_().object,setFilterData:_().func,handleModalClose:_().func,handleDownloadButton:_().func,columnsToInclude:_().array,setColumnsToInclude:_().func,userNotes:_().string,setUserNotes:_().func,reportTitle:_().string,setReportTitle:_().func};const oe=se,ce=r.p+"fonts/chart-pie-solid.svg";var ie=function(e){var t=e.style;return l().createElement("img",{style:t,src:ce,alt:"Static pie solid"})};ie.propTypes={style:_().object};var ue=r(23320),me=r(33084),pe=r(73596);const fe=function(){var e=(0,n.useState)(!1),t=(0,a.Z)(e,2),r=t[0],d=t[1],v=(0,n.useState)(!1),y=(0,a.Z)(v,2),g=y[0],E=y[1],Z=(0,n.useState)(ne.N.formatMessage(h.Z.customReportDefaultTitle)),b=(0,a.Z)(Z,2),x=b[0],C=b[1],_=(0,n.useState)(""),S=(0,a.Z)(_,2),M=S[0],N=S[1],D=(0,n.useState)(Object.keys(R.jW)),k=(0,a.Z)(D,2),w=k[0],O=k[1],j=(0,n.useState)(R.OX),P=(0,a.Z)(j,2),H=P[0],L=P[1],I=function(){C(ne.N.formatMessage(h.Z.customReportDefaultTitle)),N(""),O(Object.keys(R.jW)),L(R.OX),E(!1),d(!1)};return(0,n.useEffect)((function(){var e,t,r;null===(e=insights)||void 0===e||null===(t=e.chrome)||void 0===t||null===(r=t.hideGlobalFilter)||void 0===r||r.call(t)})),l().createElement(l().Fragment,null,l().createElement(ue.Z,{title:ne.N.formatMessage(h.Z.reportsPageTitle),showBreadcrumb:!1}),l().createElement(p.Z,null,l().createElement(s.r,{hasGutter:!0,lg:3,md:4,sm:12},l().createElement(o.P,null,l().createElement(c.Z,{className:"report-card"},l().createElement(i.l,null,l().createElement(ie,{style:T.Z.pieChartIcon}),l().createElement("span",{className:"pf-u-ml-sm",style:T.Z.cardTitle},ne.N.formatMessage(h.Z.executiveReportCardTitle))),l().createElement(u.e,null,ne.N.formatMessage(h.Z.executiveReportCardDescription)),l().createElement(m.e,null,l().createElement(X,null)))),l().createElement(o.P,null,l().createElement(c.Z,{className:"report-card"},l().createElement(i.l,null,l().createElement(f.ZP,{size:"lg",color:"var(--pf-global--link--Color)"}),l().createElement("span",{className:"pf-u-ml-sm",style:T.Z.cardTitle},ne.N.formatMessage(h.Z.customReportCardTitle))),l().createElement(u.e,null,ne.N.formatMessage(h.Z.customReportCardDescription)),l().createElement(m.e,null,l().createElement("a",{className:"create-report",onClick:function(){return d(!0)}},ne.N.formatMessage(h.Z.customReportCardButton))))))),l().createElement(oe,{isOpen:r,columnsToInclude:w,setColumnsToInclude:O,filterData:H,userNotes:M,reportTitle:x,setReportTitle:C,setUserNotes:N,setFilterData:L,handleModalClose:I,handleDownloadButton:function(){E(!0),d(!1)}}),g&&l().createElement(me.Z,{key:"download",reportData:{header:w,reportTitle:x,userNotes:M},showButton:!1,onSuccess:I,params:(0,pe.pX)(H),filters:(0,pe._R)(H),isReportDynamic:!0,label:h.Z.configModalExportReport}))}}}]);
//# sourceMappingURL=../sourcemaps/Reports.01bcf7e5556475af4d8e.js.map