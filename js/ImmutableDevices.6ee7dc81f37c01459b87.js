"use strict";(self.webpackChunkvulnerability=self.webpackChunkvulnerability||[]).push([[4634],{92162:(e,t,r)=>{r.d(t,{Z:()=>s});var n=r(29439),o=r(93942),i=r(54025),u=r(32132),a=r(30893);const s=function(e,t){var r=(0,o.v9)((function(e){var t=e.entities;return null==t?void 0:t.operatingSystems}))||[],s=(0,i.useLoadModule)({appName:"inventory",scope:"inventory",module:"./OsFilterHelpers"}),c=(0,n.Z)(s,1)[0],l=void 0===c?{}:c,f=l.toGroupSelectionValue,p=l.buildOSFilterConfig;return p?[p({label:u.N.formatMessage(a.Z.osFilterLabel),type:"checkbox",id:"rhel_version",value:f(e?e.split(","):[]),onChange:function(e,r){var n=Object.values(r).flatMap((function(e){return Object.keys(e)})).toString();t({rhel_version:n,page:1})},placeholder:u.N.formatMessage(a.Z.osFilterPlaceholder)},r)]:[]}},95351:(e,t,r)=>{r.d(t,{Z:()=>f});var n=r(4942),o=r(29439),i=r(83237),u=r(32132),a=r(23279),s=r.n(a),c=r(77865),l=r.n(c);const f=function(e,t,r,a,c){var f=l().useState(),p=(0,o.Z)(f,2),d=p[0],v=p[1],y=l().useState((function(){return s()((function(t){var r;void 0!==t&&c((r={},(0,n.Z)(r,e,t),(0,n.Z)(r,"page",1),r))}),400)})),m=(0,o.Z)(y,1)[0];return l().useEffect((function(){return v(a)}),[a]),{type:i.Y.text,label:u.N.formatMessage(t),key:e,filterValues:{"aria-label":"search-field",id:"search-".concat(t.id),onChange:function(e,t){v(t),m(t)},placeholder:u.N.formatMessage(r),value:d}}}},33606:(e,t,r)=>{r.r(t),r.d(t,{default:()=>U});var n=r(93433),o=r(4942),i=r(29439),u=r(77865),a=r.n(u),s=r(45697),c=r.n(s),l=r(74806),f=r(29648),p=r(93942),d=r(83296),v=r(22167),y=r(57998),m=r(64091),g=r(78733),b=r(66123),O=r(24788),h=r(15861),j=r(64687),w=r.n(j),_=r(71478);function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Z=function(){var e=(0,h.Z)(w().mark((function e(t,r){var n,o,i,u;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,_.ip)(t);case 2:if(n=e.sent,!(o=null==n?void 0:n.data.map((function(e){return e.id}))).length){e.next=9;break}return e.next=7,r({devices_uuid:o});case 7:u=e.sent,null===(i=n.data)||void 0===i||i.forEach((function(e){var t,r,n=null==u||null===(t=u.data)||void 0===t||null===(r=t.devices)||void 0===r?void 0:r.find((function(t){return t.DeviceUUID===e.id}));return e.attributes=k(k({},e.attributes),n)}));case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),D=function(e){var t=g.jp.find((function(e){return"os"===e.key})),r=g.jp.find((function(e){return"advisories_list"===e.key})),o=e.findIndex((function(e){return"system_profile"===e.key}));return-1!==o&&(e[o]=t),[].concat((0,n.Z)(e),[r||[]])},E=r(97481),S=r(15248),F=r(95351),N=r(92162),C=r(22663),L=r(37450),x=r(30893);function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var R=function(e){var t=e.cveName,r=e.intl,o=(0,L.Wu)([g._I.readHosts],"inventory"),s=(0,i.Z)(o,2),c=(0,i.Z)(s[0],1)[0],l=s[1],j=(0,p.I0)(),P=(0,f.H1)(g.qB),V=(0,i.Z)(P,2),R=V[0],U=V[1],B=(0,p.v9)((function(e){var t=e.entities;return null==t?void 0:t.total})),I=(0,p.v9)((function(e){var t=e.entities;return(null==t?void 0:t.error)||{}})),q=(0,p.v9)((function(e){return e.ImmutableDevicesStore.parameters}),p.wU),H=function(e){return j((0,m.dT)(e))};(0,u.useEffect)((function(){return H(R)}),[]),(0,u.useEffect)((function(){return U(M({},q))}),[q]);var z=function(e){var t=e.id,r=e.setUrlParams,n=e.createRows,o=(0,_.hC)(),i=function(){var e=(0,h.Z)(w().mark((function e(i,u){var a,s,c,l,f,p,d,v,y,m,g,b,O,h,j,_,P,D;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y=u.orderBy,m=u.orderDirection,g=u.page,b=u.per_page,O=u.edgeParams,h=u.filters,j=h.hostnameOrId,_="".concat("ASC"===m?"":"-").concat(y),P=k(k(k({filter:j},O),null!=h&&h.hostGroupFilter?{group_names:h.hostGroupFilter.join(",")}:{}),{},{page:g,page_size:b,sort:_}),null==r||r(k({},P)),e.next=7,Z(k(k({},t&&{id:t}),P),o);case 7:return D=e.sent,e.abrupt("return",{results:"function"==typeof n?n(D||{}):null==D||null===(a=D.data)||void 0===a?void 0:a.map((function(e){return k({id:e.id},e.attributes)})),total:null==D||null===(s=D.meta)||void 0===s?void 0:s.total_items,page:null==D||null===(c=D.meta)||void 0===c?void 0:c.page,perPage:null==D||null===(l=D.meta)||void 0===l?void 0:l.page_size,meta:{page:null==D||null===(f=D.meta)||void 0===f?void 0:f.page,sort:null==D||null===(p=D.meta)||void 0===p?void 0:p.sort,page_size:null==D||null===(d=D.meta)||void 0===d?void 0:d.page_size,cves_without_errata:null==D||null===(v=D.meta)||void 0===v?void 0:v.cves_without_errata}});case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();return i}({id:t,createRows:v.mU}),A=(0,F.Z)("filter",x.Z.systemsSearchName,x.Z.searchFilterByName,q.filter,H),T=(0,F.Z)("advisory",x.Z.advisoryName,x.Z.searchFilterByAdvisoryName,q.advisory,H),G=(0,N.Z)(q.rhel_version,H),Y={filters:(0,S.DU)(M({},q)),onDelete:function(e,t){return(0,S.vH)(t,H)},deleteTitle:r.formatMessage(x.Z.resetFilters)};return l?a().createElement(E.Z,{centered:!0}):null!=I&&I.hasError&&!c?a().createElement(b.Z,{code:null==I?void 0:I.errorCode}):a().createElement(C.Z,{appName:"inventory",module:"./ImmutableDevices",fallback:a().createElement("div",null),store:d.Z.getStore(),onLoad:function(e){var t=e.mergeWithEntities;d.Z.register(M({},t((0,y.K)([]),M({page:Number(q.page||1),perPage:g.L8},q.sort&&{sortBy:{key:q.sort.replace(/^-/,""),direction:q.sort.match(/^-/)?"desc":"asc"}}))))},key:"inventory",customFilters:{edgeParams:M({},q)},getEntities:z,showActions:0!==B,hideFilters:{all:!0,hostGroupFilter:!1},noSystemsTable:a().createElement(O.UE,null),mergeAppColumns:D,filterConfig:{items:[A,T].concat((0,n.Z)(G))},activeFiltersConfig:Y})};R.propTypes={cveName:c().string,intl:c().object};const U=(0,l.ZP)(R)},15248:(e,t,r)=>{r.d(t,{A6:()=>f,DU:()=>v,HV:()=>d,Yy:()=>m,lO:()=>p,vH:()=>y});var n=r(4942),o=r(30893),i=r(78733),u=r(32132),a=r(18446),s=r.n(a);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f=function(e,t,r){return r({page:t})},p=function(e,t,r){return r({page_size:t,page:1})},d=function(e){return{onSelect:function(t,r){return e.downloadReport(r)}}},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=e.filter,n=e.advisory,a=function(e,r){return i.Oq[e].items.reduce((function(n,o){if(r===o.value)n.name=o.label,n.value=o.value;else if("rule_presence"===e){var u=t.find((function(e){return e.value===r}));["true","false",i.Zm].includes(r)?n.name=i.Oq.rule_presence.items.find((function(e){return e.value===r})).label:n.name=u&&u.label||r,n.value=r}return n}),{})},s=function(e,t){return e.reduce((function(e,r){return e.push(a(t,r)),e}),[])},c=function(e,t){return Object.keys(e).includes(t)&&!["",void 0].includes(e[t])},l=Object.keys(i.Oq).reduce((function(t,r){if("rule_presence"===r&&(c(e,"rule_presence")||c(e,"rule"))){var n=[].concat(e.rule_presence?e.rule_presence.split(","):[],e.rule?e.rule.split(","):[]);t.push({key:r,multiValue:n,category:i.Oq[r].title,chips:s(n,r)})}else if("cvss_filter"===r&&(c(e,"cvss_from")||c(e,"cvss_to"))){var o=e.cvss_from&&parseFloat(e.cvss_from).toFixed(1)||"0.0",u=e.cvss_to&&parseFloat(e.cvss_to).toFixed(1)||"10.0";"0.0"===o&&"10.0"===u||t.push({key:r,category:i.Oq[r].title,chips:[{name:"".concat(o," - ").concat(u)}]})}else if("rhel_version"===r&&c(e,"rhel_version"))t.push({key:r,multiValue:e.rhel_version.split(","),category:"Operating system",chips:e.rhel_version.split(",").map((function(e){return{value:e,name:"RHEL ".concat(e)}}))});else if(c(e,r)){var l="string"==typeof e[r]&&e[r].split(","),f=l&&l.length>1&&s(l,r)||[a(r,e[r])];t.push({key:r,multiValue:l,category:i.Oq[r].title,chips:f})}return t}),[]);return r&&l.push({key:"filter",category:u.N.formatMessage(o.Z.searchLabel),chips:[{name:r}]}),n&&l.push({key:"advisory",category:u.N.formatMessage(o.Z.advisoryName),chips:[{name:n}]}),l},y=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t(r?l(l({},arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),{},{page:1,reset:r}):l(l({},e.reduce((function(e,t){if("rule_presence"===t.key){var r=t.multiValue.filter((function(e){return!t.chips.some((function(t){return t.value===e}))}));e.rule_presence=r.filter((function(e){return["true","false"].includes(e)})).join(",")||"",e.rule=r.filter((function(e){return!["true","false"].includes(e)})).join(",")||""}else"filter"===t.key||"advisory"===t.key||t.multiValue&&1===t.multiValue.length?e[t.key]="":"cvss_filter"===t.key?(e.cvss_filter=void 0,e.cvss_from=void 0,e.cvss_to=void 0):e[t.key]=t.multiValue.filter((function(e){return!t.chips.some((function(t){return t.value===e}))})).join(",");return""===e[t.key]&&(e[t.key]=void 0),e}),{})),{},{page:1}))},m=function(e,t,r){return e=r.reduce((function(t,r){return l(l({},t),e[r]&&(0,n.Z)({},r,e[r]))}),{}),s()(e,t)}},57998:(e,t,r)=>{r.d(t,{K:()=>c});var n=r(4942),o=r(18535),i=r(75910);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s={columns:[],rows:[],entities:[],loaded:!1,tagsLoaded:!1,allTagsLoaded:!1,invConfig:{},sortBy:{key:"updated",direction:"desc"},page:1,perPage:r(78733).L8,selectedRows:[],selectedRowsCount:0},c=function(e){return function(){var t=arguments.length>1?arguments[1]:void 0,r=a({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:s);switch(t.type){case i.LY+"_FULFILLED":return function(e,t,r){return t.selectedRows||(t.selectedRows=[]),t.sortBy||(t.sortBy={key:"updated",direction:"desc"}),t.loaded?a(a({},t),{},{columns:e,rows:t.rows.map((function(e){return a(a({},e),{},{selected:t.selectedRows.some((function(t){return t.id===e.id}))||!1})})),meta:r.payload.meta}):t}(e,r,t);case i.pr:return(0,o.hd)(r,t,t.selecting);case i.xC:return a(a({},r),{},{rows:r.rows.map((function(e){return a(a({},e),{},{isOpen:e.id===t.payload.id?t.payload.isOpen:e.isOpen})}))});case i.t2:return s;default:return r}}}}}]);
//# sourceMappingURL=../sourcemaps/ImmutableDevices.35367523c59e88ede02604f119992482.js.map