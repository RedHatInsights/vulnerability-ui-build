"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[226],{24557:(e,t,a)=>{a.r(t),a.d(t,{CVEPageContext:()=>et,default:()=>at});var r=a(29439),n=a(86350),s=a(45697),l=a.n(s),o=a(77865),c=a.n(o),i=a(43003),u=a(28216),m=a(83594),f=a(5977),v=a(78733),d=a(50693),p=a(16475),E=a(49739),g=a(83826),Z=a(68340),y=a(68774),b=a(74806),N=a(30893),h=a(4942),M=a(87462),w=a(45987),P=a(56455),V=a(60448),S=a(6023),_=a(75863),x=["isLoading","variant","children"];function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){(0,h.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var k={spinner:"spinner",table:"table",compactTable:"compactTable",rectangle:"rectangle",inlineSkeleton:"inlineSkeleton",skeleton:"skeleton"},j=function(e){var t=e.isLoading,a=e.variant,r=e.children,n=(0,w.Z)(e,x);if(t)switch(a){case k.spinner:return c().createElement(S.Z,(0,M.Z)({centered:!0},n));case k.table:return c().createElement(V.Z,n);case k.compactTable:return c().createElement(V.Z,(0,M.Z)({variant:_.B.compact},n));case k.rectangle:return c().createElement(P.Z,(0,M.Z)({shape:"square"},n));case k.inlineSkeleton:return c().createElement(P.Z,(0,M.Z)({size:P.i.lg},n,{style:C({display:"inline-block"},n.style)}));default:return c().createElement(P.Z,(0,M.Z)({size:P.i.lg},n))}return r};j.propTypes={isLoading:l().bool,variant:l().oneOf(Object.keys(k)),style:l().object,children:l().node};const R=j;var L=function(e){var t=e.cveAttributes,a=e.intl,r=t.public_date,n=t.description,s=t.rh_link;return c().createElement(et.Consumer,null,(function(e){return c().createElement(E.K,{hasGutter:!0},c().createElement(g.v,{className:"pf-u-mt-sm"},c().createElement("div",null,c().createElement("span",{className:"pf-u-mr-xs"},a.formatMessage(N.Z.publishDate),":"),c().createElement(R,{isLoading:e.isLoading,variant:k.inlineSkeleton,style:{width:"100px"}},r))),c().createElement(g.v,null,c().createElement(R,{isLoading:e.isLoading,variant:k.rectangle,style:{height:"132px",width:"100%"}},c().createElement(y.D,{style:{textAlign:"justify"}},c().createElement(Z.x,{component:Z.q.p},n)))),c().createElement(g.v,{className:"pf-u-mt-sm pf-u-mb-md"},s))}))};L.propTypes={cveAttributes:l().any,intl:l().any};const D=(0,b.ZP)(L);var A=a(79851),I=a(34512),T=a(90496),H=a(29648),F=a(79706),q=a(91290),J=a(3351),B=a(22860),U=a(6934),K=a(32132),G={AV:{name:K.N.formatMessage(N.Z.vectorNamesV3AV),values:{N:K.N.formatMessage(N.Z.vectorValuesNetwork),A:K.N.formatMessage(N.Z.vectorValuesAdjacent),L:K.N.formatMessage(N.Z.vectorValuesLocal),P:K.N.formatMessage(N.Z.vectorValuesPhysical)}},AC:{name:K.N.formatMessage(N.Z.vectorNamesV3AC),values:{L:K.N.formatMessage(N.Z.vectorValuesLow),H:K.N.formatMessage(N.Z.vectorValuesHigh)}},PR:{name:K.N.formatMessage(N.Z.vectorNamesV3PR),values:{N:K.N.formatMessage(N.Z.vectorValuesNone),L:K.N.formatMessage(N.Z.vectorValuesLow),H:K.N.formatMessage(N.Z.vectorValuesHigh)}},UI:{name:K.N.formatMessage(N.Z.vectorNamesV3UI),values:{N:K.N.formatMessage(N.Z.vectorValuesNone),R:K.N.formatMessage(N.Z.vectorValuesRequired)}},S:{name:K.N.formatMessage(N.Z.vectorNamesV3S),values:{U:K.N.formatMessage(N.Z.vectorValuesUnchanged),C:K.N.formatMessage(N.Z.vectorValuesChanged)}},C:{name:K.N.formatMessage(N.Z.vectorNamesV3C),values:{N:K.N.formatMessage(N.Z.vectorValuesNone),L:K.N.formatMessage(N.Z.vectorValuesLow),H:K.N.formatMessage(N.Z.vectorValuesHigh)}},I:{name:K.N.formatMessage(N.Z.vectorNamesV3I),values:{N:K.N.formatMessage(N.Z.vectorValuesNone),L:K.N.formatMessage(N.Z.vectorValuesLow),H:K.N.formatMessage(N.Z.vectorValuesHigh)}},A:{name:K.N.formatMessage(N.Z.vectorNamesV3A),values:{N:K.N.formatMessage(N.Z.vectorValuesNone),L:K.N.formatMessage(N.Z.vectorValuesLow),H:K.N.formatMessage(N.Z.vectorValuesHigh)}},CVSS:{name:K.N.formatMessage(N.Z.vectorNamesCvssVersion),values:{"3.0":3}}},W={AV:{name:K.N.formatMessage(N.Z.vectorNamesV2AV),values:{N:K.N.formatMessage(N.Z.vectorValuesNetwork),A:K.N.formatMessage(N.Z.vectorValuesAdjacentNetwork),L:K.N.formatMessage(N.Z.vectorValuesLocal)}},AC:{name:K.N.formatMessage(N.Z.vectorNamesV2AC),values:{N:K.N.formatMessage(N.Z.vectorValuesNone),L:K.N.formatMessage(N.Z.vectorValuesLow),H:K.N.formatMessage(N.Z.vectorValuesHigh)}},Au:{name:K.N.formatMessage(N.Z.vectorNamesV2AU),values:{M:K.N.formatMessage(N.Z.vectorValuesMultiple),S:K.N.formatMessage(N.Z.vectorValuesSingle),N:K.N.formatMessage(N.Z.vectorValuesNone)}},C:{name:K.N.formatMessage(N.Z.vectorNamesV2C),values:{C:K.N.formatMessage(N.Z.vectorValuesComplete),P:K.N.formatMessage(N.Z.vectorValuesPartial),N:K.N.formatMessage(N.Z.vectorValuesNone)}},I:{name:K.N.formatMessage(N.Z.vectorNamesV2I),values:{C:K.N.formatMessage(N.Z.vectorValuesComplete),P:K.N.formatMessage(N.Z.vectorValuesPartial),N:K.N.formatMessage(N.Z.vectorValuesNone)}},A:{name:K.N.formatMessage(N.Z.vectorNamesV2A),values:{C:K.N.formatMessage(N.Z.vectorValuesComplete),P:K.N.formatMessage(N.Z.vectorValuesPartial),N:K.N.formatMessage(N.Z.vectorValuesNone)}}},z=a(60329),Q=function(e){var t,a,n,s=e.cvss2_metrics,l=e.cvss3_metrics,o=e.intl,i=(l?"CVSS 3.0":s&&"CVSS 2.0")||"CVSS 3.0",u=l||s,m=(a=l&&G||s&&W,n={},(t=u)&&t.split("/").forEach((function(e){var t=e.split(":"),s=(0,r.Z)(t,2),l=s[0],o=s[1],c=a[l]&&a[l].name,i=a[l]&&a[l].values[o]||"N/A";c&&(n[c]=i)})),n);return delete m.cvssVersion,c().createElement(et.Consumer,null,(function(t){return c().createElement(y.D,null,c().createElement(F.J,{id:"popover-cvss",position:"bottom",maxWidth:"100%",enableFlip:!0,headerContent:"".concat(i," ").concat(o.formatMessage(N.Z.cvssVectorPopoverTitle)),bodyContent:c().createElement(R,{isLoading:t.isLoading,colSize:2,rowSize:8,variant:k.compactTable},u?c().createElement(J.i,{"aria-label":"Metric breakdown",variant:_.B.compact,gridBreakPoint:"",cells:[o.formatMessage(N.Z.cvssVectorMetric),o.formatMessage(N.Z.cvssVectorValue)],rows:Object.entries(m)},c().createElement(U.x,null),c().createElement(B.R,null)):"N/A")},c().createElement(z.Z,{isLarge:!0,className:"pf-u-mb-xs pointer"},i," ",o.formatMessage(N.Z.cvssVectorVectorString),c().createElement(q.ZP,{color:"var(--pf-global--secondary-color--100)",className:"pf-u-ml-xs"}))),c().createElement(R,{isLoading:t.isLoading,style:{width:"320px"}},c().createElement("span",{className:"pf-u-mr-md"},e.score),c().createElement("span",{id:"cvss-vector-content"},o.formatMessage(N.Z.vector)+": ",(null==u?void 0:u.substring(u.indexOf("/")+1))||"N/A")))}))};Q.propTypes={cvss2_metrics:l().string,cvss3_metrics:l().string,score:l().any,intl:l().any};const Y=(0,b.ZP)(Q);var X=function(e){var t=e.title,a=e.value,r=e.content;return c().createElement(F.J,{id:"popover",bodyContent:r,headerContent:"",position:"bottom",appendTo:document.querySelector(".vulnerability")},c().createElement(E.K,{className:"popover-content"},c().createElement(g.v,null,c().createElement(z.Z,{isLarge:!0},t)),c().createElement(g.v,null,c().createElement("a",null,a))))};X.propTypes={title:l().any,value:l().any,content:l().any};const $=X;var ee=a(69957),te=a(89687),ae=function(e){var t=e.cveAttributes,a=e.intl,r=(0,H.nJ)(t.impact||"Unknown"),n=t.business_risk,s=t.business_risk_justification,l=t.status,o=t.status_justification,i=t.systems_status_detail,u=t.systems_status_divergent,m=i&&Object.keys(i).map((function(e){return[v.Em.find((function(t){return t.value===e.toString()})).label,i[e].toString()]})),f=c().createElement(E.K,{className:"pf-u-p-xs"},c().createElement(g.v,null,c().createElement(z.Z,{className:"pf-u-mb-xs"},a.formatMessage(N.Z.justificationNote))),c().createElement(g.v,null,s||"--")),d=c().createElement(E.K,{className:"pf-u-p-xs"},c().createElement(g.v,null,c().createElement(z.Z,{className:"pf-u-mb-xs"},a.formatMessage(N.Z.cveStatus)),l||"--",c().createElement(z.Z,{className:"pf-u-mb-xs pf-u-mt-sm"},a.formatMessage(N.Z.justificationNote)),o||"--"),u>0&&c().createElement(g.v,null,c().createElement(y.D,null,c().createElement("hr",{className:"pf-u-mt-sm pf-u-mb-sm"})),c().createElement(z.Z,{isLarge:!0},a.formatMessage(N.Z.cveDetailsPageSystemsWTCves)),c().createElement(J.i,{"aria-label":"Status details",gridBreakPoint:"",cells:[a.formatMessage(N.Z.statusLabel),a.formatMessage(N.Z.count)],rows:m,className:"status-breakdown-table",variant:"compact"},c().createElement(U.x,null),c().createElement(B.R,null))));return c().createElement(et.Consumer,null,(function(e){return c().createElement(E.K,{hasGutter:!0},c().createElement(g.v,null,c().createElement(A.P,{hasGutter:!0},c().createElement(I.J,null,c().createElement($,{title:a.formatMessage(N.Z.businessRiskLabel),value:c().createElement(R,{isLoading:e.isLoading,style:{width:"100px"}},n),content:f})),c().createElement(I.J,{className:"pf-u-ml-lg"},c().createElement($,{title:a.formatMessage(N.Z.statusLabel),content:d,value:c().createElement(R,{isLoading:e.isLoading,style:{width:"100px"}},c().createElement("span",null,u>0&&c().createElement(ee.ZP,{color:"var(--pf-global--primary-color--100)"})," ",l))})))),c().createElement(g.v,null,c().createElement(z.Z,{className:"pf-u-mb-xs",isLarge:!0},a.formatMessage(N.Z.impact)),c().createElement(R,{isLoading:e.isLoading,style:{width:"100px"}},c().createElement("span",{id:"severity-shield",style:{color:r.color}},c().createElement(te.Z,{impact:r.title,hasLabel:!0})))),c().createElement(g.v,null,c().createElement(Y,{cvss2_metrics:t.cvss2_metrics,cvss3_metrics:t.cvss3_metrics,score:(0,T.Z)(t.cvss2_score,t.cvss3_score)})))}))};ae.propTypes={cveAttributes:l().any,intl:l().any};const re=(0,b.ZP)(ae);var ne=a(35224),se=a(32203),le=a(62394),oe=a(61932),ce=a(73727),ie=a(78216),ue=a(68778),me=a(15265),fe=a(26076),ve=a(53411),de=a(38463),pe=function(e){var t=e.rules,a=e.synopsis,r=e.changeExposedSystemsParameters,n=e.intl,s=(0,u.I0)(),l=[].concat(t).sort((function(e,t){return t.systems_affected-e.systems_affected}));return l&&l.map((function(e,t){var l;return e.summary&&c().createElement(se.Z,{className:"card-box",key:e.rule_id,ouiaId:"security-rule-card-"+t},c().createElement(oe.L,{toggleText:c().createElement(A.P,null,c().createElement(I.J,{className:"pf-u-mr-xl"},c().createElement(y.D,null,c().createElement(Z.x,{component:Z.q.h4},c().createElement(ve.Z,{className:"pf-u-mr-sm"}),e.description))),c().createElement(I.J,{id:"filter-affected-systems-split"},e.rule_id&&c().createElement(y.D,null,c().createElement(Z.x,{id:"filter-affected-systems",onClick:function(t){var a;a=e.rule_id,s(r({rule:a})),t.stopPropagation()},component:Z.q.small},c().createElement(ce.rU,{key:e.rule_id,to:"/cves/".concat(a,"/?rule=").concat(e.rule_id)},n.formatMessage(N.Z.filterByAffectedSystems,{count:null!==(l=e.systems_affected)&&void 0!==l?l:-1}))))))},c().createElement(le.e,{className:"rule-card-body"},c().createElement(d.r,{hasGutter:!0},c().createElement(p.P,{md:9,sm:12},c().createElement(E.K,{hasGutter:!0},c().createElement(g.v,null,c().createElement(de.Z,{text:e.summary})),c().createElement(g.v,null,c().createElement(y.D,null,c().createElement(A.P,null,e.rule_impact&&c().createElement(I.J,null,c().createElement(z.Z,{className:"label pf-u-mb-xs"},n.formatMessage(N.Z.impact)),c().createElement(ne.u,{content:Object.values(v.l8)[e.rule_impact-1]},c().createElement(ie.Z,{value:e.rule_impact,className:"severity-label"}))),c().createElement(I.J,null,c().createElement(z.Z,{className:"label pf-u-mb-xs"},n.formatMessage(N.Z.riskOfChange)),c().createElement(ne.u,{content:v.p3[e.change_risk]},v.MS[e.change_risk])),c().createElement(I.J,null,c().createElement(z.Z,{className:"label pf-u-mb-xs"},n.formatMessage(N.Z.remediationLabel)),c().createElement(A.P,null,c().createElement(I.J,null,e.playbook_count?c().createElement(o.Fragment,null,c().createElement(ue.ZP,{className:"checkCircleIcon pf-u-mr-xs"}),n.formatMessage(N.Z.yes),c().createElement(ne.u,{content:n.formatMessage(N.Z.ansibleRemediationTooltip)},c().createElement(q.ZP,{className:"l-sm-spacer outlinedQuestionCircleIcon"}))):n.formatMessage(N.Z.no)),c().createElement(I.J,{className:"pf-u-ml-md"},e.reboot_required&&c().createElement(Z.x,null,c().createElement(fe.ZP,{className:"pf-u-mr-xs powerOffIcon"}),n.formatMessage(N.Z.rebootRequired)))))))),e.kbase_node_id&&c().createElement(g.v,null,c().createElement(y.D,null,c().createElement(Z.x,{className:"pf-u-mt-xs",component:Z.q.p},c().createElement("a",{className:"kb-link",href:"".concat(v.E7,"/").concat(e.kbase_node_id),target:"_blank",rel:"noopener noreferrer"},n.formatMessage(N.Z.knowledgebaseArticle),c().createElement(me.ZP,{className:"l-sm-spacer"}))))))),c().createElement(p.P,{md:3,sm:12},c().createElement(y.D,null,c().createElement(z.Z,null,n.formatMessage(N.Z.associatedCves)),c().createElement(Z.x,{component:Z.q.p,className:"pf-u-mt-xs associated-cves"},a," (",n.formatMessage(N.Z.current),")",e.associated_cves.filter((function(e){return e!==a})).map((function(e,t){return c().createElement("a",{className:"associated-cve-link",key:t,href:"".concat(v.OF,"/").concat(e)},e)})).reduce((function(e,t){return[e,", ",t]}),[""]))))))))}))};pe.defaultProps={rules:[]},pe.propTypes={intl:l().any,rules:l().array,synopsis:l().string,changeExposedSystemsParameters:l().func};const Ee=(0,b.ZP)(pe);var ge=a(86896),Ze=a(86135),ye=function(){var e=(0,ge.Z)();return c().createElement(se.Z,{className:"card-box",ouiaId:"known-exploit-card"},c().createElement(oe.L,{toggleText:c().createElement(y.D,null,c().createElement(Z.x,{component:Z.q.h4},c().createElement(Ze.Z,{className:"pf-u-mr-sm"}),e.formatMessage(N.Z.knownExploitHeader)))},c().createElement(le.e,null,e.formatMessage(N.Z.knownExploitDescription))))},be=function(e){var t=e.data,a=e.changeExposedSystemsParameters;return c().createElement(d.r,{hasGutter:!0},c().createElement(p.P,{md:8,sm:12},c().createElement(D,{cveAttributes:t.data})),c().createElement(p.P,{md:4,sm:12,className:"pf-u-mt-sm pf-u-ml-sm"},c().createElement(re,{cveAttributes:t.data})),t.data.known_exploit&&c().createElement(ye,null),c().createElement(Ee,{changeExposedSystemsParameters:a,synopsis:t.data.synopsis,rules:t.data.rules}))};be.propTypes={data:l().object,changeExposedSystemsParameters:l().func};const Ne=be;var he=a(41489),Me=a(74372),we=a(19738),Pe=a(66516),Ve=a(83296),Se=a(57998),_e=a(62215),xe=a(33739),Oe=a(66123),Ce=a(83215),ke=a(24788),je=a(93433),Re=a(49629),Le=a(16493),De=a(16369),Ae=a(1792),Ie=a(92162),Te=a(15248),He=a(37450),Fe=a(95351),qe=a(63368);function Je(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Be(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(a),!0).forEach((function(t){(0,h.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Je(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Ue=function(e){var t=e.rawData,a=e.cveName,r=e.cveStatusDetails,n=e.selectedRows,s=e.selectedRowsCount,l=e.selectedRowsRawData,i=e.filterRuleValues,u=e.parameters,f=e.methods,d=e.canEditPairStatus,p=e.canExport,E=e.children,g=(0,ge.Z)(),Z=f.apply,y=f.showStatusModal,b=f.handleSelect,h=f.downloadReport,M=f.setColumnModalOpen,w=t.isLoaded,P=t.meta,V=l.filter((function(e){return e.remediation===v.sF})),S=[""].concat((0,je.Z)(d?[{label:g.formatMessage(N.Z.editStatus),onClick:function(){return y([r],l)},props:{isDisabled:!s}}]:[]),[{label:g.formatMessage(N.Z.columnManagementModalTitle),onClick:function(){return M(!0)}}]),_=(0,Fe.Z)("filter",N.Z.systemsSearchName,N.Z.searchFilterByName,u.filter,Z),x=(0,Fe.Z)("advisory",N.Z.advisory,N.Z.searchFilterByAdvisory,u.advisory,Z),O=(0,Ie.Z)(u.rhel_version,Z),C=(0,He.ZS)({rawData:t,selectedRows:n,selectedRowsCount:s,handleSelect:b,fetchResource:function(e){return(0,m.Wf)(Be(Be({id:a},u),e))}});return c().createElement(o.Fragment,null,c().createElement(Re.Z,{className:"vuln-systems-primary-toolbar",exportConfig:p&&Be({isDisabled:0===P.totalItems,ouiaId:"export"},(0,Te.HV)({downloadReport:h})),dedicatedAction:w&&c().createElement(Le.Z,{manyRules:!0,isDisabled:0===V.length,systems:V,cves:{id:a,rules:i}}),actionsConfig:{actions:S,dropdownProps:{ouiaId:"toolbar-actions"}},activeFiltersConfig:{filters:(0,Te.DU)(Be({},u),i),onDelete:function(e,t){return(0,Te.vH)(t,Z)},deleteTitle:g.formatMessage(N.Z.resetFilters)},bulkSelect:C,filterConfig:{items:[_,(0,De.Z)(Z,u,i,{isDynamic:!0,dropdownItems:v.cM}),(0,Ae.Z)(Z,u),x,O,(0,qe.Z)(Z,u)]}}),E)};Ue.propTypes={rawData:H.nE,parameters:l().object,cveName:l().string,cveStatusDetails:l().object,filterRuleValues:l().object,selectedRows:l().array,selectedRowsCount:l().number,selectedRowsRawData:l().array,children:l().node,methods:l().shape({apply:l().func,handleSelect:l().func,showStatusModal:l().func,downloadReport:l().func,setColumnModalOpen:l().func}),canEditPairStatus:l().bool,canExport:l().bool};var Ke=a(71478),Ge=a(66761);function We(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ze(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?We(Object(a),!0).forEach((function(t){(0,h.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):We(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Qe=function(e){var t=e.intl,a=e.cveName,n=e.cveStatusDetails,s=e.filterRuleValues,l=e.hasSecurityRule,f=e.canEditPairStatus,d=e.canExport,p=e.inventoryRef,b=e.refreshInventory,h=(0,u.I0)(),M=(0,o.useState)((function(){return function(){return null}})),w=(0,r.Z)(M,2),P=w[0],V=w[1],S=(0,H.H1)(v.qB),x=(0,r.Z)(S,2),O=x[0],C=x[1],k=(0,o.useState)(!1),j=(0,r.Z)(k,2),R=j[0],L=j[1],D=(0,u.v9)((function(e){var t=e.entities;return(null==t?void 0:t.rows)||[]}),u.wU),A=(0,u.v9)((function(e){var t=e.entities;return null==t?void 0:t.total})),I=(0,u.v9)((function(e){var t=e.entities;return null==t?void 0:t.meta})),T=(0,u.v9)((function(e){var t=e.entities;return(null==t?void 0:t.error)||{}})),F=(0,u.v9)((function(e){var t=e.entities;return(null==t?void 0:t.selectedRows)||{}})),q=(0,u.v9)((function(e){var t=e.entities;return null==t?void 0:t.selectedRowsCount})),J=(0,u.v9)((function(e){var t=e.entities;return(null==t?void 0:t.selectedRowsRawData)||[]})),B=(0,u.v9)((function(e){var t=e.entities;return(null==t?void 0:t.loaded)||!1})),U=(0,u.v9)((function(e){return e.CVEDetailsPageStore.parameters}),u.wU),K=(0,u.v9)((function(e){return e.CVEDetailsPageStore.columns})),G=function(e){return h((0,m.vv)(e))};(0,o.useEffect)((function(){return G(O)}),[]),(0,o.useEffect)((function(){return C(ze(ze({},U),I))}),[C,U,I]),(0,o.useEffect)((function(){return function(){h((0,m.r5)())}}),[h]);var W=function(e,t){V((function(){return function(){return c().createElement(Pe.Z,{cveList:e,updateRef:function(){b(),h((0,m.ZO)(a))},inventoryList:t,type:"systemsExposed"})}}))},z=(0,He.U)(Ke.ip,{id:a,createRows:i.JF}),Q=(0,o.useState)(0),Y=(0,r.Z)(Q,2),X=Y[0],$=Y[1];(0,o.useEffect)((function(){return $(X+1)}),[K]);return c().createElement(E.K,{hasGutter:!0},c().createElement(g.v,null,c().createElement(y.D,null,c().createElement(Z.x,{component:Z.q.h2},t.formatMessage(N.Z.affectsSystems)))),c().createElement(g.v,null,null!=T&&T.hasError?c().createElement(Oe.Z,{code:null==T?void 0:T.errorCode}):c().createElement(xe.Z,{disableDefaultColumns:!0,onLoad:function(e){var t=e.mergeWithEntities;Ve.Z.register(ze({},t((0,Se.K)(v.jp),ze({page:Number(U.page||1),perPage:20},U.sort&&{sortBy:{key:U.sort.replace(/^-/,""),direction:U.sort.match(/^-/)?"desc":"asc"}}))))},tableProps:{isStickyHeader:!0,canSelectAll:!1,actionResolver:function(){return f&&A&&(0,i.ji)(W,n)},variant:_.B.compact},paginationProps:{isDisabled:!A},showTagModal:!0,isFullView:!0,ref:p,autoRefresh:!0,key:"inventory",customFilters:{vulnerabilityParams:ze({},U)},expandable:l,columnsCounter:X,columns:function(e){return t=e,K.filter((function(e){var t;return null!==(t=e.isShown)&&void 0!==t?t:e.isShownByDefault})).map((function(e){return ze(ze({},t.find((function(t){var a=t.key;return e.key===a}))),e)}));var t},getEntities:z,hasCheckbox:0!==A,showActions:0!==A,onExpandClick:function(e,t,a,r){var n=r.id;return h((0,m.yw)(n,a))},hideFilters:{all:!0},noSystemsTable:c().createElement(ke.UE,null)},c().createElement(Ue,{rawData:{data:D,meta:{totalItems:A},isLoaded:B},parameters:U,cveName:a,selectedRows:F,selectedRowsCount:q,selectedRowsRawData:J,cveStatusDetails:n,filterRuleValues:s,methods:{downloadReport:function(e){_e.Z.exec(m.TA,ze({id:a},U),e,"systems-exposed",(function(e){return h((0,Ce.wN)(e))}),(function(){return h((0,Ce.L1)())}))},apply:G,handleSelect:function(e){return h((0,m.hd)(e))},showStatusModal:W,setColumnModalOpen:L},canEditPairStatus:f,canExport:d},P&&c().createElement(P,null),c().createElement(Ge.Z,{appliedColumns:K,applyColumns:function(e){return h((0,m.w8)(e))},isModalOpen:R,setModalOpen:L})))))};Qe.propTypes={intl:l().object,cveName:l().string,cveStatusDetails:l().object,filterRuleValues:l().array,hasSecurityRule:l().bool,canEditPairStatus:l().bool,canExport:l().bool,inventoryRef:l().object,refreshInventory:l().func};const Ye=(0,b.ZP)((0,f.EN)(Qe));var Xe=a(75115),$e=a(61790),et=c().createContext({isLoading:!0}),tt=function(e){var t=e.match,a=(0,u.I0)(),s=c().createRef(),l=(0,He.Wu)([v._I.setPairStatus,v._I.setCveStatusAndBusinessRisk,v._I.basicReporting,v._I.readVulnerabilityResults]),f=(0,r.Z)(l,2),d=(0,r.Z)(f[0],4),p=d[0],E=d[1],g=d[2],Z=d[3],y=f[1],b=(0,o.useState)(t.params.cve),N=(0,r.Z)(b,1)[0],h=(0,o.useState)((function(){return function(){return null}})),M=(0,r.Z)(h,2),w=M[0],P=M[1],V=(0,o.useState)((function(){return function(){return null}})),S=(0,r.Z)(V,2),_=S[0],x=S[1],O=(0,u.v9)((function(e){return e.CVEDetailsPageStore.cveDetails})),C=(0,o.useMemo)((function(){return(0,i.m4)(O)}),[O]),k=(0,u.v9)((function(e){var t=e.entities;return null==t?void 0:t.total}));(0,o.useEffect)((function(){a((0,m.ZO)(N))}),[a,N]);var j=function(){return a((0,m.r5)()),s.current.onRefreshData({page:1})};(0,o.useEffect)((function(){return function(){a((0,m.ds)()),a((0,Ce.L1)())}}),[a]);var R,L,D=C.error,A=C.data,I={id:N,status_id:C.data.status_id,justification:C.data.status_justification,exposed_systems_count:k||0},T=[(0,he.Eh)((function(e){P((function(){return function(){return c().createElement(Me.Z,{open:!0,cves:e,updateRef:function(){return a((0,m.ZO)(N))}})}}))}),[{business_risk_id:C.data.business_risk_id,id:N,justification:C.data.business_risk_justification}]),(0,he.bp)((function(e){x((function(){return function(){return c().createElement(we.Z,{cves:e,updateRef:function(e){a((0,m.ZO)(N)),e&&j()}})}}))}),[I])],H=A.rules,F=H&&H.map((function(e){return{value:e.rule_id,label:e.description}}));return null!=D&&D.hasError?c().createElement(c().Fragment,null,c().createElement(Xe.Z,{title:N}),c().createElement(Oe.Z,{code:null==D?void 0:D.errorCode})):c().createElement(et.Provider,{value:C&&{isLoading:C.isLoading||y}},c().createElement(Xe.Z,{title:A.celebrity_name?N+" - "+A.celebrity_name:N,actions:E&&T,actionsOuiaId:"cve-actions",breadcrumbs:[{title:v.yy.cvesPage.title,to:v.yy.cvesPage.to,loaded:!0},{title:N,isActive:!0,loaded:!0}],labels:[c().createElement($e.Z,{key:"labels",hasExploit:!(null===(R=O.payload.data)||void 0===R||!R.attributes.known_exploit),hasRule:(null===(L=O.payload.data)||void 0===L?void 0:L.attributes.rules.length)>0})]},c().createElement(Ne,{changeExposedSystemsParameters:m.vv,data:C}),c().createElement(_,null),c().createElement(w,null)),c().createElement(n.Z,null,Z?c().createElement(Ye,{cveName:N,filterRuleValues:F,cveStatusDetails:I,hasSecurityRule:(null==H?void 0:H.length)>0,canEditPairStatus:p,canExport:g,inventoryRef:s,refreshInventory:j}):c().createElement(ke.bY,null)))};tt.propTypes={match:l().object};const at=(0,f.EN)(tt)}}]);
//# sourceMappingURL=../sourcemaps/CVEDetailsPage.ddadc3a866d3866174b56fff7cbef591.js.map