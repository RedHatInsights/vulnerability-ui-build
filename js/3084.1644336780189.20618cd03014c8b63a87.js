"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[3084],{1809:(e,t,r)=>{r.d(t,{Z:()=>f});var s=r(4942),a=r(77865),n=r.n(a),o=r(45697),l=r.n(o),i=r(74093),c=r(3968),u=r(80167),p=r(30893);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v=function(e){var t=e.intl,r=e.hasRule,s=e.hasExploit,a=e.isSmall,o=void 0!==a&&a;return n().createElement(i.G7,{style:u.Z.labelsWrapper},s&&n().createElement(i.G7,{style:d(d({},u.Z.label),{},{width:o?62:70})},n().createElement(c.Uc,{icon:!1,width:o?62:75,variant:4,label:t.formatMessage(p.Z.knownExploit),textStyle:o?d(d({},u.Z.smallText),{},{left:-56}):void 0,labelStyle:{border:"solid",borderWidth:1,borderColor:"#c9190b",height:o?12:20}})),r&&n().createElement(i.G7,{style:u.Z.label},n().createElement(c.Uc,{icon:!1,width:o?59:63,label:t.formatMessage(p.Z.securityRuleLabel),textStyle:o?u.Z.smallText:void 0,labelStyle:{border:"solid",borderWidth:1,borderColor:"#bee1f4",height:o?12:20}})))};v.propTypes={hasRule:l().bool,hasExploit:l().bool,intl:l().any,isSmall:l().bool};const f=v},75201:(e,t,r)=>{r.d(t,{Z:()=>m});var s=r(77865),a=r.n(s),n=r(45697),o=r.n(n),l=r(74093),i=r(80167),c=r(30893),u=r(22408),p=function(e){var t=e.hasRule,r=e.hasExploit;return a().createElement(l.G7,null,r&&a().createElement(l.xv,{style:i.Z.footer},(0,u.aR)(c.Z.knownExploitPDFFooter)),t&&a().createElement(l.xv,{style:i.Z.footer},(0,u.aR)(c.Z.securityRulePDFFooter)))};p.propTypes={hasRule:o().bool,hasExploit:o().bool};const m=p},43198:(e,t,r)=>{r.d(t,{Z:()=>y});var s=r(77865),a=r.n(s),n=r(45697),o=r.n(n),l=r(3968),i=r(74093),c=r(30893),u=r(62598),p=r(78733),m=r(22408),d=r(80167),v=r(61429),f=function(e){for(var t,r=e.data,n=e.meta,o=e.filters,f=e.intl,y=e.isReportDynamic,b=e.reportData,h=e.user,Z=e.type,g=y?o:o.reduce((function(e,t){var r,s;return e[t.key]={filter:t.category,values:"publish_date"===t.key?p.GZ.find((function(e){return e.value===t.chips[0].value})).timespan_label:t.chips.map((function(e){return e.name})).join(", "),isAllChosen:(null===(r=("cves"===Z?p.jW:p.Gb)[t.key])||void 0===r?void 0:r.component)===v.Z?t.chips.length===(null===(s=p.Oq[t.key])||void 0===s?void 0:s.items.length):null},e}),{}),_=[{name:"impact",msg:c.Z.CVEsPDFreportFiltersSeverity,lowercase:!0},{name:"business_risk_id",msg:c.Z.CVEsPDFreportFiltersBusinessRisk,lowercase:!0},{name:"status_id",msg:c.Z.CVEsPDFreportFiltersStatus,lowercase:!0},{name:"rule_presence",msg:c.Z.CVEsPDFreportFiltersDefinedValue,lowercase:!0},{name:"known_exploit",msg:c.Z.CVEsPDFreportFiltersDefinedValue,lowercase:!0},{name:"rhel_version",msg:c.Z.CVEsPDFreportFiltersOsVersion}],E=[{name:"filter",msg:c.Z.systemsPDFreportFiltersSearchTerm,lowercase:!0},{name:"rhel_version",msg:c.Z.systemsPDFreportFiltersOsVersion}],O="cves"===Z?_:E,w=0;w<O.length;w++)if(g.hasOwnProperty(O[w].name)){O[w].isFirst=!0;break}for(var P=O.length-1;P>=0;P--)if(g.hasOwnProperty(O[P].name)){O[P].isLast=!0;break}var D,x,C,k;return a().createElement(s.Fragment,{key:"first-section"},y&&a().createElement(l.nv,null,(0,m.aR)(c.Z.customReportIntroductionText)),"cves"===Z?a().createElement(l.nv,null,(0,m.aR)(c.Z.customReportSearchTermCvssAndPublishDate,{hasSearchTerm:g.hasOwnProperty("filter")?"yes":"no",searchTerm:g.filter&&g.filter.values,score:g.cvss_filter&&g.cvss_filter.values||p.OX.cvss_filter.from.toFixed(1)+" - "+p.OX.cvss_filter.to.toFixed(1),published:g.publish_date&&g.publish_date.values||(0,m.aR)(c.Z.customReportTimespanAnytime)}),O.map((function(e){var t;return g.hasOwnProperty(e.name)&&!(null!==(t=g[e.name])&&void 0!==t&&t.isAllChosen)&&(0,m.aR)(e.msg,{values:e.lowercase?g[e.name].values.toLowerCase():g[e.name].values,prefix:e.isLast?f.formatMessage(c.Z.customReportAnd):";"})})),a().createElement(i.xv,null,"."),"\n\n"):(k=null===(D=o.find((function(e){return"excluded"===e.key})))||void 0===D?void 0:D.multiValue,(null===(x=Object.values(g))||void 0===x||null===(C=x.filter((function(e){return!0!==e.isAllChosen})))||void 0===C?void 0:C.length)>0?a().createElement(l.nv,null,f.formatMessage(c.Z.systemsPDFreportSubHeader),1===(null==k?void 0:k.length)&&("true"===k[0]?" "+f.formatMessage(c.Z.systemsPDFreportFiltersExcluded):" "+f.formatMessage(c.Z.systemsPDFreportFiltersIncluded)),O.map((function(e){var t;return g.hasOwnProperty(e.name)&&!(null!==(t=g[e.name])&&void 0!==t&&t.isAllChosen)&&(0,m.aR)(e.msg,{values:e.lowercase?g[e.name].values.toLowerCase():g[e.name].values,prefix:e.isFirst?"":e.isLast?f.formatMessage(c.Z.customReportAnd):";"})})),".\n\n"):null),"cves"===Z&&a().createElement(l.nv,null,a().createElement(i.xv,null,(0,m.aR)(c.Z.CVEsPDFreportSubHeader,{cve_count:n.total_items.toString(),system_count:n.system_count.toString()}),(y&&(null===(t=b.header)||void 0===t?void 0:t.includes("known_exploit"))||!y)&&(0,m.aR)(c.Z.CVEsPDFreportSubHeaderExploit,{knownExploitCount:n.knownExploitCount.toString()}))),b&&b.userNotes?a().createElement(i.G7,{style:d.Z.userNotes},a().createElement(l.nv,{style:d.Z.userNotesTitle},a().createElement(i.xv,{style:d.Z.bold},f.formatMessage(c.Z.customReportUserNoteLabel))),a().createElement(l.nv,null,a().createElement(i.xv,null,b.userNotes)),a().createElement(l.nv,null,h&&h.identity&&a().createElement(i.xv,{style:d.Z.italic},f.formatMessage(c.Z.customReportUserNotesGenerated,{name:"".concat(h.identity.user.first_name," ").concat(h.identity.user.last_name)})))):null,a().createElement(i.G7,{style:d.Z.mt16},(0,u.Z)({data:r,intl:f,header:b&&b.header,type:Z,isReportDynamic:y})))};f.defaultProps={user:void 0},f.propTypes={intl:o().any,filters:o().array,data:o().object,meta:o().object,reportData:o().object,isReportDynamic:o().bool,user:o().object,type:o().string};const y=f},62598:(e,t,r)=>{r.d(t,{Z:()=>g});var s=r(4942),a=r(93433),n=r(77865),o=r.n(n),l=r(45697),i=r.n(l),c=r(74093),u=r(3968),p=r(35240),m=r(78733),d=r(30893),v=r(80167),f=r(29648),y=r(1809);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Z=function(e){var t=e.data,r=e.page,s=e.intl,l=e.header,i=e.type,b=e.isReportDynamic,Z=void 0!==b&&b,g=[{name:"publish_date",header:{value:s.formatMessage(d.Z.publishDate)}},{name:"cvss_filter",header:{value:s.formatMessage(d.Z.cvssBaseScore)},hit:"cvss_score"},{name:"impact",header:{value:s.formatMessage(d.Z.impact)},hit:"impact"},{name:"affecting",header:{value:s.formatMessage(d.Z.systemsExposed)},hit:"systems_affected"},{name:"business_risk_id",header:{value:s.formatMessage(d.Z.businessRisk)},hit:"business_risk"},{name:"status_id",header:{value:s.formatMessage(d.Z.status)},hit:"status"}],_=function(e){var t=e.value,r=e.style;return o().createElement(c.xv,{key:t,style:r},t)},E=["cvss_score","impact","systems_affected","business_risk","status"],O=[];l?(O.push({value:s.formatMessage(d.Z.cveId)}),E=[],g.forEach((function(e){l.includes(e.name)&&(O.push(e.header),e.hit&&E.push(e.hit))}))):"cves"===i?O=[{value:s.formatMessage(d.Z.cveId)}].concat(g.map((function(e){return e.header}))):(E=["display_name","os","cve_count","updated"],O=[{value:s.formatMessage(d.Z.systemsColumnHeaderName),id:"name"},{value:s.formatMessage(d.Z.systemsColumnHeaderOSFull)},{value:s.formatMessage(d.Z.systemsColumnHeaderCveCount)},{value:s.formatMessage(d.Z.systemsColumnHeaderUpdated)}]);var w=function(e){var t=e.rules&&e.rules.length>0;return Z?t&&l.includes("rule_presence"):t},P=(0,a.Z)(t.map((function(e){var t,r,n=e.attributes;return[o().createElement(c.G7,{style:[v.Z.bodyCell,v.Z.cveCell]},o().createElement(c.G7,null,o().createElement(c.xv,null,o().createElement(c.rU,{style:v.Z.link,src:"".concat(m.OF,"/").concat(n.synopsis)},n.synopsis))),o().createElement(y.Z,{hasExploit:(t=n,r=t.known_exploit,Z?r&&l.includes("known_exploit"):r),hasRule:w(n),intl:s,isSmall:!0})),(!l||l.includes("publish_date"))&&o().createElement(c.xv,{key:n.public_date,style:[v.Z.bodyCell,v.Z.cveCell]},(0,p.Un)(n.public_date))].concat((0,a.Z)(E.map((function(e){return _({value:n[e],style:[v.Z.bodyCell,v.Z.cveCell]})}))))}))),D=(0,a.Z)(t.map((function(e){var t=e.attributes;return[_({value:t.display_name,style:[v.Z.bodyCell,v.Z.systemNameCell]}),_({value:t.os,style:[v.Z.bodyCell,v.Z.systemCell]}),_({value:t.opt_out?s.formatMessage(d.Z.systemsTableExcluded):t.cve_count,style:[v.Z.bodyCell,v.Z.systemCell]}),_({value:(0,f.p6)(t.updated,!0),style:[v.Z.bodyCell,v.Z.systemCell]})]})));return o().createElement(n.Fragment,{key:r},o().createElement(u.iA,{withHeader:!0,rows:[O.map((function(e){return _(h(h({},e),{},{style:[v.Z.headerCell,"cves"===i?v.Z.cveCell:"name"===e.id?v.Z.systemNameCell:v.Z.systemCell]}))}))].concat((0,a.Z)("cves"===i?P:D))}),0===t.length&&o().createElement(c.xv,null,s.formatMessage(d.Z.customReportNoItems)))};Z.propTypes={data:i().object,intl:i().any,page:i().number,header:i().array,type:i().string,isReportDynamic:i().bool};const g=Z},33084:(e,t,r)=>{r.d(t,{Z:()=>R});var s=r(87462),a=r(93433),n=r(4942),o=r(15861),l=r(29439),i=r(45987),c=r(87757),u=r.n(c),p=r(77865),m=r.n(p),d=r(45697),v=r.n(d),f=r(86896),y=r(3968),b=r(71478),h=r(29648),Z=r(22408),g=r(30893),_=r(43198),E=r(62598),O=r(75201),w=r(62215),P=r(78733),D=r(37450),x=["filters","params","reportData","buttonProps","isReportDynamic","label"];function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var j=function(e){var t=e.filters,r=e.params,n=e.reportData,c=void 0===n?{}:n,d=e.buttonProps,v=e.isReportDynamic,C=void 0!==v&&v,j=e.label,R=(0,i.Z)(e,x),F=(0,f.Z)(),S=(0,p.useState)(!1),M=(0,l.Z)(S,2),T=M[0],N=M[1],V=(0,p.useState)(!1),A=(0,l.Z)(V,2),G=A[0],H=A[1],U=(0,p.useState)(!1),L=(0,l.Z)(U,2),I=L[0],W=L[1],B=(0,D.lm)(),X=(0,l.Z)(B,2),q=X[0],z=X[1];(0,p.useEffect)((function(){N(!0),q({msg:F.formatMessage(g.Z.notificationReportDownloadStart)})}),[]);var J=function(e){return(0,h.F3)(e,P.tp.otherPages,(function(e){var t=e.attributes;return t.rules.length>0||t.known_exploit?P.tp.labelsHeightMultiplier:1}))},K=function(){var e=(0,o.Z)(u().mark((function e(){var s,n,o,l,i,p,m,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,b.dH)(k(k(k({},r),w.Z.defaultParams),{},{sort:r.sort||"-cvss_score",affecting:"true"},C?{advanced_report:"true"}:{report:"true"}));case 3:o=e.sent,s=o.data,n=o.meta,e.next=14;break;case 8:return e.prev=8,e.t0=e.catch(0),z(),q("403"===e.t0.status?P._V:{variant:"danger",autoDismiss:!1,msg:F.formatMessage(g.Z.notificationReportDownloadFailureTitle),description:F.formatMessage(g.Z.notificationReportDownloadFailureBody)}),N(!1),e.abrupt("return",[]);case 14:if(!c||!c.userNotes){e.next=18;break}return e.next=17,insights.chrome.auth.getUser();case 17:l=e.sent;case 18:return i=function(e,t){return t.knownExploitCount=e.filter((function(e){return!0===e.attributes.known_exploit})).length,e.map((function(e){var r;return t.hasRule||(t.hasRule=e.attributes.rules.length>0),k(k({},e),{},{attributes:k(k({},e.attributes),{},{status:P.Em.find((function(t){return t.value===e.attributes.status_id.toString()})).label,business_risk:P.eF.find((function(t){return t.value===e.attributes.business_risk_id.toString()})).label,impact:(null===(r=P.cv[e.attributes.impact])||void 0===r?void 0:r.title)||F.formatMessage(g.Z.impactListUnknown),cvss_score:parseFloat(e.attributes.cvss3_score||e.attributes.cvss2_score).toFixed(1)})})}))},p=i(s,n),H((function(){var e;return C?n.hasRule&&c&&(null===(e=c.header)||void 0===e?void 0:e.includes("rule_presence")):n.hasRule})),W((function(){var e;return C?n.knownExploitCount>0&&c&&(null===(e=c.header)||void 0===e?void 0:e.includes("known_exploit")):n.knownExploitCount>0})),m=(0,_.Z)({data:p.splice(0,(0,Z.rg)(c,r)),meta:n,filters:t,intl:F,isReportDynamic:C,reportData:c,user:l,type:"cves"}),d=J(p),N(!1),z(),q({variant:"success",msg:F.formatMessage(g.Z.notificationReportDownloadSuccess)}),e.abrupt("return",[m].concat((0,a.Z)(d.map((function(e,t){return(0,E.Z)({data:e,page:t,intl:F,header:c&&c.header,type:"cves",isReportDynamic:C})})))));case 28:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return m().createElement("div",null,m().createElement(y.o6,(0,s.Z)({fallback:null,orientation:"landscape",size:"A4",type:"",fileName:"".concat(w.Z.filename(C?"reports":""),".pdf"),buttonProps:k({component:"button"},d),asyncFunction:K,allPagesHaveTitle:!1,footer:m().createElement(O.Z,{intl:F,hasRule:G,hasExploit:I}),reportName:C?c.reportTitle:F.formatMessage(g.Z.cvePDFReportName),label:T?F.formatMessage(g.Z.loading):F.formatMessage(j)},R)))};j.defaultProps={label:g.Z.kebabExportAsPDF},j.propTypes={filters:v().oneOfType([v().array,v().object]),params:v().object,reportData:v().object,buttonProps:v().object,label:v().oneOfType([v().array,v().object]),isReportDynamic:v().bool};const R=j}}]);
//# sourceMappingURL=../sourcemaps/3084.5f36eb8b441b4e2e8b4ecb5564e06428.js.map