"use strict";(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[743],{75584:(e,t,n)=>{n.r(t),n.d(t,{default:()=>le});var r=n(4942),a=n(29439),o=n(77865),s=n.n(o),l=n(86896),c=n(30893),u=n(28216),i=n(93433),d=n(45697),p=n.n(d),f=n(74806),m=n(5977),b=n(29648),v=n(83594),y=n(49629),g=n(95351),O=n(15248),w=n(62215),h=n(87462),Z=n(15861),E=n(45987),P=n(87757),D=n.n(P),j=n(3968),S=n(71478),R=n(43198),x=n(62598),I=n(78733),_=n(37450),C=["filters","params","reportData","buttonProps","label"];function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=function(e){var t=e.filters,n=e.params,r=e.reportData,u=void 0===r?{}:r,d=e.buttonProps,p=e.label,f=(0,E.Z)(e,C),m=(0,l.Z)(),v=(0,o.useState)(!1),y=(0,a.Z)(v,2),g=y[0],O=y[1],P=(0,_.lm)(),k=(0,a.Z)(P,2),F=k[0],N=k[1],T=I.tp.systemsReportRestPages,B=I.tp.systemsReportFirstPage;(0,o.useEffect)((function(){O(!0),F({msg:m.formatMessage(c.Z.notificationReportDownloadStart)})}),[]);var A=function(e){return(0,b.F3)(e,T)},H=function(){var e=(0,Z.Z)(D().mark((function e(){var r,a,o,s,l;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,S.vk)(M(M({},n),w.Z.defaultParams));case 3:o=e.sent,r=o.data,a=o.meta,e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(0),N(),F({variant:"danger",autoDismiss:!1,msg:m.formatMessage(c.Z.notificationReportDownloadFailureTitle),description:m.formatMessage(c.Z.notificationReportDownloadFailureBody)}),e.abrupt("return",[]);case 13:return s=(0,R.Z)({data:r.splice(0,B),meta:a,filters:t,intl:m}),l=A(r),O(!1),N(),F({variant:"success",msg:m.formatMessage(c.Z.notificationReportDownloadSuccess)}),e.abrupt("return",[s].concat((0,i.Z)(l.map((function(e,t){return(0,x.Z)({data:e,page:t,intl:m,header:u&&u.header})})))));case 19:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return s().createElement("div",null,s().createElement(j.o6,(0,h.Z)({},f,{fallback:null,label:g?m.formatMessage(c.Z.loading):m.formatMessage(p),asyncFunction:H,buttonProps:M({component:"button"},d),reportName:m.formatMessage(c.Z.systemPDFReportName),type:"",fileName:"".concat(w.Z.filename("system-list"),".pdf"),allPagesHaveTitle:!1,size:"A4",orientation:"landscape"})))};F.defaultProps={label:c.Z.kebabExportAsPDF},F.propTypes={filters:p().oneOfType([p().array,p().object]),params:p().object,reportData:p().object,buttonProps:p().object,label:p().oneOfType([p().array,p().object])};const N=F;var T=n(41489),B=n(44612),A=n(32132);const H=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.excluded,r=function(t){e({excluded:t.length>0?null==t?void 0:t.join(","):void 0,page:1})};return{label:A.N.formatMessage(c.Z.filterSystemsIncludedInAnalysis),type:B.Y.checkbox,urlParam:"excluded",filterValues:{onChange:function(e,t){r(t)},items:I._9.map((function(e){return{label:e.label,value:e.value}})),value:(null==n?void 0:n.length)>0?null==n?void 0:n.split(","):void 0}}};var U=n(83215),V=n(92162);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=function(e){var t=e.selectedRows,n=e.selectedRowsCount,r=e.selectedRowsRawData,l=e.intl,d=e.canExport,p=e.canSetExcludedIncluded,f=e.canReadExcludedIncluded,m=e.parameters,b=e.rawData,h=e.methods,Z=(0,o.useState)(!1),E=(0,a.Z)(Z,2),P=E[0],D=E[1],j=h.apply,S=h.handleSelect,R=h.doOptOut,x=h.setColumnModalOpen,C=(0,u.I0)(),k=(0,o.useMemo)((function(){return{selectedExcluded:r.some((function(e){return!0===e.opt_out})),selectedIncluded:r.some((function(e){return!1===e.opt_out}))}}),[r]),M=[""].concat((0,i.Z)(p?[{label:l.formatMessage(c.Z.systemKebabExcludeAnalysis,{count:n}),onClick:function(){return R(t,null==r?void 0:r[0].display_name,!0)},props:{isDisabled:!n||!k.selectedIncluded}},{label:l.formatMessage(c.Z.systemKebabIncludeAnalysis,{count:n}),onClick:function(){return R(t,null==r?void 0:r[0].display_name,!1,t)},props:{isDisabled:!n||!k.selectedExcluded}}]:[]),[{label:l.formatMessage(c.Z.columnManagementModalTitle),onClick:function(){return x(!0)}}]),F=(0,_.ZS)({rawData:b,selectedRows:t,selectedRowsCount:n,handleSelect:S,fetchResource:function(e){return(0,v.ip)(z(z({},m),e))}}),B=[(0,g.Z)("filter",c.Z.systemsSearchName,c.Z.searchFilterByName,m.filter,j)].concat((0,i.Z)(f?[H(j,m)]:[]),[(0,V.Z)(m.rhel_version,j)]);return s().createElement(o.Fragment,null,s().createElement(y.Z,{className:"vuln-systems-primary-toolbar",bulkSelect:F,actionsConfig:{actions:M,dropdownProps:{ouiaId:"toolbar-actions"}},filterConfig:{items:B},activeFiltersConfig:{filters:(0,O.DU)(m),onDelete:function(e,t,n){return(0,O.vH)(t,h.apply,n,I.Sy)},deleteTitle:l.formatMessage(c.Z.resetFilters),showDeleteButton:!(0,O.Yy)(m,f?I.Sy:{},I.D2)},exportConfig:d?z({isDisabled:0===b.meta.totalItems,extraItems:[(0,T.Ec)(P,D)],ouiaId:"export"},(0,O.HV)({downloadReport:function(e){var t=z({},m);w.Z.exec(v.lc,t,e,"system-list",(function(e){return C((0,U.wN)(e))}),(function(){return C((0,U.L1)())}))}})):null}),P&&s().createElement(N,{showButton:!1,params:m,filters:(0,O.DU)(m),onSuccess:function(){return D(!1)}}))};K.propTypes={rawData:b.nE,canExport:p().bool,canSetExcludedIncluded:p().bool,canReadExcludedIncluded:p().bool,parameters:p().object,selectedRows:p().array,selectedRowsCount:p().number,selectedRowsRawData:p().array,methods:p().shape({doOptOut:p().func,apply:p().func,handleSelect:p().func,setColumnModalOpen:p().func}),intl:p().any};const W=(0,m.EN)((0,f.ZP)(K));var Y=n(83296),q=n(86350),G=n(43003),J=n(75115),Q=n(57998),X=n(33739),$=n(66123),ee=n(75863),te=n(24788),ne=n(66761),re=n(94909),ae=n(6023);function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const le=function(){var e=(0,_.Wu)([I._I.readVulnerabilityResults,I._I.setExcludedIncluded,I._I.basicReporting,I._I.readExcludedIncluded]),t=(0,a.Z)(e,2),n=(0,a.Z)(t[0],4),r=n[0],i=n[1],d=n[2],p=n[3],f=t[1],m=s().createRef(),y=(0,u.I0)(),g=(0,l.Z)(),O=(0,b.H1)(I.IV),w=(0,a.Z)(O,2),h=w[0],Z=w[1],E=(0,u.v9)((function(e){var t=e.entities;return(null==t?void 0:t.rows)||[]}),u.wU),P=(0,u.v9)((function(e){var t=e.entities;return null==t?void 0:t.total})),D=(0,u.v9)((function(e){var t=e.entities;return null==t?void 0:t.meta})),j=(0,u.v9)((function(e){var t=e.entities;return(null==t?void 0:t.selectedRows)||{}})),R=(0,u.v9)((function(e){var t=e.entities;return null==t?void 0:t.selectedRowsCount})),x=(0,u.v9)((function(e){var t=e.entities;return(null==t?void 0:t.selectedRowsRawData)||[]})),C=(0,u.v9)((function(e){var t=e.entities;return(null==t?void 0:t.loaded)||!1})),k=(0,u.v9)((function(e){return e.SystemsPageStore.params}),u.wU);p||(k.excluded="");var M=(0,u.v9)((function(e){return e.SystemsPageStore.error})),F=M.hasError,N=M.errorCode,T=(0,u.v9)((function(e){return e.SystemsPageStore.columns})),B=(0,o.useState)(!1),A=(0,a.Z)(B,2),H=A[0],V=A[1];(0,o.useEffect)((function(){return function(){y((0,v.re)()),y((0,v.r5)()),y((0,U.L1)())}}),[y]);var L=function(e){return y((0,v.SF)(e))};(0,o.useEffect)((function(){return L(h)}),[]),(0,o.useEffect)((function(){return Z(se(se({},k),D))}),[Z,k,D]);var z=(0,_.a9)((function(){return y((0,v.r5)()),m.current.onRefreshData({page:1})})),K=(0,_.U)(S.vk,{}),oe=(0,o.useState)(0),le=(0,a.Z)(oe,2),ce=le[0],ue=le[1];return(0,o.useEffect)((function(){return ue(ce+1)}),[T]),f?s().createElement(ae.Z,{centered:!0}):r?s().createElement(o.Fragment,null,s().createElement(ne.Z,{appliedColumns:T,applyColumns:function(e){return y((0,v.Ce)(e))},isModalOpen:H,setModalOpen:V}),s().createElement(J.Z,{title:g.formatMessage(c.Z.vulnerabilitySystemsHeader),showBreadcrumb:!1}),s().createElement(q.Z,null,F?s().createElement($.Z,{code:N}):s().createElement(X.Z,{disableDefaultColumns:!0,onLoad:function(e){var t=e.mergeWithEntities;Y.Z.register(se({},t((0,Q.K)(T),se({page:Number(k.page||1),perPage:Number(k.page_size||20)},k.sort&&{sortBy:{key:k.sort.replace(/^-/,""),direction:k.sort.match(/^-/)?"desc":"asc"}}))))},tableProps:{isStickyHeader:!0,canSelectAll:!1,actionResolver:P>0&&i&&function(e){return(0,G.zs)(e,z)},variant:ee.B.compact},paginationProps:{isDisabled:!P},showTagModal:!0,isFullView:!0,ref:m,autoRefresh:!0,customFilters:{vulnerabilityParams:se({},k)},columnsCounter:ce,columns:function(e){return t=e,T.filter((function(e){var t;return null!==(t=e.isShown)&&void 0!==t?t:e.isShownByDefault})).map((function(e){return se(se({},t.find((function(t){var n=t.key;return e.key===n}))),e)}));var t},getEntities:K,hideFilters:{all:!0},noSystemsTable:s().createElement(te.UE,null)},s().createElement(W,{canExport:d,canSetExcludedIncluded:i,canReadExcludedIncluded:p,parameters:k,rawData:{data:E,meta:{totalItems:P},isLoaded:C},selectedRows:j,selectedRowsCount:R,selectedRowsRawData:x,methods:{doOptOut:z,apply:L,handleSelect:function(e){return y((0,v.hd)(e))},setColumnModalOpen:V},actions:!0})))):s().createElement(re.Z,null)}}}]);
//# sourceMappingURL=../sourcemaps/Systems.d02307e86462d45fe5768feb225eae29.js.map