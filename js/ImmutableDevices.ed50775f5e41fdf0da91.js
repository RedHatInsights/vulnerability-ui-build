(self.webpackChunkvulnerability=self.webpackChunkvulnerability||[]).push([[4634],{95351:(e,t,r)=>{"use strict";r.d(t,{Z:()=>f});var n=r(4942),o=r(29439),i=r(83237),u=r(32132),s=r(23279),c=r.n(s),a=r(77865),l=r.n(a);const f=function(e,t,r,s,a){var f=l().useState(),p=(0,o.Z)(f,2),v=p[0],d=p[1],y=l().useState((function(){return c()((function(t){var r;void 0!==t&&a((r={},(0,n.Z)(r,e,t),(0,n.Z)(r,"page",1),r))}),400)})),g=(0,o.Z)(y,1)[0];return l().useEffect((function(){return d(s)}),[s]),{type:i.Y.text,label:u.N.formatMessage(t),key:e,filterValues:{"aria-label":"search-field",id:"search-".concat(t.id),onChange:function(e,t){d(t),g(t)},placeholder:u.N.formatMessage(r),value:v}}}},16369:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(4942),o=r(83237),i=r(78733),u=r(32132),s=r(30893),c=r(2883),a=r.n(c),l=r(18446),f=r.n(l);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const d=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=[];return r.rule_presence&&(l=l.concat(r.rule_presence.split(","))),r.rule&&(l=l.concat(r.rule.split(","))),{label:u.N.formatMessage(s.Z.filterSecurityRules),type:o.Y.checkbox,key:"security_rule",filterValues:{onChange:function(t,r){var n;n=r,e(v(v(v({},c.isDynamic&&{rule:n.join(",")||void 0}),!c.isDynamic&&{rule_presence:n.join(",")||void 0}),{},{page:1}))},items:(t=c.dropdownItems?c.dropdownItems:i.rM,a()(t,n,f()).map((function(e){return{label:e.label,value:e.value}}))),value:l}}}},29803:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>M});var n=r(4942),o=r(29439),i=r(77865),u=r.n(i),s=r(45697),c=r.n(s),a=r(74806),l=r(29648),f=r(93942),p=r(62012),v=r(55140),d=function(){return d=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},d.apply(this,arguments)};var y=r(83296),g=r(22167),m=r(64091),b=r(78733),h=r(66123),O=r(24788),j=r(93433),w=r(15861),P=r(64687),_=r.n(P),k=r(71478),Z=r(37450),D=r(57998);function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var F=function(){var e=(0,w.Z)(_().mark((function e(t,r){var n,o,i,u,s,c;return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,k.ip)(t);case 2:if(n=e.sent,o=null==n?void 0:n.data.map((function(e){return e.id})),i=!1,!o.length){e.next=11;break}return e.next=8,r({devices_uuid:o});case 8:c=e.sent,i=(null==c||null===(u=c.data)||void 0===u?void 0:u.enforce_edge_groups)||!1,null===(s=n.data)||void 0===s||s.forEach((function(e){var t,r,n=null==c||null===(t=c.data)||void 0===t||null===(r=t.devices)||void 0===r?void 0:r.find((function(t){return t.DeviceUUID===e.id}));return e.attributes=S(S({},e.attributes),n)}));case 11:return e.abrupt("return",{vulnerableSystems:n,enforceEdgeGroups:i});case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),N=r(97481),R=r(15248),x=r(95351),C=r(16369),I=r(22663),V=r(30893);function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var G=function(e){var t=e.intl,r=e.cveName,n=e.filterRuleValues,s=e.inventoryRef,c=e.headerFilters,a=(0,Z.Wu)([b._I.readHosts],"inventory"),P=(0,o.Z)(a,2),E=(0,o.Z)(P[0],1)[0],L=P[1],G=(0,f.I0)(),M=function(e,t){var r=(0,p.useNavigate)(),n=(0,v.Z)();return function(o,i){return r(function(e,t,r,n){var o=("object"==typeof r?r.pathname:r)||"",i=/^\//.test(o),u=n?"/preview":"",s=t||e.getApp(),c=i?[u,e.getBundle(),s,o.replace(/^\//,"")].join("/"):o;return"object"==typeof r?d(d({},r),{pathname:c}):c}(n,e,o,i||t))}}("inventory"),U=(0,l.H1)(b.qB),z=(0,o.Z)(U,2),H=z[0],A=z[1],T=(0,f.v9)((function(e){var t=e.entities;return null==t?void 0:t.total})),Y=(0,f.v9)((function(e){var t=e.entities;return(null==t?void 0:t.error)||{}})),K=(0,f.v9)((function(e){var t=e.entities;return(null==t?void 0:t.meta)||{}})),W=(0,f.v9)((function(e){return e.ImmutableDevicesStore.parameters})),q=function(e){return G((0,m.dT)(e))};(0,i.useEffect)((function(){return q(H)}),[]),(0,i.useEffect)((function(){return A(B(B({},W),c))}),[W,c]);var J=function(e){var t=e.id,r=e.setUrlParams,n=e.createRows,o=(0,k.hC)(),i=function(){var e=(0,w.Z)(_().mark((function e(i,u){var s,c,a,l,f,p,v,d,y,g,m,b,h,O,j,w,P,k,D,E;return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g=u.orderBy,m=u.orderDirection,b=u.page,h=u.per_page,O=u.edgeParams,j=u.filters,w=j.hostnameOrId,P=S(S(S(S({filter:w},O),null!=j&&j.hostGroupFilter?{group_names:j.hostGroupFilter.join(",")}:{}),(null==j||null===(s=j.osFilter)||void 0===s?void 0:s.length)>0?{rhel_version:j.osFilter.map((function(e){return e.value})).join(",")}:{}),{},{page:b,page_size:h,sort:(0,Z.v8)(g,m)}),null==r||r(S({},P)),e.next=6,F(S(S({},t&&{id:t}),P),o);case 6:return k=e.sent,D=k.vulnerableSystems,E=k.enforceEdgeGroups,e.abrupt("return",{results:"function"==typeof n?n(D||{},E,!0):null==D||null===(c=D.data)||void 0===c?void 0:c.map((function(e){return S({id:e.id},e.attributes)})),total:null==D||null===(a=D.meta)||void 0===a?void 0:a.total_items,page:null==D||null===(l=D.meta)||void 0===l?void 0:l.page,perPage:null==D||null===(f=D.meta)||void 0===f?void 0:f.page_size,meta:{page:null==D||null===(p=D.meta)||void 0===p?void 0:p.page,sort:null==D||null===(v=D.meta)||void 0===v?void 0:v.sort,page_size:null==D||null===(d=D.meta)||void 0===d?void 0:d.page_size,cves_without_errata:null==D||null===(y=D.meta)||void 0===y?void 0:y.cves_without_errata,enforceEdgeGroups:E}});case 10:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();return i}({id:r,createRows:g.mU});(0,i.useEffect)((function(){q(c)}),[c]);var Q=(0,x.Z)("filter",V.Z.systemsSearchName,V.Z.searchFilterByName,W.filter,q),X=(0,x.Z)("advisory",V.Z.advisoryName,V.Z.searchFilterByAdvisoryName,W.advisory,q),$=(0,C.Z)(q,W,n,{isDynamic:!0,dropdownItems:b.rM.filter((function(e){return"true"!==e.value}))}),ee={filters:(0,R.DU)(B({},W),n),onDelete:function(e,t,r){return(0,R.vH)(t,q,r,{})},deleteTitle:t.formatMessage(V.Z.resetFilters),showDeleteButton:!(0,R.Yy)(W,{},b.de)},te=function(e){return(0,i.useCallback)((function(t){var r=t.mergeWithEntities;y.Z.register(S({},r((0,D.K)([]),S({page:Number(e.page||1),perPage:b.L8},e.sort&&{sortBy:(0,l.mg)(e.sort)}))))}),[])}(W);return L?u().createElement(N.Z,{size:"lg"}):null!=Y&&Y.hasError||!E?u().createElement(h.Z,{code:(null==Y?void 0:Y.errorCode)||!E&&403,"aria-label":"Error handler"}):u().createElement(I.Z,{appName:"inventory",ref:s,module:"./ImmutableDevices",fallback:u().createElement("div",null),store:y.Z.getStore(),onLoad:te,key:"immutableDevices",customFilters:{edgeParams:B(B({},W),{},{host_type:"edge"})},getEntities:J,showActions:0!==T,hideFilters:{all:!0,hostGroupFilter:K.enforceEdgeGroups||!1,operatingSystem:!1},noSystemsTable:u().createElement(O.UE,null),mergeAppColumns:function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=b.jp.find((function(e){return"os"===e.key})),n=b.jp.find((function(e){return"advisories_list"===e.key})),o=e.findIndex((function(e){return"system_profile"===e.key}));-1!==o&&(e[o]=r);var i=e.findIndex((function(e){return"groups"===e.key}));return-1!==i&&(e[i].props=S(S({},e[i].props),{},{isStatic:t})),[].concat((0,j.Z)(e),[n||[]])}(e,K.enforceEdgeGroups)},filterConfig:{items:[Q,$,X]},activeFiltersConfig:ee,onRowClick:function(e,t){M("/".concat(t,"?appName=vulnerabilities"))}})};G.defaultProps={headerFilters:{}},G.propTypes={cveName:c().string,intl:c().object,filterRuleValues:c().object,inventoryRef:c().object,headerFilters:c().object};const M=(0,a.ZP)(G)},15248:(e,t,r)=>{"use strict";r.d(t,{A6:()=>f,DU:()=>d,HV:()=>v,Yy:()=>g,lO:()=>p,vH:()=>y});var n=r(4942),o=r(30893),i=r(78733),u=r(32132),s=r(18446),c=r.n(s);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f=function(e,t,r){return r({page:t})},p=function(e,t,r){return r({page_size:t,page:1})},v=function(e){return{onSelect:function(t,r){return e.downloadReport(r)}}},d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.filter,s=e.advisory,c=(0,i.Zj)(r),a=function(e,r){return c[e].items.reduce((function(n,o){if(r===o.value)n.name=o.label,n.value=o.value;else if("rule_presence"===e){var u=t.find((function(e){return e.value===r}));["true","false",i.Zm].includes(r)?n.name=c.rule_presence.items.find((function(e){return e.value===r})).label:n.name=u&&u.label||r,n.value=r}return n}),{})},l=function(e,t){return e.reduce((function(e,r){return e.push(a(t,r)),e}),[])},f=function(e,t){return Object.keys(e).includes(t)&&!["",void 0].includes(e[t])},p=Object.keys(c).reduce((function(t,r){if("rule_presence"===r&&(f(e,"rule_presence")||f(e,"rule"))){var n=[].concat(e.rule_presence?e.rule_presence.split(","):[],e.rule?e.rule.split(","):[]);t.push({key:r,multiValue:n,category:c[r].title,chips:l(n,r)})}else if("cvss_filter"===r&&(f(e,"cvss_from")||f(e,"cvss_to"))){var o=e.cvss_from&&parseFloat(e.cvss_from).toFixed(1)||"0.0",i=e.cvss_to&&parseFloat(e.cvss_to).toFixed(1)||"10.0";"0.0"===o&&"10.0"===i||t.push({key:r,category:c[r].title,chips:[{name:"".concat(o," - ").concat(i)}]})}else if("rhel_version"===r&&f(e,"rhel_version"))t.push({key:r,multiValue:e.rhel_version.split(","),category:"Operating system",chips:e.rhel_version.split(",").map((function(e){return{value:e,name:"RHEL ".concat(e)}}))});else if(f(e,r)){var u="string"==typeof e[r]&&e[r].split(","),s=u&&u.length>1&&l(u,r)||[a(r,e[r])];t.push({key:r,multiValue:u,category:c[r].title,chips:s})}return t}),[]);return n&&p.push({key:"filter",category:u.N.formatMessage(o.Z.searchLabel),chips:[{name:n}]}),s&&p.push({key:"advisory",category:u.N.formatMessage(o.Z.advisoryName),chips:[{name:s}]}),p},y=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t(r?l(l({},arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),{},{page:1,reset:r}):l(l({},e.reduce((function(e,t){if("rule_presence"===t.key){var r=t.multiValue.filter((function(e){return!t.chips.some((function(t){return t.value===e}))}));e.rule_presence=r.filter((function(e){return["true","false"].includes(e)})).join(",")||"",e.rule=r.filter((function(e){return!["true","false"].includes(e)})).join(",")||""}else"filter"===t.key||"advisory"===t.key||t.multiValue&&1===t.multiValue.length?e[t.key]="":"cvss_filter"===t.key?(e.cvss_filter=void 0,e.cvss_from=void 0,e.cvss_to=void 0):e[t.key]=t.multiValue.filter((function(e){return!t.chips.some((function(t){return t.value===e}))})).join(",");return""===e[t.key]&&(e[t.key]=void 0),e}),{})),{},{page:1}))},g=function(e,t,r){return e=r.reduce((function(t,r){return l(l({},t),e[r]&&(0,n.Z)({},r,e[r]))}),{}),c()(e,t)}},57998:(e,t,r)=>{"use strict";r.d(t,{K:()=>a});var n=r(4942),o=r(18535),i=r(75910);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c={columns:[],rows:[],entities:[],loaded:!1,tagsLoaded:!1,allTagsLoaded:!1,invConfig:{},sortBy:{key:"updated",direction:"desc"},page:1,perPage:r(78733).L8,selectedRows:[],selectedRowsCount:0},a=function(e){return function(){var t=arguments.length>1?arguments[1]:void 0,r=s({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:c);switch(t.type){case i.LY+"_FULFILLED":return function(e,t,r){return t.selectedRows||(t.selectedRows=[]),t.sortBy||(t.sortBy={key:"updated",direction:"desc"}),t.loaded?s(s({},t),{},{columns:e,rows:t.rows.map((function(e){return s(s({},e),{},{selected:t.selectedRows.some((function(t){return t.id===e.id}))||!1})})),meta:r.payload.meta}):t}(e,r,t);case i.pr:return(0,o.hd)(r,t,t.selecting);case i.xC:return s(s({},r),{},{rows:r.rows.map((function(e){return s(s({},e),{},{isOpen:e.id===t.payload.id?t.payload.isOpen:e.isOpen})}))});case i.t2:return c;default:return r}}}},2883:(e,t,r)=>{var n=r(21078),o=r(5976),i=r(45652),u=r(29246),s=r(10928),c=o((function(e){var t=s(e);return t="function"==typeof t?t:void 0,i(n(e,1,u,!0),void 0,t)}));e.exports=c}}]);
//# sourceMappingURL=../sourcemaps/ImmutableDevices.8f9b4acb84ac382aa732bbd73491c520.js.map