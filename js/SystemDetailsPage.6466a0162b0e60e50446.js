(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[774],{39825:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Be});var r=n(59713),o=n.n(r),a=n(34575),i=n.n(a),c=n(93913),s=n.n(c),l=n(2205),u=n.n(l),p=n(78585),f=n.n(p),d=n(29754),m=n.n(d),y=n(86350),v=n(83215),b=n(45697),O=n.n(b),h=n(25558),g=n.n(h),E=n(276),S=n(5977),j=n(13921),P=n(6479),_=n.n(P),w=n(63038),D=n.n(w),C=n(60578),Z=n(67154),R=n.n(Z),k=n(319),x=n.n(k),T=n(3351),A=n(22860),I=n(6934),L=n(75863),M=n(75959),F=n(32875),H=n(26686),N=n(76558),B=n(21155),V=n(89776);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Y=function(e){var t,n=e.context,r=e.header,o=e.entity,a=n.cves,i=n.methods,c=n.selectedCves,s=n.expandedRows,l=n.canEditStatus;(null==a||null===(t=a.meta)||void 0===t?void 0:t.patch_access)||(r=r.filter((function(e){return"advisory"!==e.key})));var u=!a.data||0===a.data.length,p=u?[]:a.data.map((function(e){return c.includes(e.id)&&K(K({},e),{},{selected:!0})||e})).map((function(e,t){var n=t%2==0?s.find((function(t){return t.id===e.id}))||!1:{isOpen:void 0};return K(K({},e),{},{isOpen:n&&n.isOpen})}));return g().createElement(h.Fragment,null,a.isLoading?g().createElement(M.Z,{colSize:6,rowSize:20,variant:L.B.compact}):g().createElement(h.Fragment,null,g().createElement(T.i,{isStickyHeader:!0,canSelectAll:!1,"aria-label":"Vulnerability CVE table",cells:r,rows:u?function(){var e=n.cves;return[{heightAuto:!0,cells:[{props:{colSpan:8},title:0!==["filter","cvss_from","cvss_to","public_from","public_to","impact","status_id"].filter((function(t){return Object.prototype.hasOwnProperty.call(e.meta,t)&&e.meta[t]})).length?V.UA:o?V.dX:e.data&&0!==e.data.length?void 0:V.vb}]}]}():p,onSelect:u?void 0:function(e,t,r){var o=n.cves,a=n.methods,i=o.data[r]&&o.data[r].id;a.selectCves(t,i)},actionResolver:!u&&l&&function(e,t){return(0,H.k8)(i,o,t.rowIndex)},sortBy:u?void 0:(0,N.hO)([{key:"collapse"},{key:"checkbox"}].concat(x()(r)),a.meta.sort),onCollapse:u?void 0:function(e,t,r){return function(e,t,r){var o=n.cves,a=n.methods,i=n.isAllExpanded,c=o.data[t]&&o.data[t].id;a.openCves(r,[c],i)}(0,t,r)},onSort:u?void 0:function(e,t,n){return(0,N.L6)(t,n,[{key:"collapse"},{key:"checkbox"}].concat(x()(r)),a.meta.sort,i.apply)},gridBreakPoint:"grid-lg",ouiaId:"cves-table",variant:L.B.compact},g().createElement(h.Fragment,null,g().createElement(I.x,null),g().createElement(A.R,null))),g().createElement(F.Z,null,g().createElement(B.Z,{meta:a.meta,apply:i.apply}))))};Y.propTypes={context:O().any,header:O().array,entity:O().string};const z=function(e){return g().createElement(je.Consumer,null,(function(t){return g().createElement(Y,R()({context:t},e))}))};var X=n(90654),J=n(84115),W=n(9470),q=n(24517),G=n(49739),$=n(83826),Q=n(68340),ee=n(68774),te=n(58990),ne=n(20326),re=n(41620),oe=n(72239),ae=n(49629),ie=n(93259),ce=n(59341),se=n(91629),le=n(93622),ue=n(50047),pe=n(74566),fe=n(15490),de=n(3196),me=n(47496);function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var be=function(e){var t=e.entity,n=e.intl,r=e.context,o=r.cves,a=r.parameters,i=r.methods,c=r.selectedCves,s=r.isAllExpanded,l=r.canEditStatus,u=r.canRemediate,p=a.filter,f=a.advisory,d=u&&(c&&c.length||0),m=(0,h.useMemo)((function(){return(0,oe.Z)({selectedItems:c,selectorHandler:i.selectCves,items:o,fetchResource:function(e){return i.fetchResource(ve(ve({},a),e))},multiRow:!0})}),[c,o,a,i]),y=[""].concat(x()(l?[{label:n.formatMessage(C.Z.editStatus),onClick:function(){return i.showStatusModal(x()(c).map((function(e){return ve({id:e},o.data.filter((function(t){return e===t.id})).map((function(e){return{status_id:e.status_id,cve_status_id:e.cve_status_id,justification:e.status_justification,cve_justification:e.cve_status_justification}}))[0])})),[])},props:{isDisabled:!d}}]:[]),[{label:s?n.formatMessage(C.Z.kebabCollapseCves):n.formatMessage(C.Z.kebabExpandCves),onClick:function(){var e=r.cves,t=r.methods,n=r.isAllExpanded,o=!n,a=n?[]:e.data.filter((function(e){return e.id})).map((function(e){return e.id}));t.openCves(o,a,!n)},props:{isDisabled:0===o.meta.total_items}}]),v=c.flatMap((function(e){return o.data.filter((function(t){return e===t.id}))}));return g().createElement(g().Fragment,null,g().createElement(ae.Z,{pagination:{itemCount:o.meta.total_items||0,page:o.meta.page||1,perPage:o.meta.page_size||1,ouiaId:"pagination-top",onSetPage:function(e,t){return(0,me.A6)(e,t,i.apply)},onPerPageSelect:function(e,t){return(0,me.lO)(e,t,i.apply)}},dedicatedAction:u&&t&&g().createElement(re.Z,{systems:t,cves:v}),actionsConfig:{actions:y,kebabToggleProps:{isDisabled:!d&&0===o.meta.total_items},dropdownProps:{ouiaId:"toolbar-actions"}},bulkSelect:{count:d,items:m.items,isDisabled:0===o.meta.total_items&&0===d,checked:Boolean(d),ouiaId:"bulk-select",onSelect:function(){return m.handleOnCheckboxChange()}},filterConfig:{items:[(0,le.Z)("filter",C.Z.cve,C.Z.searchFilterByCveID,p,i.apply),(0,ue.Z)(i.apply,a),(0,fe.Z)(i.apply,a),(0,se.Z)(i.apply,a),(0,ce.Z)(i.apply,a),(0,pe.Z)(i.apply,a),(0,ie.Z)(i.apply,a),(0,de.Z)(i.apply,a),(0,le.Z)("advisory",C.Z.advisory,C.Z.search,f,i.apply)]},activeFiltersConfig:{filters:(0,me.DU)(a),onDelete:function(e,t){return(0,me.vH)(t,i.apply)}},exportConfig:ve({isDisabled:0===o.meta.total_items,ouiaId:"export"},(0,me.HV)(i))}))};be.defaultProps={totalNumber:0,apply:function(){},downloadReport:function(){}},be.propTypes={entity:O().string,context:O().object,intl:O().any};const Oe=(0,X.ZP)((function(e){return g().createElement(je.Consumer,null,(function(t){return g().createElement(be,R()({context:t},e))}))}));var he=n(73727),ge=n(59105);function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var je=(0,h.createContext)({}),Pe=function(e){var t,n,r=e.entity,o=e.intl,a=e.allowedCveActions,i=e.showHeaderLabel,c=e.setPageTitle,s=(0,E.useDispatch)(),l=(0,h.useState)((function(){return function(){return null}})),u=D()(l,2),p=u[0],f=u[1],d=(0,h.useState)(!1),m=D()(d,2),y=m[0],b=m[1],O=(0,h.useState)(!0),S=D()(O,2),P=S[0],_=S[1],w=(0,E.useSelector)((function(e){return e.SystemCvesStore.cveList})),Z=(0,E.useSelector)((function(e){return e.SystemCvesStore.parameters})),R=(0,E.useSelector)((function(e){return e.SystemCvesStore.selectedCves})),k=(0,E.useSelector)((function(e){return e.SystemCvesStore.expandedRows})),x=(0,E.useSelector)((function(e){return e.SystemCvesStore.isAllExpanded})),T=["REMEDIATE","EDIT_STATUS"].map((function(e){return a.includes(e)})),A=D()(T,2),I=A[0],L=A[1],M=(0,h.useMemo)((function(){return(0,q.l3)(r.id,w)}),[w]),F=(0,N.H1)(W.kO),H=D()(F,2),B=H[0],U=H[1],K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,N.pX)(e);s((0,j.KV)(t))};return(0,h.useEffect)((function(){c&&(document.title="".concat(r.display_name,"\n                - ").concat(o.formatMessage(C.Z.systemsHeader)," - ").concat(o.formatMessage(C.Z.pageTitleSuffix))),P?(K(Se({sort:"-public_date"},B)),_(!1)):(s((0,j.E8)(Se(Se({},Z),{},{system:r.id}))),y&&U(Se({},Z))||b(!0))}),[Z]),(0,h.useEffect)((function(){return function(){s((0,j.jS)()),s((0,v.L1)())}}),[]),w.payload.errors?(t=w.payload.errors.status,404===(n=parseInt(t))&&r.id?V.yE:g().createElement(ge.Z,{code:n})):g().createElement(je.Provider,{value:{cves:M,parameters:Z,selectedCves:R,expandedRows:k,isAllExpanded:x,canRemediate:I,canEditStatus:L,methods:{apply:K,downloadReport:function(e){var t=Se(Se({},Z),{},{system:r.id});te.Z.exec(j.E8,t,e,"system-cves")},selectCves:function(e,t){s((0,j.TT)(t))},openCves:function(e,t,n){s((0,j.pJ)({isOpen:e,cves:t,isAllExpanded:n}))},showStatusModal:function(e){var t=Array.from(M.data.filter((function(t){return e.some((function(e){return e.id===t.id}))})));t=t.map((function(e){return{id:e.id,cve_status_id:e.cve_status_id,status_id:e.status_id,justification:e.status_justification,cve_justification:e.cve_status_justification}})),f((function(){return function(){return g().createElement(ne.Z,{cveList:t,updateRef:function(){return(0,N.$)(M.meta,K)},inventoryList:[{id:r.id,display_name:r.display_name}],type:"systemDetail"})}}))},fetchResource:function(e){return(0,j.KX)(Se(Se({},e),{},{system:r.id}))}}}},g().createElement(p,null),g().createElement(G.K,{hasGutter:!0},i&&g().createElement($.v,null,g().createElement(ee.D,null,g().createElement(Q.x,{component:Q.q.h2},o.formatMessage(C.Z.cvesHeader)))),g().createElement($.v,null,g().createElement(Oe,{entity:r.id}))),g().createElement(z,{header:W.Vm,entity:r.id}))};Pe.defaultProps={allowedCveActions:[],showHeaderLabel:!1,setPageTitle:!1},Pe.propTypes={entity:O().object,intl:O().any,allowedCveActions:O().array,showHeaderLabel:O().bool};var _e=(0,S.EN)((0,X.ZP)(Pe)),we=function(e){var t=e.customItnlProvider,n=e.customRouter,r=_()(e,["customItnlProvider","customRouter"]),o=n?he.BrowserRouter:h.Fragment,a=t?J.Z:h.Fragment;return g().createElement(a,t&&{locale:navigator.language.slice(0,2),messages:C.Z},g().createElement(o,n&&{basename:"".concat(window.location.pathname)},g().createElement(_e,r)))};we.propTypes={customItnlProvider:O().bool,customRouter:O().bool},we.defaultProps={customItnlProvider:!1,customRouter:!1};var De=function(e){u()(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=m()(t);if(n){var o=m()(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return f()(this,e)});function o(e){return i()(this,o),r.call(this,e)}return s()(o,[{key:"render",value:function(){var e=this.props,t=e.entity,n=e.isOptOut,r=e.optOutSystemHandler,o=e.loaded;return t&&o?n?g().createElement(g().Fragment,null,g().createElement(V.o0,{buttonAction:function(){return r(!1)}})):g().createElement(g().Fragment,null,g().createElement(_e,{entity:{id:t.id,display_name:t.display_name},allowedCveActions:["EDIT_STATUS","REMEDIATE"],showHeaderLabel:!0,setPageTitle:!0})):null}}]),o}(g().Component);De.propTypes={entity:O().object,isOptOut:O().bool,loaded:O().bool,optOutSystemHandler:O().func};const Ce=(0,S.EN)((0,E.connect)((function(e){var t=e.entityDetails;return{entity:t.entity,isOptOut:t.opt_out,loaded:t.loaded}}),null)(De));var Ze=n(23315);function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xe={loaded:!1},Te=n(16523),Ae=n(86190),Ie=n(38775),Le=n(53895),Me=n(33902);function Fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function He(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ne=function(e){u()(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=m()(t);if(n){var o=m()(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return f()(this,e)});function o(e){var t;return i()(this,o),(t=r.call(this,e)).optOutSystem=function(e){t.props.optOutSystem(t.state.inventoryId,e).then((function(){t.props.fetchSystemDetails(t.state.inventoryId),!0===e?t.props.addNotification({variant:"success",title:t.props.intl.formatMessage(C.Z.inventoryOptOutSuccess)}):t.props.addNotification({variant:"success",title:t.props.intl.formatMessage(C.Z.inventoryResumeAnalysisTitle),description:t.props.intl.formatMessage(C.Z.inventoryResumeAnalysisDescription)})}))},t.state={inventoryId:t.props.match.params.inventoryId},t}return s()(o,[{key:"componentDidMount",value:function(){this.props.fetchSystemDetails(this.state.inventoryId)}},{key:"render",value:function(){var e=this,t=this.props,n=t.systemDetails,r=void 0===n?{}:n,o=t.errors,a=r.opt_out,i=void 0!==a&&a,c=r.entity,s=r.loaded;return g().createElement(g().Fragment,null,g().createElement(Ie.Z,null,g().createElement(Ae.Z,{title:"",breadcrumbs:[{title:W.yy.systemsPage.title,to:W.yy.systemsPage.to,loaded:!0},{title:(null==c?void 0:c.display_name)||this.props.intl.formatMessage(C.Z.invalidSystem),isActive:!0,loaded:s}]},!o&&g().createElement(Le.Z,{onLoad:function(t){var n=t.mergeWithEntities,r=t.mergeWithDetail,o=t.INVENTORY_ACTION_TYPES;Te.Z.register(He(He({},n()),r(function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case Ze.up+"_FULFILLED":return ke(ke({},n),r.payload.data);case e.LOAD_ENTITY_FULFILLED:return ke(ke({},n),{},{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return g().createElement(Ce,{optOutSystemHandler:t})}}]});case e.LOAD_ENTITY_REJECTED:return ke(ke({},n),{},{loaded:!0,activeApps:[{title:"Vulnerabilities",name:"vulnerabilities",component:function(){return g().createElement(Ce,null)}}]});default:return n}}}(o,e.optOutSystem))))},hideBack:!0,actions:c&&[i?{title:this.props.intl.formatMessage(C.Z.inventoryKebabOptionsResume),onClick:function(){return e.optOutSystem(!1)}}:{title:this.props.intl.formatMessage(C.Z.inventoryKebabOptionsExclude),onClick:function(){return e.optOutSystem(!0)}}]})),g().createElement(y.Z,null,g().createElement(g().Fragment,null,g().createElement(Me.Z,{optOutSystemHandler:this.optOutSystem})))))}}]),o}(g().Component);Ne.propTypes={fetchSystemDetails:O().func,systemDetails:O().object,optOutSystem:O().func,match:O().object,addNotification:O().func,intl:O().any,errors:O().object};const Be=(0,S.EN)((0,X.ZP)((0,E.connect)((function(e){return{errors:e.SystemCvesStore.cveList.payload.errors,systemDetails:e.entityDetails}}),(function(e){return{optOutSystem:function(t,n){return e((0,j.DP)(t,n))},fetchSystemDetails:function(t){return e((0,j.o0)(t))},addNotification:function(t){return e((0,v.wN)(t))}}}))(Ne)))}}]);