(self.webpackChunkvulnerability=self.webpackChunkvulnerability||[]).push([[9322],{4521:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>je});var a=r(4942),n=r(29439),s=r(77865),o=r.n(s),l=r(28216),c=r(50693),i=r(16475),u=r(32203),m=r(70),p=r(62394),f=r(49734),v=r(14748),d=r(82442),g=r(93433),y=r(15861),b=r(64687),Z=r.n(b),E=r(86896),h=r(3968),S=r(71478),O=r(30893),x=r(45697),T=r.n(x),D=r(78733),R=r(62410),j=r(59589),w=r(80167),M=function(e){var t=e.counter,r=e.label;return o().createElement(j.G7,null,o().createElement(j.xv,{style:w.Z.counter},t),o().createElement(j.xv,{style:w.Z.counterLabel},r))};M.propTypes={counter:T().number,label:T().string};const C=M;var _=function(e){var t=e.data,r=e.intl,a=t.totalSystems,n=t.totalCves,l=t.totalRules;return o().createElement(s.Fragment,{key:"exec-first-page"},o().createElement(j.xv,{style:[w.Z.generated,w.Z.mb24]},r.formatMessage(O.Z.executiveReportGenerated,{date:(0,R.Z)({date:new Date,type:"exact"}).props.children})),o().createElement(j.xv,{style:w.Z.mb16},r.formatMessage(O.Z.executiveReportHeader)),o().createElement(j.xv,{style:w.Z.mb8},r.formatMessage(O.Z.executiveReportSubHeader,{systems:o().createElement(j.xv,{style:w.Z.bold},r.formatMessage(O.Z.executiveReportHeaderSystems,{systems:a})),cves:o().createElement(j.xv,{style:w.Z.bold},r.formatMessage(O.Z.executiveReportHeaderCVEs,{cves:n})),rules:o().createElement(j.xv,{style:w.Z.bold},r.formatMessage(O.Z.executiveReportHeaderRules,{rules:l}))})),o().createElement(h.$0,{withColumn:!1},o().createElement(h.s_,null,o().createElement(h.Lv,{style:w.Z.counterPanel},o().createElement(C,{counter:a,label:r.formatMessage(O.Z.executiveReportAnalyzedSystems,{systems:a})})),o().createElement(h.Lv,{style:w.Z.counterPanel},o().createElement(C,{counter:n,label:r.formatMessage(O.Z.executiveReportAnalyzedCVEs,{cves:n})})),o().createElement(h.Lv,{style:w.Z.counterPanel},o().createElement(C,{counter:l,label:r.formatMessage(O.Z.executiveReportAnalyzedRules,{rules:l})})))))};_.propTypes={data:T().exact({totalSystems:T().number,totalCves:T().number,totalRules:T().number}),intl:T().any};const N=_;var P=r(84506),k=r(39138),I=r.n(k),F=r(1809),H=function(e){var t=e.data,r=e.intl,a=function(e){return o().createElement(j.xv,{style:w.Z.mb8}," ",I()(e,{length:400}))},l=t.recentCvesData,c=t.CVSSChart,i=t.CVSSData,u=t.CVSSHeader,m=t.topCves,p=(0,P.Z)(u),f=p[0],v=p.slice(1);return o().createElement(s.Fragment,{key:"first-section"},o().createElement(j.xv,{style:w.Z.header},r.formatMessage(O.Z.cvesHeader)),o().createElement(h.$0,{titleProps:{style:w.Z.sectionTitle},title:r.formatMessage(O.Z.executiveReportCvesByCVSS)},o().createElement(h.sg,null,o().createElement(h.kL,{chartType:"pie",subTitle:"Cves",title:"100",data:c,colorSchema:"orange",legendHeader:f})),o().createElement(h.sg,null,o().createElement(h.iA,{withHeader:!0,rows:[v].concat((0,g.Z)(i))}))),o().createElement(h.$0,{titleProps:{style:w.Z.sectionTitle},title:r.formatMessage(O.Z.executiveReportRecentlyPublishedCves)},o().createElement(h.s_,{style:{flex:1}},l.map((function(e){var t=(0,n.Z)(e,2),r=t[0],a=t[1];return o().createElement(s.Fragment,{key:r},o().createElement(h.Lv,{style:{flex:1},title:r},a))})))),o().createElement(h.$0,{titleProps:{style:w.Z.sectionTitle},title:r.formatMessage(O.Z.executiveReportTop3),withColumn:!1},m.map((function(e){var t=e.synopsis,n=e.known_exploit,s=e.rule_presence,l=e.description,c=e.cvss3_score,i=e.systems_affected;return o().createElement(h.s_,{key:t,title:t,description:a(l),labels:o().createElement(F.Z,{hasExploit:n,hasRule:s,intl:r})},o().createElement(h.Lv,{title:r.formatMessage(O.Z.executiveReportPanelTitle)},Number.parseFloat(c).toFixed(1)),o().createElement(h.Lv,{title:r.formatMessage(O.Z.systemsExposed)},i.toString()))}))))};H.propTypes={data:T().exact({recentCvesData:T().array,CVSSChart:T().array,CVSSData:T().array,CVSSHeader:T().array,topCves:T().array}),intl:T().any};const L=H;var B=function(e){var t=e.data,r=e.intl,a=function(e,t){return o().createElement(s.Fragment,null,o().createElement(j.xv,{style:w.Z.mb8},"".concat(I()(e,{length:320}),"\n\n")),r.formatMessage(O.Z.associatedCves)," ",t.map((function(e){return e})).join(", "))},n=t.topRules,l=t.rulesHeader,c=t.rulesBySeverityMap,i=t.rulesChart;return o().createElement(s.Fragment,{key:"first-section"},o().createElement(j.xv,{style:w.Z.header},r.formatMessage(O.Z.rules)),o().createElement(h.$0,{titleProps:{style:w.Z.sectionTitle},title:r.formatMessage(O.Z.executiveReportRulesSection)},o().createElement(h.sg,null,o().createElement(h.iA,{withHeader:!0,rows:[l].concat((0,g.Z)(c))})),o().createElement(h.sg,null,o().createElement(h.kL,{chartType:"bar",subTitle:"rules",title:"Rules",data:i,colorSchema:"orange",legend:!1}))),o().createElement(h.$0,{titleProps:{style:w.Z.sectionTitle},title:r.formatMessage(O.Z.executiveReportTop3Rules),withColumn:!1},n.map((function(e,t){return o().createElement(h.s_,{key:t,title:e.name,description:a(e.description,e.associated_cves)},o().createElement(h.Lv,{title:r.formatMessage(O.Z.executiveReportRulePanelTitle)},o().createElement(h.Uc,{variant:e.severity})),o().createElement(h.Lv,{title:r.formatMessage(O.Z.systemsExposed)},e.systems_affected.toString()))}))))};B.propTypes={data:T().exact({topRules:T().array,rulesHeader:T().array,rulesBySeverityMap:T().array,rulesChart:T().array}),intl:T().any};const V=B;function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var A=function(e){var t,r=e.data,a=e.intl,s=r.cves_by_severity,l=r.recent_cves,c=r.top_cves,i=r.cves_total,u=r.system_count,m=r.top_rules,p=r.rules_total,f=r.rules_by_severity;0===(null==s||null===(t=s.na)||void 0===t?void 0:t.count)&&(delete s.na,delete D.cL.na);var v=Object.keys(f).reverse().map((function(e){return[D.q[e]].concat((0,g.Z)(Object.values(f[e]).map((function(e){return e.toString()}))))})),d=Object.values(s).reverse().map((function(e){var t=e.count,r=e.percentage,n=e.known_exploit_count;return[a.formatMessage(O.Z.executiveReportOfTotal,{count:t,percentage:r}),n.toString()]})),y=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=[];for(var n in e){var s=e[n],o=t[n],l=void 0!==o.count?o.count:o;r&&o.percentage&&(l=o.percentage),a.push([s,l.toString()])}return a},b=y(D.YM,z({},l)),Z=y(D.cL,z({},s),!0).map((function(e){var t=(0,n.Z)(e,2),r=t[0],a=t[1];return{x:r,y:Number(a)}})),E=v.map((function(e){var t=(0,n.Z)(e,3),r=t[0],a=t[2];return{name:r,x:r,y:Number(a)}})),h={totalSystems:u,totalCves:i,totalRules:p},S={recentCvesData:b,CVSSChart:Z,CVSSData:d,CVSSHeader:D.rs,topCves:c},x={topRules:m,rulesHeader:D.$D,rulesBySeverityMap:v,rulesChart:E};return[o().createElement(N,{key:"first-page",intl:a,data:h}),o().createElement(L,{key:"second-page-cves",intl:a,data:S}),o().createElement(V,{key:"third-page-rules",intl:a,data:x})]};A.propTypes={data:T().exact({cves_by_severity:T().object,recent_cves:T().object,top_cves:T().array,cves_total:T().number,system_count:T().number,rules_by_severity:T().object,rules_total:T().number,top_rules:T().array}),intl:T().any};const W=A;var $=r(37450),U=r(75201);const X=function(){var e=(0,E.Z)(),t=(0,s.useState)(!1),r=(0,n.Z)(t,2),a=r[0],l=r[1],c=(0,s.useState)(!1),i=(0,n.Z)(c,2),u=i[0],m=i[1],p=(0,s.useState)(!1),f=(0,n.Z)(p,2),v=f[0],d=f[1],b=(0,s.useState)(!1),x=(0,n.Z)(b,2),T=x[0],R=x[1],j=(0,$.lm)(),w=(0,n.Z)(j,2),M=w[0],C=w[1],_=function(){var t=(0,y.Z)(Z().mark((function t(){var r,a;return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,S.nK)();case 3:r=t.sent,t.next=12;break;case 6:return t.prev=6,t.t0=t.catch(0),C(),M("403"===t.t0.status?D._V:{variant:"danger",autoDismiss:!1,msg:e.formatMessage(O.Z.notificationReportDownloadFailureTitle),description:e.formatMessage(O.Z.notificationReportDownloadFailureBody)}),l(!1),t.abrupt("return",[]);case 12:return a=W({data:r,intl:e}),d((function(){return r.top_cves.some((function(e){return!0===e.rule_presence}))})),R((function(){return r.top_cves.some((function(e){return!0===e.known_exploit}))})),l(!1),C(),M({variant:"success",msg:e.formatMessage(O.Z.notificationReportDownloadSuccess)}),t.abrupt("return",(0,g.Z)(a));case 19:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(){return t.apply(this,arguments)}}(),N=(new Date).toISOString().split("T"),P=(0,n.Z)(N,1)[0];return o().createElement(s.Fragment,null,a?e.formatMessage(O.Z.loading):o().createElement("a",{onClick:function(){return m(!0),l(!0),void M({msg:e.formatMessage(O.Z.notificationReportDownloadStart)})}},e.formatMessage(O.Z.executiveReportCardButton)),u&&o().createElement(h.o6,{fallback:o().createElement("div",null),type:e.formatMessage(O.Z.executiveReportTitle),fileName:"vulnerability_executive-report--".concat(P,".pdf"),buttonProps:{variant:"link",isInline:!0},groupName:"Red Hat Insights",asyncFunction:_,allPagesHaveTitle:!1,showButton:!1,footer:o().createElement(U.Z,{intl:e,hasRule:v,hasExploit:T}),onSuccess:function(){m(!1)}}))};var J=r(80236),Q=r(47173),K=r(83115),q=r(59775),Y=r(92607),ee=r(93149),te=r(23393),re=r(13115),ae=r(57980),ne=r(32132),se=r(27482),oe=r(87462),le=r(54680),ce=r(92694),ie=function(e){var t=e.sorterData,r=e.setSorterData,a=e.selectProps,l=e.options,c=(0,s.useState)(!1),i=(0,n.Z)(c,2),u=i[0],m=i[1];return o().createElement(le.P,(0,oe.Z)({variant:"single",direction:"up","aria-label":"Select Input",onToggle:function(){return m(!u)},isOpen:u,placeholderText:l.find((function(e){return e.value===t})).label,key:"custom-sorter",onSelect:function(e,t){!function(e){var t=l.find((function(t){return t.label===e})).value;r(t),m(!1)}(t)},width:"auto"},a),l.map((function(e){return o().createElement(ce.$,{width:"100%",key:e.label,value:e.label})})))};ie.propTypes={sorterData:T().string,setSorterData:T().func,selectProps:T().object,options:T().array};const ue=ie;var me=r(95705),pe=r(40306),fe=r(29648);function ve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function de(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ve(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ge=function(e){var t=e.isOpen,r=e.handleModalClose,a=e.filterData,c=e.sorterData,i=e.setFilterData,u=e.setSorterData,m=e.handleDownloadButton,p=e.columnsToInclude,f=e.setColumnsToInclude,v=e.userNotes,d=e.setUserNotes,y=e.reportTitle,b=e.setReportTitle,Z=e.inheritGlobalTags,E=e.setInheritGlobalTags,h=e.globalFilterTags,S=(0,l.I0)(),x=(0,s.useState)(!0),T=(0,n.Z)(x,2),R=T[0],j=T[1],M=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(e,t){var r=t.major,a=t.minor,n="RHEL ".concat(r);return e[n]=[].concat((0,g.Z)(e[n]||[]),[{label:"RHEL ".concat(r,".").concat(a),value:"".concat(r,".").concat(a)}]),e}),{});return(e=Object.entries(e)).sort((function(e,t){return(0,fe.n4)(e[0],t[0],!1)})),e=e.map((function(e){var t=(0,n.Z)(e,2),r=t[0],a=t[1];return[r,Array.from(a).sort((function(e,t){return(0,fe.n4)(e.value,t.value,!1)}))]})),Object.fromEntries(e)}((0,l.v9)((function(e){var t,r=e.ReportsPageStore;return null==r||null===(t=r.operatingSystems)||void 0===t?void 0:t.data}))||[]),C=["rule_presence","known_exploit","impact","cvss_filter","business_risk_id","status_id","publish_date","rhel_version"];return(0,s.useEffect)((function(){R&&f(Object.keys(D.jW))}),[R,f]),(0,s.useEffect)((function(){S((0,pe.g6)())}),[S]),o().createElement(J.u,{width:"50rem",title:ne.N.formatMessage(O.Z.configModalTitle),ouiaId:"custom-report-modal",isOpen:t,onClose:function(){r(),E(!0)},actions:[o().createElement(Q.zx,{key:"export",variant:"primary",onClick:m,isDisabled:!(0,se.o)(a.cvss_filter.from,a.cvss_filter.to)||v.length>D.Z0},ne.N.formatMessage(O.Z.configModalExportReport)),o().createElement(Q.zx,{key:"cancel",variant:"secondary",onClick:function(){r(),E(!0)}},ne.N.formatMessage(O.Z.cancel))]},o().createElement(K.l,null,o().createElement(q.c,{label:ne.N.formatMessage(O.Z.customReportTitleLabel),fieldId:"horizontal-form-name"},o().createElement(Y.oi,{value:y,onChange:function(e){return b(e)},type:"text",className:"report-text-input",id:"horizontal-form-name"})),o().createElement(q.c,{label:ne.N.formatMessage(O.Z.customReportFilterDataByLabel)},o().createElement("div",{className:"custom-report-select-wrapper"},C&&C.map((function(e){var t;return null===(t=D.jW[e])||void 0===t?void 0:t.component(de(de({},D.jW[e]),{},{filterData:a,setFilterData:i,selectProps:de({className:"pf-u-mr-sm pf-u-mb-sm"},D.jW[e].selectProps),options:D.jW[e].items,filterId:e,filterName:D.jW[e].title},"rhel_version"===e?{options:Object.values(M).flat(),groups:M}:{}))})))),o().createElement(q.c,{label:ne.N.formatMessage(O.Z.tagFilterTitle)},o().createElement(me.Z,{onEdit:function(){return E(!1)},selectedTags:a.tags,setSelectedTags:function(e){return i(de(de({},a),{},{tags:e}))},globalTags:h,inheritGlobalTags:Z}),(null==h?void 0:h.length)>0&&Z&&o().createElement("div",{className:"pf-u-font-size-sm pf-u-mt-sm"},ne.N.formatMessage(O.Z.tagFilterGlobal),o().createElement("a",{className:"pf-u-ml-md",onClick:function(){E(!1),a.tags=[]}},ne.N.formatMessage(O.Z.tagFilterClear)))),o().createElement(q.c,{label:ne.N.formatMessage(O.Z.customReportDataToIncludeLabel)},o().createElement(re.t,{"aria-label":"Default with single selectable"},o().createElement(ae.G,{text:ne.N.formatMessage(O.Z.customReportDataToggleAll),isSelected:R,onChange:function(){return j(!0)}}),o().createElement(ae.G,{text:ne.N.formatMessage(O.Z.customReportDataToggleCustom),isSelected:!R,onChange:function(){return j(!1)}})),R||o().createElement("div",{style:w.Z.columns},o().createElement(ee.X,{id:"cve_id",label:"CVE ID",isChecked:!0,isDisabled:!0,className:"pf-u-mb-md"}),Object.entries(D.jW).filter((function(e){return!1!==(0,n.Z)(e,2)[1].hasColumn})).map((function(e){var t=(0,n.Z)(e,2),r=t[0],a=t[1];return o().createElement(ee.X,{id:r,key:r,label:a.title,isChecked:p.includes(r),onChange:function(e){return function(e,t){f(t?[].concat((0,g.Z)(p),[e]):p.filter((function(t){return t!==e})))}(r,e)},className:"pf-u-mb-md"})})))),o().createElement(q.c,{label:ne.N.formatMessage(O.Z.customReportSortDataByLabel)},o().createElement("div",{className:"custom-report-select-wrapper"},o().createElement(ue,{sorterData:c,setSorterData:u,selectProps:{className:"pf-u-mr-sm pf-u-mb-sm"},options:D.AH}))),o().createElement(q.c,{label:ne.N.formatMessage(O.Z.customReportUserNotesLabel),fieldId:"user-notes-box",helperTextInvalid:ne.N.formatMessage(O.Z.customReportUserNoteTooLong),validated:v.length>D.Z0&&"error"},o().createElement(te.Kx,{value:v,onChange:function(e){return d(e)},type:"text",id:"user-notes-box",className:"report-text-input",resizeOrientation:"vertical",style:{minHeight:"4em"},validated:v.length>D.Z0&&"error"}))))};ge.propTypes={isOpen:T().bool,filterData:T().object,sorterData:T().string,setFilterData:T().func,setSorterData:T().func,handleModalClose:T().func,handleDownloadButton:T().func,columnsToInclude:T().array,setColumnsToInclude:T().func,userNotes:T().string,setUserNotes:T().func,reportTitle:T().string,setReportTitle:T().func,inheritGlobalTags:T().bool,setInheritGlobalTags:T().func,globalFilterTags:T().array};const ye=ge,be=r.p+"fonts/chart-pie-solid.svg";var Ze=function(e){var t=e.style;return o().createElement("img",{style:t,src:be,alt:"Static pie solid"})};Ze.propTypes={style:T().object};var Ee=r(75115),he=r(27255),Se=r(22408),Oe=r(83215),xe=r(94909),Te=r(97481);function De(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?De(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):De(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const je=function(){var e,t=(0,$.Wu)([D._I.advancedReporting,D._I.readVulnerabilityResults,D._I.readHosts],""),r=(0,n.Z)(t,2),a=(0,n.Z)(r[0],3),g=a[0],y=a[1],b=a[2],Z=r[1],E=(0,s.useState)(!1),h=(0,n.Z)(E,2),S=h[0],x=h[1],T=(0,s.useState)(!1),R=(0,n.Z)(T,2),j=R[0],M=R[1],C=(0,s.useState)(ne.N.formatMessage(O.Z.customReportDefaultTitle)),_=(0,n.Z)(C,2),N=_[0],P=_[1],k=(0,s.useState)(""),I=(0,n.Z)(k,2),F=I[0],H=I[1],L=(0,s.useState)(Object.keys(D.jW)),B=(0,n.Z)(L,2),V=B[0],G=B[1],z=(0,s.useState)(D.OX),A=(0,n.Z)(z,2),W=A[0],U=A[1],J=(0,s.useState)(D.JQ),Q=(0,n.Z)(J,2),K=Q[0],q=Q[1],Y=(0,s.useState)(!0),ee=(0,n.Z)(Y,2),te=ee[0],re=ee[1],ae=null!==(e=(0,l.v9)((function(e){return e.ReportsPageStore.parameters.tags})))&&void 0!==e?e:[],se=(0,l.I0)();(0,s.useEffect)((function(){return function(){se((0,Oe.L1)())}}),[se]);var oe=function(){P(ne.N.formatMessage(O.Z.customReportDefaultTitle)),H(""),G(Object.keys(D.jW)),U(D.OX),q(D.JQ),M(!1),x(!1)},le=function(e){var t=e.split("/"),r=(0,n.Z)(t,2),a=r[0],s=r[1].split("="),o=(0,n.Z)(s,2);return{string:e,namespace:a,key:o[0],value:o[1]}};return Z?o().createElement(Te.Z,{centered:!0}):g&&b?o().createElement(o().Fragment,null,o().createElement(Ee.Z,{title:ne.N.formatMessage(O.Z.reportsPageTitle),showBreadcrumb:!1}),o().createElement(v.Z,null,o().createElement(c.r,{hasGutter:!0,lg:3,md:4,sm:12},o().createElement(i.P,null,o().createElement(u.Z,{className:"report-card"},o().createElement(m.l,null,o().createElement(Ze,{style:w.Z.pieChartIcon}),o().createElement("span",{className:"pf-u-ml-sm",style:w.Z.cardTitle},ne.N.formatMessage(O.Z.executiveReportCardTitle))),o().createElement(p.e,null,ne.N.formatMessage(O.Z.executiveReportCardDescription)),o().createElement(f.e,null,o().createElement(X,null)))),y&&o().createElement(i.P,null,o().createElement(u.Z,{className:"report-card"},o().createElement(m.l,null,o().createElement(d.ZP,{size:"lg",color:"var(--pf-global--link--Color)"}),o().createElement("span",{className:"pf-u-ml-sm",style:w.Z.cardTitle},ne.N.formatMessage(O.Z.customReportCardTitle))),o().createElement(p.e,null,ne.N.formatMessage(O.Z.customReportCardDescription)),o().createElement(f.e,null,o().createElement("a",{className:"create-report",onClick:function(){return x(!0)}},ne.N.formatMessage(O.Z.customReportCardButton))))))),o().createElement(ye,{isOpen:S,columnsToInclude:V,setColumnsToInclude:G,filterData:W,sorterData:K,userNotes:F,reportTitle:N,setReportTitle:P,setUserNotes:H,setFilterData:U,setSorterData:q,handleModalClose:oe,handleDownloadButton:function(){M(!0),x(!1)},inheritGlobalTags:te,setInheritGlobalTags:re,globalFilterTags:ae}),j&&o().createElement(he.Z,{key:"download",reportData:{header:V,reportTitle:N,userNotes:F},showButton:!1,onSuccess:oe,params:(0,Se.QT)(Re(Re({},W),{},{tags:te?null==ae?void 0:ae.map(le):W.tags}),K),filters:(0,Se._R)(Re(Re({},W),{},{tags:te?null==ae?void 0:ae.map(le):W.tags})),isReportDynamic:!0,label:O.Z.configModalExportReport})):o().createElement(xe.Z,{title:ne.N.formatMessage(O.Z.reportsPageTitle),emptyStateTitle:ne.N.formatMessage(O.Z.emptyStateNoAccessReportsPage)})}},62215:(e,t,r)=>{"use strict";r.d(t,{Z:()=>g});var a=r(4942),n=r(15861),s=r(71002),o=r(43144),l=r(15671),c=r(64687),i=r.n(c),u=r(35240),m=r(32132),p=r(30893),f=r(78733);function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const g=new((0,o.Z)((function e(){var t=this;(0,l.Z)(this,e),this.filename=function(e){var r=(new Date).toISOString().replace(/[T:]/g,"-").split(".")[0]+"-utc";switch(e){case"reports":return"vulnerability_cves-report--".concat((new Date).toISOString().split("T")[0]);case"systems-exposed":return"vulnerability_systems-exposed-".concat(t.params.cve,"--").concat(r);case"system-list":return"vulnerability_systems--".concat(r);default:return"vulnerability_cves--".concat(r)}},this.checkTypes=function(e,r,a){if("function"!=typeof e)throw"exec expects the 1st param to be funtion. Received ".concat((0,s.Z)(e));if(!t.pages.includes(r))throw"Page ".concat(r," does not exist");if(!t.formats.includes(a))throw"Format ".concat(a," is not supported")},this.exec=function(){var e=(0,n.Z)(i().mark((function e(r,a,n,s,o,l){var c,m,p,v,g;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(t.notifications.start),t.checkTypes(r,s,n),t.params.cve=(null==a?void 0:a.id)||null,e.prev=3,e.next=6,r(d(d(d(d({},a.id&&{id:a.id}),a),t.defaultParams),{},{data_format:n,report:"true"}));case 6:return c=e.sent,m=c.payload,e.next=10,m;case 10:p=e.sent,v=p.data,g="json"===n?JSON.stringify(v):v,(0,u.Sv)(g,t.filename(s),n),l(),o(t.notifications.success),e.next=23;break;case 18:throw e.prev=18,e.t0=e.catch(3),l(),o("403"===e.t0.status?f._V:t.notifications.failure),"".concat(e.t0);case 23:case"end":return e.stop()}}),e,null,[[3,18]])})));return function(t,r,a,n,s,o){return e.apply(this,arguments)}}(),this.defaultParams={page:1,page_size:Math.min(Number.MAX_SAFE_INTEGER,9007199254740991)},this.params={cve:null},this.pages=["systems-exposed","system-cves","cves","system-list"],this.formats=["csv","json"],this.notifications={start:{variant:"info",title:m.N.formatMessage(p.Z.notificationReportDownloadStart)},success:{variant:"success",title:m.N.formatMessage(p.Z.notificationReportDownloadSuccess)},failure:{variant:"danger",autoDismiss:!1,title:m.N.formatMessage(p.Z.notificationReportDownloadFailureTitle),description:m.N.formatMessage(p.Z.notificationReportDownloadFailureBody)}}})))},97853:()=>{}}]);
//# sourceMappingURL=../sourcemaps/Reports.583289dd0dec14a82f068159429ac120.js.map