(self.webpackChunkvulnerability=self.webpackChunkvulnerability||[]).push([[7311],{1809:(e,t,r)=>{"use strict";r.d(t,{Z:()=>f});var a=r(4942),s=r(77865),n=r.n(s),l=r(45697),o=r.n(l),i=r(3117),u=r(69239),c=r(80167),p=r(30893);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d=function(e){var t=e.intl,r=e.hasRule,a=e.hasExploit,s=e.isSmall,l=void 0!==s&&s;return n().createElement(i.G7,{style:c.Z.labelsWrapper},a&&n().createElement(i.G7,{style:v(v({},c.Z.label),{},{width:l?62:70})},n().createElement(u.Uc,{icon:!1,width:l?62:75,variant:4,label:t.formatMessage(p.Z.knownExploit),textStyle:l?v(v({},c.Z.smallText),{},{left:-56}):void 0,labelStyle:{border:"solid",borderWidth:1,borderColor:"#c9190b",height:l?12:20}})),r&&n().createElement(i.G7,{style:c.Z.label},n().createElement(u.Uc,{icon:!1,width:l?59:63,label:t.formatMessage(p.Z.securityRuleLabel),textStyle:l?c.Z.smallText:void 0,labelStyle:{border:"solid",borderWidth:1,borderColor:"#bee1f4",height:l?12:20}})))};d.propTypes={hasRule:o().bool,hasExploit:o().bool,intl:o().any,isSmall:o().bool};const f=d},75201:(e,t,r)=>{"use strict";r.d(t,{Z:()=>m});var a=r(77865),s=r.n(a),n=r(45697),l=r.n(n),o=r(3117),i=r(80167),u=r(30893),c=r(22408),p=function(e){var t=e.hasRule,r=e.hasExploit;return s().createElement(o.G7,null,r&&s().createElement(o.xv,{style:i.Z.footer},(0,c.aR)(u.Z.knownExploitPDFFooter)),t&&s().createElement(o.xv,{style:i.Z.footer},(0,c.aR)(u.Z.securityRulePDFFooter)))};p.propTypes={hasRule:l().bool,hasExploit:l().bool};const m=p},27255:(e,t,r)=>{"use strict";r.d(t,{Z:()=>U});var a=r(87462),s=r(93433),n=r(4942),l=r(15861),o=r(29439),i=r(45987),u=r(64687),c=r.n(u),p=r(77865),m=r.n(p),v=r(45697),d=r.n(v),f=r(86896),b=r(69239),y=r(71478),h=r(29648),g=r(22408),Z=r(30893),E=r(3117),O=r(35240),_=r(78733),w=r(80167),P=r(1809);function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var x=function(e){var t=e.data,r=e.page,a=e.intl,n=e.header,l=e.type,o=e.isReportDynamic,i=void 0!==o&&o,u=[{name:"publish_date",header:{value:a.formatMessage(Z.Z.publishDate)}},{name:"cvss_filter",header:{value:a.formatMessage(Z.Z.cvssBaseScore)},hit:"cvss_score"},{name:"impact",header:{value:a.formatMessage(Z.Z.impact)},hit:"impact"},{name:"affecting",header:{value:a.formatMessage(Z.Z.systemsExposed)},hit:"systems_affected"},{name:"business_risk_id",header:{value:a.formatMessage(Z.Z.businessRisk)},hit:"business_risk"},{name:"status_id",header:{value:a.formatMessage(Z.Z.status)},hit:"status"},{name:"advisory_available",header:{value:a.formatMessage(Z.Z.advisory)},hit:"advisory_available"}],c=function(e){var t=e.value,r=e.style;return m().createElement(E.xv,{key:t,style:r},t)},v=["cvss_score","impact","systems_affected","business_risk","status"],d=[];n?(d.push({value:a.formatMessage(Z.Z.cveId)}),v=[],u.forEach((function(e){n.includes(e.name)&&(d.push(e.header),e.hit&&v.push(e.hit))}))):"cves"===l?d=[{value:a.formatMessage(Z.Z.cveId)}].concat(u.map((function(e){return e.header}))):(v=["display_name","os","cve_count","updated"],d=[{value:a.formatMessage(Z.Z.systemsColumnHeaderName),id:"name"},{value:a.formatMessage(Z.Z.systemsColumnHeaderOSFull)},{value:a.formatMessage(Z.Z.systemsColumnHeaderCveCount)},{value:a.formatMessage(Z.Z.systemsColumnHeaderUpdated)}]);var f=function(e){var t=e.rules&&e.rules.length>0;return i?t&&n.includes("rule_presence"):t},y=(0,s.Z)(t.map((function(e){var t,r,l=e.attributes;return[m().createElement(E.G7,{style:[w.Z.bodyCell,w.Z.cveCell]},m().createElement(E.G7,null,m().createElement(E.xv,null,m().createElement(E.rU,{style:w.Z.link,src:"".concat(_.OF,"/").concat(l.synopsis)},l.synopsis))),m().createElement(P.Z,{hasExploit:(t=l,r=t.known_exploit,i?r&&n.includes("known_exploit"):r),hasRule:f(l),intl:a,isSmall:!0})),(!n||n.includes("publish_date"))&&m().createElement(E.xv,{key:l.public_date,style:[w.Z.bodyCell,w.Z.cveCell]},(0,O.Un)(l.public_date))].concat((0,s.Z)(v.map((function(e){return c({value:l[e],style:[w.Z.bodyCell,w.Z.cveCell]})}))))}))),g=(0,s.Z)(t.map((function(e){var t=e.attributes;return[c({value:t.display_name,style:[w.Z.bodyCell,w.Z.systemNameCell]}),c({value:t.os,style:[w.Z.bodyCell,w.Z.systemCell]}),c({value:t.opt_out?a.formatMessage(Z.Z.systemsTableDisabled):t.cve_count,style:[w.Z.bodyCell,w.Z.systemCell]}),c({value:(0,h.p6)(t.updated,!0),style:[w.Z.bodyCell,w.Z.systemCell]})]})));return m().createElement(p.Fragment,{key:r},m().createElement(b.iA,{withHeader:!0,rows:[d.map((function(e){return c(C(C({},e),{},{style:[w.Z.headerCell,"cves"===l?w.Z.cveCell:"name"===e.id?w.Z.systemNameCell:w.Z.systemCell]}))}))].concat((0,s.Z)("cves"===l?y:g))}),0===t.length&&m().createElement(E.xv,null,a.formatMessage(Z.Z.customReportNoItems)))};x.propTypes={data:d().object,intl:d().any,page:d().number,header:d().array,type:d().string,isReportDynamic:d().bool};const k=x;var F=r(61429),j=function(e){for(var t,r=e.data,a=e.meta,s=e.filters,n=e.intl,l=e.isReportDynamic,o=e.reportData,i=e.user,u=e.type,c=l?s:s.reduce((function(e,t){var r,a,s;return e[t.key]={filter:t.category,values:"publish_date"===t.key?_.GZ.find((function(e){return e.value===t.chips[0].value})).timespan_label:t.chips.map((function(e){return e.name})).join(", "),isAllChosen:(null===(r=("cves"===u?_.jW:_.Gb)[t.key])||void 0===r?void 0:r.component)===F.Z?t.chips.length===(null===(a=_.Oq[t.key])||void 0===a||null===(s=a.items)||void 0===s?void 0:s.length)||t.allChosen:null},e}),{}),v=[{name:"impact",msg:Z.Z.CVEsPDFreportFiltersSeverity,lowercase:!0},{name:"business_risk_id",msg:Z.Z.CVEsPDFreportFiltersBusinessRisk,lowercase:!0},{name:"status_id",msg:Z.Z.CVEsPDFreportFiltersStatus,lowercase:!0},{name:"rule_presence",msg:Z.Z.CVEsPDFreportFiltersDefinedValue,lowercase:!0},{name:"known_exploit",msg:Z.Z.CVEsPDFreportFiltersDefinedValue,lowercase:!0},{name:"advisory_available",msg:Z.Z.CVEsPDFreportFiltersAdvisoryAvailable,lowercase:!0},{name:"rhel_version",msg:Z.Z.CVEsPDFreportFiltersOsVersion}],d=[{name:"filter",msg:Z.Z.systemsPDFreportFiltersSearchTerm,lowercase:!0},{name:"rhel_version",msg:Z.Z.systemsPDFreportFiltersOsVersion}],f="cves"===u?v:d,y=0;y<f.length;y++)if(c.hasOwnProperty(f[y].name)){f[y].isFirst=!0;break}for(var h=f.length-1;h>=0;h--)if(c.hasOwnProperty(f[h].name)){f[h].isLast=!0;break}var O,P,D,C,x;return m().createElement(p.Fragment,{key:"first-section"},l&&m().createElement(b.nv,null,(0,g.aR)(Z.Z.customReportIntroductionText)),"cves"===u?m().createElement(b.nv,null,(0,g.aR)(Z.Z.customReportSearchTermCvssAndPublishDate,{hasSearchTerm:c.hasOwnProperty("filter")?"yes":"no",searchTerm:c.filter&&c.filter.values,score:c.cvss_filter&&c.cvss_filter.values||_.OX.cvss_filter.from.toFixed(1)+" - "+_.OX.cvss_filter.to.toFixed(1),published:c.publish_date&&c.publish_date.values||(0,g.aR)(Z.Z.customReportTimespanAnytime)}),f.map((function(e){var t;return c.hasOwnProperty(e.name)&&!(null!==(t=c[e.name])&&void 0!==t&&t.isAllChosen)&&(0,g.aR)(e.msg,{values:e.lowercase?c[e.name].values.toLowerCase():c[e.name].values,prefix:e.isLast?n.formatMessage(Z.Z.customReportAnd):";"})})),c.tags?".\n\n":"",c.tags?n.formatMessage(Z.Z.tagFilterParagraph)+" "+c.tags.values.map((function(e){return"".concat(e.namespace,":").concat(e.key,"=").concat(e.value)})).slice(0,10).join(", "):"",(null===(x=c.tags)||void 0===x?void 0:x.values.length)>10&&" "+n.formatMessage(Z.Z.tagFilterParagraphAndMore,{count:c.tags.values.length-10}),".\n\n"):(C=null===(O=s.find((function(e){return"excluded"===e.key})))||void 0===O?void 0:O.multiValue,(null===(P=Object.values(c))||void 0===P||null===(D=P.filter((function(e){return!0!==e.isAllChosen})))||void 0===D?void 0:D.length)>0?m().createElement(b.nv,null,n.formatMessage(Z.Z.systemsPDFreportSubHeader),1===(null==C?void 0:C.length)&&("true"===C[0]?" "+n.formatMessage(Z.Z.systemsPDFreportFiltersDisabled):" "+n.formatMessage(Z.Z.systemsPDFreportFiltersEnabled)),f.map((function(e){var t;return c.hasOwnProperty(e.name)&&!(null!==(t=c[e.name])&&void 0!==t&&t.isAllChosen)&&(0,g.aR)(e.msg,{values:e.lowercase?c[e.name].values.toLowerCase():c[e.name].values,prefix:e.isFirst?"":e.isLast?n.formatMessage(Z.Z.customReportAnd):";"})})),".\n\n"):null),"cves"===u&&m().createElement(b.nv,null,m().createElement(E.xv,null,(0,g.aR)(Z.Z.CVEsPDFreportSubHeader,{cve_count:a.total_items.toString(),system_count:a.system_count.toString()}),(l&&(null===(t=o.header)||void 0===t?void 0:t.includes("known_exploit"))||!l)&&(0,g.aR)(Z.Z.CVEsPDFreportSubHeaderExploit,{knownExploitCount:a.knownExploitCount.toString()}))),o&&o.userNotes?m().createElement(E.G7,{style:w.Z.userNotes},m().createElement(b.nv,{style:w.Z.userNotesTitle},m().createElement(E.xv,{style:w.Z.bold},n.formatMessage(Z.Z.customReportUserNoteLabel))),m().createElement(b.nv,null,m().createElement(E.xv,null,o.userNotes)),m().createElement(b.nv,null,i&&i.identity&&m().createElement(E.xv,{style:w.Z.italic},n.formatMessage(Z.Z.customReportUserNotesGenerated,{name:"".concat(i.identity.user.first_name," ").concat(i.identity.user.last_name)})))):null,m().createElement(E.G7,{style:w.Z.mt16},k({data:r,intl:n,header:o&&o.header,type:u,isReportDynamic:l})))};j.defaultProps={user:void 0},j.propTypes={intl:d().any,filters:d().array,data:d().object,meta:d().object,reportData:d().object,isReportDynamic:d().bool,user:d().object,type:d().string};const R=j;var M=r(75201),S=r(62215),T=r(37450),A=r(55140),V=["filters","params","reportData","buttonProps","isReportDynamic","label"];function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var H=function(e){var t=e.filters,r=e.params,n=e.reportData,u=void 0===n?{}:n,v=e.buttonProps,d=e.isReportDynamic,E=void 0!==d&&d,O=e.label,w=(0,i.Z)(e,V),P=(0,f.Z)(),D=(0,A.Z)(),C=(0,p.useState)(!1),x=(0,o.Z)(C,2),F=x[0],j=x[1],N=(0,p.useState)(!1),H=(0,o.Z)(N,2),U=H[0],L=H[1],I=(0,p.useState)(!1),W=(0,o.Z)(I,2),B=W[0],X=W[1],q=(0,T.lm)(),z=(0,o.Z)(q,2),J=z[0],K=z[1];(0,p.useEffect)((function(){j(!0),J({msg:P.formatMessage(Z.Z.notificationReportDownloadStart)})}),[]);var Q=function(e){return(0,h.F3)(e,_.tp.otherPages,(function(e){var t=e.attributes;return t.rules.length>0||t.known_exploit?_.tp.labelsHeightMultiplier:1}))},Y=function(){var e=(0,l.Z)(c().mark((function e(){var a,n,l,o,i,p,m,v;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,y.dH)(G(G(G({},r),S.Z.defaultParams),{},{sort:r.sort||"-cvss_score",affecting:"true"},E?{advanced_report:"true"}:{report:"true"}));case 3:l=e.sent,a=l.data,n=l.meta,e.next=14;break;case 8:return e.prev=8,e.t0=e.catch(0),K(),J("403"===e.t0.status?_._V:{variant:"danger",autoDismiss:!1,msg:P.formatMessage(Z.Z.notificationReportDownloadFailureTitle),description:P.formatMessage(Z.Z.notificationReportDownloadFailureBody)}),j(!1),e.abrupt("return",[]);case 14:if(!u||!u.userNotes){e.next=18;break}return e.next=17,D.auth.getUser();case 17:o=e.sent;case 18:return i=function(e,t){return t.knownExploitCount=e.filter((function(e){return!0===e.attributes.known_exploit})).length,e.map((function(e){var r;return t.hasRule||(t.hasRule=e.attributes.rules.length>0),G(G({},e),{},{attributes:G(G({},e.attributes),{},{status:_.Em.find((function(t){return t.value===e.attributes.status_id.toString()})).label,business_risk:_.eF.find((function(t){return t.value===e.attributes.business_risk_id.toString()})).label,impact:(null===(r=_.cv[e.attributes.impact])||void 0===r?void 0:r.title)||P.formatMessage(Z.Z.impactListUnknown),cvss_score:parseFloat(e.attributes.cvss3_score||e.attributes.cvss2_score).toFixed(1),advisory_available:e.attributes.advisory_available?P.formatMessage(Z.Z.available):P.formatMessage(Z.Z.notAvailable)})})}))},p=i(a,n),L((function(){var e;return E?n.hasRule&&u&&(null===(e=u.header)||void 0===e?void 0:e.includes("rule_presence")):n.hasRule})),X((function(){var e;return E?n.knownExploitCount>0&&u&&(null===(e=u.header)||void 0===e?void 0:e.includes("known_exploit")):n.knownExploitCount>0})),m=R({data:p.splice(0,(0,g.rg)(u,r)),meta:n,filters:t,intl:P,isReportDynamic:E,reportData:u,user:o,type:"cves"}),v=Q(p),j(!1),K(),J({variant:"success",msg:P.formatMessage(Z.Z.notificationReportDownloadSuccess)}),e.abrupt("return",[m].concat((0,s.Z)(v.map((function(e,t){return k({data:e,page:t,intl:P,header:u&&u.header,type:"cves",isReportDynamic:E})})))));case 28:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return m().createElement("div",null,m().createElement(b.o6,(0,a.Z)({fallback:null,orientation:"landscape",size:"A4",type:"",fileName:"".concat(S.Z.filename(E?"reports":""),".pdf"),buttonProps:G({component:"button"},v),asyncFunction:Y,allPagesHaveTitle:!1,footer:m().createElement(M.Z,{intl:P,hasRule:U,hasExploit:B}),reportName:E?u.reportTitle:P.formatMessage(Z.Z.cvePDFReportName),label:F?P.formatMessage(Z.Z.loading):P.formatMessage(O)},w)))};H.defaultProps={label:Z.Z.kebabExportAsPDF},H.propTypes={filters:d().oneOfType([d().array,d().object]),params:d().object,reportData:d().object,buttonProps:d().object,label:d().oneOfType([d().array,d().object]),isReportDynamic:d().bool};const U=H},72816:()=>{}}]);