(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_vulnerabilities||[]).push([[281],{66780:(e,t,r)=>{"use strict";r.d(t,{Z:()=>H});var s=r(67154),a=r.n(s),n=r(87757),o=r.n(n),i=r(319),l=r.n(i),c=r(59713),u=r.n(c),p=r(48926),m=r.n(p),f=r(63038),v=r.n(f),y=r(6479),d=r.n(y),b=r(25558),h=r.n(b),g=r(45697),_=r.n(g),Z=r(86896),E=r(276),P=r(58141),O=r(92339),D=r(81815),j=r(18623),C=r(89736),R=r(35240),k=r(59912),w=r(94949);function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var x=function(e){var t=e.data,r=e.page,s=e.intl,a=e.header,n=e.type,o=e.isReportDynamic,i=void 0!==o&&o,c=[{name:"publish_date",header:{value:s.formatMessage(j.Z.publishDate)}},{name:"cvss_filter",header:{value:s.formatMessage(j.Z.cvssBaseScore)},hit:"cvss_score"},{name:"impact",header:{value:s.formatMessage(j.Z.impact)},hit:"impact"},{name:"affecting",header:{value:s.formatMessage(j.Z.systemsExposed)},hit:"systems_affected"},{name:"business_risk_id",header:{value:s.formatMessage(j.Z.businessRisk)},hit:"business_risk"},{name:"status_id",header:{value:s.formatMessage(j.Z.status)},hit:"status"}],u=function(e){var t=e.value,r=e.style;return h().createElement(C.xv,{key:t,style:r},t)},p=["cvss_score","impact","systems_affected","business_risk","status"],m=[];a?(m.push({value:s.formatMessage(j.Z.cveId)}),p=[],c.forEach((function(e){a.includes(e.name)&&(m.push(e.header),e.hit&&p.push(e.hit))}))):"cves"===n?m=[{value:s.formatMessage(j.Z.cveId)}].concat(c.map((function(e){return e.header}))):(p=["display_name","cve_count","updated"],m=[{value:"Name"},{value:"Applicable CVEs"},{value:"Last seen"}]);var f=l()(t.map((function(e){var t=e.attributes;return[h().createElement(b.Fragment,null,h().createElement(C.G7,{style:[w.Z.bodyCell,w.Z.cveCell]},h().createElement(C.G7,null,h().createElement(C.xv,null,h().createElement(C.rU,{style:w.Z.link,src:"".concat(k.OF,"/").concat(t.synopsis)},t.synopsis))),h().createElement(C.G7,{style:w.Z.securityRuleLabel},function(e){var t=e.rules&&e.rules.length>0;return i?t&&a.includes("rule_presence"):t}(t)&&h().createElement(P.Uc,{icon:!1,width:63,label:s.formatMessage(j.Z.securityRuleLabel)})))),(!a||a.includes("publish_date"))&&h().createElement(C.xv,{key:t.public_date,style:[w.Z.bodyCell,w.Z.cveCell]},(0,R.Un)(t.public_date))].concat(l()(p.map((function(e){return u({value:t[e],style:[w.Z.bodyCell,w.Z.cveCell]})}))))}))),v=l()(t.map((function(e){var t=e.attributes;return[u({value:t.display_name,style:[w.Z.bodyCell,w.Z.systemNameCell]}),u({value:t.opt_out?s.formatMessage(j.Z.systemsTableExcluded):t.cve_count,style:[w.Z.bodyCell,w.Z.systemCell]}),u({value:(0,D.p6)(t.updated,!0),style:[w.Z.bodyCell,w.Z.systemCell]})]})));return h().createElement(b.Fragment,{key:r},h().createElement(P.iA,{withHeader:!0,rows:[m.map((function(e){return u(N(N({},e),{},{style:[w.Z.headerCell,"cves"===n?w.Z.cveCell:"Name"===e.value?w.Z.systemNameCell:w.Z.systemCell]}))}))].concat(l()("cves"===n?f:v))}),0===t.length&&h().createElement(C.xv,null,s.formatMessage(j.Z.customReportNoCves)))};x.propTypes={data:_().object,intl:_().any,page:_().number,header:_().array,type:_().string,isReportDynamic:_().bool};const M=x;var S=r(37330),T=function(e){for(var t=e.data,r=e.meta,s=e.filters,a=e.intl,n=e.isReportDynamic,o=e.reportData,i=e.user,l=e.type,c=n?s:s.reduce((function(e,t){return e[t.key]={filter:t.category,values:"publish_date"===t.key?k.GZ.find((function(e){return e.value===t.chips[0].value})).timespan_label:t.chips.map((function(e){return e.name})).join(", ")},e}),{}),u=[{name:"impact",msg:j.Z.CVEsPDFreportFiltersSeverity},{name:"business_risk_id",msg:j.Z.CVEsPDFreportFiltersBusinessRisk},{name:"status_id",msg:j.Z.CVEsPDFreportFiltersStatus},{name:"rule_presence",msg:j.Z.CVEsPDFreportFiltersSecurityRule},{name:"security_rule",msg:j.Z.CVEsPDFreportFiltersSecurityRule}],p=u.length-1;p>=0;p--)if(c.hasOwnProperty(u[p].name)){u[p].isLast=!0;break}return h().createElement(b.Fragment,{key:"first-section"},n&&h().createElement(P.nv,null,(0,S.Jo)(j.Z.customReportIntroductionText)),"cves"===l?h().createElement(P.nv,null,(0,S.Jo)(j.Z.customReportSearchTermCvssAndPublishDate,{hasSearchTerm:c.hasOwnProperty("filter")?"yes":"no",searchTerm:c.filter&&c.filter.values,score:c.cvss_filter&&c.cvss_filter.values||k.OX.cvss_filter.from.toFixed(1)+" - "+k.OX.cvss_filter.to.toFixed(1),published:c.publish_date&&c.publish_date.values||(0,S.Jo)(j.Z.customReportTimespanAnytime)}),u.map((function(e){return c.hasOwnProperty(e.name)&&(0,S.Jo)(e.msg,{values:c[e.name].values.toLowerCase(),prefix:e.isLast?a.formatMessage(j.Z.customReportAnd):";"})})),h().createElement(C.xv,null,"."),"\n\n"):h().createElement(P.nv,null,c.filter?(0,S.Jo)(j.Z.systemsPDFreportFiltersSearchTerm,{searchTerm:c.filter.values}):""),"cves"===l&&h().createElement(P.nv,null,(0,S.Jo)(j.Z.CVEsPDFreportSubHeader,{cve_count:r.total_items.toString(),system_count:r.system_count.toString()})),o&&o.userNotes?h().createElement(C.G7,{style:w.Z.userNotes},h().createElement(P.nv,{style:w.Z.userNotesTitle},h().createElement(C.xv,{style:w.Z.bold},a.formatMessage(j.Z.customReportUserNoteLabel))),h().createElement(P.nv,null,h().createElement(C.xv,null,o.userNotes)),h().createElement(P.nv,null,i&&i.identity&&h().createElement(C.xv,{style:w.Z.italic},a.formatMessage(j.Z.customReportUserNotesGenerated,{name:"".concat(i.identity.user.first_name," ").concat(i.identity.user.last_name)})))):null,M({data:t,intl:a,header:o&&o.header,type:l,isReportDynamic:n}))};T.defaultProps={user:void 0},T.propTypes={intl:_().any,filters:_().array,data:_().object,meta:_().object,reportData:_().object,isReportDynamic:_().bool,user:_().object,type:_().string};const L=T;var A=r(64739),U=r(83215);function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var J=function(e){var t=e.filters,r=e.params,s=e.reportData,n=void 0===s?{}:s,i=e.buttonProps,c=e.isReportDynamic,u=void 0!==c&&c,p=e.type,f=e.label,y=d()(e,["filters","params","reportData","buttonProps","isReportDynamic","type","label"]),g=(0,Z.Z)(),_=(0,b.useState)(!1),R=v()(_,2),F=R[0],N=R[1],x=(0,b.useState)(!1),S=v()(x,2),T=S[0],V=S[1],J=(0,E.useDispatch)();(0,b.useEffect)((function(){return function(){J((0,U.L1)())}}),[J]);var H=function(e){return(0,D.Ro)(e,k.tp.otherPages)},I=function(){var e=m()(o().mark((function e(){var s,a,i,c,m,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(!0),J((0,U.wN)({dismissable:!0,variant:"info",title:g.formatMessage(j.Z.customReportNotificationCve)})),e.next=4,(0,O.dH)(G(G(G({},r),A.Z.defaultParams),{},{sort:r.sort||"-cvss_score",affecting:"true,false"}));case 4:if(s=e.sent,a=s.data,i=s.meta,!n||!n.userNotes){e.next=11;break}return e.next=10,insights.chrome.auth.getUser();case 10:c=e.sent;case 11:return a=a.map((function(e){var t;return G(G({},e),{},{attributes:G(G({},e.attributes),{},{status:k.Em.find((function(t){return t.value===e.attributes.status_id.toString()})).label,business_risk:k.eF.find((function(t){return t.value===e.attributes.business_risk_id.toString()})).label,impact:(null===(t=k.cv[e.attributes.impact])||void 0===t?void 0:t.title)||g.formatMessage(j.Z.impactListUnknown),cvss_score:parseFloat(e.attributes.cvss3_score||e.attributes.cvss2_score).toFixed(1)})})})),V((function(){var e,t=a.some((function(e){return e.attributes.rules.length>0}));return u?t&&n&&(null===(e=n.header)||void 0===e?void 0:e.includes("rule_presence")):t})),m=L({data:a.splice(0,n.userNotes?k.tp.firstPageWithNote:k.tp.firstPageWithoutNote),meta:i,filters:t,intl:g,isReportDynamic:u,reportData:n,user:c,type:p}),f=H(a),N(!1),e.abrupt("return",[m].concat(l()(f.map((function(e,t){return M({data:e,page:t,intl:g,header:n&&n.header,type:p,isReportDynamic:u})})))));case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=m()(o().mark((function e(){var s,a,i,c,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(!0),J((0,U.wN)({dismissable:!0,variant:"info",title:g.formatMessage(j.Z.customReportNotificationSystem)})),e.next=4,(0,O.vk)(G(G({},r),A.Z.defaultParams));case 4:return s=e.sent,a=s.data,i=s.meta,c=L({data:a.splice(0,k.tp.firstPageWithoutNote),meta:i,filters:t,intl:g}),u=H(a),N(!1),e.abrupt("return",[c].concat(l()(u.map((function(e,t){return M({data:e,page:t,intl:g,header:n&&n.header})})))));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return h().createElement("div",null,h().createElement(P.o6,a()({},y,{label:F?g.formatMessage(j.Z.loading):g.formatMessage(f),asyncFunction:"cves"===p?I:W,buttonProps:G({component:"button"},i),reportName:u?n.reportTitle:"cves"===p?g.formatMessage(j.Z.cvePDFReportName):g.formatMessage(j.Z.systemPDFReportName),type:"",fileName:"".concat(A.Z.filename("cves"===p?u?"reports":"":"system-list"),".pdf"),allPagesHaveTitle:!1,size:"A4",orientation:"landscape",footer:T&&h().createElement(C.xv,{style:w.Z.footer},g.formatMessage(j.Z.customReportFooter))})))};J.defaultProps={label:j.Z.kebabExportAsPDF},J.propTypes={filters:_().oneOfType([_().array,_().object]),params:_().object,reportData:_().object,buttonProps:_().object,label:_().oneOfType([_().array,_().object]),isReportDynamic:_().bool,type:_().string};const H=J}}]);
//# sourceMappingURL=281.ed5d9f54aae56999e2c6.js.map